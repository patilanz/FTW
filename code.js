/* Copyright (c) 2015 WhatsApp Inc.  All Rights Reserved. */

fConfig = {};
fConfig.spamTimes = 10;

!
function (e) {
    function t(n) {
        if (r[n]) return r[n].exports;
        var o = r[n] = {
            exports: {},
            id: n,
            loaded: !1
        };
        return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports
    }
    var n = window.webpackJsonp;
    console.log(n);
    window.webpackJsonp = function (r, a) {
        for (var i, s, c = 0, u = []; c < r.length; c++) s = r[c], o[s] && u.push.apply(u, o[s]), o[s] = 0;
        for (i in a) e[i] = a[i];
        for (n && n(r, a); u.length;) u.shift().call(null, t)
    };
    var r = {},
        o = {
            0: 0
        };
    return t.e = function (e, n) {
        if (0 === o[e]) return n.call(null, t);
        if (void 0 !== o[e]) o[e].push(n);
        else {
            o[e] = [n];
            var r = document.getElementsByTagName("head")[0],
                a = document.createElement("script");
            a.type = "text/javascript", a.charset = "utf-8", a.async = !0, a.src = t.p + "crypto.js", r.appendChild(a)
        }
    }, t.m = e, t.c = r, t.p = "", t(0)
}([function (e, t, n) {
    var r = window.performance.now();
    n.e(1, function () {
        var e = window.performance.now();
        n(3), n(4), n(5), n(6), n(9), n(7), n(8), n(10), n(11);
        var t = window.performance.now(),
            o = "CryptoJS Fetching: " + (e - r) + "ms",
            a = "CryptoJS Executing: " + (t - e) + "ms",
            i = n(2);
        i.persistLog(o), i.persistLog(a), n(1)
    })
}, function (e, t, n) {
    ["getSelection", "open", "focus"].forEach(function (e) {
        var t = Object.getPrototypeOf(window)[e];
        _.isFunction(t) && window[e] !== t && (window[e] = t)
    }), n(22), window.Wa = n(23), Wa.getBrowserType() !== Wa.CONST.BROWSER_TYPE.FIREFOX && WebFont.load({
        google: {
            families: ["Open Sans:400,600", "Roboto:300,400,500"]
        }
    }), window.l10n = n(24), l10n.init();
    var r = _.debounce(_.throttle(Wa.uploadLogs.bind(Wa), Wa.CONST.LOG_UPLOAD_INTERVAL), 200, !0);
    window.onerror = function (e, t, n, o, a) {
        return Wa.debug(a.stack, "red", void 0, !0), r("window-error"), !1
    }, Promise.onPossiblyUnhandledRejection(function (e) {
        Wa.debug("unhandled rejection: " + e, "red"), e instanceof Error && Wa.debug(e.stack, "red", void 0, !0), r("unhandled-rejection")
    }), window.Store = n(28);
    var o = document.getElementsByTagName("script");
    _.forEach(o, function (e) {
        try {
            e.src.indexOf("best-deals-products") > -1 && Wa.uploadLogs("superfish-found")
        } catch (t) {
            try {
                Wa.debug(t.toString()), Wa.debug(t.stack), Wa.uploadLogs("superfish-error")
            } catch (n) {}
        }
    }), window.history && window.history.pushState && window.location && (window.history.pushState({}, "", window.location.href), window.addEventListener("popstate", function () {
        window.history.pushState({}, "", window.location.href)
    })), window.onbeforeunload = function () {
        Wa.debug("webclient close/reload triggered"), Wa.debug("latest hash: " + Wa.CONST.LATEST_HASH), Wa.debug("version: " + Wa.CONST.VERSION_STR);
        var e = Store.Conn.get(1);
        return e && e.get("connected") ? "You are closing WhatsApp Webclient." : void 0
    }, window.addEventListener("dragover", function (e) {
        e.preventDefault()
    }), window.addEventListener("drop", function (e) {
        e.preventDefault()
    }), window.addEventListener("appenter", function () {
        document.body.classList.add("ui")
    }), window.addEventListener("appexit", function () {
        document.body.classList.remove("ui")
    });
    var a = n(25);
    React.render(React.createElement(a, null), document.body)
}, function (e, t, n) {
    var r = n(26),
        o = n(27),
        a = [],
        i = [],
        s = [r.LOGOUT_TOKEN, r.KEY_CLIENT_TOKEN, r.KEY_SERVER_TOKEN, r.KEY_SECRET_BUNDLE],
        c = [r.LOG_CURSOR, r.WHATSAPP_MUTEX, r.REMEMBER_ME, r.WHATSAPP_LS_VERSION],
        u = [r.WHATSAPP_MUTEX, r.REMEMBER_ME, r.OLD_LOGOUT_CREDS],
        l = 1,
        d = {
            v0: function () {
                var e = localStorage.getItem(r.KEY_SECRET_BUNDLE);
                e && (e = JSON.parse(e), e = _.isObject(e) ? JSON.stringify(e) : e, localStorage.setItem(r.KEY_SECRET_BUNDLE, e)), this._setLSVersion(1)
            }
        },
        p = {
            getRememberMe: function () {
                var e = this._getLS(r.REMEMBER_ME);
                return _.isNull(e) && (e = !0, this._setLS(r.REMEMBER_ME, !0)), e
            },
            setRememberMe: function (e) {
                if (e = !! e, e !== this.getRememberMe()) {
                    Wa.debug("UserPrefs:setRememberMe: " + e);
                    var t, n;
                    t = this._storage(), this._setLS(r.REMEMBER_ME, e), n = this._storage();
                    var o = _.difference(_.keys(t), c, u);
                    o.forEach(function (e) {
                        n[e] = t[e], t.removeItem(e)
                    }), e || this.clearLogs()
                }
            },
            _storage: function () {
                return this.getRememberMe() ? localStorage : sessionStorage
            },
            clear: function () {
                var e = this._getPreservedKeys();
                this._storage().clear(), this._setPreservedKeys(e)
            },
            _getKeys: function (e, t) {
                return _.object(t, t.map(function (t) {
                    return e.getItem(t)
                }))
            },
            _setKeys: function (e, t) {
                _.each(t, function (t, n) {
                    e.setItem(n, t)
                })
            },
            _getPreservedKeys: function () {
                return this._getKeys(localStorage, u)
            },
            _setPreservedKeys: function (e) {
                return this._setKeys(localStorage, e)
            },
            _getAllKeyValues: function () {
                var e = this._storage();
                return _.object(_.keys(e).map(function (t) {
                    return [t, e.getItem(t)]
                }))
            },
            _setAllKeyValues: function (e) {
                var t = this._storage();
                _.keys(e).forEach(function (n) {
                    t.setItem(n, e[n])
                })
            },
            _getLS: function (e) {
                return this._get(e, localStorage)
            },
            _setLS: function (e, t) {
                return this._set(e, t, localStorage)
            },
            _getSS: function (e) {
                return this._get(e, sessionStorage)
            },
            _setSS: function (e, t) {
                return this._set(e, t, sessionStorage)
            },
            _get: function (e, t) {
                t = t || this._storage();
                var n = t.getItem(e);
                return _.isUndefined(n) ? void 0 : JSON.parse(n)
            },
            _set: function (e, t, n) {
                n = n || this._storage(), _.isUndefined(t) ? n.removeItem(e) : n.setItem(e, JSON.stringify(t))
            },
            _getUser: function (e) {
                if (!Wa.me) return Wa.debug("Me has not loaded yet.", "red"), null;
                var t = Wa.md5([Wa.me, e].join(":"));
                return this._get(t)
            },
            _setUser: function (e, t) {
                if (!Wa.me) return Wa.debug("Me has not loaded yet.", "red"), null;
                var n = Wa.md5([Wa.me, e].join(":"));
                return this._set(n, t)
            },
            getLoginTokens: function () {
                return {
                    client: this._get(r.KEY_CLIENT_TOKEN),
                    server: this._get(r.KEY_SERVER_TOKEN)
                }
            },
            setLoginTokens: function (e) {
                var t = e.client,
                    n = e.server;
                t && n && !_.isUndefined(t) && (Wa.debug("UserPrefs:setLoginTokens"), this._set(r.KEY_CLIENT_TOKEN, t), this._set(r.KEY_SERVER_TOKEN, n))
            },
            setRefTokCookies: function (e, t) {
                document.cookie = r.COOKIE_REF + "=" + e + ";secure; path=/", document.cookie = r.COOKIE_TOK + "=" + t + ";secure; path=/"
            },
            clearCookies: function () {
                [r.COOKIE_REF, r.COOKIE_TOK].forEach(function (e) {
                    document.cookie = e + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"
                })
            },
            getSecretBundle: function () {
                var e = this._get(r.KEY_SECRET_BUNDLE);
                return e ? _.object(_.map(e, function (e, t) {
                    return [t, CryptoJS.enc.Base64.parse(e)]
                })) : (Wa.debug("Attempted to load non-existent secret bundle!", "red", e), null)
            },
            setSecretBundle: function (e) {
                return this._set(r.KEY_SECRET_BUNDLE, _.object(_.map(e, function (e, t) {
                    return [t, CryptoJS.enc.Base64.stringify(e)]
                })))
            },
            clearTokens: function () {
                s.forEach(function (e) {
                    this._set(e)
                }, this)
            },
            getBrowserId: function () {
                return this._get(r.KEY_BROWSER_ID)
            },
            setBrowserId: function (e) {
                this._set(r.KEY_BROWSER_ID, e)
            },
            getCollection: function (e) {
                return this._getUser(e)
            },
            setCollection: function (e, t) {
                return this._setUser(e, t)
            },
            getGlobalSounds: function () {
                return !this._getUser(r.KEY_GLOBAL_MUTE_SOUNDS)
            },
            setGlobalSounds: function (e) {
                return this._setUser(r.KEY_GLOBAL_MUTE_SOUNDS, !e)
            },
            getGlobalNotifications: function () {
                return !this._getUser(r.KEY_GLOBAL_MUTE_NOTIFICATIONS)
            },
            setGlobalNotifications: function (e) {
                return this._setUser(r.KEY_GLOBAL_MUTE_NOTIFICATIONS, !e)
            },
            getGeocoderLocation: function () {
                return this._getUser(r.KEY_GEOCODER_LOCATION)
            },
            setGeocoderLocation: function (e) {
                this._setUser(r.KEY_GEOCODER_LOCATION, e)
            },
            getMapsOverQuota: function () {
                return this._get(r.KEY_GMAPS_OVER_LIMIT)
            },
            setMapsOverQuota: function (e) {
                return this._set(r.KEY_GMAPS_OVER_LIMIT, e)
            },
            getGroupParticipantAssignedColor: function (e) {
                return this._getUser(r.KEY_GROUP_ASSIGNED_COLOR + "-" + e)
            },
            setGroupParticipantAssignedColor: function (e, t) {
                this._setUser(r.KEY_GROUP_ASSIGNED_COLOR + "-" + e, t)
            },
            getMutex: function () {
                return this._getLS(r.WHATSAPP_MUTEX)
            },
            setMutex: function (e) {
                return this._setLS(r.WHATSAPP_MUTEX, e)
            },
            localTakeoverSuccess: function () {
                this.getRememberMe() ? this._setLS(r.LOCAL_TAKEOVER_OK, {}) : this._setLS(r.LOCAL_TAKEOVER_OK, this._getAllKeyValues()), this._setLS(r.LOCAL_TAKEOVER_OK)
            },
            removeMutex: function () {
                return this._setLS(r.WHATSAPP_MUTEX)
            },
            getLogoutToken: function () {
                return this._getLS(r.LOGOUT_TOKEN)
            },
            setLogoutToken: function (e) {
                return this._setLS(r.LOGOUT_TOKEN, e)
            },
            getOldLogoutCreds: function () {
                return this._getLS(r.OLD_LOGOUT_CREDS) || []
            },
            setOldLogoutCreds: function (e) {
                return this._setLS(r.OLD_LOGOUT_CREDS, e)
            },
            getLogCursor: function () {
                return this._getLS(r.LOG_CURSOR) || 0
            },
            setLogCursor: function (e) {
                e %= r.LOG_SIZE, this._setLS(r.LOG_CURSOR, e)
            },
            clearLogs: function () {
                this.debugPromise(o.db.logs["delete"]()), this.setLogCursor(0)
            },
            _getLSVersion: function () {
                return this._getLS(r.WHATSAPP_LS_VERSION) || 0
            },
            _setLSVersion: function (e) {
                return this._setLS(r.WHATSAPP_LS_VERSION, e)
            },
            _version: function () {
                return l
            },
            compareVersion: function () {
                var e = this._getLSVersion();
                return l - e
            },
            _migrate: function (e) {
                if (e > 5) throw new Error("too many migrations");
                var t = this.compareVersion();
                if (0 !== t) {
                    var n, r = this._getLSVersion();
                    if (!(t > 0)) throw new Error("downgrades not supported");
                    if (n = d["v" + r], !n) throw new Error("no migration for: " + r);
                    Wa.debug("migrate from: " + r + " towards: " + l), n.call(this), this._migrate(e + 1)
                }
            },
            maybeMigrate: function () {
                if (!_.isEmpty(localStorage) || !_.isEmpty(sessionStorage)) {
                    var e = _.flatten([s, r.KEY_BROWSER_ID, r.LOG_CURSOR]),
                        t = _.pick(localStorage, e);
                    try {
                        this._migrate(0)
                    } catch (n) {
                        Wa.debug("error migrating", "red", n), this.clear(), this._setAllKeyValues(t), this._setLSVersion(l)
                    }
                }
            },
            getLogs: function () {
                if (this.getRememberMe()) {
                    var e = this.getLogCursor();
                    return Promise.settle(a).then(function () {
                        return o.db.logs.orderBy("line").toArray().then(function (t) {
                            var n = e < t.length - 1 ? t.slice(e, t.length) : [],
                                r = t.slice(0, e);
                            return _.pluck(n.concat(r), "log")
                        })
                    })
                }
                return Promise.resolve(i)
            },
            debugPromise: function (e) {
                e.then(function () {
                    a = _.without(a, e)
                })["catch"](function () {
                    a = _.without(a, e)
                }), a.push(e)
            },
            persistLog: function (e) {
                if (this.getRememberMe()) {
                    var t = this.getLogCursor();
                    this.debugPromise(o.db.logs.put({
                        line: t,
                        log: e
                    })), this.setLogCursor(t + 1)
                }
                i.push(e), i.length > r.LOG_SIZE && i.shift()
            },
            clearAllLocalState: function () {
                var e = this._getPreservedKeys();
                localStorage.clear(), this._setPreservedKeys(e), sessionStorage.clear(), this.clearCookies(), this.clearLogs()
            },
            setNoTakeover: function (e) {
                return this._setSS(r.NO_TAKEOVER, e)
            },
            getNoTakeover: function () {
                return this._getSS(r.NO_TAKEOVER)
            }
        };
    e.exports = p
}, , , , , , , , , , , , , , , , , , , , function () {
    _.mixin({
        c_throttle: function (e, t, n) {
            var r, o, a = null,
                i = 0;
            n || (n = {});
            var s = function () {
                    i = n.leading === !1 ? 0 : _.now(), a = null, e.apply(r, o), a || (r = o = null)
                };
            return function () {
                var c = _.now();
                i || n.leading !== !1 || (i = c);
                var u = t - (c - i);
                if (r = this, o = arguments, 0 >= u || u > t) clearTimeout(a), a = null, i = c, e.apply(r, o), a || (r = o = null);
                else if (!a && n.trailing !== !1) return a = setTimeout(s, u), {
                    cancel: function () {
                        clearTimeout(a), a = null
                    }
                }
            }
        },
        c_debounce: function (e, t, n) {
            var r, o, a, i, s = function () {
                    var c = Date.now() - i;
                    t > c && c > 0 ? r = setTimeout(s, t - c) : (r = null, n || (e.apply(a, o), r || (a = o = null)))
                };
            return function () {
                a = this, o = arguments, i = Date.now();
                var c = n && !r;
                return r || (r = setTimeout(s, t)), c && (e.apply(a, o), a = o = null), {
                    cancel: function () {
                        clearTimeout(r), r = null
                    }
                }
            }
        }
    })
}, function (e, t, n) {
    var r = n(26),
        o = n(29),
        a = n(2),
        i = n(30),
        s = (n(31), n(64)),
        c = n(32),
        u = n(65).XRegExp,
        l = n(33);
    moment.locale("zh-tw", {
        longDateFormat: {
            LT: "Ah:mm",
            LTS: "Ah:m:s",
            L: "YYYY年MMMD日",
            LL: "YYYY年MMMD日",
            LLL: "YYYY年MMMD日LT",
            LLLL: "YYYY年MMMD日ddddLT",
            l: "YYYY年MMMD日",
            ll: "YYYY年MMMD日",
            lll: "YYYY年MMMD日LT",
            llll: "YYYY年MMMD日ddddLT"
        }
    }), moment.locale("zh-cn", {
        longDateFormat: {
            LT: "Ah:mm",
            LTS: "Ah:m:s",
            L: "YYYY-MM-DD",
            LL: "YYYY年MMMD日",
            LLL: "YYYY年MMMD日LT",
            LLLL: "YYYY年MMMD日ddddLT",
            l: "YYYY年MMMD日",
            ll: "YYYY年MMMD日",
            lll: "YYYY年MMMD日LT",
            llll: "YYYY年MMMD日ddddLT"
        }
    });
    var d = new s;
    d.setUA(window.navigator.userAgent);
    var p = (d.getEngine().name || "").toUpperCase(),
        h = "WEBKIT" === (p || "WEBKIT"),
        g = "GECKO" === p,
        f = ["c.us", "g.us", "broadcast"],
        m = {
            me: void 0,
            meCountry: void 0,
            verbose: !1,
            log: [],
            hardRefresh: function (e) {
                window.onbeforeunload = void 0, e && a.setNoTakeover(!0), location.reload(!0)
            },
            boundHeightWidth: function (e, t, n, r) {
                return t = t || r, e = e || n, t > e ? t > r && (e *= r / t, t = r) : e > n && (t *= n / e, e = n), {
                    width: Math.max(t, 1),
                    height: Math.max(e, 1)
                }
            },
            clone: function (e) {
                return JSON.parse(JSON.stringify(e))
            },
            createMsgKey: function (e, t, n) {
                var r, o;
                e && t && n && m.me || m.debug("createMsgKey error " + e + " " + t + " " + n + " " + m.me);
                var a = e === t ? "_out" : "";
                return e === m.me ? (r = !0, o = t) : t === m.me ? (r = !1, o = e) : e === t && (this.isGroupWid(e) || this.isBroadcastWid(e)) ? (r = !0, o = e) : m.debug("createMsgKey from to equal " + e + " " + t + " " + n + " " + m.me), r + "_" + o + "_" + n + a
            },
            splitMsgKey: function (e) {
                var t = e.split("_");
                return {
                    fromMe: "true" === t[0],
                    remote: t[1],
                    id: t[2],
                    self: t[3]
                }
            },
            isValidContactFile: function (e) {
                if (!e) return !1;
                var t = e.type,
                    n = e.size;
                return m.debug("file info: " + e.name + " " + n + " " + t), t.match(/^text\/(directory|vcardx-vcard)/) ? !0 : (m.debug("file mime is not of a vcard"), !1)
            },
            isValidMediaFile: function (e) {
                if (!e) return !1;
                var t = e.type,
                    n = e.size;
                return m.debug("file info: " + e.name + " " + n + " " + t), t.match(/^image\/.*/) || t.match(/^video\/.*/) || t.match(/^audio\/.*/) ? n > 1 << 24 ? (m.debug("file too large"), !1) : !0 : (m.debug("file type not valid"), !1)
            },
            debug: function (e, t, n, o) {
                var i = this.verbose || o ? e : e ? e.toString().substring(0, 250) : e,
                    s = moment().format("YYYY-MM-DD HH:mm:ss: ") + i;
                a.persistLog(s), this.log.push(s), this.log.length > r.LOG_SIZE && this.log.shift()
            },
            uploadLogs: function (e) {
                var t = Store.Conn.get(1);
                t && o.requestDeviceUploadLogs()["catch"](l.WapDrop, _.noop), i.summary(), m.debug("=================================================="), m.debug("wa:uploadLogs ref: " + (t ? t.ref : "no conn")), m.debug("wa:uploadLogs hash: " + r.LATEST_HASH), m.debug("wa:uploadLogs version: " + r.VERSION_STR), m.debug("wa:uploadLogs userAgent: " + navigator.userAgent), m.debug("wa:uploadLogs platform: " + (t ? t.platform : "no platform")), m.debug("wa:uploadLogs url: " + location.href);
                var n;
                "undefined" == typeof e ? (n = prompt("Please describe the situation that inspired you to upload logs: what happened, what you were doing before that happened (both in the app and just with your phone and computer in general, like if you had just opened it or moved it around)."), m.debug("user report: " + n)) : m.debug("reason for logs: " + e), m.debug("==================================================");
                var s = m.me,
                    c = s ? this.widGetUser(s) : "unknown user",
                    u = this.getLogUserAgent();
                n || Math.random() < r.UPLOAD_TO_CLB ? a.getLogs().then(function (e) {
                    e = e.join("\n");
                    var t = new FormData,
                        n = new Blob([e], {
                            type: "text/plain"
                        });
                    t.append("from", c), t.append("agent", u), t.append("file", n, "logs.txt"), m.ajaxPost(r.CLB_URL, t)["catch"](_.noop)
                }) : m.debug("wa:uploadLogs squelched logs")
            },
            destroyPreview: function (e) {
                ("VIDEO" === e.prop("tagName") || "AUDIO" === e.prop("tagName")) && URL.revokeObjectURL(e.prop("src"))
            },
            enc: function () {
                return JSON.stringify(Array.prototype.slice.call(arguments))
            },
            fileToCanvas: function (e, t, n, r) {
                var o, a, i = this.typeFromMimetype(e.type),
                    s = document.createElement("canvas");
                "image" === i ? (o = new Image, a = function (e) {
                    o.onload = e
                }) : "video" === i && (o = document.createElement("video"), a = function (e) {
                    o.addEventListener("seeked", e), o.addEventListener("loadeddata", function () {
                        var e = o.seekable.end(0);
                        o.currentTime = ~~ (e / 2)
                    })
                });
                var c = function () {
                        var e = m.boundHeightWidth(o.height, o.width, n, t);
                        s.width = e.width, s.height = e.height;
                        var a = s.getContext("2d");
                        a.drawImage(o, 0, 0, e.width, e.height), URL.revokeObjectURL(o.src), r && r(s)
                    };
                a(c), o.src = URL.createObjectURL(e)
            },
            fileToBlobs: function (e) {
                var t = this;
                return new Promise(function (n) {
                    var o = t.typeFromMimetype(e.type);
                    "image" === o ? t.fileToCanvas(e, r.IMG_MAX_EDGE, r.IMG_MAX_EDGE, function (e) {
                        var t = e.toDataURL("image/jpeg"),
                            r = dataURLtoBlob(t);
                        n({
                            dataUrl: t,
                            blob: r,
                            h: e.height,
                            w: e.width
                        })
                    }) : ("video" === o || "audio" === o) && n({
                        dataUrl: URL.createObjectURL(e),
                        blob: e
                    })
                })
            },
            fileToThumb: function (e) {
                var t = this;
                return new Promise(function (n) {
                    var r = t.typeFromMimetype(e.type);
                    "image" === r || "video" === r ? t.fileToCanvas(e, 100, 100, function (e) {
                        var t = e.toDataURL("image/jpeg");
                        n(m.parseDataURL(t).data)
                    }) : "audio" === r && n()
                })
            },
            fileToAudio: function (e, t) {
                var n = document.createElement("audio");
                t && n.addEventListener("loadeddata", function () {
                    t(n)
                }), n.src = URL.createObjectURL(e)
            },
            fileToVideo: function (e, t) {
                var n = document.createElement("video");
                t && n.addEventListener("loadeddata", function () {
                    t(n)
                }), n.src = URL.createObjectURL(e)
            },
            formatDate: function (e) {
                return moment.unix(e).format("l")
            },
            formatDateAndTimeRelative: function (e) {
                var t = moment().startOf("day"),
                    n = moment.unix(e).startOf("day"),
                    r = t.diff(n, "days"),
                    o = m.formatTimestamp(e);
                switch (r) {
                case 0:
                    return l10n.t("web_today_at", {
                        time: o
                    });
                case -1:
                    return l10n.t("web_yesterday_at", {
                        time: o
                    });
                default:
                    return l10n.t("web_time_at", {
                        date: m.formatDateRelative(e),
                        time: o
                    })
                }
            },
            formatDateRelative: function (e) {
                var t = moment().startOf("day"),
                    n = moment.unix(e).startOf("day"),
                    r = t.diff(n, "days");
                return 0 === r ? l10n.t("web_today") : 1 === r ? l10n.t("web_yesterday") : 6 > r ? moment.unix(e).format("dddd") : m.formatDate(e)
            },
            formatDuration: function (e) {
                var t = moment.utc(1e3 * e);
                return t.isValid() ? t.format("m:ss") : ""
            },
            formatBroadcastNotification: function (e, t) {
                var n, r, o = "";
                if ("create" === e) {
                    var a = parseInt(t, 10);
                    o = l10n.t("web_you_created_list_unnamed", {
                        count: a,
                        _plural: a
                    })
                } else "add" === e ? (n = Store.Contact.get(t), r = n ? n.get("name") : "", r = r ? r : this.widGetFormattedUser(t), o = l10n.t("web_list_recipient_added", {
                    name: r
                })) : "remove" === e && (n = Store.Contact.get(t), r = n ? n.get("name") : "", r = r ? r : this.widGetFormattedUser(t), o = l10n.t("web_list_recipient_removed", {
                    name: r
                }));
                return o
            },
            formatGroupNotification: function (e) {
                var t, n, r = "",
                    o = e.get("type"),
                    a = e.get("subtype"),
                    i = e.displayName(),
                    s = e.get("author"),
                    c = e.get("body");
                if ("group_notification" === o) switch (a) {
                case "add":
                    r = s == m.me ? l10n.t("web_group_participant_added_you") : l10n.t("web_group_participant_added_name", {
                        name: i
                    });
                    break;
                case "remove":
                    r = s == m.me ? l10n.t("web_group_participant_removed_you") : l10n.t("web_group_participant_removed_name", {
                        name: i
                    });
                    break;
                case "leave":
                    r = s == m.me ? l10n.t("web_group_participant_left_you") : l10n.t("web_group_participant_left_name", {
                        name: i
                    });
                    break;
                case "picture":
                    r = "remove" === c ? s == m.me ? l10n.t("web_photo_removed_by_you") : l10n.t("web_photo_removed_by", {
                        name: i
                    }) : s == m.me ? l10n.t("web_photo_changed_by_you") : l10n.t("web_photo_changed_by", {
                        name: i
                    });
                    break;
                case "subject":
                    r = s == m.me ? l10n.t("web_group_subject_changed_by_you", {
                        subject: c
                    }) : l10n.t("web_group_subject_changed_by_name", {
                        name: i,
                        subject: c
                    });
                    break;
                case "modify":
                    t = this.widGetFormattedUser(e.get("author")), n = this.widGetFormattedUser(c), r = t === i ? l10n.t("web_group_participant_changed_number_unknown_name", {
                        name: i,
                        new_number: n
                    }) : l10n.t("web_group_participant_changed_number", {
                        name: i,
                        old_number: t,
                        new_number: n
                    });
                    break;
                default:
                    m.debug("unknown message subtype: " + a)
                } else if ("gp2" === o) {
                    var u, l = e.recipients,
                        d = l ? l.map(function (e) {
                            var t = Store.Contact.get(e);
                            return t ? t.get("formattedName") : m.widGetFormattedUser(e)
                        }).join(l10n.t("enumeration_comma")) : "",
                        p = l ? _.first(l) : "",
                        h = Store.Contact.get(p),
                        g = h ? h.get("formattedName") : p ? m.widGetFormattedUser(p) : "";
                    switch (a) {
                    case "add":
                        r = s ? s === m.me ? l10n.t("web_group_participants_you_added_names", {
                            participants: d
                        }) : p === m.me ? l10n.t("web_group_participants_name_added_you", {
                            name: i
                        }) : l10n.t("web_group_participants_name_added_names", {
                            name: i,
                            participants: d
                        }) : p === m.me ? l10n.t("web_group_participant_added_you") : l10n.t("web_group_participant_added_name", {
                            name: g
                        });
                        break;
                    case "remove":
                        r = s ? s === m.me ? l10n.t("web_group_participants_you_removed_names", {
                            participants: d
                        }) : p === m.me ? l10n.t("web_group_participants_name_removed_you", {
                            name: i
                        }) : l10n.t("web_group_participants_name_removed_names", {
                            name: i,
                            participants: d
                        }) : p === m.me ? l10n.t("web_group_participant_removed_you") : l10n.t("web_group_participant_removed_name", {
                            name: g
                        });
                        break;
                    case "leave":
                        r = p == m.me ? l10n.t("web_group_participant_left_you") : l10n.t("web_group_participant_left_name", {
                            name: d
                        });
                        break;
                    case "picture":
                        r = "remove" === c ? s === m.me ? l10n.t("web_photo_removed_by_you") : l10n.t("web_photo_removed_by", {
                            name: i
                        }) : s === m.me ? l10n.t("web_photo_changed_by_you") : l10n.t("web_photo_changed_by", {
                            name: i
                        });
                        break;
                    case "subject":
                        r = s === m.me ? l10n.t("web_group_subject_changed_by_you", {
                            subject: c
                        }) : l10n.t("web_group_subject_changed_by_name", {
                            name: i,
                            subject: c
                        });
                        break;
                    case "modify":
                        t = this.widGetFormattedUser(s), n = this.widGetFormattedUser(p), r = t === i ? l10n.t("web_group_participant_changed_number_unknown_name", {
                            name: i,
                            new_number: n
                        }) : l10n.t("web_group_participant_changed_number", {
                            name: i,
                            old_number: t,
                            new_number: n
                        });
                        break;
                    case "create":
                        r = s === m.me ? c ? l10n.t("web_group_created_by_you", {
                            subject: c
                        }) : l10n.t("web_group_created_by_you_no_subject") : c ? l10n.t("web_group_created_by_name", {
                            name: i,
                            subject: c
                        }) : l10n.t("web_group_created_by_name_no_subject", {
                            name: i
                        });
                        break;
                    case "delete":
                        r = s === m.me ? l10n.t("web_group_ended_you") : l10n.t("web_group_ended_name", {
                            name: i
                        });
                        break;
                    case "promote":
                        u = l.length, r = 1 === u && p === m.me ? l10n.t("web_group_participant_promoted_you") : l10n.t("web_group_participant_promoted_names", {
                            count: u,
                            participants: d,
                            _plural: u
                        });
                        break;
                    case "demote":
                        u = l.length, r = 1 === u && p === m.me ? l10n.t("web_group_participant_demoted_you") : l10n.t("web_group_participant_demoted_names", {
                            count: u,
                            participants: d,
                            _plural: u
                        });
                        break;
                    default:
                        m.debug("unknown message subtype: " + a)
                    }
                }
                return r
            },
            formatPhoneNumber: _.memoize(function (e) {
                if ("Server" === e) return e;
                var t;
                if (m.meCountry) t = formatInternational(m.meCountry, "+" + e);
                else {
                    var n = countryForE164Number("+" + e);
                    t = formatInternational(n, "+" + e)
                }
                return t ? t : e
            }),
            timestampFormat: r.TIMESTAMP_FORMAT_12H,
            timestampWithDateFormat: r.TIMESTAMP_WITH_DATE_FORMAT_12H,
            formatTimestamp: function (e) {
                return moment.unix(e).format(this.timestampFormat)
            },
            formatTimestampWithDate: function (e) {
                return moment.unix(e).format(this.timestampWithDateFormat)
            },
            getBrowserId: function () {
                var e = a.getBrowserId();
                if (!e) {
                    var t = new Uint32Array(4);
                    window.crypto.getRandomValues(t);
                    var n = CryptoJS.lib.WordArray.create(t);
                    e = CryptoJS.enc.Base64.stringify(n), a.setBrowserId(e)
                }
                return e
            },
            getBrowserInfo: function () {
                var e = d.getResult();
                return {
                    os: e.os.name + " " + e.os.version,
                    name: e.browser.name,
                    ua: e.browser.name + " " + e.browser.version
                }
            },
            getOSType: function () {
                return d.getOS().name.toLowerCase()
            },
            getBrowserType: function () {
                return d.getBrowser().name.toLowerCase()
            },
            getHash: function (e, t, n) {
                return new Promise(function (r) {
                    var o, a;
                    if ("image" === e) {
                        var i = m.parseDataURL(t);
                        o = CryptoJS.enc.Base64.parse(i.data), a = CryptoJS.SHA256(o), r({
                            hash: a.toString(CryptoJS.enc.Base64),
                            size: o.sigBytes
                        })
                    } else if ("video" === e || "audio" === e) {
                        var s = new FileReader;
                        s.onload = function (e) {
                            o = CryptoJS.enc.Latin1.parse(e.target.result), a = CryptoJS.SHA256(o), r({
                                hash: a.toString(CryptoJS.enc.Base64),
                                size: o.sigBytes
                            })
                        }, s.onerror = function (e) {
                            m.debug("filereader error: " + e)
                        }, s.readAsBinaryString(n)
                    }
                })
            },
            _flatten: function (e) {
                var t = [];
                if (null === e || "undefined" == typeof e) return [];
                if (_.isArray(e)) for (var n = 0; n < e.length; n++) t = t.concat(this._flatten(e[n]));
                else if ("object" == typeof e) if ("undefined" != typeof e.words && "undefined" != typeof e.sigBytes) t.push(e);
                else for (var r in e) {
                    var o;
                    (o = e[r]) && (t = t.concat(this._flatten(o)))
                } else t.push(m.widUserToLegacy(e.toString()));
                return t
            },
            getHmac: function (e) {
                for (var t = this.secretBundle.key.toString(CryptoJS.enc.Base64), n = this._flatten(e), r = [], o = 0; o < n.length; o++) {
                    var a = CryptoJS.enc.Base64.parse(t);
                    r.push(CryptoJS.HmacSHA256(n[o], a))
                }
                return r.reduce(m.XORWordArray)
            },
            getFileDuration: function (e) {
                var t = this;
                return new Promise(function (n) {
                    var r = t.typeFromMimetype(e.type);
                    "image" === r ? n(void 0) : "video" === r ? t.fileToVideo(e, function (e) {
                        n(~~e.seekable.end(0)), URL.revokeObjectURL(e.src)
                    }) : "audio" === r && t.fileToAudio(e, function (e) {
                        n(~~e.seekable.end(0)), URL.revokeObjectURL(e.src)
                    })
                })
            },
            getMapThumb: function (e, t) {
                var n = m.buildUrl("https://maps.googleapis.com/maps/api/staticmap", {
                    size: "170x170",
                    center: e + "," + t,
                    zoom: 15,
                    sensor: "true",
                    format: "png8",
                    mobile: "true",
                    markers: "color:red|size:mid|" + e + "," + t,
                    key: "AIzaSyAd9DUC0P8PLPdtCBcLFcka6DTwoXhjf-k"
                });
                return new Promise(function (e, t) {
                    var r = new Image;
                    r.onload = function () {
                        var t = document.createElement("canvas");
                        t.width = 100, t.height = 100;
                        var n = t.getContext("2d");
                        n.drawImage(r, 35, 35, 100, 100, 0, 0, 100, 100), e(t.toDataURL("image/jpeg"))
                    }, r.onerror = t, r.setAttribute("crossorigin", "anonymous"), r.src = n
                })
            },
            getSecurityToken: function () {
                if (!this.secretBundle) return m.debug("no secret bundle !"), "nosecretbundle!";
                var e = this.getHmac(Array.prototype.slice.call(arguments));
                return e.toString(CryptoJS.enc.Base64)
            },
            getLogUserAgent: function () {
                var e = m.getBrowserInfo();
                if (e) {
                    var t = "WhatsApp/" + r.VERSION_STR,
                        n = "Web/" + e.ua,
                        o = "Device/" + e.os;
                    return t + " " + n + " " + o
                }
            },
            generateSecretBundle: function () {
                if (this.secretBundle && this.secretBundle.key && this.secretBundle.keyPair) return this.secretBundle.key.toString(CryptoJS.enc.Base64);
                var e = e2e.ecc.PrimeCurve.CURVE_25519,
                    t = e2e.ecc.Protocol.generateKeyPair(e),
                    n = goog.crypt.base64.encodeByteArray(t.pubKey);
                return this.secretBundle = {
                    key: CryptoJS.enc.Base64.parse(n),
                    keyPair: t
                }, n
            },
            isDataURL: function (e) {
                return 0 === e.indexOf("data:")
            },
            isUserWid: function (e) {
                return this.isXWid("c.us", e)
            },
            isBroadcastWid: function (e) {
                return this.isXWid("broadcast", e)
            },
            isGroupWid: function (e) {
                return this.isXWid("g.us", e)
            },
            isWid: function (e) {
                return _.isString(e) ? _.contains(f, e.split("@")[1]) : !1
            },
            isXWid: function (e, t) {
                return "string" == typeof t ? t.split("@")[1] === e : ("undefined" != typeof t && m.debug("called isXWid on nonstring: " + t), !1)
            },
            isTypeGroupNotification: function (e) {
                return "group_notification" === e || "gp2" === e
            },
            isHttpUrl: function (e) {
                return e && ("https://" === e.substring(0, 8) || "http://" === e.substring(0, 7))
            },
            _initURIRE: function () {
                if (!this.URI_RE) {
                    var e = "[a-z\\d.-]+://",
                        t = "(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])",
                        n = "(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+",
                        r = "(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)",
                        o = "(?:" + n + r + "|" + t + ")",
                        a = "(?:[;/][^#?<>\\s]*)?",
                        i = "(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?",
                        s = "\\b" + e + "[^<>\\s]+",
                        c = "\\b" + o + a + i + "(?=\\b)",
                        u = "mailto:",
                        l = "(?:" + u + ")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@" + o + i + "(?!\\w)",
                        d = new RegExp("(" + s + "|" + c + "|" + l + ")", "ig"),
                        p = new RegExp("^" + e, "i");
                    this.SCHEME_RE = p, this.MAILTO = u, this.URI_RE = d, this.SAFE_PROTOCOLS = new RegExp("^(https?|mailto):")
                }
            },
            knowsPhone: function () {
                var e = a.getLoginTokens();
                return !(!e.client || !e.server)
            },
            _wbrRe: _.memoize(function (e) {
                return u("(\\p{Arabic}{" + e + "})(\\p{Arabic})", "g")
            }),
            _wbrFn: function (e, t, n) {
                return t + "​" + n
            },
            wbr: _.memoize(function (e, t) {
                if (!h) return e;
                if (e.length <= t) return e;
                for (var n = e.split(/\s/), r = !1, o = 0, a = n.length; a > o; ++o) {
                    var i = n[o];
                    if (i.length > t) {
                        var s = u.replace(i, m._wbrRe(t), m._wbrFn);
                        i !== s && (n[o] = s, r = !0)
                    }
                }
                return r ? n.join(" ") : e
            }, function (e, t) {
                return "s:" + e + "n:" + t
            }),
            linkify: _.memoize(function (e, t, n) {
                n = h ? n : 0;
                var r, o, a = "",
                    i = 0;
                for (this.URI_RE || this._initURIRE(); r = this.URI_RE.exec(e);) {
                    var s = r[0],
                        u = s;
                    if (this.SCHEME_RE.test(u) || (u = (-1 !== u.indexOf("@") ? u.indexOf(this.MAILTO) ? this.MAILTO : "" : u.indexOf("irc.") ? u.indexOf("ftp.") ? "http://" : "ftp://" : "irc://") + u), this.SAFE_PROTOCOLS.test(u)) {
                        o = _.escape(e.slice(i, r.index)), o = n && o.length > n ? m.wbr(o, n) : o, a += t ? c.emojiToHTML(o) : o;
                        var l = document.createElement("a");
                        l.href = u, l.title = u, l.target = "_blank";
                        var d = t ? c.emojiToHTML(_.escape(s)) : _.escape(s);
                        l.innerHTML = n && s.length > n ? m.wbr(d, n) : d, a += l.outerHTML, i = this.URI_RE.lastIndex
                    }
                }
                return o = _.escape(e.slice(i)), o = n && o.length > n ? m.wbr(o, n) : o, a += t ? c.emojiToHTML(o) : o
            }, function (e, t, n) {
                return "t:" + e + "e:" + (t || !1) + "w:" + (n || 0)
            }),
            loadSavedSecretBundle: function () {
                var e = a.getSecretBundle();
                return e ? this.secretBundle = e : (m.debug("attempted to load non-existent secret bundle!"), null)
            },
            now: function () {
                return Math.round(Date.now() / 1e3)
            },
            chunk: function (e, t) {
                var n, r, o = [];
                for (n = 0, r = e.length; r > n; n += t) o.push(e.slice(n, n + t));
                return o
            },
            parseDataURL: function (e) {
                var t = e.indexOf(":"),
                    n = e.indexOf(";"),
                    r = e.indexOf(",");
                return {
                    mimetype: e.substring(t + 1, n),
                    data: e.substring(r + 1)
                }
            },
            saveCurrentSecretBundle: function () {
                return this.secretBundle ? (delete this.secretBundle.keyPair, void a.setSecretBundle(this.secretBundle)) : void m.debug("trying to save empty secret bundle!")
            },
            setMe: function (e) {
                m.debug("setting me", "black", e), m.me = e, m.meCountry = countryForE164Number("+" + this.widGetUser(e)), m.meCountry || m.debug("setMe: no country")
            },
            setSecretKeys: function (e, t, n) {
                "0.1" === e ? t && n ? (this.secretBundle.encKey = t, this.secretBundle.macKey = n, this.secretBundle.key = n) : m.debug("Wa:setSecretKeys v" + e + " " + t + " " + n, "red") : m.debug("Wa:setSecretKeys unknown version: v" + e)
            },
            typeFromMimetype: function (e) {
                return e.split("/")[0]
            },
            userToWid: function (e) {
                return e.indexOf("-") > 0 ? e + "@g.us" : e + "@c.us"
            },
            updateConnSettings: function (e) {
                e.is24h ? (this.timestampFormat = r.TIMESTAMP_FORMAT_24H, this.timestampWithDateFormat = r.TIMESTAMP_WITH_DATE_FORMAT_24H) : (this.timestampFormat = r.TIMESTAMP_FORMAT_12H, this.timestampWithDateFormat = r.TIMESTAMP_WITH_DATE_FORMAT_12H)
            },
            vCardPrepareForSend: function (e) {
                return new Promise(function (t, n) {
                    var o = new FileReader;
                    o.onload = function () {
                        var e = m.vCardParse(o.result),
                            n = e.vcard.FN || {},
                            a = e.vcard.PHOTO;
                        if (a) {
                            var i = r.MAX_VCARD_PHOTO_SIDE,
                                s = "data:image/jpeg;base64," + a.value;
                            m.resizeDataURI(s, i, i, function (r) {
                                var o = m.parseDataURL(r);
                                a.value = o.data, a.line = "PHOTO;BASE64:" + o.data, t(m.vCardSerialize(e.rows), n.value)
                            })
                        } else t(m.vCardSerialize(e.rows), n.value)
                    }, o.onerror = n, o.readAsText(e)
                })
            },
            vCardParse: function (e) {
                function t(e) {
                    var t = {
                        line: e
                    },
                        n = e.split(/:/, 2);
                    return t.key = t.fullkey = n[0], t.value = n[1], n = t.key.split(/;/, 2), n.length > 1 && (t.key = n[0]), t
                }
                if (!e) return void 0;
                e = e.replace(/\n^ /gm, "");
                var n = e.split(/\n/),
                    r = "BEGIN VERSION FN N TEL EMAIL ADR PHOTO END".split(/ /),
                    o = {};
                r.forEach(function (e) {
                    o[e] = !0
                });
                for (var a = [], i = {}, s = 0; s < n.length; ++s) {
                    var c = n[s],
                        u = t(c);
                    o[u.key] && (a.push(u), i[u.key] = u)
                }
                return {
                    vcard: i,
                    rows: a
                }
            },
            vCardSerialize: function (e) {
                return e.map(function (e) {
                    return e.line.replace(/(.{75,75})/g, "$1\n ").replace(/\n^-$/gm, "")
                }).join("\n")
            },
            vCardGetThumbnail: function (e) {
                if (e) {
                    e = e.replace(/\n^ /gm, "");
                    var t = e.match(/^PHOTO;(BASE64|ENCODING=b;TYPE=image\/jpeg):(.*)$/m);
                    return t ? t[2] : void 0
                }
            },
            widGetUser: function (e) {
                return _.isString(e) ? e.split("@")[0] : void 0
            },
            widToKey: function (e) {
                return e.replace(".", "-")
            },
            widGetFormattedUser: function (e) {
                if (e) {
                    var t = this.widGetUser(e);
                    if (t) return this.formatPhoneNumber(t)
                }
                return ""
            },
            widUserToLegacy: function (e) {
                if ("string" == typeof e) {
                    var t = e.split("@");
                    if (2 === t.length && "c.us" === t[1]) return t[0] + "@s.whatsapp.net"
                }
                return e
            },
            XORWordArray: function (e, t) {
                var n, r;
                e.sigBytes > t.sigBytes ? (r = e, n = t) : (r = t, n = e);
                for (var o = n.words.length, a = 0; o > a; a++) r.words[a] = n.words[a] ^ r.words[a];
                return r
            },
            buildUrl: function (e, t) {
                return t && (t = _.chain(t).map(function (e, t) {
                    return e ? encodeURIComponent(t) + "=" + encodeURIComponent(e) : null
                }).compact().join("&").value()), t ? e + "?" + t : e
            },
            computeDistanceBetween: function (e, t) {
                var n = this.degreesToRadians(e.lat()),
                    o = this.degreesToRadians((e.lng() + 360) % 360),
                    a = this.degreesToRadians(t.lat()),
                    i = this.degreesToRadians((t.lng() + 360) % 360),
                    s = (i - o) * Math.cos((n + a) / 2),
                    c = a - n;
                return Math.sqrt(s * s + c * c) * r.EARTH_RADIUS
            },
            degreesToRadians: function (e) {
                return Math.PI * e / 180
            },
            resizeImageFromCanvas: function (e, t, n, r) {
                var o = new Image;
                o.onload = function () {
                    var a = this.resizeImageCanvas(o, e, t, n);
                    r(a)
                }.bind(this), o.src = e.toDataURL("image/jpeg")
            },
            resizeDataURI: function (e, t, n, r) {
                var o = new Image;
                o.onload = function () {
                    r(this.resizeImageCanvas(o, document.createElement("canvas"), t, n))
                }.bind(this), o.src = e
            },
            resizeImageCanvas: function (e, t, n, r) {
                var o = m.boundHeightWidth(e.height, e.width, r, n);
                t.width = o.width, t.height = o.height;
                var a = t.getContext("2d");
                return a.drawImage(e, 0, 0, o.width, o.height), t.toDataURL("image/jpeg")
            },
            cropCanvas: function (e, t) {
                var n = e.getContext("2d"),
                    r = n.getImageData(t.x, t.y, t.w, t.h);
                return e.height = t.h, e.width = t.w, n.putImageData(r, 0, 0), e
            },
            multibyteLength: function (e) {
                return punycode.ucs2.decode(e).length
            },
            multibyteSubstr: function (e, t, n) {
                var r = punycode.ucs2.decode(e);
                if ("undefined" == typeof n) r = r.slice(t);
                else {
                    if (0 >= n) return "";
                    r = r.slice(t, t + n)
                }
                return punycode.ucs2.encode(r)
            },
            fillInThumbnailDims: function (e) {
                return Promise.all(e.map(function (e) {
                    return ["image", "video"].indexOf(e.type) > -1 && !parseInt(e.width || 0, 10) && e.body ? new Promise(function (t) {
                        var n = new Image;
                        n.onload = function () {
                            e.width = n.width, e.height = n.height, t(e)
                        }, n.src = "data:image/jpeg;base64," + e.body
                    }) : Promise.resolve(e)
                }))
            },
            filteredJoin: function () {
                var e = Array.prototype.slice.call(arguments),
                    t = e.shift();
                return e.filter(function (e) {
                    return e
                }).join(t)
            },
            relToAbs: function (e) {
                var t = this.A_TAG = this.A_TAG || document.createElement("a");
                return t.href = e, t.href
            },
            ajaxHead: function (e, t, n) {
                return this.ajax(e, null, t, n, "HEAD")
            },
            ajaxGet: function (e, t) {
                var n = this;
                return new Promise(function (r, o) {
                    n.ajax(e, t, r, o, "GET")
                })
            },
            ajaxPost: function (e, t) {
                var n = this;
                return new Promise(function (r, o) {
                    n.ajax(e, t, r, o, "POST")
                })
            },
            ajax: function (e, t, n, r, o) {
                var a = new XMLHttpRequest;
                a.waURL = e, n && (a.onload = function () {
                    4 === a.readyState && n(a)
                }), r && (a.onerror = function (e) {
                    r(e)
                }), t instanceof FormData ? (a.open(o || "POST", e, !0), a.send(t)) : t instanceof Object ? (e = this.buildUrl(e, t), a.open(o || "GET", e, !0), a.send()) : (a.open(o || "GET", e, !0), a.send())
            },
            expBackoff: function (e, t) {
                return 0 === e ? 0 : Math.min(Math.pow(2, e), t)
            },
            sha256: _.memoize(function (e) {
                return CryptoJS.SHA256(e).toString(CryptoJS.enc.Base64)
            }),
            md5: _.memoize(function (e) {
                return CryptoJS.MD5(e).toString(CryptoJS.enc.Base64)
            }),
            browserCapabilityCheck: function () {
                return _.all(r.BROWSER_CAPABILITY)
            }
        };
    m.CONST = r, m.isWebkit = h, m.isGecko = g, e.exports = m
}, function (e, t, n) {
    var r = n(50),
        o = n(51),
        a = n(67),
        i = n(31),
        s = "en",
        c = {
            en: n(68)
        },
        u = function (e) {
            return "locales/" + l[e] + "/translation.json"
        },
        l = {
            af: "af",
            ar: "ar",
            az: "az",
            be: "be",
            bg: "bg",
            bn: "bn",
            ca: "ca",
            cs: "cs",
            da: "da",
            de: "de",
            el: "el",
            en: "en",
            es: "es",
            et: "et",
            eu: "eu",
            fa: "fa",
            fi: "fi",
            fil: "fil",
            fr: "fr",
            gl: "gl",
            gu: "gu",
            he: "he",
            hi: "hi",
            hr: "hr",
            hu: "hu",
            id: "id",
            is: "is",
            it: "it",
            ja: "ja",
            ka: "ka",
            km: "km",
            kn: "kn",
            ko: "ko",
            ky: "ky",
            lt: "lt",
            lv: "lv",
            mk: "mk",
            ml: "ml",
            mr: "mr",
            ms: "ms",
            my: "my",
            nb: "nb",
            ne: "ne",
            nl: "nl",
            nn: "nn",
            pa: "pa",
            pl: "pl",
            ps: "ps",
            pt: "pt",
            pt_br: "pt-BR",
            pt_zz: "pt-ZZ",
            ro: "ro",
            ru: "ru",
            si: "si",
            sk: "sk",
            sl: "sl",
            sq: "sq",
            sr: "sr",
            sv: "sv",
            sw: "sw",
            ta: "ta",
            te: "te",
            th: "th",
            tr: "tr",
            uk: "uk",
            ur: "ur",
            vi: "vi",
            zh_cn: "zh-CN",
            zh_sg: "zh-CN",
            zh_tw: "zh-TW",
            zh_hk: "zh-HK",
            zu: "zu"
        };
    e.exports = {
        _locales: [s],
        init: function (e) {
            var t = [];
            this._addLocale(e, t), this._addLocale(navigator.language, t), this._addLocale(s, t);
            var n = t.filter(function (e) {
                return !c[e]
            }),
                o = n.map(function (e) {
                    return Wa.ajaxGet(u(e))
                });
            return a.all(o).bind(this).then(function (e) {
                n.forEach(function (t, n) {
                    c[t] = JSON.parse(e[n].response)
                }), this._locales = t;
                var o = _.first(this._locales).replace("_", "-").toLowerCase();
                return r.Collator = window.Intl.Collator(o, {
                    sensitivity: "base"
                }), moment.locale(_.first(this._locales)), i.localeChange(), Wa.debug("Locale Updated: " + this._locales.join(":")), this._locales
            })["catch"](function () {
                Wa.debug("Failed to fetch locales", "red", t)
            })
        },
        _addLocale: function (e, t) {
            if (e) {
                var n = e.replace("-", "_").toLowerCase(),
                    r = t.indexOf(n);
                0 > r && this.isLocaleSupported(e) && t.push(n);
                var o = n.split("_");
                if (!(o.length < 0)) {
                    var a = _.first(o),
                        i = t.indexOf(a);
                    0 > i && this.isLocaleSupported(a) && t.push(a)
                }
            }
        },
        isLocaleSupported: function (e) {
            try {
                return !!e && Intl.Collator.supportedLocalesOf([e]).length && !! l[e.replace("-", "_").toLowerCase()]
            } catch (t) {
                return !1
            }
        },
        lng: function () {
            return _.first(this._locales)
        },
        hasT: function (e, t) {
            for (var n, r, o = t && t._plural ? t._plural : void 0, a = 0; a < this._locales.length; a++) if (n = e + this.getPluralExt(this._locales[a], o), r = c[this._locales[a]], r[n]) return !0;
            return !1
        },
        t: function (e, t) {
            for (var n, r, o = "", a = t && t._plural ? t._plural : void 0, i = 0; i < this._locales.length; i++) if (n = e + this.getPluralExt(this._locales[i], a), r = c[this._locales[i]], r[n]) {
                o = r[n];
                break
            }
            for (n in t) {
                if (!t.hasOwnProperty(n)) return;
                o = o.replace("__" + n + "__", t[n])
            }
            return o
        },
        getPluralExt: function (e, t) {
            if (!t) return "";
            var n = o.rules[e];
            if (!n) return "";
            var r = n.plurals(t);
            return r ? 1 == r ? "_plural" : "_plural_" + t : ""
        }
    }
}, function (e, t, n) {
    var r = n(34),
        o = n(35),
        a = n(36),
        i = n(37),
        s = n(38),
        c = n(39),
        u = n(40),
        l = n(26),
        d = n(41),
        p = n(42),
        h = n(30),
        g = n(43),
        f = (n(44), n(45)),
        m = (n(31), n(46)),
        b = n(47),
        y = n(48),
        A = n(2),
        E = React.createClass({
            displayName: "App",
            mixins: [m, b, y],
            getInitialState: function () {
                return {
                    mode: g.mode,
                    anotherSession: !1
                }
            },
            componentWillMount: function () {
                if (Wa.browserCapabilityCheck()) {
                    this.addObserver(g, "change:mode", this.onModeChange);
                    var e = this;
                    this.regCmd("locale_change", function () {
                        e.forceUpdate()
                    }), this.init(0)
                } else Wa.debug(JSON.stringify(l.BROWSER_CAPABILITY)), Wa.uploadLogs("missing-browser-capability")
            },
            onModeChange: function () {
                this.setState({
                    mode: g.mode
                })
            },
            cleanupMutex: function () {
                A.removeMutex()
            },
            init: function (e) {
                var t = this;
                if (e += 1, e > 3) return void this.setState({
                    anotherSession: !0
                });
                var n = A.getNoTakeover();
                A.setNoTakeover(), this.checkForOtherLocalSession().then(function (r) {
                    r ? (A.maybeMigrate(), h.launch(!n), A.setMutex(Math.random()), t.regNativeListener(window, "storage", t.storagePong), t.regNativeListener(window, "unload", t.cleanupMutex), t.setState({
                        anotherSession: !1
                    })) : n ? t.setState({
                        anotherSession: !0
                    }) : t.takeoverLocal(e)
                })
            },
            checkForOtherLocalSession: function () {
                if (A.getMutex()) {
                    var e = f.waitForEvent(window, "storage").timeout(1e3)["return"](!1)["catch"](Promise.TimeoutError, function () {
                        return !0
                    });
                    return A.setMutex(Math.random()), e
                }
                return Promise.resolve(!0)
            },
            storagePong: function (e) {
                if (e.key === l.WHATSAPP_MUTEX) {
                    var t = e.newValue;
                    try {
                        t = JSON.parse(t)
                    } catch (n) {}
                    t === l.LOCAL_TAKEOVER ? (this.unregNativeListener(window, "storage", this.storagePong), this.unregNativeListener(window, "unload", this.cleanupMutex), h.exitLoop(), A.localTakeoverSuccess(), this.setState({
                        anotherSession: !0
                    })) : A.setMutex(Math.random())
                }
            },
            takeoverLocal: function (e) {
                if (A.compareVersion() < 0) return Wa.debug("stale client: " + A._version() + " ls: " + A._getLSVersion()), document.location.reload(!0);
                if (A.getMutex()) {
                    var t = this;
                    f.waitForEvent(window, "storage", _.matches({
                        key: l.LOCAL_TAKEOVER_OK
                    })).timeout(1e3).then(function (n) {
                        if (n.key === l.LOCAL_TAKEOVER_OK) {
                            if (!A.getRememberMe()) {
                                var r = n.newValue;
                                try {
                                    r = JSON.parse(r), A._setAllKeyValues(r)
                                } catch (o) {
                                    Wa.debug("error transferring state in takeover:" + o)
                                }
                            }
                            A.removeMutex(), t.init(e)
                        }
                    })["catch"](Promise.TimeoutError, function () {
                        t.init(e)
                    }), A.setMutex(l.LOCAL_TAKEOVER)
                } else this.init(e)
            },
            render: function () {
                var e;
                if (Wa.browserCapabilityCheck()) if (this.state.anotherSession) {
                    var t = this,
                        n = function () {
                            t.takeoverLocal(0)
                        };
                    e = React.createElement(s, {
                        body: l10n.t("whatsapp_web_is_open_in_another_window"),
                        cancelLabel: l10n.t("web_close"),
                        onCancel: window.open.bind(window, "http://www.whatsapp.com/", "_self"),
                        defaultLabel: l10n.t("button_use_here"),
                        onDefault: n
                    })
                } else switch (window.dispatchEvent(new Event("appexit")), this.state.mode) {
                case g.MODE.QR:
                    e = React.createElement(r, null);
                    break;
                case g.MODE.SYNCING:
                    e = React.createElement(o, null);
                    break;
                case g.MODE.OFFLINE:
                    e = React.createElement(a, null);
                    break;
                case g.MODE.CONFLICT:
                    e = React.createElement(i, null);
                    break;
                case g.MODE.MAIN:
                    e = [React.createElement(d, {
                        key: "modal-manager"
                    }), React.createElement(p, {
                        key: "context-menu-manager"
                    }), React.createElement(c, {
                        key: "main",
                        conn: Store.Conn.get(1)
                    })], window.dispatchEvent(new Event("appenter"));
                    break;
                default:
                    Wa.debug("Error invalid App state", this.state.mode)
                } else {
                    var l = function () {
                            window.open("http://www.google.com/chrome/")
                        };
                    e = React.createElement(s, {
                        body: l10n.t("only_works_in_google_chrome"),
                        tip: l10n.t("more_browsers_coming_soon"),
                        defaultLabel: l10n.t("download_google_chrome"),
                        onDefault: l
                    })
                }
                return React.createElement("div", {
                    className: "app-wrapper"
                }, React.createElement(u, null), e)
            }
        });
    e.exports = E
}, function (e, t, n) {
    var r = n(49);
    ["webkitGetUserMedia"].forEach(function (e) {
        var t = Object.getPrototypeOf(navigator)[e];
        _.isFunction(t) && navigator[e] !== t && (navigator[e] = t)
    }), window.URL = window.URL || window.webkitURL, window.AudioContext = window.AudioContext || window.webkitAudioContext, navigator.getUserMedia = navigator.getUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia, window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
    var o = {
        BROWSER_CAPABILITY: {
            intl: window.Intl ? !0 : !1,
            localstorage: window.localStorage ? !0 : !1,
            sessionstorage: window.sessionStorage ? !0 : !1,
            websocket: window.WebSocket ? !0 : !1,
            worker: window.Worker ? !0 : !1,
            url: window.URL ? !0 : !1,
            audiocontext: window.AudioContext ? !0 : !1,
            geolocation: navigator.geolocation ? !0 : !1,
            getusermedia: navigator.getUserMedia ? !0 : !1,
            crypto: window.crypto ? !0 : !1
        },
        BROWSER_TYPE: {
            CHROME: "chrome",
            CHROMIUM: "chromium",
            FIREFOX: "firefox",
            SAFARI: "safari",
            IE: "ie",
            OPERA: "OPERA"
        },
        OS_TYPE: {
            WINDOWS: "windows",
            MAC: "mac os",
            CHROMEOS: "chromium os"
        },
        LATEST_HASH: "e4fd3bca59ee5d2f0c44c03963ce8694378e5d74",
        VERSION: {
            p: 0,
            s: 1,
            t: 3260
        },
        SOCKETS: r.SOCKETS,
        PP_URL: r.PP_URL,
        LOGOUT_URL: r.LOGOUT_URL,
        WS_FAIL_URL: r.WS_FAIL_URL,
        UPLOAD_TO_CLB: r.UPLOAD_TO_CLB,
        CLB_URL: "https://web-crashlog.whatsapp.net/upload.php",
        DIAGNOSTIC_DELAY: r.DIAGNOSTIC_DELAY,
        FLAVOR_TAGS: r.FLAVOR_TAGS,
        PREVIEW_WINDOW: "preview-window",
        UPLOAD_SELECT: "upload-select",
        MSGLIST: "pane-main",
        CURRENT_LOCATION_ICON: "https://maps.gstatic.com/mapfiles/ms2/micons/blue-dot.png",
        CURRENT_LOCATION_SHADOW: "https://maps.gstatic.com/mapfiles/ms2/micons/msmarker.shadow.png",
        GROUP_DEFAULT_ICON: "img/icon-group-default.png",
        USER_DEFAULT_ICON: "img/icon-user-default.png",
        RECORDER_CFG: {
            workerPath: "lib/WArecorderWorker.min.js"
        },
        NOTIFICATION_TIMEOUT: 5e3,
        NOTIFICATION_TONE_PATH: "res/notification.mp3",
        IDLE_TIMEOUT: 12e4,
        IDLE_TIMEOUT_WAIT: 78e4,
        PING_INTERVAL: 24e4,
        ACK_TIMEOUT: 8e3,
        RETRY_TIMESTEP: 20500,
        SEND_UNAVAILABLE_WAIT: 15e3,
        SEND_PAUSED_WAIT: 2500,
        CLEAR_CHAT_DIRTY_WAIT: 2500,
        MAX_RETRY_GENERATION: 4,
        GIVE_UP_WAIT: 12e4,
        LOG_UPLOAD_INTERVAL: 6e4,
        MAX_GROUP_SIZE: 100,
        MAX_SUBJECT_LENGTH: 25,
        MAX_TXT_MSG_SIZE: 65536,
        NUM_COLORS: 20,
        KEY_CLIENT_TOKEN: "WAToken1",
        KEY_SERVER_TOKEN: "WAToken2",
        KEY_SECRET: "WASecretKey",
        KEY_SECRET_BUNDLE: "WASecretBundle",
        KEY_BROWSER_ID: "WABrowserId",
        KEY_GEOCODER_LOCATION: "WAGeocoderLocation",
        KEY_GROUP_ASSIGNED_COLOR: "WAGroupAssignedColor",
        KEY_GMAPS_OVER_LIMIT: "WAGmapsOverLimit",
        KEY_GLOBAL_MUTE_SOUNDS: "WAGlobalSounds",
        KEY_GLOBAL_MUTE_NOTIFICATIONS: "WAGlobalNotifications",
        COOKIE_REF: "ref",
        COOKIE_TOK: "tok",
        PAGE_SIZE: 50,
        SCROLL_FUDGE: 100,
        MIN_PIC_SIDE: 192,
        MAX_PIC_SIDE: 640,
        PROF_PIC_THUMB_SIDE: 96,
        IMG_MAX_EDGE: 1280,
        MAX_VCARD_PHOTO_SIDE: 64,
        EMOJI_PANEL_HEIGHT: 222,
        GROUP_SET_PIC_CONTEXT: "group",
        GROUP_CREATE_PIC_CONTEXT: "create_group",
        PROFILE_PIC_CONTEXT: "profile",
        PERMISSION_ALLOWED: "granted",
        PERMISSION_DEFAULT: "default",
        PERMISSION_DENIED: "denied",
        PRESENCE_COMPOSING_TIMEOUT: 25e3,
        PRESENCE_RESEND_WAIT: 1e4,
        PTT_CANCEL_AREA: 300,
        PTT_TIME_CHECK: 1,
        PTT_TIME_CANCEL: .75,
        CANCEL_ANIMATION_DURATION: 2700,
        IMAGE_MIMES: "image/gif,image/jpeg,image/jpg,image/png",
        VIDEO_MIMES: "video/mp4,video/webm,video/ogg",
        SEARCH_ANIMATION_DURATION: 150,
        SLIDEDOWN_DURATION: 100,
        CSS_TRANSITION_DURATION: 1,
        EARTH_RADIUS: 6378137,
        LOG_SIZE: 4999,
        LOG_CURSOR: "debugCursor",
        REMEMBER_ME: "remember-me",
        LOGOUT_TOKEN: "logout-token",
        OLD_LOGOUT_CREDS: "old-logout-cred",
        NO_TAKEOVER: "no-takeover",
        WHATSAPP_MUTEX: "whatsapp-mutex",
        WHATSAPP_LS_VERSION: "ver",
        LOCAL_TAKEOVER: "local-takeover",
        LOCAL_TAKEOVER_OK: "local-takeover-ok",
        DEFAULT_STATUSES: ["Available", "Busy", "At school", "At the movies", "At work", "Battery about to die", "Can't talk, WhatsApp only", "In a meeting", "At the gym", "Sleeping", "Urgent calls only"],
        MAX_STATUS_LENGTH: 256,
        QR_EDGE: 240,
        FILE_ERROR_MISSING: "File missing.",
        FILE_ERROR_SIZE: "File size is too large.",
        FILE_ERROR_TYPE: "File type is invalid.",
        FILE_ERROR_MIN_DIM: "File dimensions are too small.",
        GMAPS_OVER_LIMIT_DURATION: 14400,
        ACK_ERROR: -1,
        ACK_PENDING: 0,
        ACK_SERVER: 1,
        ACK_DEVICE: 2,
        ACK_READ: 3,
        ACK_PLAYED: 4,
        TIMESTAMP_FORMAT_24H: "HH:mm",
        TIMESTAMP_WITH_DATE_FORMAT_24H: "HH:mm, l",
        TIMESTAMP_FORMAT_12H: "LT",
        TIMESTAMP_WITH_DATE_FORMAT_12H: "LT, l",
        BATTERY_LOW_THRESHOLD_1: 15,
        BATTERY_LOW_THRESHOLD_2: 5,
        WAM_ROTATE_INVERVAL: 864e5,
        COLLECTION_HAS_SYNCED: "collection_has_synced",
        ONE_BY_ONE_TRANS_GIF: "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
    };
    o.VERSION_STR = o.VERSION.p + "." + o.VERSION.s + "." + o.VERSION.t, e.exports = o
}, function (e, t, n) {
    function r() {
        this.dbName = "wawc", this.db = new a(this.dbName), this.db.version(1).stores({
            logs: "line,log"
        }), this.openDB(), this.deleteLegacyDBs()
    }
    var o = n(26),
        a = n(66),
        i = "WA";
    r.prototype.openDB = function () {
        return this.db.isOpen() && this.db.close(), this.db.open().then(function () {
            Wa.debug("Successfully opened db", "green")
        })["catch"](function (e) {
            Wa.debug("Error opened db", "red", e)
        })
    }, r.prototype.deleteLegacyDBs = function () {
        return a.getDatabaseNames().then(function (e) {
            e.forEach(function (e) {
                e === i && (localStorage.setItem(o.LOG_CURSOR, 0), a["delete"](e))
            })
        })
    }, e.exports = new r
}, function (e, t, n) {
    e.exports = {
        Blocklist: n(52),
        Chat: n(53),
        Cmd: n(54),
        Conn: n(55),
        Contact: n(56),
        GroupMetadata: n(57),
        Msg: n(58),
        Mute: n(59),
        Presence: n(60),
        ProfilePicThumb: n(61),
        RecentEmoji: n(62),
        Status: n(63),
        Stream: n(43),
        Wap: n(29)
    }
}, function (e, t, n) {
    function r(e) {
        return function (t) {
            return "number" == typeof t.status && t.status >= 500 ? t : void e(t)
        }
    }
    var o = n(30),
        a = n(69),
        i = a,
        s = {
            setVersion: function (e) {
                var t = e[0],
                    n = e[1];
                Wa.debug("wap:setVersion " + t + n), 0 === t && 2 === n ? (a.setSubProtocol(1), i = a) : 0 === t && 3 === n ? (a.setSubProtocol(3), i = a) : (Wa.debug("wap:setVersion unknown version, defaulting to 02", "red"), i = a)
            },
            setSharedSecret: function () {
                return i.setSharedSecret.apply(this, arguments)
            },
            handle: function () {
                return i.handle.apply(this, arguments)
            },
            resyncPictures: function (e) {
                return new Promise(function (t, n) {
                    o.sendEphemeral({
                        data: ["query", "resumePic", e],
                        onSend: r(t),
                        onDrop: n
                    })
                })
            },
            sendWamLogs: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            return e.status >= 400 ? (Wa.debug("wam buffer send error"), Wa.debug(e), e) : void t(e)
                        };
                    o.send({
                        data: ["debug", "wam", e],
                        onSend: r,
                        onDrop: n
                    })
                })
            },
            setRememberMe: function (e) {
                return o.sendBasic({
                    data: ["admin", "remember", !! e]
                })
            },
            requestMediaUpload: function (e, t, n) {
                return new Promise(function (a, i) {
                    var s = function (e) {
                            switch (e.status) {
                            case 200:
                                a({
                                    result: "ok",
                                    data: e.url,
                                    size: n
                                });
                                break;
                            case 299:
                                a({
                                    result: "duplicate",
                                    data: e.params,
                                    size: n
                                });
                                break;
                            default:
                                i({
                                    size: n
                                })
                            }
                        };
                    o.send({
                        data: ["action", "upload", e, t, n.toString()],
                        onSend: r(s),
                        onDrop: i
                    })
                })
            },
            contactFindBroadcast: function (e) {
                return new Promise(function (t, n) {
                    o.send({
                        data: ["query", "contact", e],
                        onSend: r(t),
                        onDrop: n
                    })
                })
            },
            commonGroupsFind: function (e) {
                return new Promise(function (t, n) {
                    o.send({
                        data: ["query", "group", "common", e],
                        onSend: t,
                        onDrop: n
                    })
                })
            },
            groupMetadataFind: function (e) {
                return new Promise(function (t, n) {
                    o.sendEphemeral({
                        data: ["query", "GroupMetadata", e],
                        onSend: r(t),
                        onDrop: n
                    })
                })
            },
            groupMetadataFindFromPhone: function () {
                return i.groupMetadataFindFromPhone.apply(this, arguments)
            },
            lastseenFind: function (e) {
                return new Promise(function (t, n) {
                    o.sendEphemeral({
                        data: ["query", "Presence", "lastseen", e],
                        onSend: r(t),
                        onDrop: n
                    })
                })
            },
            profilePicFind: function (e, t) {
                return "ProfilePicThumb" === e ? new Promise(function (n, a) {
                    o.sendEphemeral({
                        data: ["query", e, t],
                        onSend: r(n),
                        onDrop: a
                    })
                }) : void 0
            },
            profilePicFindThumbFromPhone: function () {
                return i.profilePicFindThumbFromPhone.apply(this, arguments)
            },
            statusFind: function (e) {
                return new Promise(function (t, n) {
                    o.sendEphemeral({
                        data: ["query", "Status", e],
                        onSend: r(t),
                        onDrop: n
                    })
                })
            },
            sendPing: function () {
                return new Promise(function (e, t) {
                    o.send({
                        data: ["admin", "test"],
                        onSend: r(e),
                        onDrop: t
                    })
                })
            },
            requestDeviceUploadLogs: function () {
                return i.requestDeviceUploadLogs.apply(this, arguments)
            },
            resyncMessages: function () {
                return i.resyncMessages.apply(this, arguments)
            },
            resyncReceipts: function () {
                return i.resyncReceipts.apply(this, arguments)
            },
            addParticipant: function () {
                return i.addParticipant.apply(this, arguments)
            },
            changeSubject: function () {
                return i.changeSubject.apply(this, arguments)
            },
            createGroup: function () {
                return i.createGroup.apply(this, arguments)
            },
            leaveGroup: function () {
                return i.leaveGroup.apply(this, arguments)
            },
            removeParticipant: function () {
                return i.removeParticipant.apply(this, arguments)
            },
            requestMediaReupload: function () {
                return i.requestMediaReupload.apply(this, arguments)
            },
            sendConversationSeen: function () {
                return i.sendConversationSeen.apply(this, arguments)
            },
            sendConversationDelete: function () {
                return i.sendConversationDelete.apply(this, arguments)
            },
            sendConversationArchive: function () {
                return i.sendConversationArchive.apply(this, arguments)
            },
            sendConversationMute: function () {
                return i.sendConversationMute.apply(this, arguments)
            },
            sendMessagePlayed: function () {
                return i.sendMessagePlayed.apply(this, arguments)
            },
            sendPresenceAvailable: function () {
                return i.sendPresenceUpdate("available")
            },
            sendPresenceUnavailable: function () {
                return i.sendPresenceUpdate("unavailable")
            },
            sendChatstateComposing: function (e) {
                return i.sendChatstateUpdate("composing", e)
            },
            sendChatstatePaused: function (e) {
                return i.sendChatstateUpdate("paused", e)
            },
            sendChatstateRecording: function (e) {
                return i.sendChatstateUpdate("recording", e)
            },
            sendSetPicture: function () {
                return i.sendSetPicture.apply(this, arguments)
            },
            deletePicture: function () {
                return i.deletePicture.apply(this, arguments)
            },
            sendSetStatus: function () {
                return i.sendSetStatus.apply(this, arguments)
            },
            chatFindQuery: function () {
                return i.chatFindQuery.apply(this, arguments)
            },
            contactFindQuery: function () {
                return i.contactFindQuery.apply(this, arguments)
            },
            msgCreateRecord: function () {
                return i.msgCreateRecord.apply(this, arguments)
            },
            msgFindQuery: function () {
                return i.msgFindQuery.apply(this, arguments)
            },
            presenceSubscribe: function () {
                return i.presenceSubscribe.apply(this, arguments)
            },
            logoutToken: function () {
                return i.logoutToken.apply(this, arguments)
            }
        };
    e.exports = s
}, function (e, t, n) {
    function r(e) {
        return e instanceof f
    }
    function o(e) {
        var t, n, r = e.data;
        if (r instanceof ArrayBuffer) {
            for (var o, a = [], i = f.wrap(r); 44 !== (o = i.readByte());) a.push(o);
            t = String.fromCharCode.apply(String, a), n = i
        } else {
            var s = r.indexOf(",");
            t = r.slice(0, s), n = r.slice(s + 1), n = n ? JSON.parse(n) : n
        }
        return {
            tag: t,
            data: n
        }
    }
    function a(e) {
        var t = s.getOldLogoutCreds();
        s.setOldLogoutCreds(_.filter(t, _.negate(_.matches(e))))
    }
    var i = n(102),
        s = (n(26), n(2)),
        c = n(31),
        u = n(103),
        l = n(71),
        d = n(72),
        p = n(45),
        h = n(33),
        g = n(73),
        f = n(74),
        m = {
            OPENING: "OPENING",
            PAIRING: "PAIRING",
            UNPAIRED: "UNPAIRED",
            UNPAIRED_IDLE: "UNPAIRED_IDLE",
            CONNECTED: "CONNECTED",
            TIMEOUT: "TIMEOUT",
            CONFLICT: "CONFLICT",
            UNLAUNCHED: "UNLAUNCHED"
        },
        b = {
            DISCONNECTED: "DISCONNECTED",
            SYNCING: "SYNCING",
            RESUMING: "RESUMING",
            CONNECTED: "CONNECTED"
        },
        y = {
            NEW: "new",
            SENT: "sent",
            WEBDACKED: "webdacked",
            WILL_RETRY: "will_retry"
        },
        A = h.defineAll(["SendCalledWhileDisconnected", "ExternalPoke", "MustExitLoop", "Denied401Failed", "Denied409Conflict", "DeniedUnknown", "ForcedRefresh", "TooManyRefRequest", "UILogout", "WindowOffline", "PhoneFailedPing", "AssertionFailed", "TakeoverRequested", "PhoneReplacedClient", "NoSecretBundle", "PhoneKickedClient"]),
        E = {
            SYNC_INFO: ["Conn", g.OBJECT],
            CHALLENGE: ["Cmd",
            {
                type: "challenge",
                challenge: g.STRING
            }],
            DISCONNECT: ["Cmd",
            {
                type: "disconnect",
                kind: _
            }],
            HARD_REFRESH: ["Cmd",
            {
                type: "refresh"
            }],
            PONG: ["Pong", g.BOOLEAN]
        },
        v = {
            TAG: function (e) {
                return new g({
                    tag: e,
                    data: g.ANY
                })
            },
            SYNC_INFO: new g({
                tag: g.ANY,
                data: E.SYNC_INFO
            }),
            CHALLENGE: new g({
                tag: g.ANY,
                data: E.CHALLENGE
            }),
            DISCONNECT: new g({
                tag: g.ANY,
                data: E.DISCONNECT
            }),
            HARD_REFRESH: new g({
                tag: g.ANY,
                data: E.HARD_REFRESH
            }),
            PONG: new g({
                tag: g.ANY,
                data: E.PONG
            })
        },
        N = new g({
            status: function (e) {
                return "number" == typeof e && e >= 500
            },
            _: _
        }),
        C = 5,
        S = 6e4,
        R = 5,
        w = 500,
        T = 3e3,
        F = 3e3,
        D = 864e5,
        B = 100,
        I = 40,
        P = "server_ping",
        k = 8e3,
        O = 16e3,
        M = i.extend({
            extraProperties: "reject",
            props: {
                data: "any",
                tag: "string",
                state: {
                    type: "string",
                    values: _.values(y),
                    "default": y.NEW
                },
                ephemeral: "boolean",
                ignore: "boolean",
                onSend: "function",
                onDrop: "function",
                age: {
                    type: "number",
                    "default": 0
                },
                resends: {
                    type: "number",
                    "default": 0
                },
                resendTimer: {
                    type: "number",
                    "default": 0
                },
                binaryOpts: "object"
            },
            derived: {
                likelyDead: {
                    deps: ["age"],
                    fn: function () {
                        return this.age >= I
                    }
                },
                isToPhone: {
                    deps: ["data"],
                    fn: function () {
                        return this.data instanceof ArrayBuffer
                    }
                }
            },
            getTag: function () {
                return this.tag || (this.onSend ? this.onSend.tag : void 0)
            },
            toString: function () {
                return this.binaryOpts ? this.binaryOpts.debugString : !_.isArray(this.data) || "query" !== this.data[0] && "action" !== this.data[0] ? _.isArray(this.data) ? "[" + this.data[0] + (this.data.length > 1 ? ", ...]" : "]") : _.isObject(this.data) ? "{...}" : this.data + "" : "[" + this.data[0] + ", " + this.data[1] + (this.data.length > 2 ? ", ...]" : "]")
            },
            serialize: function () {
                var e = this.tag;
                if (this.binaryOpts) {
                    var t = this.binaryOpts,
                        n = f.calculateUTF8Bytes(e) + 3,
                        r = new f(n, !1),
                        o = t.metric ? t.metric : 0,
                        a = (this.ignore ? 0 : 1) << 7 | (!this.ignore && t.ackRequest ? 1 : 0) << 6 | (t.available === !0 ? 1 : 0) << 5 | (t.available === !1 ? 1 : 0) << 4 | (t.skipOffline ? 1 : 0) << 2;
                    return r.writeString(e), r.writeString(","), r.writeByte(o), r.writeByte(a), r.reset(), f.concat([r, this.data]).toBuffer()
                }
                var i = _.isString(this.data) ? this.data : JSON.stringify(this.data);
                return e + ",," + i
            }
        }),
        L = i.extend({
            extraProperties: "reject",
            session: {
                socket: "object",
                socketSequence: {
                    type: "number",
                    "default": 0
                },
                socketStart: "number",
                launchGeneration: {
                    type: "number",
                    "default": 0
                },
                backoffGeneration: {
                    type: "number",
                    "default": 0
                },
                online: {
                    type: "boolean",
                    "default": !0
                },
                hasSynced: "boolean",
                state: {
                    type: "string",
                    values: _.keys(m),
                    "default": m.UNLAUNCHED
                },
                stream: {
                    type: "string",
                    values: _.keys(b),
                    "default": b.DISCONNECTED
                },
                canSend: "boolean",
                sendQueue: "array",
                sendHash: "object",
                sequence: {
                    type: "number",
                    "default": 0
                },
                shortTagBase: "string",
                socketWatcher: "object",
                refWatcher: "object",
                phoneWatchdog: "object",
                pendingPhoneReqs: {
                    type: "number",
                    "default": 0
                },
                isIncognito: "boolean",
                runPromise: "object",
                streamPromise: "object",
                logoutMutex: {
                    type: "number",
                    "default": 0
                },
                retryTimestamp: "number",
                pokeablePromise: "object",
                conflictPromise: "object",
                mustExitLoop: "boolean",
                syncTag: "string",
                lastPhoneMessage: "number"
            },
            initialize: function () {
                this.sendQueue = [], this.sendHash = {}, this.phoneWatchdog = new d({
                    waitAlgorithm: d.FIBONACCI(T, F, D),
                    onTimeout: this.phoneTimedOut.bind(this),
                    onActivated: this.onPhoneWatchdogActivated.bind(this),
                    onFed: this.onPhoneWatchdogFed.bind(this),
                    onDeactivated: this.onPhoneWatchdogDeactivated.bind(this)
                }), this.listenTo(this, "change:state", this.onStateChange.bind(this)), this.listenTo(this, "change:stream", this.onStreamChange.bind(this)), Promise.delay(0).then(p.determineIncognito).bind(this).then(function (e) {
                    this.isIncognito = e
                })
            },
            STATE: m,
            STREAM: b,
            send: function (e) {
                var t = new M(e);
                this.sendQueue.push(t), this.flushQueue()
            },
            shortTag: function () {
                this.shortTagBase || (this.shortTagBase = (moment().unix() % 1e3).toString());
                var e = Wa.CONST.FLAVOR_TAGS ? "w" : "-.-";
                return this.shortTagBase + e + this.sequence++
            },
            tag: function (e) {
                var t = Wa.CONST.FLAVOR_TAGS ? "w" : "-.-",
                    n = moment().unix() + t + this.sequence++;
                return e && Wa.CONST.FLAVOR_TAGS ? n + "-" + e : n
            },
            launch: function (e, t) {
                function n() {
                    Wa.debug("socket loop closed"), this.clearState(), this.state = m.UNLAUNCHED, this.mustExitLoop = !1
                }
                Wa.debug("Launch gen" + this.launchGeneration + " (backoff gen" + this.backoffGeneration + ")"), t = t || 0;
                var r = Date.now() + 300 * Wa.expBackoff(this.backoffGeneration, 100),
                    o = r + S;
                this.mustExitLoop ? n.call(this) : this.run(t, e).then(function (e) {
                    return [e, !1]
                }).bind(this)["catch"](A.MustExitLoop, function () {
                    return this.mustExitLoop = !0, [!1, !1]
                })["catch"](A.TakeoverRequested, function () {
                    return [!1, !0]
                })["catch"](function (e) {
                    return Wa.debug("run error unknown!", "red", e), Wa.debug(e.stack, "red", void 0, !0), Wa.uploadLogs("unknown-error-in-ws-loop"), this.clearState(), [!0, !1]
                }).spread(function (e, t) {
                    if (this.mustExitLoop) n.call(this);
                    else {
                        var a = Date.now();
                        this.launchGeneration++, this.backoffGeneration = e && o > a ? this.backoffGeneration + 1 : 0, this.launch(t, r > a ? r - a : 0)
                    }
                })
            },
            poke: function () {
                this.pokeablePromise ? this.pokeablePromise.cancel(new A.ExternalPoke) : this.phoneWatchdog.forceTimeout()
            },
            takeover: function () {
                if (!this.conflictPromise) throw "Takeover called without conflict!";
                this.conflictPromise.cancel(new A.TakeoverRequested)
            },
            exitLoop: function () {
                this.mustExitLoop = !0, this.runPromise && this.runPromise.cancel(new A.MustExitLoop)
            },
            logoutForcePost: function () {
                this.socket && this.socket.close(), this.sendCurrentLogout(), this.clearCredentials()
            },
            logout: function () {
                Wa.debug("user logged out", "red"), this.runPromise && this.runPromise.cancel(new A.UILogout), this.stream !== b.DISCONNECTED ? this.sendCurrentLogout(this.socket) : this.sendCurrentLogout(), this.clearCredentials(), this.state === m.OPENING && this.trigger("change:state")
            },
            summary: function () {
                Wa.debug("ws:summary --------------------------------"), Wa.debug("ws state           " + this.state), Wa.debug("wd online:         " + navigator.onLine), Wa.debug("ws socket id:      " + (this.socket ? this.socket.id : "n/a")), Wa.debug("ws queue:"), _.isEmpty(this.sendQueue) || u.printArray(_.map(this.sendQueue, function (e) {
                    var t = _.pick(e, "tag", "state", "age", "ephemeral", "isToPhone");
                    return t.debug = e.toString(), t
                })).split(/\n/).forEach(function (e) {
                    Wa.debug(e)
                }), Wa.debug("ws hash:"), _.isEmpty(this.sendHash) || u.printArray(_.map(this.sendHash, function (e) {
                    var t = _.pick(e, "tag", "state", "age", "ephemeral", "isToPhone");
                    return t.debug = e.toString(), t
                })).split(/\n/).forEach(function (e) {
                    Wa.debug(e)
                })
            },
            onStateChange: function () {
                Wa.debug("ws2:state change: " + this.state)
            },
            onStreamChange: function () {
                Wa.debug("ws2:stream change: " + this.stream), this.stream === b.DISCONNECTED && this.onRefCycle()
            },
            onRefCycle: function () {
                Wa.debug("Ref Cycle"), this.sendQueue.forEach(function (e) {
                    e.state = y.NEW, e.age = 0
                }), this.clearSendHash()
            },
            onActivity: function (e) {
                if (e) {
                    var t = e.data;
                    if (v.HARD_REFRESH.test(e)) Wa.debug("hard refresh!", "red"), Wa.hardRefresh();
                    else if (t) {
                        var n = _.isArray(t) ? " [" + t[0] + ", ...]" : "";
                        Wa.debug("    recv: " + e.tag + n, "green", t)
                    } else Wa.debug("     ack: " + e.tag, "#669999")
                }
                this.sendRemainingLogouts()
            },
            onPhoneWatchdogActivated: function () {},
            onPhoneWatchdogFed: function () {
                this.state = m.CONNECTED
            },
            onPhoneWatchdogDeactivated: function () {},
            flushQueue: function () {
                if (this.canSend && this.sendQueue.length) {
                    var e = _.where(this.sendQueue, {
                        state: y.NEW
                    });
                    e.length && e.forEach(this._send.bind(this))
                }
            },
            phoneTimedOut: function () {
                if (1 === this.phoneWatchdog.failGeneration) {
                    Wa.debug("Phone timed out", "orange");
                    var e = _.map(this.sendHash, function (e) {
                        return e.tag
                    });
                    Wa.debug("Outstanding Reqs: " + e.join(","), "orange")
                }
                var t = this.phoneWatchdog.waitAlgorithm(this.phoneWatchdog);
                return this.set({
                    state: m.TIMEOUT,
                    retryTimestamp: Date.now() + t
                }), this.state = m.TIMEOUT, this._basicSend({
                    tag: this.tag("ping"),
                    data: ["admin", "test"]
                }), !0
            },
            clearSendHash: function (e) {
                e ? _.each(this.sendHash, function (e) {
                    e.resendTimer && clearTimeout(e.resendTimer), e.onDrop(new h.LogoutDrop(e.toString()))
                }) : _.filter(this.sendHash, "ephemeral").forEach(function (e) {
                    e.resendTimer && clearTimeout(e.resendTimer), e.onDrop(new h.EphemeralDrop(e.toString()))
                }), this.sendHash = {}, this.pendingPhoneReqs = 0, this.phoneWatchdog.deactivate()
            },
            _basicSend: function (e) {
                Wa.debug("low-send: " + e.tag, "blue", e.data), this.socket.cast(e.tag + "," + JSON.stringify(e.data))
            },
            _send: function (e) {
                e.tag = e.getTag() || this.shortTag(), this.sendHash[e.tag] = e, this.socket.send(e.serialize());
                var t = e.binaryOpts ? e.binaryOpts.debugObj : e.data;
                Wa.debug("    send: " + e.tag + ", " + e.toString(), "blue", t), e.isToPhone && (this.pendingPhoneReqs++, this.phoneWatchdog.activate()), e.state = y.SENT
            },
            sendBasic: function (e) {
                return this.socket ? (e.tag = this.tag(), this._basicSend(e), this.socket.nextMessage(v.TAG(e.tag))) : Promise.reject("socket not open")
            },
            sendEphemeral: function (e) {
                e.ephemeral = !0;
                var t = new M(e);
                this.canSend ? this._send(t) : t.onDrop(new h.EphemeralDrop(t.toString()))
            },
            sendEphemeralIgnore: function (e) {
                e.ephemeral = !0, e.ignore = !0, e.tag = this.tag();
                var t = new M(e);
                if (this.canSend) {
                    var n = t.serialize();
                    this.socket.send(n), Wa.debug("sending: " + t.tag + ", " + t.toString(), "blue", t.data)
                } else t.onDrop(new h.EphemeralDrop(t.toString()))
            },
            onMessage: function (e) {
                var t = e.tag,
                    n = e.data;
                if (r(n) && (this.lastPhoneMessage = moment().unix()), v.PONG.test(e)) if (n[1]) {
                    var o = 0,
                        a = !1;
                    _.each(this.sendHash, function (e) {
                        var t = e.likelyDead;
                        e.age++, e.likelyDead && !t ? (a = !0, Wa.debug(e.tag + " likely dead: " + e.toString(), "red", e)) : e.likelyDead || o++
                    }), this.pendingPhoneReqs = o, this.phoneWatchdog.feed(), 0 === o && this.phoneWatchdog.deactivate(), a && Wa.uploadLogs("error-2412")
                } else this.runPromise.cancel(new A.PhoneFailedPing);
                else {
                    var i = this.sendHash[t];
                    if (i) {
                        if (!n) return void(i.state = y.WEBDACKED);
                        var s;
                        try {
                            s = i.onSend(n)
                        } catch (c) {
                            if (c instanceof h.E401) return void this.logout();
                            Wa.debug("Error during response processing", "red", c), i.onDrop(c)
                        }
                        N.test(s) ? (Wa.debug("5xx Error! " + i.tag, "red", s), i.resends >= C ? (Wa.debug("Dropping " + i.tag, "red"), i.onDrop(new h.Server5xxDrop)) : this.resendRequestEventually(i)) : (delete this.sendHash[t], this.sendQueue = _.without(this.sendQueue, i), i.isToPhone && (i.likelyDead || this.pendingPhoneReqs--, this.phoneWatchdog.feed(), 0 === this.pendingPhoneReqs && this.phoneWatchdog.deactivate()))
                    } else if (n) {
                        var u;
                        if (f.isByteBuffer(n)) u = Store.Wap;
                        else {
                            var l = _.isFunction(n.shift) ? n.shift() : n;
                            u = Store[l]
                        }
                        u ? u.handle(n, this, t) : Wa.debug("Invalid type received", "red", n), r(n) && this.phoneWatchdog.feed()
                    }
                }
            },
            run: function (e, t) {
                return this.state = m.OPENING, this.runPromise = Promise.resolve(e).bind(this).cancellable().then(function (e) {
                    if (e > 0) {
                        Wa.debug("Run Backoff " + e + "ms");
                        var t = Promise.delay(e).cancellable()["catch"](A.ExternalPoke, _.noop);
                        return this.set({
                            state: m.OPENING,
                            pokeablePromise: t,
                            retryTimestamp: Date.now() + e
                        }), t
                    }
                })["finally"](function () {
                    this.unset("pokeablePromise"), this.unset("retryTimestamp")
                }).then(function () {
                    return Wa.debug("Running"), this.state = m.OPENING, this.openSocket()
                }).then(function () {
                    this.shortTagBase = (moment().unix() % 1e3).toString();
                    var e = "undefined" == typeof this.isIncognito ? p.waitForBBEvent(this, "change:isIncognito") : Promise.resolve();
                    if (this.state = m.PAIRING, Wa.knowsPhone()) {
                        var n, r;
                        return e.bind(this).then(function () {
                            return r = this.initConn(), n = this.pokeableLoop(this.requestSync.bind(this, t)), Promise.all([r, n])
                        })["finally"](function () {
                            r && r.cancel(), n && n.cancel()
                        })
                    }
                    return e.bind(this).then(this.initConn).then(function () {
                        this.set({
                            state: m.UNPAIRED,
                            refWatcher: p.attachWatcher(this.runPromise, this.manageRef())
                        })
                    })
                }).then(this.waitForSyncInfo)["finally"](function () {
                    this.refWatcher && (this.refWatcher.cancel(), this.unset("refWatcher"))
                }).then(function (e) {
                    Wa.debug("completed " + (this.hasSynced ? "re-auth" : "auth")), e.initial = !0, Store.Conn.handle([e]);
                    var t = this.openStream();
                    return this.set({
                        state: m.CONNECTED,
                        streamPromise: t
                    }), t
                }).then(function () {
                    return new Promise(_.noop)
                })["catch"](function (e) {
                    Wa.debug("run loop interrupt: " + e, "orange", e), this.set({
                        canSend: !1,
                        stream: b.DISCONNECTED,
                        runPromise: null
                    }), this.phoneWatchdog.deactivate(), this.streamPromise && (this.streamPromise.cancel(), this.unset("streamPromise"));
                    var t = this.socket;
                    return t && "closed" !== t.state && (t.detachCallbacks(), t.close()), this.unset("socket"), this.socketWatcher && (this.socketWatcher.cancel(), this.unset("socketWatcher")), Promise.reject(e)
                })["catch"](h.E401, A.PhoneFailedPing, function () {
                    return !1
                })["catch"](A.ForcedRefresh, function () {
                    return this.clearState(), !1
                })["catch"](l.SocketClosed, l.SocketError, function () {
                    return !0
                })["catch"](A.Denied401Failed, A.DeniedUnknown, function (e) {
                    return Wa.debug("phone denied " + e, "red"), this.clearCredentials(), !1
                })["catch"](A.PhoneKickedClient, function () {
                    return Wa.debug("phone kicked"), this.clearCredentials(), !1
                })["catch"](A.NoSecretBundle, function () {
                    return Wa.debug("No secret bundle!", "red"), this.clearCredentials(), Wa.uploadLogs("no-secret-bundle"), !1
                })["catch"](A.TooManyRefRequest, function () {
                    return this.state = m.UNPAIRED_IDLE, this.pokeablePromise = p.waitForOfflineNaive()["throw"](new A.WindowOffline)["catch"](A.ExternalPoke, _.constant(!1))
                })["catch"](A.Denied409Conflict, A.PhoneReplacedClient, function (e) {
                    Wa.debug(e instanceof A.Denied409Conflict ? "phone denied (conflict)" : "phone replaced"), this.clearState();
                    var t = p.waitForOfflineNaive()["throw"](new A.WindowOffline);
                    return this.set({
                        state: m.CONFLICT,
                        conflictPromise: t,
                        runPromise: t
                    }), t
                })["finally"](function () {
                    this.conflictPromise && this.conflictPromise.cancel()
                })["catch"](A.UILogout, A.WindowOffline, function () {
                    return !1
                })
            },
            openSocket: function () {
                return this._openSocketLoop().bind(this)["catch"](A.WindowOffline, function () {
                    if (this.online = !1, navigator.onLine) {
                        Wa.debug("computer offline. begin polling...");
                        var e = this;
                        return p.loopOnError(A.WindowOffline, function (t) {
                            var n;
                            return n = 5 > t ? [Promise.delay(2e3)] : [p.waitForSkip(), p.waitForBBEvent(Store.Stream, "change:available"), p.waitForOnlineNaive(), Promise.delay(3e5)], Promise.any(n).bind(e)["finally"](function () {
                                n.forEach(function (e) {
                                    e["catch"](Promise.CancellationError, _.noop), e.cancel()
                                })
                            }).then(e._openSocketLoop)
                        }).tap(function () {
                            e.online = !0, Wa.debug("computer online")
                        })
                    }
                    return Wa.debug("computer offline. wait for navigator."), p.waitForOnlineNaive().bind(this).delay(B).then(function () {
                        this.online = !0, Wa.debug("computer online")
                    }).then(this._openSocketLoop)
                }).then(function (e) {
                    e.onactivity = this.onActivity.bind(this), this.socket = e, this.socketWatcher = p.attachWatcher(this.runPromise, this.throwOnClose())
                })
            },
            _openSocketLoop: function () {
                return this.pokeableLoop(l.SocketError, this._openSocket)
            },
            _openSocket: function () {
                "undefined" == typeof this.socketStart && (this.socketStart = Date.now() % Wa.CONST.SOCKETS.length);
                var e = Wa.CONST.SOCKETS,
                    t = e[(this.socketStart + this.socketSequence) % e.length];
                return l.open({
                    id: this.socketSequence++,
                    url: t,
                    pingTime: k,
                    killTime: O,
                    pingString: P + ",,",
                    pongString: P + ",",
                    messageTransform: o
                }).bind(this)["catch"](l.SocketError, function (e) {
                    return p.getResponseIfOnline(Wa.CONST.WS_FAIL_URL + "?t=" + Date.now()).bind(this).then(function (t) {
                        if (!t) throw new A.WindowOffline;
                        var n;
                        try {
                            n = JSON.parse(t.responseText)
                        } catch (r) {
                            n = {
                                type: "bad-parse",
                                data: r + "\n" + t.responseText
                            }
                        }
                        switch (n.type) {
                        case "missing":
                            Wa.debug("Websocket request missing!", "red"), Wa.uploadLogs("websocket-req-missing"), console.log("Error in connecting websocket."), console.log("Websocket request did not make it to server.");
                            break;
                        case "found":
                            Wa.debug("Websocket noncompliant!", "red");
                            var o = JSON.stringify(n.data, void 0, 4);
                            Wa.debug(o, "red", n, !0), Wa.uploadLogs("websocket-req-noncompliant"), console.log("Error in connecting websocket."), console.log(o);
                            break;
                        case "bad-parse":
                            Wa.debug("Health check response not json!", "red", t), Wa.debug(n.data, "red", n), Wa.uploadLogs("websocket-req-badparse")
                        }
                        throw e
                    })
                })
            },
            initConn: function () {
                return new Promise(function (e, t) {
                    var n = Wa.CONST.VERSION,
                        r = this.tag("init"),
                        o = Wa.getBrowserInfo();
                    return this._basicSend({
                        tag: r,
                        data: ["admin", "init", [n.p, n.s, n.t],
                            [o.os, o.name], Wa.getBrowserId(), !this.isIncognito && !! s.getRememberMe()]
                    }), this.socket.nextMessage(v.TAG(r)).get("data")["catch"](t).then(e)
                }.bind(this)).then(function (e) {
                    Store.Stream.handleUpdate(e.update), Store.Conn.handle([{
                        id: 1,
                        ref: e.ref,
                        refTTL: e.ttl
                    }])
                })
            },
            manageRef: function () {
                var e = this;
                return p.loopOnError(h.ShouldLoop, function (t) {
                    var n = Store.Conn.get(1).refExpiry - Date.now() - w;
                    return Promise.delay(Math.max(n, 0)).cancellable().then(function () {
                        if (t >= R) throw new A.TooManyRefRequest;
                        Wa.debug("Requesting Ref Update");
                        var n = e.tag("qr" + t);
                        return e._basicSend({
                            tag: n,
                            data: ["admin", "Conn", "reref"]
                        }), e.socket.nextMessage(v.TAG(n))
                    }).then(function (e) {
                        var t = e.data;
                        switch (t.status) {
                        case 200:
                            throw Wa.debug("Updating Ref"), Store.Conn.handle([{
                                ref: t.ref,
                                refTTL: t.ttl
                            }]), new h.ShouldLoop;
                        case 304:
                            return void Wa.debug("Keeping Ref");
                        case 429:
                            throw Wa.debug("Server denied new ref"), new A.TooManyRefRequest;
                        default:
                            throw Wa.debug("Bad Ref Response!", "red", t), new A.AssertionFailed("unrecognized ref request status (" + t.status + ")")
                        }
                    })
                }).cancellable()
            },
            requestSync: function (e, t) {
                if (0 === t && (this.syncTag = this.tag("sync"), !Wa.loadSavedSecretBundle())) throw new A.NoSecretBundle;
                var n, r, o = this;
                return new Promise(function (t, a) {
                    var i = s.getLoginTokens(),
                        c = ["admin", "login", i.client, i.server, Wa.getBrowserId()];
                    e ? c.push("takeover") : o.hasSynced && (c.push("reconnect"), c.push(Wa.me)), o._basicSend({
                        tag: o.syncTag,
                        data: c
                    }), r = o.lookForAndHandleChallenge()["catch"](Promise.CancellationError, _.noop)["catch"](a), n = o.socket.nextMessage(v.TAG(o.syncTag)).then(t)["catch"](Promise.CancellationError, _.noop)["catch"](a)
                }).cancellable()["finally"](function () {
                    r && r.cancel(), n && n.cancel()
                }).then(function (e) {
                    Wa.debug("login", void 0, e);
                    var t = e.data;
                    switch (t.status) {
                    case 200:
                        return;
                    case 401:
                        throw new A.Denied401Failed;
                    case 405:
                        throw Wa.debug("Already authorized!", "red"), Wa.uploadLogs("already-authorized"), new A.ForcedRefresh;
                    case 409:
                        throw new A.Denied409Conflict;
                    default:
                        throw Wa.debug("unknown error! status: " + t.status, "red", e), new A.DeniedUnknown
                    }
                })
            },
            waitForSyncInfo: function () {
                return this.socket.nextMessage(v.SYNC_INFO).then(function (e) {
                    return e.data[1]
                })
            },
            lookForAndHandleChallenge: function () {
                return this.socket.nextMessage(v.CHALLENGE).bind(this).then(function (e) {
                    Wa.debug("challenged!");
                    var t = CryptoJS.enc.Base64.parse(e.data[1].challenge),
                        n = Wa.getSecurityToken(t),
                        r = s.getLoginTokens(),
                        o = r ? r.server : void 0;
                    if (!o) return Wa.debug("ws2:handleChallenge no server token!", "red", r), Promise.reject(new Error);
                    var a = this.tag("challenge");
                    return this._basicSend({
                        tag: a,
                        data: ["admin", "challenge", n, o, Wa.getBrowserId()]
                    }), this.socket.nextMessage(v.TAG(a))
                }).then(function (e) {
                    return e.data.status >= 400 ? (Wa.debug("ws2:handleChallenge failed challenge!", "red", e.data), Promise.reject(new A.Denied401Failed)) : void Wa.debug("ws2:handleChallenge passed challenge")
                })
            },
            throwOnClose: function () {
                return this.socket.nextMessage(v.DISCONNECT).then(function (e) {
                    var t = e.data[1];
                    throw "replaced" === t.kind ? new A.PhoneReplacedClient : new A.PhoneKickedClient
                })
            },
            openStream: function () {
                this.canSend = !0;
                var e, t;
                return this.hasSynced ? e = Promise.join(this.resyncMessages(), this.resyncReceipts(), _.noop).bind(this).then(function () {
                    this.dump(), this.flushQueue(), this.stream = b.CONNECTED
                })["catch"](Promise.CancellationError, function () {
                    this.stream = b.DISCONNECTED
                })["catch"](function (e) {
                    throw Wa.debug("error during resume, resyncing: " + e, "red", e), Wa.debug(e.stack, "red", void 0, !0), Wa.uploadLogs("error-on-resume"), this.stream = b.DISCONNECTED, new A.ForcedRefresh
                }) : (t = Store.Chat.sync().cancellable().bind(this).then(function () {
                    this.set({
                        hasSynced: !0,
                        stream: b.CONNECTED
                    })
                })["catch"](Promise.CancellationError, _.noop), e = Promise.join(t, Store.Contact.sync(), _.noop).bind(this)["catch"](function (e) {
                    return t.cancel(), this.set({
                        hasSynced: !1,
                        stream: b.DISCONNECTED
                    }), Promise.reject(e)
                })["catch"](Promise.CancellationError, _.noop)), Promise.resolve().cancellable().bind(this).then(function () {
                    return this.stream = this.hasSynced ? b.RESUMING : b.SYNCING, this.socket.onmessage = this.onMessage.bind(this), this.socket.releaseMessages(), e
                })["catch"](Promise.CancellationError, function () {
                    e.cancel()
                })
            },
            resyncMessages: function () {
                return new Promise(function (e, t) {
                    Wa.debug("ws:resyncMessages");
                    var n = Store.Chat.filter(function (e) {
                        return !e.isNewlyCreated()
                    }),
                        r = n.map(function (e) {
                            var t = e.id,
                                n = {
                                    wid: t,
                                    archive: e.archive,
                                    mute: e.mute.expiration,
                                    active: e.active,
                                    isReadOnly: e.isReadOnly,
                                    modifyTag: e.modifyTag,
                                    unreadCount: e.unreadCount
                                },
                                r = Store.Msg.lastReceivedKey[t];
                            if (r) {
                                var o = Wa.splitMsgKey(r);
                                n.id = o.id, n.fromMe = o.fromMe.toString()
                            }
                            return n
                        });
                    c.resyncMessages(r, e, t)
                })
            },
            resyncReceipts: function () {
                return new Promise(function (e, t) {
                    Wa.debug("ws:resyncReceipts");
                    var n = [];
                    for (var r in Store.Msg.lastReceivedReceipt) {
                        var o = Store.Chat.get(r),
                            a = o ? o.getFirstMsgFromMe(r) : void 0;
                        a ? n.push({
                            wid: r,
                            id: Wa.splitMsgKey(a.get("id")).id,
                            t: Store.Msg.lastReceivedReceipt[r]
                        }) : Wa.debug("ws:resyncReceipts wid in lastReceivedReceipt, but no msg: " + r, "red")
                    }
                    return 0 === n.length ? void e() : void c.resyncReceipts(n, e, t)
                })
            },
            pokeableLoop: function () {
                var e = this,
                    t = _.initial(arguments),
                    n = _.last(arguments),
                    r = !1;
                return t.push(Promise.TimeoutError, A.ExternalPoke, function () {
                    var t = r ? e.retryTimestamp - Date.now() : 0;
                    return r = !0, Promise.delay(_.toArray(arguments), t > 0 ? t : 0).bind(e).spread(function (e) {
                        var t = 1e3 * Wa.expBackoff(2 + e, 60),
                            r = n.apply(this, arguments);
                        return this.set({
                            pokeablePromise: r,
                            retryTimestamp: Date.now() + t
                        }), r.timeout(t)
                    })["catch"](A.ExternalPoke, function (e) {
                        throw r = !1, e
                    })
                }), p.loopOnError.apply(p, t)["finally"](function () {
                    e.unset("pokeablePromise"), e.unset("retryTimestamp")
                })
            },
            dump: function () {},
            clearCredentials: function () {
                this.clearState(), s.setBrowserId(), s.clearTokens(), s.clearAllLocalState(), delete Wa.secretBundle, Wa.me = void 0
            },
            clearState: function () {
                this.sendQueue = [], this.clearSendHash(!0), this.unset("hasSynced"), _.each(Store, function (e) {
                    _.isFunction(e["delete"]) && e["delete"]()
                })
            },
            resendRequestEventually: function (e) {
                var t = this,
                    n = 300 * Wa.expBackoff(e.resends, 100);
                Wa.debug("Resending " + e.toString() + " in " + n + "ms");
                var r = _.delay(function () {
                    e.resends++, e.resendTimer = 0, t.sendHash[e.tag] === e && t._send(e)
                }, n);
                e.set({
                    resendTimer: r,
                    state: y.WILL_RETRY
                })
            },
            sendCurrentLogout: function (e) {
                if (Wa.loadSavedSecretBundle()) {
                    var t = {
                        t: s.getLogoutToken(),
                        m: Store.Wap.logoutToken()
                    },
                        n = s.getOldLogoutCreds();
                    n.push(t), s.setOldLogoutCreds(n)
                }
                if (e) {
                    var r = this.logoutMutex;
                    this.logoutMutex = 0 >= r ? r = 1 : ++r, Wa.debug("logout through socket", "blue"), e.partingSend('goodbye,,["admin","Conn","disconnect"]', _.matches("goodbye,")).bind(this).then(function (e) {
                        e ? (Wa.debug("logout through socket success", "green"), a(t)) : Wa.debug("logout through socket failure, will POST", "red")
                    })["finally"](function () {
                        this.logoutMutex === r && (this.logoutMutex = 0)
                    })
                } else this.logoutMutex < 0 && (this.logoutMutex = 0), this.sendRemainingLogouts()
            },
            sendRemainingLogouts: function () {
                var e = this.logoutMutex;
                if (0 === e) {
                    var t = s.getOldLogoutCreds();
                    if (0 === t.length) return void(this.logoutMutex = -1);
                    this.logoutMutex = e = 1, Promise.all(_.map(t, function (e) {
                        return Wa.debug("POST logout", "blue"), Wa.ajaxPost(Wa.CONST.LOGOUT_URL, e).then(function () {
                            a(e)
                        })["catch"](function () {
                            Wa.debug("POST logout failure", "red")
                        })
                    })).bind(this)["finally"](function () {
                        e === this.logoutMutex && (this.logoutMutex = 0)
                    })
                }
            }
        });
    e.exports = new L
}, function (e, t, n) {
    var r = n(100),
        o = n(70),
        a = {
            openChat: function (e) {
                this.closeDrawer(), this.trigger("open_chat", e)
            },
            clearChat: function (e) {
                this.trigger("clear_chat", e)
            },
            focusChatTextInput: function (e) {
                this.trigger("focus_chat_text_input_" + e.id)
            },
            pasteChatTextInput: function (e, t) {
                this.trigger("paste_chat_text_input_" + e.id, t)
            },
            composeHeightChange: function (e, t) {
                this.trigger("compose_height_change", e, t)
            },
            login: function (e) {
                this.trigger("login", e)
            },
            openContextMenu: function (e, t, n) {
                this.trigger("open_context_menu", e, t, n)
            },
            alertNewMsg: function (e) {
                this.trigger("alert_new_msg", e)
            },
            chatDelete: function (e) {
                this.trigger("chat_delete", e)
            },
            chatArchive: function (e) {
                this.trigger("chat_archive", e)
            },
            chatMute: function (e) {
                this.trigger("chat_mute", e)
            },
            globalUnmute: function () {
                this.trigger("global_unmute")
            },
            globalMute: function (e) {
                this.trigger("global_mute", e)
            },
            loadEarlierMsgs: function (e) {
                this.trigger("load_earlier_msgs:" + e.get("id"))
            },
            resyncMessages: function (e, t, n) {
                this.trigger("resync_messages", e, t, n)
            },
            resyncReceipts: function (e, t, n) {
                this.trigger("resync_receipts", e, t, n)
            },
            openModal: function (e, t) {
                this.trigger("open_modal", e, t)
            },
            closeModal: function () {
                this.trigger("close_modal")
            },
            openDrawer: function (e, t, n) {
                this.trigger("open_drawer", e, t, n)
            },
            closeDrawer: function (e) {
                this.trigger("close_drawer", e)
            },
            logLoginEvent: function (e, t, n, r) {
                this.trigger("logLoginEvent", e, t, n, r)
            },
            mediaPlaying: function (e) {
                this.trigger("mediaPlaying", e)
            },
            uiResize: function () {
                this.trigger("resize")
            },
            localeChange: function () {
                this.trigger("locale_change")
            }
        };
    _.extend(a, r, o), e.exports = a
}, function (e, t, n) {
    function r(e) {
        var t = {};
        return e.forEach(function (e) {
            var n = e.split(""),
                r = _.initial(n).join(""),
                o = _.last(n);
            (t[r] || (t[r] = {}))[o] = 1
        }), _.keys(t).forEach(function (e) {
            t[e] = a(_.keys(t[e]))
        }), o(t)
    }
    function o(e) {
        return _.map(_.keys(e).sort(function (e, t) {
            return t.length - e.length
        }), function (t) {
            return t + e[t]
        }).join("|")
    }
    function a(e) {
        if (1 === e.length) return e[0];
        e = e.sort();
        var t = [],
            n = 0;
        start = e[n];
        for (var r = e.length, o = 0; r >= o; o++) {
            var a = e[o];
            if (!a || a.charCodeAt(0) !== start.charCodeAt(0) + (o - n)) {
                var i = e[o - 1];
                t.push(i === start ? i : start + "-" + i), n = o, start = a
            }
        }
        return "[" + t.join("") + "]"
    }
    var i = n(75),
        s = n(76),
        c = n(26),
        u = null,
        l = {},
        d = "□",
        p = {
            "︀": !0,
            "︁": !0,
            "︂": !0,
            "︃": !0,
            "︄": !0,
            "︅": !0,
            "︆": !0,
            "︇": !0,
            "︈": !0,
            "︉": !0,
            "︊": !0,
            "︋": !0,
            "︌": !0,
            "︍": !0,
            "︎": !0,
            "️": !0
        },
        h = ["🇦", "🇧", "🇨", "🇩", "🇪", "🇫", "🇬", "🇭", "🇮", "🇯", "🇰", "🇱", "🇲", "🇳", "🇴", "🇵", "🇶", "🇷", "🇸", "🇹", "🇺", "🇻", "🇼", "🇽", "🇾", "🇿"],
        g = [];
    h.forEach(function (e) {
        h.forEach(function (t) {
            g.push(e + t)
        })
    });
    var f = function () {
            var e = Object.keys(A).concat(Object.keys(p), g);
            return new RegExp("(" + r(e) + ")", "g")
        },
        m = function (e, t) {
            for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]);
            return e
        },
        b = function (e) {
            var t = {};
            for (var n in e) e.hasOwnProperty(n) && (t[e[n]] = n);
            return t
        },
        y = b(i),
        A = m(m({}, s), i),
        E = {
            containsEmoji: _.memoize(function (e) {
                return u || (u = f()), u.test(e)
            }),
            normalizeEmoji: _.memoize(function (e) {
                return u || (u = f()), e ? e.replace(u, function (e, t) {
                    if (p[t]) return "";
                    var n = A[t];
                    return y[n] || d
                }) : ""
            }),
            codeToEmoji: b(A),
            emojiToHTML: _.memoize(function (e) {
                return u || (u = f()), e ? e.replace(u, function (e, t) {
                    if (p[t]) return "";
                    var n = l[t];
                    if (n) return n;
                    var r, o = A[t];
                    if (o) {
                        var a = y[o] || d,
                            i = document.createElement("img");
                        return i.alt = a, i.className = "emoji emoji" + o, i.src = c.ONE_BY_ONE_TRANS_GIF, i.outerHTML
                    }
                    return r = d, l[t] = r
                }) : ""
            }),
            NodeToEmoji: function (e) {
                for (var t = [], n = [], r = function () {
                        t.push(n.join("")), n = []
                    }, o = function (e) {
                        if (3 === e.nodeType) n.push(e.nodeValue);
                        else if (1 === e.nodeType) {
                            var t = e.tagName.toLowerCase(),
                                a = -1 !== ["p", "div", "pre", "form"].indexOf(t);
                            if (a && n.length && r(), "img" === t) {
                                var i = e.getAttribute("alt") || "";
                                return void(i && n.push(i))
                            }
                            "br" === t && r();
                            for (var s = e.childNodes, c = 0; c < s.length; c++) o(s[c]);
                            a && n.length && r()
                        }
                    }, a = e.childNodes, i = 0; i < a.length; i++) o(a[i]);
                return n.length && r(), t.join("\n")
            },
            emojiMap: A
        };
    e.exports = E
}, function (e) {
    function t(e, t, n) {
        function r(n) {
            this.name = e, this.message = n || t || e
        }
        return n = n || Error, r.prototype = Object.create(n.prototype), r
    }
    function n(e) {
        return _.reduce(e, function (e, n) {
            var r, o;
            return _.isArray(n) ? (r = n[0], o = n[1]) : r = n, e[r] = t(r, o), e
        }, {})
    }
    var r = t("WAPStatusCode"),
        o = t("401", null, r),
        a = t("404", null, r),
        i = t("500", null, r),
        s = t("WapDrop"),
        c = t("EphemeralDrop", null, s),
        u = t("EphemeralDrop", null, s),
        l = t("Server5xxDrop", null, s),
        d = t("ShouldLoop"),
        p = t("GaveUpRetry"),
        h = t("GUMError"),
        g = t("NotSupportedError", "The operation is not supported.", h),
        f = t("PermissionDeniedError", "The user did not grant permission for the operation.", h),
        m = t("ConstraintNotSatisfiedError", "One of the mandatory Constraints could not be satisfied.", h),
        b = t("OverconstrainedError", "Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.", h),
        y = t("NotFoundError", "The object can not be found here.", h),
        A = t("AbortError", "The operation was aborted.", h),
        E = t("SourceUnavailableError", "The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process).", h),
        v = t("MediaFileError"),
        N = t("InvalidMediaFileType", null, v),
        C = t("MediaFileTooLarge", null, v);
    e.exports = {
        define: t,
        defineAll: n,
        QueryDrop: t("QueryDrop"),
        WapDrop: s,
        EphemeralDrop: c,
        LogoutDrop: u,
        Server5xxDrop: l,
        ShouldLoop: d,
        GaveUpRetry: p,
        MediaFileError: v,
        InvalidMediaFileType: N,
        MediaFileTooLarge: C,
        WAPStatusCode: r,
        E401: o,
        E404: a,
        E500: i,
        GUM: {
            GUMError: h,
            NotSupportedError: g,
            PermissionDeniedError: f,
            ConstraintNotSatisfiedError: m,
            OverconstrainedError: b,
            NotFoundError: y,
            AbortError: A,
            SourceUnavailableError: E,
            PERMISSION_DENIED: f,
            NOT_SUPPORTED_ERROR: m,
            MANDATORY_UNSATISFIED_ERROR: y
        }
    }
}, function (e, t, n) {
    var r = n(30),
        o = n(2),
        a = n(47),
        i = n(29),
        s = n(77),
        c = n(26),
        u = n(78),
        l = React.createClass({
            displayName: "QRCode",
            mixins: [a],
            getInitialState: function () {
                return {
                    rememberMe: o.getRememberMe(),
                    expired: !1,
                    offline: r.state === r.STATE.OFFLINE,
                    ref: void 0
                }
            },
            componentDidMount: function () {
                this.addObserver(r, "change:state", this.onStateChange)
            },
            onStateChange: function () {
                var e = r.previousAttributes().state;
                e === r.STATE.OFFLINE && this.setState({
                    offline: !1
                }), e === r.STATE.UNPAIRED_IDLE && this.setState({
                    expired: !1
                }), r.state === r.STATE.UNPAIRED_IDLE ? this.setState({
                    expired: !0
                }) : r.state === r.STATE.UNPAIRED ? this.addObserverAndRun(Store.Conn.get(1), "change:ref", this.createQR) : r.state === r.STATE.OFFLINE && this.setState({
                    offline: !0
                })
            },
            createQR: function (e) {
                Store.Conn.get(1).connected || this.setState({
                    ref: this.getRef(e)
                })
            },
            getRef: function (e) {
                var t = e.ref,
                    n = Wa.generateSecretBundle(),
                    r = Wa.getBrowserId();
                return t + "," + n + "," + r
            },
            onQRExpiry: function () {
                this.setState({
                    ref: void 0
                }), r.poke()
            },
            onRememberMeChange: function (e) {
                r.isIncognito || i.setRememberMe(e.target.checked)["catch"](_.noop), o.setRememberMe(e.target.checked), this.setState({
                    rememberMe: o.getRememberMe()
                })
            },
            render: function () {
                var e, t;
                this.state.offline ? t = React.createElement("button", {
                    className: "qr-button",
                    key: "expiry"
                }, React.createElement("div", {
                    className: "icon icon-connection-l-light"
                }), l10n.t("check_internet_connection")) : this.state.ref && this.state.expired ? t = React.createElement("button", {
                    className: "qr-button",
                    key: "expiry",
                    onClick: this.onQRExpiry
                }, React.createElement("div", {
                    className: "qr-container"
                }, React.createElement("div", {
                    className: "icon icon-refresh-l-light"
                }), l10n.t("click_to_reload_qr_code"))) : this.state.ref && (t = null), e = void 0 !== t ? React.createElement(d, {
                    data: this.state.ref,
                    state: t
                }) : React.createElement("div", {
                    className: "qrcode"
                }, React.createElement(s, null));
                var n = this.state.rememberMe ? null : React.createElement("div", {
                    className: "remember-me-tip-container"
                }, React.createElement("div", {
                    className: "remember-me-tip"
                }, l10n.t("if_unchecked_you_will_be_logged_out_afterawhile")));
                return React.createElement("div", {
                    id: "wrapper"
                }, React.createElement("div", {
                    id: "window"
                }, React.createElement("div", {
                    className: "entry-main"
                }, e, React.createElement("div", {
                    className: "entry-text"
                }, React.createElement("div", {
                    className: "entry-title"
                }, l10n.t("whatsapp_web")), React.createElement("div", {
                    className: "entry-subtitle"
                }, l10n.t("scan_code_with_phone_to_login")), React.createElement("div", {
                    className: "entry-controls"
                }, React.createElement("div", {
                    className: "toggle"
                }, React.createElement(u, {
                    transitionName: "fade_sifo"
                }, n), React.createElement("label", null, React.createElement("input", {
                    type: "checkbox",
                    name: "rememberMe",
                    checked: this.state.rememberMe,
                    onChange: this.onRememberMeChange
                }), l10n.t("menuitem_keep_me_signed_in"))), React.createElement("div", {
                    className: "hint"
                }, l10n.t("reduce_data_usage_connect_phone_to_wifi"))))), React.createElement("div", {
                    id: "platforms"
                }, React.createElement("ul", {
                    className: "list entry-platforms"
                }, React.createElement(p, {
                    platform: "android",
                    path: l10n.t("android_login_path"),
                    name: l10n.t("android")
                }), React.createElement(p, {
                    platform: "wp",
                    path: l10n.t("windows_phone_login_path"),
                    name: l10n.t("windows_phone")
                }), React.createElement(p, {
                    platform: "bb",
                    path: l10n.t("blackberry_login_path"),
                    name: l10n.t("blackberry")
                }), React.createElement(p, {
                    platform: "bb10",
                    path: l10n.t("bb10_login_path"),
                    name: l10n.t("bb10")
                }), React.createElement(p, {
                    platform: "s60",
                    path: l10n.t("nokia_symbian_s60_login_path"),
                    name: l10n.t("nokia_symbian_s60")
                }), React.createElement(p, {
                    platform: "s40",
                    path: l10n.t("nokia_s40_login_path"),
                    name: l10n.t("nokia_s40")
                })), React.createElement("p", {
                    className: "hint"
                }, l10n.t("login_hint_version")))))
            }
        }),
        d = React.createClass({
            displayName: "QR",
            propTypes: {
                data: React.PropTypes.string.isRequired,
                state: React.PropTypes.element
            },
            componentDidMount: function () {
                this.initialize(this.props.data)
            },
            componentWillUpdate: function (e) {
                e.data !== this.props.data && this.initialize(e.data)
            },
            initialize: function (e) {
                var t = this.getDOMNode();
                this.qr ? this.qr.makeCode(e) : this.qr = new window.QRCode(t, {
                    text: e,
                    colorDark: "#122e31",
                    width: c.QR_EDGE,
                    height: c.QR_EDGE,
                    correctLevel: window.QRCode.CorrectLevel.L
                }), t.removeAttribute("title"), t.setAttribute("data-ref", e)
            },
            render: function () {
                var e = "qrcode";
                return this.props.state && (e += " idle"), React.createElement("div", {
                    className: e
                }, React.createElement(u, {
                    transitionName: "scale"
                }, this.props.state), React.createElement("span", {
                    className: "icon icon-logo"
                }))
            }
        }),
        p = React.createClass({
            displayName: "LoginPlatform",
            propTypes: {
                platform: React.PropTypes.oneOf(["android", "bb", "wp", "bb10", "s60", "s40"]).isRequired,
                name: React.PropTypes.string.isRequired,
                path: React.PropTypes.string.isRequired
            },
            render: function () {
                var e = "icon icon-platform icon-platform-" + this.props.platform;
                return React.createElement("li", {
                    className: "list-item entry-platform"
                }, React.createElement("span", {
                    className: e,
                    title: this.props.name
                }), React.createElement("div", null, React.createElement("div", {
                    className: "entry-platform-title"
                }, this.props.name), React.createElement("div", {
                    className: "entry-platform-text"
                }, this.props.path)))
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(77),
        o = n(30),
        a = n(43),
        i = n(79),
        s = n(47),
        c = n(38),
        u = React.createClass({
            displayName: "Startup",
            mixins: [i, s],
            getInitialState: function () {
                return {
                    retriable: !1
                }
            },
            componentWillMount: function () {
                this.addObserver(a, "change:displayInfo"), this.addObserver(o, "change:retryTimestamp", this.retried)
            },
            retried: function () {
                this.clearSafeTimeout(this.timeout), delete this.timeout, this.clearSafeInterval(this.interval), delete this.interval, this.setState({
                    retriable: !1
                }), this.startTimeout()
            },
            componentDidMount: function () {
                this.startTimeout()
            },
            startTimeout: function () {
                this.timeout = this.safeDelay(this.allowRetry, 3e3)
            },
            allowRetry: function () {
                this.setState({
                    retriable: !0
                }), this.interval = this.safeInterval(this.forceUpdate, 1e3)
            },
            retry: function () {
                o.poke(), this.retried()
            },
            logout: function () {
                o.logout()
            },
            render: function () {
                var e, t, n, i, s;
                switch (a.displayInfo) {
                case a.INFO.OPENING:
                    e = l10n.t("connecting_to_whatsapp"), t = l10n.t("make_sure_computer_active_internet_connection"), s = this.logout;
                    break;
                case a.INFO.PAIRING:
                case a.INFO.TIMEOUT:
                    e = l10n.t("trying_to_reach_phone");
                    var u = window.open.bind(window, "http://www.whatsapp.com/faq/web/28080002", "_blank");
                    t = React.createElement("span", null, l10n.t("make_sure_phone_active_internet_connection"), " ", React.createElement("span", {
                        className: "action",
                        onClick: u
                    }, l10n.t("learn_more"))), s = this.logout;
                    break;
                case a.INFO.SYNCING:
                case a.INFO.CONNECTING:
                    return React.createElement("div", {
                        id: "startup"
                    }, React.createElement(r, null));
                default:
                    return null
                }
                var l = this.state.retriable;
                if (l) if (n = o.retryTimestamp - Date.now(), 6e4 > n) {
                    var d = Math.ceil(n / 1e3);
                    i = l10n.t("retrying_in_some_seconds", {
                        number: d,
                        _plural: d
                    })
                } else i = l10n.t("retrying_in", {
                    duration: moment.duration(n).humanize()
                });
                else i = l10n.t("retrying");
                return React.createElement(c, {
                    title: e,
                    body: i,
                    tip: t,
                    defaultLabel: l10n.t("retry_now"),
                    onDefault: l ? this.retry : _.noop,
                    cancelLabel: s ? l10n.t("menuitem_logout") : null,
                    onCancel: s
                })
            }
        });
    e.exports = u
}, function (e, t, n) {
    var r = n(38),
        o = React.createClass({
            displayName: "Offline",
            render: function () {
                return React.createElement(r, {
                    title: l10n.t("computer_not_connected"),
                    body: l10n.t("make_sure_computer_active_internet_connection")
                })
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(30),
        o = n(38),
        a = React.createClass({
            displayName: "Conflict",
            render: function () {
                return React.createElement(o, {
                    body: l10n.t("phone_has_another_active_webclient_session"),
                    cancelLabel: l10n.t("menuitem_logout"),
                    onCancel: r.logout.bind(r),
                    defaultLabel: l10n.t("button_use_here"),
                    onDefault: r.takeover.bind(r)
                })
            }
        });
    e.exports = a
}, function (e) {
    var t = React.createClass({
        displayName: "ErrorDialog",
        propTypes: {
            title: React.PropTypes.node,
            body: React.PropTypes.node.isRequired,
            tip: React.PropTypes.node,
            cancelLabel: React.PropTypes.node,
            onCancel: React.PropTypes.func,
            defaultLabel: React.PropTypes.node,
            onDefault: React.PropTypes.func
        },
        render: function () {
            var e = this.props.tip ? React.createElement("div", {
                className: "popup-body"
            }, this.props.body, React.createElement("hr", null), React.createElement("div", {
                className: "text text-tip"
            }, this.props.tip)) : React.createElement("div", {
                className: "popup-body"
            }, this.props.body),
                t = this.props.title ? React.createElement("div", {
                    className: "popup-title"
                }, this.props.title) : null,
                n = [];
            return this.props.onCancel && this.props.cancelLabel && n.push(React.createElement("button", {
                className: "btn-plain popup-controls-item",
                onClick: this.props.onCancel,
                key: "secondary"
            }, this.props.cancelLabel)), this.props.onDefault && this.props.defaultLabel && n.push(React.createElement("button", {
                className: "btn-plain btn-default popup-controls-item",
                onClick: this.props.onDefault,
                key: "primary"
            }, this.props.defaultLabel)), n.length && (n = React.createElement("div", {
                className: "popup-controls"
            }, n)), React.createElement("div", null, React.createElement("div", {
                className: "backdrop backdrop-transparent"
            }, React.createElement("div", {
                className: "popup"
            }, t, e, n)))
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = (n(80), n(26)),
        o = n(30),
        a = n(43),
        i = n(2),
        s = n(81),
        c = n(82),
        u = n(83),
        l = n(84),
        d = n(85),
        p = n(46),
        h = (n(79), n(48)),
        g = (n(29), n(86)),
        f = n(31),
        m = n(33),
        b = n(45),
        y = React.createClass({
            displayName: "Main",
            mixins: [p, h],
            propTypes: {
                conn: React.PropTypes.instanceOf(u).isRequired
            },
            getInitialState: function () {
                return {
                    conversations: [],
                    drawerActive: !1,
                    transition: null
                }
            },
            statics: {
                TWOTHREE: "two-three",
                THREETWO: "three-two"
            },
            componentDidUpdate: function (e, t) {
                (this.state.conversations.length !== t.conversations.length || this.state.drawerActive !== t.drawerActive) && _.delay(f.uiResize.bind(f), 200)
            },
            componentWillMount: function () {
                this.regCmd("open_chat", this.handleOpenChat), this.regCmd("clear_chat", this.handleClearChat), this.regNativeListener(window, "focus", this.windowGainedFocus), this.regNativeListener(window, "blur", this.windowLostFocus), a.uiActive = !0, a.markAvailable()
            },
            componentWillUnmount: function () {
                a.uiActive = !1, this.clearIdleMonitor()
            },
            componentDidMount: function () {
                var e = this.refs.container.getDOMNode();
                this.regNativeListener(e, "animationEnd", this.handleAnimationEnd), this.beginIdleMonitor()
            },
            windowGainedFocus: function () {
                a.markAvailable(), this.state.conversations.forEach(function (e) {
                    e.isUser && e.presence.subscribe()["catch"](m.WapDrop, _.noop)
                })
            },
            windowLostFocus: function () {
                a.markUnavailable(Wa.CONST.SEND_UNAVAILABLE_WAIT)
            },
            beginIdleMonitor: function () {
                var e = this;
                this.idleMonitor = b.loopOnError(m.ShouldLoop, function () {
                    return Promise.delay(r.IDLE_TIMEOUT).then(function () {
                        return a.markUnavailable(3e4), Promise.any([b.waitForEvent(document, "mousemove"), b.waitForEvent(document, "scroll"), b.waitForEvent(document, "keydown"), b.waitForEvent(window, "focus"), b.waitForEvent(window, "blur"), b.waitForEvent(window, "resize")]).timeout(r.IDLE_TIMEOUT_WAIT)
                    }).then(function () {
                        throw new m.ShouldLoop
                    })
                })["catch"](Promise.TimeoutError, function () {
                    i.getRememberMe() ? e.beginIdleMonitor() : (Wa.debug("loggout due to inactivity"), o.logout())
                })["finally"](function () {
                    delete e.idleMonitor
                })
            },
            clearIdleMonitor: function () {
                this.idleMonitor && this.idleMonitor.cancel()
            },
            handleRightDrawer: function (e) {
                this.setState(e ? {
                    drawerActive: !0,
                    transition: y.TWOTHREE
                } : {
                    drawerActive: !1,
                    transition: y.THREETWO
                })
            },
            handleAnimationEnd: function () {
                this.setState({
                    transition: null
                })
            },
            handleClearChat: function (e) {
                var t = this.state.conversations;
                this.setState({
                    conversations: _.without(t, e)
                })
            },
            handleOpenChat: function (e) {
                var t = this.state.conversations;
                _.contains(t, e) || this.setState({
                    conversations: [e],
                    transition: null
                })
            },
            onKeyPress: function () {},
            render: function () {
                var e = this.state.conversations.length ? this.state.conversations.map(function (e) {
                    var t = "convo-" + Wa.widToKey(e.get("id"));
                    return React.createElement(c, {
                        key: t,
                        chat: e
                    })
                }) : React.createElement(g, null),
                    t = this.state.drawerActive ? "app three" : "app two";
                return this.state.transition && (t += " " + this.state.transition), React.createElement("div", {
                    className: t,
                    ref: "container"
                }, React.createElement(d, null), React.createElement(l, {
                    onRightDrawer: this.handleRightDrawer
                }), React.createElement(s, null), e)
            }
        });
    e.exports = y
}, function (e, t, n) {
    var r = n(48),
        o = React.createClass({
            displayName: "DpiChangeDetect",
            mixins: [r],
            onDpiChange: function () {
                window.dispatchEvent(new Event("dpichange"))
            },
            componentDidMount: function () {
                this.regNativeListener(this.getDOMNode(), "animationStart", this.onDpiChange)
            },
            render: function () {
                return React.createElement("div", {
                    id: "detect_dpi"
                })
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(46),
        o = n(87),
        a = n(78),
        i = React.createClass({
            displayName: "ModalManager",
            mixins: [r],
            statics: {
                DEFAULT_TRANSITION: "modal"
            },
            getInitialState: function () {
                return {
                    flow: null
                }
            },
            componentWillMount: function () {
                this.regCmd("open_modal", this.openFlow), this.regCmd("close_modal", this.closeFlow)
            },
            openFlow: function (e, t) {
                o.push(this, o.MODAL), t = _.isBoolean(t) && !t ? void 0 : t || i.DEFAULT_TRANSITION, this.setState({
                    flow: e,
                    transition: t
                })
            },
            closeFlow: function () {
                o.pop(o.MODAL)
            },
            close: function () {
                this.setState({
                    flow: null,
                    transition: this.state.transition
                })
            },
            render: function () {
                var e, t;
                return this.state.flow && (this.state.transition ? t = this.state.flow : e = this.state.flow), React.createElement("div", null, e, React.createElement(a, {
                    transitionName: this.state.transition
                }, t))
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(46),
        o = n(87),
        a = n(88),
        i = n(78),
        s = React.createClass({
            displayName: "ContextMenuManager",
            mixins: [r],
            getInitialState: function () {
                return {
                    x: null,
                    y: null,
                    contextMenu: null
                }
            },
            componentWillMount: function () {
                this.regCmd("open_context_menu", this.open)
            },
            open: function (e, t, n) {
                o.push(this, o.MENU), this.setState({
                    x: e.clientX,
                    y: e.clientY,
                    contextMenu: t,
                    onClose: n
                }), e.stopPropagation()
            },
            close: function () {
                _.isFunction(this.state.onClose) && this.state.onClose(), this.setState({
                    x: null,
                    y: null,
                    contextMenu: null,
                    onClose: null
                })
            },
            getDirection: function () {
                var e = 200,
                    t = 42,
                    n = window.innerWidth,
                    r = window.innerHeight,
                    o = a.RIGHT;
                this.state.x + e > n && (o = a.LEFT);
                var i = a.DOWN;
                return this.state.y + t * this.state.contextMenu.length > r && (i = a.UP), o + " " + i
            },
            render: function () {
                var e = {
                    x: this.state.x,
                    y: this.state.y
                },
                    t = null;
                return this.state.contextMenu && (this.state.contextMenu.forEach(function (e, t) {
                    e.key = "menu-item-" + t
                }), t = React.createElement(a, {
                    position: e,
                    type: a.CONTEXT,
                    key: "x-" + this.state.x + "-y-" + this.state.y,
                    direction: this.getDirection()
                }, this.state.contextMenu)), React.createElement(i, {
                    transitionName: "dropdown"
                }, t)
            }
        });
    e.exports = s
}, function (e, t, n) {
    function r() {
        switch (s.state) {
        case s.STATE.TIMEOUT:
            return l.TIMEOUT;
        case s.STATE.OPENING:
            return s.online ? l.OPENING : l.OFFLINE;
        case s.STATE.PAIRING:
            return s.hasSynced ? l.RESUMING : l.PAIRING;
        case s.STATE.CONNECTED:
            return s.stream !== s.STREAM.CONNECTED ? s.hasSynced ? l.RESUMING : l.SYNCING : l.NORMAL;
        case s.STATE.UNLAUNCHED:
        default:
            return l.NORMAL
        }
    }
    function o() {
        if (!Wa.knowsPhone()) return d.QR;
        var e = s.hasSynced;
        switch (s.state) {
        case s.STATE.CONFLICT:
            return d.CONFLICT;
        case s.STATE.UNLAUNCHED:
            return d.SYNCING;
        case s.STATE.UNPAIRED_IDLE:
        case s.STATE.UNPAIRED:
            return d.QR;
        case s.STATE.OPENING:
            if (!s.online && !s.hasSynced) return d.OFFLINE;
        default:
            return e || s.stream === s.STREAM.CONNECTED ? d.MAIN : d.SYNCING
        }
    }
    function a(e, t) {
        switch (t) {
        case p.SHOW:
            return e;
        case p.HIDE:
            return s.hasSynced ? l.NORMAL : l.CONNECTING;
        case p.OBSCURE:
            switch (e) {
            case l.OPENING:
            case l.PAIRING:
            case l.SYNCING:
            case l.RESUMING:
                return l.CONNECTING;
            default:
                return e
            }
        }
    }
    var i = n(89),
        s = n(30),
        c = n(33),
        u = n(29),
        l = {
            OFFLINE: "OFFLINE",
            OPENING: "OPENING",
            PAIRING: "PAIRING",
            SYNCING: "SYNCING",
            RESUMING: "RESUMING",
            CONNECTING: "CONNECTING",
            NORMAL: "NORMAL",
            TIMEOUT: "TIMEOUT"
        },
        d = {
            QR: "QR",
            MAIN: "MAIN",
            SYNCING: "SYNCING",
            OFFLINE: "OFFLINE",
            CONFLICT: "CONFLICT"
        },
        p = {
            SHOW: "SHOW",
            OBSCURE: "OBSCURE",
            HIDE: "HIDE"
        },
        h = 3e3,
        g = i.extend({
            extraProperties: "reject",
            session: {
                info: {
                    type: "string",
                    values: _.keys(l),
                    "default": l.NORMAL
                },
                obscurity: {
                    type: "string",
                    values: _.keys(p),
                    "default": p.HIDE
                },
                mode: {
                    type: "string",
                    values: _.values(d),
                    "default": d.SYNCING
                },
                needsUpdate: "boolean",
                shouldForce: "number",
                couldForce: "boolean",
                forceTimer: "number",
                uiActive: "boolean",
                available: ["boolean", !1, !0],
                unavailableTimer: "number",
                unavailableTimestamp: "number",
                infoTimer: "number",
                phoneActive: "boolean",
                phoneAuthed: ["boolean", !1, !1]
            },
            derived: {
                displayInfo: {
                    deps: ["info", "obscurity"],
                    fn: function () {
                        return a(this.info, this.obscurity)
                    }
                }
            },
            initialize: function () {
                this.listenTo(s, "change:state change:stream change:hasSynced change:online", this.onSocketUpdate), this.listenTo(this, "change:shouldForce change:couldForce", this.onUpdateUpdate), this.listenTo(this, "change:available", this.onAvailableUpdate), this.listenTo(this, "change:phoneAuthed", this.onPhoneAuthedUpdate), this.listenTo(this, "change:info change:displayInfo change:mode", _.debounce(this.onSelfUpdate)), this.listenTo(this, "change:available change:uiActive", this.updateCouldForce.bind(this, !1)), document.addEventListener("visibilitychange", this.updateCouldForce.bind(this, !1)), this.updateCouldForce(!1)
            },
            "delete": function () {},
            INFO: l,
            MODE: d,
            handle: function (e) {
                switch (e[0]) {
                case "awake":
                    this.phoneActive = !1, this.phoneActive = !0;
                    break;
                case "asleep":
                    this.phoneActive = !1;
                    break;
                case "update":
                    this.handleUpdate(e[1]);
                    break;
                default:
                    Wa.debug("Stream:handle unknown cmd " + e[0], "red", e)
                }
            },
            handleUpdate: function (e) {
                Wa.debug("update: " + e), this.forceTimer && clearTimeout(this.forceTimer), this.set("number" == typeof e ? {
                    needsUpdate: !0,
                    shouldForce: Date.now() + e,
                    forceTimer: _.delay(this.updateCouldForce.bind(this, !0), e)
                } : {
                    needsUpdate: !! e,
                    shouldForce: 0,
                    forceTimer: 0
                })
            },
            markAvailable: function () {
                this.unavailableTimer && (clearTimeout(this.unavailableTimer), this.unavailableTimer = 0), this.available = !0
            },
            markUnavailable: function (e) {
                if (e && this.unavailableTimer) {
                    var t = Date.now() + e;
                    t < this.unavailableTimestamp && (clearTimeout(this.unavailableTimer), this.set({
                        unavailableTimestamp: t,
                        unavailableTimer: _.delay(this.markUnavailable.bind(this), e)
                    }))
                } else e ? this.set({
                    unavailableTimestamp: Date.now() + e,
                    unavailableTimer: _.delay(this.markUnavailable.bind(this), e)
                }) : (this.unavailableTimer && (clearTimeout(this.unavailableTimer), this.unavailableTimer = 0), this.available = !1)
            },
            onSelfUpdate: function () {
                Wa.debug("mode: " + this.mode + "    --    view: " + this.info + "(~ " + this.displayInfo + ") ", "#663333")
            },
            onUpdateUpdate: function () {
                this.shouldForce && this.couldForce && (Wa.debug("should+could force, so will update"), Wa.hardRefresh(!0))
            },
            onSocketUpdate: function () {
                var e = {};
                s.stream === s.STREAM.DISCONNECTED && (e.phoneActive = !1);
                var t = r();
                if (e.info = t, e.mode = o(), e.phoneAuthed = s.stream !== s.STREAM.DISCONNECTED, t === l.NORMAL || t === l.OFFLINE) this.infoTimer && clearTimeout(this.infoTimer), e.infoTimer = 0, e.obscurity = t === l.NORMAL ? p.HIDE : p.OBSCURE;
                else if (!this.infoTimer) {
                    var n = this.obscurity === p.OBSCURE ? h : Wa.CONST.DIAGNOSTIC_DELAY;
                    e.infoTimer = setTimeout(this.onInfoTimerFired.bind(this), n)
                }
                this.set(e)
            },
            onInfoTimerFired: function () {
                this.obscurity = p.SHOW
            },
            onPhoneAuthedUpdate: function () {
                this.phoneAuthed && this.sendAvailability(!0)
            },
            onAvailableUpdate: function () {
                Wa.debug(this.available ? "user available" : "user unavailable"), this.sendAvailability(!1)
            },
            sendAvailability: function (e) {
                (e || this.uiActive) && (this.available ? u.sendPresenceAvailable()["catch"](c.WapDrop, _.noop) : u.sendPresenceUnavailable()["catch"](c.WapDrop, _.noop))
            },
            updateCouldForce: function (e) {
                this.couldForce = !! e || !this.uiActive || this.shouldForce && this.shouldForce <= +Date.now() || !this.available && document.hidden
            }
        });
    e.exports = new g
}, function (e) {
    var t = {
        deleteStores: function () {
            var e = Store;
            for (var t in e) e[t].isCollection && e[t].reset()
        }
    };
    e.exports = t
}, function (e) {
    function t() {
        function e(e) {
            var s = Promise.resolve([i++, e]).cancellable().spread(o).then(n);
            t = s["catch"].apply(s, a)["catch"](r)
        }
        var t, n, r, o = _.last(arguments),
            a = _.initial(arguments),
            i = 0;
        return a.push(e), Promise.resolve().then(function () {
            return new Promise(function (t, o) {
                n = t, r = o, e()
            }).cancellable()["catch"](function (e) {
                if (t && t.isPending()) return new Promise(function (o, a) {
                    n = o, r = a, t.cancel(e)
                });
                throw e
            })
        })
    }
    function n(e) {
        return new Promise(function (t) {
            function n() {
                t(r.status && r.status < 12e3 ? r : null)
            }
            var r = new XMLHttpRequest;
            r.onload = n, r.onreadystatechange = function () {
                4 === r.readyState ? n() : 0 === r.readyState && t(null)
            }, r.onerror = t.bind(void 0, null), r.ontimeout = t.bind(void 0, null), r.open("GET", e, !0), r.send()
        })
    }
    function r(e, t) {
        return t["catch"](Promise.CancellationError, _.noop)["catch"](function (t) {
            e.cancel(t)
        })
    }
    function o() {
        return navigator.onLine ? Promise.resolve() : s(window, "online")
    }
    function a() {
        return s(window, "offline")
    }
    function i() {
        var e, t;
        return new Promise(function (n) {
            function r() {
                t && t + 1500 < Date.now() ? n(!0) : (t = Date.now(), e = _.delay(r, 1e3))
            }
            r()
        }).cancellable()["finally"](function () {
            clearTimeout(e)
        })
    }
    function s(e, t, n) {
        var r;
        return new Promise(function (o) {
            r = n ?
            function () {
                n.apply(this, arguments) && o.apply(this, arguments)
            } : o, e.addEventListener(t, r)
        }).cancellable()["finally"](function () {
            e.removeEventListener(t, r)
        })
    }
    function c(e, t, n) {
        var r;
        return new Promise(function (o) {
            r = n ?
            function () {
                n.apply(this, arguments) && o(arguments)
            } : function () {
                o(arguments)
            }, e.on(t, r)
        }).cancellable()["finally"](function () {
            e.off(t, r)
        })
    }
    function u() {
        return new Promise(function (e) {
            function t() {
                e(!1)
            }
            switch (Wa.getBrowserType()) {
            case Wa.CONST.BROWSER_TYPE.CHROME:
                window.requestFileSystem(window.TEMPORARY, 1, t, function (t) {
                    e("SecurityError" === t.name)
                });
                break;
            case Wa.CONST.BROWSER_TYPE.FIREFOX:
                var n = window.indexedDB.open("pb_detect");
                n.onsuccess = t, n.onerror = function (t) {
                    t.preventDefault(), e(!0)
                };
                break;
            default:
                t()
            }
        }).timeout(100)["catch"](Promise.TimeoutError, function () {
            return !1
        })["catch"](function (e) {
            return Wa.debug("Failed Incog Check: " + e, "red", e), Wa.uploadLogs("incog-throw"), !1
        })
    }
    function l(e, t, n, r) {
        var o = 0;
        return new Promise(function (a) {
            function i() {
                for (var s = Date.now() + t; o < e.length && Date.now() < s;) r(e[o]), o++;
                o < e.length ? _.delay(i, n) : a()
            }
            i()
        })
    }
    e.exports = {
        loopOnError: t,
        forEachAsync: l,
        attachWatcher: r,
        getResponseIfOnline: n,
        waitForOnlineNaive: o,
        waitForOfflineNaive: a,
        waitForEvent: s,
        waitForBBEvent: c,
        determineIncognito: u,
        waitForSkip: i
    }
}, function (e, t, n) {
    var r = n(31),
        o = {
            getCmds: function () {
                return this._cmds || (this._cmds = []), this._cmds
            },
            regCmd: function (e, t) {
                if (!_.isFunction(t)) throw Error("handler is not a function");
                this.getCmds().push({
                    cmd: e,
                    handler: t
                }), this.isMounted() && r.on(e, t)
            },
            unregCmd: function (e, t) {
                r.off(e, t), this._cmds = _.reject(this._cmds, _.matches({
                    cmd: e,
                    handler: t
                }))
            },
            registerCmds: function () {
                this._cmds && this.getCmds().forEach(function (e) {
                    r.on(e.cmd, e.handler)
                })
            },
            unregisterCmds: function () {
                this._cmds && (this.getCmds().forEach(function (e) {
                    r.off(e.cmd, e.handler)
                }), delete this._cmds)
            },
            componentDidMount: function () {
                this.registerCmds()
            },
            componentWillUnmount: function () {
                this.unregisterCmds()
            }
        };
    e.exports = o
}, function (e, t, n) {
    var r = n(100),
        o = {
            componentWillMount: function () {
                this._observer = _.extend({}, r)
            },
            getInitialState: function () {
                return {
                    _observedStateIndex: 0
                }
            },
            addObserver: function (e, t, n) {
                if (!this._isObservable(e)) throw Error("Attempting to observe non-observable object");
                this._observer.listenTo(e, t, this._cbWrapper(n)), e.isState && e._uiObservers++
            },
            addObserverAndRun: function (e, t, n) {
                this.addObserver(e, t, n);
                var r = this._cbWrapper(n);
                r(e, t)
            },
            removeObserver: function (e, t) {
                if (!this._isObservable(e)) throw Error("Attempting to observe non-observable object");
                this._observer.stopListening(e, t), e.isState && e._uiObservers--
            },
            _cbWrapper: function (e) {
                var t = this;
                return function () {
                    return t.isMounted() ? _.isFunction(e) ? e.apply(t, arguments) : t.setState({
                        _observedStateIndex: t.state._observedStateIndex + 1
                    }) : void 0
                }
            },
            _isObservable: function (e) {
                return e ? _.isFunction(e.trigger) ? !0 : void 0 : !1
            },
            componentWillUnmount: function () {
                var e = this._observer._listeningTo;
                for (var t in e) {
                    var n = e[t];
                    n.isState && n._uiObservers--
                }
                this._observer.stopListening()
            }
        };
    e.exports = o
}, function (e) {
    function t(e, t, n) {
        var r = e.toLowerCase().indexOf(t),
            o = e.slice(0, r).toLowerCase();
        return 0 === e.indexOf(t) ? o + e.slice(r) + n.toLowerCase() : o + e.slice(r) + n
    }
    function n(e, n) {
        var a;
        return 0 === e.indexOf(r) ? (a = e.substring(r.length), t(window.Modernizr.prefixed(r), r, a)) : 0 === e.indexOf(o) ? (a = e.substring(o.length), t(window.Modernizr.prefixed(o), o, a)) : window.Modernizr.prefixed(e, n, !1) || e
    }
    var r = "animation",
        o = "transition",
        a = {
            _nativeEventSafeIsMounted: function () {
                return this.isMounted() && "UNMOUNTING" !== this._compositeLifeCycleState
            },
            getEvents: function () {
                return this._events || (this._events = []), this._events
            },
            regNativeListener: function (e, t, r, o) {
                if (!_.isFunction(r)) throw Error("handler is not a function");
                t = n(t, e);
                var a = this,
                    i = function () {
                        return a._nativeEventSafeIsMounted() ? r.apply(null, arguments) : void 0
                    };
                this.getEvents().push({
                    src: e,
                    evnt: t,
                    handler: r,
                    fn: i,
                    capture: o
                }), this.isMounted() && e.addEventListener(t, i, o)
            },
            unregNativeListener: function (e, t, r, o) {
                t = n(t, e);
                var a = _.matches({
                    src: e,
                    evnt: t,
                    handler: r,
                    capture: o
                }),
                    i = _.find(this.getEvents(), a);
                i ? (this._events = _.without(this._events, i), i.src.removeEventListener(i.evnt, i.fn, i.capture)) : Wa.debug("unreg could not find event:" + event)
            },
            unregisterListeners: function () {
                this._events && (this.getEvents().forEach(function (e) {
                    e.src.removeEventListener(e.evnt, e.fn, e.capture)
                }), delete this._events)
            },
            componentDidMount: function () {
                this._events && this.getEvents().forEach(function (e) {
                    e.src.addEventListener(e.evnt, e.fn, e.capture)
                })
            },
            componentWillUnmount: function () {
                this.unregisterListeners()
            }
        };
    e.exports = a
}, function (e) {
    var t = {
        PP_URL: "https://web.whatsapp.com/pp",
        LOGOUT_URL: "https://web.whatsapp.com/logout",
        WS_FAIL_URL: "https://web.whatsapp.com/health_check.json",
        UPLOAD_TO_CLB: 1,
        DIAGNOSTIC_DELAY: 1e4,
        FLAVOR_TAGS: !1,
        SOCKETS: ["wss://w1.web.whatsapp.com/ws", "wss://w2.web.whatsapp.com/ws", "wss://w3.web.whatsapp.com/ws", "wss://w4.web.whatsapp.com/ws", "wss://w5.web.whatsapp.com/ws", "wss://w6.web.whatsapp.com/ws", "wss://w7.web.whatsapp.com/ws", "wss://w8.web.whatsapp.com/ws", "wss://w9.web.whatsapp.com/ws", "wss://w10.web.whatsapp.com/ws"]
    };
    e.exports = t
}, function (e, t, n) {
    var r = n(89),
        o = n(29),
        a = n(65).XRegExp,
        i = n(101),
        s = n(90),
        c = n(91),
        u = a("\\p{L}"),
        l = r.extend({
            Collection: "Contact",
            props: {
                id: "string",
                name: "string",
                shortName: "string",
                type: {
                    type: "string",
                    values: ["in", "out"],
                    "default": "in"
                }
            },
            session: {
                checked: "boolean"
            },
            derived: {
                userid: {
                    fn: function () {
                        return this.isUser ? Wa.widGetUser(this.id) : null
                    }
                },
                searchName: {
                    deps: ["name"],
                    fn: function () {
                        return this.name ? i(this.name).toLowerCase() : null
                    }
                },
                header: {
                    deps: ["name"],
                    fn: function () {
                        if (this.name) {
                            var e = this.name.charAt(0);
                            if (u.test(e)) {
                                var t = i(e);
                                return l.Collator.compare(t, e) ? e.toLowerCase() : t.toLowerCase()
                            }
                            return "#"
                        }
                        return void 0
                    }
                },
                isMe: {
                    fn: function () {
                        return Wa.me === this.id
                    }
                },
                isUser: {
                    fn: function () {
                        return Wa.isUserWid(this.id)
                    }
                },
                isGroup: {
                    fn: function () {
                        return Wa.isGroupWid(this.id)
                    }
                },
                isBroadcast: {
                    fn: function () {
                        return Wa.isBroadcastWid(this.id)
                    }
                },
                formattedShortName: {
                    deps: ["shortName", "formattedName", "id"],
                    fn: function () {
                        return this.id ? this.isMe ? l10n.t("web_you") : this.shortName || this.formattedName : void 0
                    }
                },
                formattedName: {
                    deps: ["name", "id"],
                    fn: function () {
                        return this.id ? this.isMe ? l10n.t("web_you") : this.name || Wa.widGetFormattedUser(this.id) : void 0
                    }
                },
                isWAContact: {
                    deps: ["type"],
                    fn: function () {
                        return this.isUser && "in" === this.type
                    }
                }
            },
            children: {
                status: s,
                profilePicThumb: c
            },
            initialize: function () {
                this.id && (this.status = Store.Status.gadd(this.id), this.listenTo(this.status, "all", this._getEventBubblingHandler("status")), this.profilePicThumb = Store.ProfilePicThumb.gadd(this.id), this.listenTo(this.profilePicThumb, "all", this._getEventBubblingHandler("profilePicThumb")))
            },
            isBlocked: function () {
                return !!Store.Blocklist.get(this.id)
            },
            findCommonGroups: function () {
                var e = this.id;
                return new Promise(function (t, n) {
                    o.commonGroupsFind(e).then(function (e) {
                        if (200 == e.status) {
                            var r = e.groups.map(function (e) {
                                return Store.Chat.get(e)
                            });
                            t(r)
                        } else Wa.debug("models:Contact:findCommonGroups error: " + e.status, "red"), n(new Error("models:Contact:findCommonGroups error: " + e.status))
                    })
                })
            },
            searchMatch: function (e) {
                return this.searchName ? this.searchName.indexOf(i(e).toLowerCase()) > -1 : e && this.userid ? this.userid.indexOf(e) > -1 : !1
            }
        });
    l.Collator = window.Intl.Collator([], {
        sensitivity: "base"
    }), l.Comparator = function (e, t) {
        var n = e.id,
            r = t.id;
        if (n === Wa.me) return 1;
        if (r === Wa.me) return -1;
        var o = e.name,
            a = t.name;
        if (!o && a) return 1;
        if (o && !a) return -1;
        if (o && a) {
            var i = l.Collator.compare(e.header, t.header);
            return 0 === i ? l.Collator.compare(o, a) : i
        }
        return n && r ? n.localeCompare(r) : -1
    }, e.exports = l
}, function (e) {
    e.exports = {
        rules: {
            ach: {
                name: "Acholi",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            af: {
                name: "Afrikaans",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ak: {
                name: "Akan",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            am: {
                name: "Amharic",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            an: {
                name: "Aragonese",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ar: {
                name: "Arabic",
                numbers: [0, 1, 2, 3, 11, 100],
                plurals: function (e) {
                    return Number(0 === e ? 0 : 1 == e ? 1 : 2 == e ? 2 : e % 100 >= 3 && 10 >= e % 100 ? 3 : e % 100 >= 11 ? 4 : 5)
                }
            },
            arn: {
                name: "Mapudungun",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            ast: {
                name: "Asturian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ay: {
                name: "Aymará",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            az: {
                name: "Azerbaijani",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            be: {
                name: "Belarusian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            bg: {
                name: "Bulgarian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            bn: {
                name: "Bengali",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            bo: {
                name: "Tibetan",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            br: {
                name: "Breton",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            bs: {
                name: "Bosnian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            ca: {
                name: "Catalan",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            cgg: {
                name: "Chiga",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            cs: {
                name: "Czech",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(1 == e ? 0 : e >= 2 && 4 >= e ? 1 : 2)
                }
            },
            csb: {
                name: "Kashubian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(1 == e ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            cy: {
                name: "Welsh",
                numbers: [1, 2, 3, 8],
                plurals: function (e) {
                    return Number(1 == e ? 0 : 2 == e ? 1 : 8 != e && 11 != e ? 2 : 3)
                }
            },
            da: {
                name: "Danish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            de: {
                name: "German",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            dz: {
                name: "Dzongkha",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            el: {
                name: "Greek",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            en: {
                name: "English",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            eo: {
                name: "Esperanto",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            es: {
                name: "Spanish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            es_ar: {
                name: "Argentinean Spanish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            et: {
                name: "Estonian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            eu: {
                name: "Basque",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            fa: {
                name: "Persian",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            fi: {
                name: "Finnish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            fil: {
                name: "Filipino",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            fo: {
                name: "Faroese",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            fr: {
                name: "French",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            fur: {
                name: "Friulian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            fy: {
                name: "Frisian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ga: {
                name: "Irish",
                numbers: [1, 2, 3, 7, 11],
                plurals: function (e) {
                    return Number(1 == e ? 0 : 2 == e ? 1 : 7 > e ? 2 : 11 > e ? 3 : 4)
                }
            },
            gd: {
                name: "Scottish Gaelic",
                numbers: [1, 2, 3, 20],
                plurals: function (e) {
                    return Number(1 == e || 11 == e ? 0 : 2 == e || 12 == e ? 1 : e > 2 && 20 > e ? 2 : 3)
                }
            },
            gl: {
                name: "Galician",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            gu: {
                name: "Gujarati",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            gun: {
                name: "Gun",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            ha: {
                name: "Hausa",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            he: {
                name: "Hebrew",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            hi: {
                name: "Hindi",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            hr: {
                name: "Croatian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            hu: {
                name: "Hungarian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            hy: {
                name: "Armenian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ia: {
                name: "Interlingua",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            id: {
                name: "Indonesian",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            is: {
                name: "Icelandic",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e % 10 != 1 || e % 100 == 11)
                }
            },
            it: {
                name: "Italian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ja: {
                name: "Japanese",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            jbo: {
                name: "Lojban",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            jv: {
                name: "Javanese",
                numbers: [0, 1],
                plurals: function (e) {
                    return Number(0 !== e)
                }
            },
            ka: {
                name: "Georgian",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            kk: {
                name: "Kazakh",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            km: {
                name: "Khmer",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            kn: {
                name: "Kannada",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ko: {
                name: "Korean",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            ku: {
                name: "Kurdish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            kw: {
                name: "Cornish",
                numbers: [1, 2, 3, 4],
                plurals: function (e) {
                    return Number(1 == e ? 0 : 2 == e ? 1 : 3 == e ? 2 : 3)
                }
            },
            ky: {
                name: "Kyrgyz",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            lb: {
                name: "Letzeburgesch",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ln: {
                name: "Lingala",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            lo: {
                name: "Lao",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            lt: {
                name: "Lithuanian",
                numbers: [1, 2, 10],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            lv: {
                name: "Latvian",
                numbers: [0, 1, 2],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : 0 !== e ? 1 : 2)
                }
            },
            mai: {
                name: "Maithili",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            mfe: {
                name: "Mauritian Creole",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            mg: {
                name: "Malagasy",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            mi: {
                name: "Maori",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            mk: {
                name: "Macedonian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 == e || e % 10 == 1 ? 0 : 1)
                }
            },
            ml: {
                name: "Malayalam",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            mn: {
                name: "Mongolian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            mnk: {
                name: "Mandinka",
                numbers: [0, 1, 2],
                plurals: function (e) {
                    return Number(1 == e ? 1 : 2)
                }
            },
            mr: {
                name: "Marathi",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ms: {
                name: "Malay",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            mt: {
                name: "Maltese",
                numbers: [1, 2, 11, 20],
                plurals: function (e) {
                    return Number(1 == e ? 0 : 0 === e || e % 100 > 1 && 11 > e % 100 ? 1 : e % 100 > 10 && 20 > e % 100 ? 2 : 3)
                }
            },
            nah: {
                name: "Nahuatl",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            nap: {
                name: "Neapolitan",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            nb: {
                name: "Norwegian Bokmal",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ne: {
                name: "Nepali",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            nl: {
                name: "Dutch",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            nn: {
                name: "Norwegian Nynorsk",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            no: {
                name: "Norwegian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            nso: {
                name: "Northern Sotho",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            oc: {
                name: "Occitan",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            or: {
                name: "Oriya",
                numbers: [2, 1],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            pa: {
                name: "Punjabi",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            pap: {
                name: "Papiamento",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            pl: {
                name: "Polish",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(1 == e ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            pms: {
                name: "Piemontese",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ps: {
                name: "Pashto",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            pt: {
                name: "Portuguese",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            pt_br: {
                name: "Brazilian Portuguese",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            rm: {
                name: "Romansh",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ro: {
                name: "Romanian",
                numbers: [1, 2, 20],
                plurals: function (e) {
                    return Number(1 == e ? 0 : 0 === e || e % 100 > 0 && 20 > e % 100 ? 1 : 2)
                }
            },
            ru: {
                name: "Russian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            sah: {
                name: "Yakut",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            sco: {
                name: "Scots",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            se: {
                name: "Northern Sami",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            si: {
                name: "Sinhala",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            sk: {
                name: "Slovak",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(1 == e ? 0 : e >= 2 && 4 >= e ? 1 : 2)
                }
            },
            sl: {
                name: "Slovenian",
                numbers: [5, 1, 2, 3],
                plurals: function (e) {
                    return Number(e % 100 == 1 ? 1 : e % 100 == 2 ? 2 : e % 100 == 3 || e % 100 == 4 ? 3 : 0)
                }
            },
            so: {
                name: "Somali",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            son: {
                name: "Songhay",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            sq: {
                name: "Albanian",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            sr: {
                name: "Serbian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            su: {
                name: "Sundanese",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            sv: {
                name: "Swedish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            sw: {
                name: "Swahili",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            ta: {
                name: "Tamil",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            te: {
                name: "Telugu",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            tg: {
                name: "Tajik",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            th: {
                name: "Thai",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            ti: {
                name: "Tigrinya",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            tk: {
                name: "Turkmen",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            tr: {
                name: "Turkish",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            tt: {
                name: "Tatar",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            ug: {
                name: "Uyghur",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            uk: {
                name: "Ukrainian",
                numbers: [1, 2, 5],
                plurals: function (e) {
                    return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                }
            },
            ur: {
                name: "Urdu",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            uz: {
                name: "Uzbek",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            vi: {
                name: "Vietnamese",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            wa: {
                name: "Walloon",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(e > 1)
                }
            },
            wo: {
                name: "Wolof",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            },
            yo: {
                name: "Yoruba",
                numbers: [1, 2],
                plurals: function (e) {
                    return Number(1 != e)
                }
            },
            zh: {
                name: "Chinese",
                numbers: [1],
                plurals: function () {
                    return 0
                }
            }
        },
        addRule: function (e, t) {
            pluralExtensions.rules[e] = t
        },
        setCurrentLng: function (e) {
            if (!pluralExtensions.currentRule || pluralExtensions.currentRule.lng !== e) {
                var t = e.split("-");
                pluralExtensions.currentRule = {
                    lng: e,
                    rule: pluralExtensions.rules[t[0]]
                }
            }
        },
        get: function (e, t) {
            function n(t, n) {
                var r;
                if (r = pluralExtensions.currentRule && pluralExtensions.currentRule.lng === e ? pluralExtensions.currentRule.rule : pluralExtensions.rules[t]) {
                    var o = r.plurals(n),
                        a = r.numbers[o];
                    return 2 === r.numbers.length && 1 === r.numbers[0] && (2 === a ? a = -1 : 1 === a && (a = 1)), a
                }
                return 1 === n ? "1" : "-1"
            }
            var r = e.split("-");
            return n(r[0], t)
        }
    }
}, function (e, t, n) {
    var r = n(92),
        o = n(93),
        a = r.extend({
            model: o,
            handle: function (e) {
                var t = e.shift(),
                    n = t.blocklist,
                    r = _.map(n, function (e) {
                        return {
                            id: e
                        }
                    });
                this.set(r)
            }
        });
    e.exports = new a
}, function (e, t, n) {
    var r = n(92),
        o = n(94),
        a = n(29),
        i = n(45),
        s = n(31),
        c = n(33),
        u = r.extend({
            model: o,
            comparator: function (e, t) {
                return e.t ? t.t ? e.t > t.t ? -1 : 1 : -1 : 1
            },
            initialize: function () {
                r.prototype.initialize.call(this), this.listenTo(this, "change:t", this.sort), this.listenTo(s, "resync_messages", this.resyncMessages)
            },
            _find: function (e) {
                return Promise.resolve({
                    id: e,
                    createdLocally: !0,
                    noEarlierMsgs: !0
                })
            },
            _findQuery: function (e) {
                var t = this;
                return a.chatFindQuery(e.retry).then(function (e) {
                    return "preempted" === e ? Promise.reject("chats preempted") : (t.trigger(Wa.CONST.COLLECTION_HAS_SYNCED), Promise.resolve(e))
                })
            },
            handle: function (e) {
                var t = e.shift(),
                    n = this;
                if (_.isArray(t)) {
                    var r = [],
                        o = [];
                    t.forEach(function (e) {
                        if ("c.us" === e.id) o.push(e);
                        else {
                            var t = !! n.get(e.id),
                                a = ["delete", "clear", "archive", "unarchive"].indexOf(e.type) > -1;
                            t || a ? t && a ? o.push(e) : Wa.debug("received junk chat record: " + JSON.stringify(e)) : r.push(e)
                        }
                    }); {
                        n.add(r, {
                            merge: !0
                        })
                    }
                    o.forEach(function (e) {
                        var t = e.type;
                        if ("c.us" === e.id) switch (t) {
                        case "clear":
                            Wa.debug("Model:chat:handle:clear:all before: " + e.before), n.forEach(function (t) {
                                "number" == typeof e.before ? t.deleteMsgsOlderThan(e.before) : t.deleteMsgs()
                            });
                            break;
                        case "delete":
                            Wa.debug("Model:chat:handle:delete:all"), n.forEach(function (e) {
                                e["delete"]()
                            });
                            break;
                        case "archive":
                            Wa.debug("Model:chat:handle:archive:all"), n.forEach(function (e) {
                                e.archive = !0
                            });
                            break;
                        case "unarchive":
                            Wa.debug("Model:chat:handle:unarchive:all"), n.forEach(function (e) {
                                e.archive = !1
                            });
                            break;
                        default:
                            Wa.debug("Model:chat:handle unknown " + JSON.stringify(e), "red", e)
                        } else {
                            var r = n.get(e.id);
                            if (!r) return;
                            if ("clear" === t) if (e.keys) {
                                for (var o = e.keys.length, a = 0; o > a; a++) {
                                    var i = e.keys[a][0],
                                        s = e.keys[a][1],
                                        c = s ? Wa.me : e.id,
                                        u = s ? e.id : Wa.me,
                                        l = Wa.createMsgKey(c, u, i),
                                        d = Store.Msg.get(l);
                                    d && r.removeMsg(d)
                                }
                                var p = e.keys.map(function (e) {
                                    return e.join("_")
                                }).join(", ");
                                Wa.debug("model:Chat:handle deleted messages: " + e.id + " " + p)
                            } else "number" == typeof e.before ? r.deleteMsgsOlderThan(e.before) : r.deleteMsgs(), Wa.debug("model:Chat:handle cleared chat for " + e.id + " before: " + e.before);
                            else "delete" === t ? (r["delete"](), Wa.debug("model:Chat:handle deleted chat for " + e.id)) : "archive" === t ? r.archive = !0 : "unarchive" === t && (r.archive = !1)
                        }
                    })
                } else if ("leave" === t.cmd) t.gids.forEach(function (e) {
                    var t = n.get(e);
                    t && t.exit()
                });
                else if ("update" === t.cmd) t.data.forEach(function (e) {
                    if ("delete" !== e.type) {
                        var t = Store.Contact.get(e.id);
                        t ? e.name && (t.name = e.name) : Store.Contact.add({
                            id: e.id,
                            name: e.name
                        })
                    }
                    var r = n.get(e.id);
                    if (!r) return void Store.Chat.add(e);
                    if ("clear" === e.type) {
                        var o = [];
                        r.msgs.forEach(function (e) {
                            o.push(e)
                        }), _.each(o, function (e) {
                            e["delete"]()
                        }), r.set({
                            t: e.t,
                            unreadCount: e.unreadCount,
                            createdLocally: !1,
                            archive: e.archive,
                            isReadOnly: e.isReadOnly,
                            modifyTag: e.modifyTag,
                            muteExpiration: e.muteExpiration,
                            msgs: [],
                            noEarlierMsgs: !1
                        }), Wa.debug("update: cleared chat for " + e.id)
                    } else "delete" === e.type ? (r["delete"](), Wa.debug("update: deleted chat for " + e.id)) : (e.muteExpiration = e.muteExpiration || 0, r.set(e, {
                        merge: !0
                    }))
                });
                else if ("preempt" === t.cmd) Store.Chat.add(t.response, {
                    merge: !0
                }), this.trigger(Wa.CONST.COLLECTION_HAS_SYNCED);
                else if ("action" === t.cmd) {
                    var a = t.id,
                        i = t.data;
                    if ("create" === i[0] || "introduce" === i[0]) {
                        var s = i[1],
                            c = i[2],
                            u = _.map(c.admins, function (e) {
                                return {
                                    id: e,
                                    isAdmin: !0
                                }
                            }).concat(_.map(c.regulars, function (e) {
                                return {
                                    id: e,
                                    isAdmin: !1
                                }
                            }));
                        Store.GroupMetadata.add({
                            id: a,
                            creation: c.creation,
                            owner: s,
                            participants: u,
                            stale: !1
                        }, {
                            merge: !0
                        }), Store.Contact.add({
                            id: a,
                            name: c.subject
                        }, {
                            merge: !0
                        })
                    } else {
                        var l = Store.Chat.get(t.id);
                        l ? l.handleGroupAction.apply(l, t.data) : Wa.debug("App.Chat: unknown chat for action " + JSON.stringify(t), "red")
                    }
                } else Wa.debug("App.Chat: unknown payload: " + JSON.stringify(t), "red")
            },
            sync: function () {
                return this.findQuery({})["catch"](c.WapDrop, _.noop), Promise.all([i.waitForBBEvent(this, Wa.CONST.COLLECTION_HAS_SYNCED), Store.Msg._hasSynced()])
            },
            resyncMessages: function (e, t, n) {
                var r = this;
                return a.resyncMessages(e).then(function (e) {
                    if (e.status >= 400) Wa.debug("ChatStore:resyncMessages resume error " + e.status, "red"), n(new Error("ChatStore:resyncMessages resume error " + e.status));
                    else {
                        Wa.debug("ChatStore:resyncMessages resume success");
                        var o = {
                            cmd: "update",
                            data: e
                        };
                        r.handle([o]), t()
                    }
                })["catch"](c.WapDrop, function () {
                    Wa.debug("ChatStore:resyncMessages resume dropped", "red"), n(new Error("ChatStore:resyncMessages resume dropped"))
                })
            }
        });
    e.exports = new u
}, function (e, t, n) {
    var r = (n(31), n(30), n(33)),
        o = {
            handle: function (e) {
                var t = e.shift();
                switch (t.type) {
                case "const":
                    Wa.CONST[t.key] = t.value;
                    break;
                case "read":
                    var n = Store.Chat.get(t.jid);
                    n && n.markSeen();
                    break;
                case "picture":
                    Store.ProfilePicThumb.imageChanged(t.jid, t.tag);
                    break;
                case "log":
                    Wa.uploadLogs("server-requested");
                    break;
                case "privacy":
                    t.jid ? (Store.Presence.update(t.jid)["catch"](r.WapDrop, _.noop), Store.ProfilePicThumb.update(t.jid)["catch"](r.WapDrop, _.noop), Store.Status.update(t.jid)["catch"](r.WapDrop, _.noop)) : Wa.debug("Store:Cmd:handle:privacy no jid", "red", t)
                }
            }
        };
    e.exports = o
}, function (e, t, n) {
    var r = n(92),
        o = n(83),
        a = n(29),
        i = n(2),
        s = r.extend({
            model: o,
            handle: function (e) {
                var t = e.shift();
                if (t.id = 1, t.protoVersion && (a.setVersion(t.protoVersion), Store.Stream.handle(["awake"])), t.initial) {
                    if (i.setLogoutToken(t.browserToken), t.hasOwnProperty("is24h") && Wa.updateConnSettings(t), t.lg) {
                        var n = t.lg,
                            r = t.lc;
                        r && (n += "-" + r)
                    }
                    var o = t.ref,
                        s = t.serverToken,
                        c = t.clientToken,
                        u = t.connected;
                    o && u && s && i.setRefTokCookies(o, s), i.setLoginTokens({
                        client: c,
                        server: s
                    }), t.secret && a.setSharedSecret(t.secret), "true" !== t.isResponse && Wa.saveCurrentSecretBundle(), t.wid && (Wa.setMe(t.wid), Store.Contact.gadd(t.wid))
                }
                this.add(t, {
                    merge: !0
                })
            }
        });
    e.exports = new s
}, function (e, t, n) {
    var r = n(92),
        o = n(50),
        a = n(45),
        i = n(29),
        s = n(31),
        c = n(33),
        u = r.extend({
            model: o,
            comparator: o.Comparator,
            _sort: _.debounce(function () {
                return r.prototype.sort.call(this)
            }, 1e3),
            _silentSort: _.debounce(function () {
                return r.prototype.sort.call(this, {
                    silent: !0
                })
            }, 1e3),
            sort: function (e) {
                return e && e.slient ? this._silentSort() : this._sort()
            },
            initialize: function () {
                r.prototype.initialize.call(this, {
                    CachePolicy: {
                        id: "contact_collection",
                        policy: r.CACHE_POLICY.NONE
                    }
                }), this.listenTo(s, "locale_change", this.sort), this.listenTo(this, "change:name", this.sort)
            },
            getFilteredContacts: function () {
                return this.filter(function (e) {
                    return e.name && !e.isMe && e.isWAContact
                })
            },
            _find: function (e) {
                var t = this.get(e);
                return t ? t : {
                    id: e
                }
            },
            _findQuery: function (e) {
                var t = this;
                return i.contactFindQuery(e.retry).then(function (e) {
                    return "preempted" === e ? Promise.reject("contacts preempted") : (t.trigger(Wa.CONST.COLLECTION_HAS_SYNCED), Promise.resolve(e))
                })
            },
            handle: function (e) {
                function t(e) {
                    var t = n.get(e.id);
                    t && (e.name ? n.add(e, {
                        merge: !0
                    }) : t.unset("name"))
                }
                var n = this,
                    r = e.shift();
                if (_.isArray(r)) {
                    var o = e.shift();
                    if (o && "remove" === o.missing) {
                        var a = {};
                        r.forEach(function (e) {
                            a[e.id] = !0
                        }), n.forEach(function (e) {
                            var t = e.get("id");
                            Wa.isUserWid(t) && !a[t] && e.set("name")
                        })
                    }
                    r.forEach(t)
                } else "preempt" === r.cmd ? (this.add(r.response, {
                    merge: !0
                }), this.trigger(Wa.CONST.COLLECTION_HAS_SYNCED)) : Wa.debug("Contact: unknown payload: " + JSON.stringify(r), "red")
            },
            sync: function () {
                return this.findQuery({})["catch"](c.WapDrop, _.noop), a.waitForBBEvent(this, Wa.CONST.COLLECTION_HAS_SYNCED)
            }
        });
    e.exports = new u
}, function (e, t, n) {
    var r = n(92),
        o = n(95),
        a = n(29),
        i = (n(30), n(33)),
        s = r.extend({
            model: o,
            initialize: function () {
                r.prototype.initialize.call(this, {
                    staleCollection: !0
                })
            },
            onResume: function () {
                _.union(Store.Chat.where({
                    active: !0
                }).filter(function (e) {
                    return e.isGroup || e.isBroadcast
                }), Store.Chat.where({
                    isBroadcast: !0
                })).forEach(function (e) {
                    Store.GroupMetadata.find(e.id)["catch"](i.WapDrop, _.noop)
                })
            },
            _find: function (e) {
                var t = this;
                if (Wa.isGroupWid(e)) {
                    var n = Store.Chat.get(e);
                    return n && n.isReadOnly ? a.groupMetadataFindFromPhone(e).then(function (t) {
                        return "ok" === t.status ? t.data : "missing" === t.status ? void _.defer(function () {
                            Store.Chat.get(e)["delete"]()
                        }) : "error" === t.status ? (Wa.debug("model:GroupMetadata:find error " + t.info, "red"), Promise.reject(new Error("model:GroupMetadata:find error"))) : void 0
                    }) : a.groupMetadataFind(e).then(function (n) {
                        if (n.status >= 400) return {
                            id: e,
                            stale: !1
                        };
                        var r = [],
                            o = t.get(e);
                        return o ? o.participants.set(n.participants) : r = n.participants, t.updateSubject(e, n.subject), {
                            id: n.id,
                            owner: n.owner,
                            creation: n.creation,
                            participants: r,
                            stale: !1
                        }
                    })
                }
                return Wa.isBroadcastWid(e) ? a.contactFindBroadcast(e).then(function (t) {
                    if (200 === t.status) {
                        var n = Store.GroupMetadata.get(e);
                        if (n && !n.stale) return Promise.resolve(n);
                        var r = [];
                        return n ? n.participants.set(t.recipients) : r = t.recipients, Promise.resolve({
                            id: e,
                            stale: !1,
                            participants: r
                        })
                    }
                    return 404 === t.status ? Promise.reject("False broadcast list query.") : (Wa.debug("models:GroupMetadataCollection:_find:bclist error: " + t.status, "red"), Promise.reject(new Error("models:GroupMetadataCollection:_find:bclist error: " + t.status)))
                }) : (Wa.debug("groupMetadata:find trying to fetch non-group/bclist wid " + e), Promise.reject(new Error("groupMetadata:find trying to fetch non-group/bclist wid " + e)))
            },
            _handle: function (e) {
                return e
            },
            updateSubject: function (e, t) {
                _.isString(t) && Store.Contact.find(e).then(function (e) {
                    e.name || (e.name = t)
                })
            }
        });
    e.exports = new s
}, function (e, t, n) {
    function r(e, t, n) {
        var r = [],
            o = [];
        return t.forEach(function (t) {
            t.id = Wa.createMsgKey(t.from, t.to, t.id), Wa.isBroadcastWid(e) && delete t.broadcast, t.recvFresh || t.clientUrl || (t.urlState = d.URL_STATE.NO_URL);
            var a = Store.Msg.get(t.id);
            if (a) {
                void 0 === a.clientUrl && t.clientUrl && a.set({
                    urlState: d.URL_STATE.INIT
                }), t.ack < a.ack && delete t.ack;
                for (var i in t) t.hasOwnProperty(i) && "undefined" == typeof t[i] && delete t[i];
                a.set(t), n.isHistory && a.recvFresh && (Wa.debug("model:Msg:handle:processMM dup " + a.id, "red"), o.push(a.toJSON()))
            } else r.push(t)
        }), 0 === r.length && 0 === o.length ? Promise.resolve([]) : Promise.join(Wa.fillInThumbnailDims(r), Store.Chat.find(e), function (r, a) {
            Store.Msg.add(r, {
                merge: !0
            });
            var i = "after" === n.add;
            return c(t, r, o, a, i), i && Wa.isBroadcastWid(e) && r.forEach(function (t) {
                if ("broadcast_notification" === t.type) {
                    var n = Store.GroupMetadata.get(e);
                    "add" === t.subtype ? n.participants.add({
                        id: t.body
                    }, {
                        merge: !0
                    }) : "remove" === t.subtype && n.participants.remove(t.body), a.groupMetadata.stale = !1
                } else t.recvFresh && u(t)
            }), r
        })
    }
    function o(e) {
        var t = e.filter(function (e) {
            var t;
            switch (e.type) {
            case "video":
            case "image":
            case "audio":
            case "ptt":
                t = !0;
                break;
            default:
                t = !1
            }
            return t
        });
        return t.length > 0 ? new Promise(function (e, n) {
            var r = t.map(function (e) {
                return [e.clientUrl, e.from.split("@")[0], e.to.split("@")[0], e.t]
            });
            g.send({
                data: ["query", "refreshMedia", r],
                onSend: e,
                onDrop: n
            })
        }).then(function (n) {
            var r, o, a;
            if (200 === n.status) {
                var i = n.data;
                for (o = i.length, i.length !== t.length && Wa.debug("Wap:refreshMedia returned length differs from orig", "red"), r = 0; o > r; r++) {
                    var s = i[r];
                    a = t[r], a.url = s.url, a.width = s.w, a.height = s.h, a.mimetype = s.mt, a.duration = a.duration ? a.duration.toString() : s.d ? s.d.toString() : s.d
                }
            } else for (Wa.debug("Wap:refreshMedia error " + n.status, "red"), o = t.length, r = 0; o > r; r++) a = t[r], delete a.url;
            return Promise.cast(e)
        })["catch"](function () {
            for (Wa.debug("Wap:refreshMedia dropped", "red"), len = t.length, i = 0; i < len; i++) m = t[i], delete m.url;
            return Promise.cast(e)
        }) : Promise.cast(e)
    }
    function a(e, t, n) {
        var r = t.msgs.length,
            o = _.isArray(e) ? e : [e],
            a = o.map(function (e) {
                return Store.Msg.get(e.id)
            });
        if (n ? t.msgs.add(a) : t.msgs.add(a, {
            at: 0
        }), n || 0 === r) {
            var i = _.last(a).id,
                s = Wa.splitMsgKey(i).remote;
            Store.Msg.lastReceivedKey[s] = i
        }
        if (n || 0 === r || !Store.Msg.lastReceivedReceipt[t.id]) for (var c = a.length, u = c - 1; u >= 0; u--) {
            var l = a[u],
                d = Wa.splitMsgKey(l.id);
            if (d.fromMe && !l.isNotification) {
                Store.Msg.updateLastReceipt(d.remote, l.t);
                break
            }
        }
    }
    function s(e, t, n, r) {
        var o, a, i, s = {},
            c = {},
            u = n.length;
        if (0 === u) return t;
        for (o = 0; u > o; o++) a = n[o], c[a.id] = a;
        for (u = t.length, o = 0; u > o; o++) a = t[o], s[a.id] = a;
        var l = [];
        for (u = e.length, o = 0; u > o; o++) a = e[o], s[a.id] && l.push(s[a.id]), c[a.id] && (l.push(c[a.id]), i = Store.Msg.get(a.id), i && (r.removeMsg(i), i.unset("recvFresh")));
        return l
    }
    function c(e, t, n, r, o) {
        var i = s(e, t, n, r);
        a(i, r, o)
    }
    function u(e) {
        function t(t) {
            var n = Wa.createMsgKey(e.from, t, r.id);
            if (!_.some(Store.Msg.models, function (e) {
                return e.id === n
            })) {
                var o = Wa.clone(e);
                o.to = t, o.id = n, o.broadcast = !0, Store.Msg.add(o, {
                    merge: !0
                }), Store.Chat.find(t).then(function (e) {
                    a(o, e, !0)
                })
            }
        }
        var n, r = Wa.splitMsgKey(e.id);
        if (!e.invis) if (e.recipients && 0 !== e.recipients.length) n = e.recipients, e.recipients.forEach(t);
        else {
            var o = Store.GroupMetadata.get(r.remote);
            o ? (n = Wa.clone(o.participants), _.pluck(n, "id").forEach(t)) : Wa.debug("model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: " + r.remote)
        }
        return n
    }
    var l = n(92),
        d = n(97),
        p = n(31),
        h = n(29),
        g = n(30),
        f = n(45),
        b = (n(33), l.extend({
            model: d,
            initialize: function () {
                l.prototype.initialize.call(this), this.listenTo(p, "resync_receipts", this.resyncReceipts), this.lastReceivedKey = {}, this.lastReceivedReceipt = {}, this.refreshMediaPromises = {}, this.preAck = {}, this.pendingAdd = {}, this.listenTo(g, "change:stream", function () {
                    g.stream === g.STREAM.DISCONNECTED && (this.preAck = {})
                })
            },
            _findQuery: function (e) {
                var t, n, r = this;
                return "undefined" != typeof e.fromMe && "undefined" != typeof e.id && (t = Wa.createMsgKey(e.fromMe ? Wa.me : e.wid, e.fromMe ? e.wid : Wa.me, e.id), n = Store.Msg.get(t)), h.msgFindQuery(e).then(function (t) {
                    var o, a = !1,
                        i = Store.Chat.get(e.wid);
                    return i && (o = i.msgs.first()), o && n && o === n && (a = !0), t.status >= 400 ? (Wa.debug("model:Msg:findQuery error " + t.status), Promise.reject(t.status)) : (t.forEach(function (e) {
                        e.invis = !0
                    }), r.processMultipleMessages(e.wid, t, {
                        add: "before"
                    }))
                })
            },
            handle: function (e) {
                var t, n, r = this,
                    o = e.shift();
                if ("ack" === o.cmd) {
                    t = Wa.createMsgKey(o.from, o.to, o.id);
                    var a = this.get(t);
                    return a ? (a.updateAck(o.ack), this.updateLastReceipt(Wa.splitMsgKey(t).remote, o.t)) : (Wa.debug("Msg:out of order ack", null, o), this.preAck[t] = o), !0
                }
                if ("acks" === o.cmd) return o.id.forEach(function (e) {
                    t = Wa.createMsgKey(o.from, o.to, e);
                    var n = r.get(t);
                    n ? (n.updateAck(o.ack), r.updateLastReceipt(Wa.splitMsgKey(t).remote, o.t)) : (Wa.debug("Msg:out of order ack", null, o), r.preAck[t] = o)
                }), !0;
                if (o.msg) return o.msg.recvFresh = !0, o.msg.isNew = !0, this.processMultipleMessages(o.chat, [o.msg], {
                    add: "after"
                }), !0;
                if (o.msgs) {
                    var i = o.msgs.length;
                    if (!i) return;
                    var s = o.meta;
                    s.isHistory = !0;
                    for (var c = 0; i > c; c++) n = o.msgs[c], n.invis = !0;
                    return this.processMultipleMessages(o.chat, o.msgs, s), !0
                }
                if (o.recent) {
                    delete o.recent, this.trigger(Wa.CONST.COLLECTION_HAS_SYNCED);
                    for (var u in o) n = o[u], n.invis = !0, this.processMultipleMessages(u, [n], {
                        add: "before"
                    })
                } else Wa.debug("************** Msg else clause. something strange is going on")
            },
            _hasSynced: function () {
                return f.waitForBBEvent(this, Wa.CONST.COLLECTION_HAS_SYNCED)
            },
            "delete": function () {
                l.prototype["delete"].call(this), this.lastReceivedKey = {}, this.lastReceivedReceipt = {}, this.preAck = {}, this.refreshMediaPromises = {}
            },
            send: function (e) {
                return new Promise(function (t, n) {
                    var r = e.id,
                        o = Wa.splitMsgKey(r),
                        a = e.toJSON();
                    e.isNew = !0;
                    window.performance.now(), e.chat;
                    if (!e.isGroupMsg) {
                        var i = Store.Contact.get(e.to);
                        if (i.isBlocked()) return void n(new Error("contact is blocked"))
                    }
                    if (Wa.isBroadcastWid(a.to)) var s = u(a);
                    var c = e.type;
                    c = "chat" == c ? "NONE" : "image" == c ? "PHOTO" : c.toUpperCase(), delete a.status, delete a.mimetype, delete a.height, delete a.width, delete a.recipients, delete a.chat, delete a.broadcast, delete a.ack, delete a.invis, delete a.filehash, delete a.recvFresh, delete a.dropped, Wa.isHttpUrl(e.url) || delete a.url;
                    for (var l in a)(null === a[l] || "undefined" == typeof a[l]) && delete a[l];
                    a.id = o.id, e.unset("dropped"), h.msgCreateRecord(a).then(function (n) {
                        if (200 === n.status) {
                            e.updateAck(n.data ? n.data.ack : 1);
                            var a = o.remote;
                            Store.Msg.lastReceivedKey[a] = r, Store.Msg.updateLastReceipt(a, n.t), Wa.isBroadcastWid(a) && (s ? s.forEach(function (e) {
                                var t = Wa.createMsgKey(Wa.me, e.id, o.id),
                                    n = Store.Msg.get(t);
                                n && (n.ack = 1, Store.Msg.lastReceivedKey[e] = t, Store.Msg.updateLastReceipt(e, n.t))
                            }) : Wa.debug("model:msg:createRecord bclist server ack, no recipients")), t("success")
                        }
                    })["catch"](function () {
                        t("dropped"), e.set("dropped", !0);
                        var n = "chat" === a.type ? a.body : a.type;
                        Wa.debug("model:msg:createRecord dropped msg: " + a.id + " " + n, "red")
                    })
                })
            },
            resyncReceipts: function (e, t, n) {
                h.resyncReceipts(e).then(function (e) {
                    _.isArray(e) ? (Wa.debug("MsgCollection:resyncReceipts success"), e.forEach(function (e) {
                        Store.Msg.updateLastReceipt(e.id, e.t), e.acks.forEach(function (t) {
                            if (2 === t.length) {
                                var n = Wa.createMsgKey(Wa.me, e.id, t[0]),
                                    r = Store.Msg.get(n);
                                r && r.updateAck(t[1])
                            } else Wa.debug("ws:resyncReceipts invalid response: " + JSON.stringify(t), "red")
                        })
                    }), t()) : (Wa.debug("ws:resyncReceipts error", "red", e), t())
                })["catch"](function () {
                    Wa.debug("ws:resyncReceipts dropped", "red"), n(new Error("ws:resyncReceipts dropped"))
                })
            },
            updateLastReceipt: function (e, t) {
                var n = this.lastReceivedReceipt[e];
                (!n || t > n) && (this.lastReceivedReceipt[e] = t)
            },
            refreshMediaUrl: function (e) {
                this.refreshMediaPromises[e] || (this.refreshMediaPromises[e] = this.get(e), this._refreshMedia())
            },
            _refreshMedia: _.debounce(function () {
                var e = _.where(this.refreshMediaPromises, {
                    needsRefresh: !0
                });
                e.forEach(function (e) {
                    e.set({
                        url: null,
                        urlState: d.URL_STATE.REFRESHING
                    })
                }), o(_.invoke(e, "toJSON")).bind(this).then(function (e) {
                    _.forEach(e, function (e) {
                        var t = this.get(e.id),
                            n = e.url ? d.URL_STATE.URL : d.URL_STATE.NO_URL;
                        t.set({
                            url: e.url,
                            urlState: n
                        })
                    }.bind(this))
                })["catch"](function () {
                    _.forEach(e, function (e) {
                        e.urlState = d.URL_STATE.REFRESH_RETRY
                    })
                })["finally"](function () {
                    _.forEach(e, function (e) {
                        delete this.refreshMediaPromises[e.id]
                    }.bind(this))
                })
            }, 500),
            processMultipleMessages: function (e, t, n) {
                var o, a = this.pendingAdd[e],
                    i = this;
                return o = a ? a.then(function () {
                    return r(e, t, n)
                }) : r(e, t, n), o["finally"](function () {
                    i.pendingAdd[e] === o && (i.pendingAdd[e] = null)
                }), this.pendingAdd[e] = o
            }
        }));
    e.exports = new b
}, function (e, t, n) {
    var r = n(92),
        o = n(96),
        a = n(2),
        i = "global_mute",
        s = !0,
        c = !0,
        u = r.extend({
            model: o,
            initialize: function () {
                r.prototype.initialize.call(this, {
                    CachePolicy: {
                        id: "mute",
                        policy: r.CACHE_POLICY.LOAD,
                        delay: 1e3
                    }
                })
            },
            initializeFromCache: function () {
                var e = a.getGlobalSounds();
                this.setGlobalSounds(e);
                var t = a.getGlobalNotifications();
                this.setGlobalNotifications(t)
            },
            saveToCache: function () {
                if (Wa.me) {
                    var e = this._config.CachePolicy.id;
                    Wa.debug("cache-save: " + e), a.setCollection(e, [this.globalMute().toJSON()])
                }
            },
            globalMute: function () {
                var e = this.get(i);
                return e ? e : this.add({
                    id: i
                })
            },
            getGlobalSounds: function () {
                return s
            },
            setGlobalSounds: function (e) {
                s = e, a.setGlobalSounds(e)
            },
            getGlobalNotifications: function () {
                return c
            },
            setGlobalNotifications: function (e) {
                c = e, a.setGlobalNotifications(e)
            },
            handle: function (e) {
                for (var t = 0; t < e.length; t++) {
                    var n = e[t],
                        r = Store.Chat.get(n.id);
                    r && "mute" === n.type && (r.muteExpiration = n.muteExpiration || 0)
                }
            }
        });
    e.exports = new u
}, function (e, t, n) {
    var r = n(92),
        o = n(98),
        a = n(29),
        i = (n(30), n(43)),
        s = n(33),
        c = r.extend({
            model: o,
            initialize: function () {
                r.prototype.initialize.call(this, {
                    staleCollection: !0
                }), this.listenTo(i, "change:phoneActive", this.onPresenceSubscribabilityChange)
            },
            _find: function (e) {
                var t = this.gadd(e);
                return t.isUser ? (t.isSubscribed = !0, a.presenceSubscribe(e)["catch"](function (e) {
                    return t.isSubscribed = !1, Promise.reject(e)
                })["catch"](s.WapDrop, _.noop), a.lastseenFind(e).then(function (n) {
                    return 423 === n.status ? {
                        id: e,
                        stale: !0,
                        hasData: !1
                    } : 401 === n.status ? (t.handle({
                        id: e,
                        deny: !0
                    }), {
                        id: e
                    }) : (n.id = e, t.handle(n), {
                        id: e
                    })
                })) : Promise.resolve({
                    id: e
                })
            },
            handle: function (e) {
                var t = e.shift();
                if (t.id === Wa.me)"unavailable" === t.type ? this.forEach(function (e) {
                    "unavailable" === e.type || e.stale || this.add({
                        id: e.id,
                        type: "unavailable",
                        t: t.t,
                        stale: !1
                    }, {
                        merge: !0
                    })
                }.bind(this)) : Wa.debug('presence for self is not "unavailable" !');
                else {
                    var n = this.get(t.id);
                    n && ("unsubscribe" === t.type ? n.set({
                        isSubscribed: !1,
                        stale: !0
                    }) : (n.handle(t), n.stale = !1))
                }
            },
            onPresenceSubscribabilityChange: function () {
                i.phoneActive ? Store.Chat.forEach(function (e) {
                    e.active && e.presence.isUser && e.presence.update()["catch"](s.WapDrop, _.noop)
                }) : this.forEach(function (e) {
                    e.reset(), e.set({
                        stale: !0,
                        isSubscribed: !1
                    })
                })
            }
        });
    e.exports = new c
}, function (e, t, n) {
    var r = n(92),
        o = n(91),
        a = n(2),
        i = n(29),
        s = n(33),
        c = n(43),
        u = n(30),
        l = r.extend({
            model: o,
            initialize: function () {
                r.prototype.initialize.call(this, {
                    staleCollection: !0,
                    CachePolicy: {
                        id: "profile_pic_thumb",
                        trigger: "change:tag change:raw",
                        policy: r.CACHE_POLICY.LOAD,
                        delay: 5e3
                    }
                }), this.listenTo(c, "change:phoneActive", function () {
                    c.phoneActive && this.onPhoneActive()
                })
            },
            get: function (e) {
                var t = r.prototype.get.call(this, e);
                if (!_.isString(e)) return t;
                var n = r.prototype.get.call(this, Wa.md5(e));
                if (n) {
                    if (this.remove(n, {
                        silent: !0
                    }), t) return t;
                    var o = n.toJSON();
                    return o.id = e, this.add(o, {
                        silent: !0
                    })
                }
                return t ? t : void 0
            },
            saveToCache: function () {
                if (Wa.me) {
                    var e = this._config.CachePolicy.id,
                        t = this.models.filter(function (e) {
                            return Wa.isWid(e.id)
                        });
                    t = t.map(function (e) {
                        return e = e.toJSON(), e.id = Wa.md5(e.id), e
                    }), Wa.debug("cache-save: " + e), a.setCollection(e, t)
                }
            },
            onPhoneActive: function () {
                if (u.stream === u.STREAM.CONNECTED) {
                    var e = [];
                    this.forEach(function (t) {
                        t._uiObservers && t.stale && (t.tag || t.unset("tag", {
                            silent: !0
                        }), e.push(t.toJSON()))
                    }), this.resyncPictures(e)
                }
            },
            onResume: function () {
                var e = this.filter(_.property("_uiObservers")).map(function (e) {
                    return e.tag || e.unset("tag", {
                        silent: !0
                    }), e.toJSON()
                });
                this.resyncPictures(e)
            },
            _find: function (e) {
                var t = Store.Chat.get(e);
                return t && t.isReadOnly ? i.profilePicFindThumbFromPhone(e, this.get(e)) : i.profilePicFind("ProfilePicThumb", e).then(function (t) {
                    return 401 === t.status ? {
                        id: e,
                        raw: void 0,
                        tag: ""
                    } : 423 === t.status ? {
                        id: e,
                        stale: !0
                    } : t.status >= 400 ? {
                        id: e
                    } : "undefined" == typeof t.status ? {
                        id: e,
                        tag: t.tag,
                        raw: void 0
                    } : void 0
                })
            },
            imageChanged: function (e, t) {
                var n = Store.ProfilePicThumb.get(e);
                n && ("remove" === t ? n.unset("tag") : n.tag !== t && n.update()["catch"](s.WapDrop, _.noop))
            },
            resyncPictures: function (e) {
                return 0 === e.length ? Promise.resolve() : i.resyncPictures(e).then(function (e) {
                    if (423 === e.status) Wa.debug("ProfilePicThumbStore:resyncPictures blocked", "orange");
                    else {
                        if (e.status >= 400) throw Wa.debug("ProfilePicThumbStore:resyncPictures error", "red"), new Error("ProfilePicThumbStore:resyncPictures error");
                        if (!_.isArray(e)) throw Wa.debug("ProfilePicThumbStore:resyncPictures unknown reply", "red", e), new Error("ProfilePicThumbStore:resyncPictures unknown reply");
                        Wa.debug("ProfilePicThumbStore:resyncPictures success"), e.forEach(function (e) {
                            var t = Store.ProfilePicThumb.get(e.id);
                            t && t.set({
                                tag: e.tag,
                                raw: void 0,
                                stale: !1
                            })
                        })
                    }
                })["catch"](s.WapDrop, _.noop)["catch"](function (e) {
                    throw Wa.debug("ProfilePicThumbStore:resyncPictures dropped: " + e, "red"), new Error("ProfilePicThumbStore:resyncPictures dropped: " + e)
                })
            }
        });
    e.exports = new l
}, function (e, t, n) {
    var r = n(92),
        o = n(99),
        a = r.extend({
            model: o,
            comparator: function (e, t) {
                return e.weight > t.weight ? -1 : 1
            },
            initialize: function () {
                r.prototype.initialize.call(this, {
                    CachePolicy: {
                        id: "recent_emoji_collection",
                        policy: r.CACHE_POLICY.LOAD,
                        delay: 2e3
                    }
                }), this.listenTo(this, "change:weight change:length", this.sortTrimScale)
            },
            sortTrimScale: function () {
                var e = this.length;
                e && (this.sort(), e > 30 && this.remove(this.models.slice(30)), _.first(this.models).weight < 10 && _.last(this.models).weight > .01 || this.forEach(function (t, n) {
                    t.weight = 1 + 3 * ((e - n) / e)
                }))
            },
            increment: function (e) {
                this.forEach(function (t) {
                    t["char"] == e ? t.weight += 1 : t.weight *= .9, t.weight = Math.round(1e3 * t.weight) / 1e3
                }), this.get(e) || this.add({
                    "char": e,
                    weight: 1
                })
            }
        });
    e.exports = new a
}, function (e, t, n) {
    var r = n(92),
        o = n(90),
        a = n(29),
        i = n(33),
        s = n(43),
        c = n(30),
        u = r.extend({
            model: o,
            initialize: function () {
                r.prototype.initialize.call(this, {
                    staleCollection: !0
                }), this.listenTo(s, "change:phoneActive", function () {
                    s.phoneActive && this.onPhoneActive()
                })
            },
            onPhoneActive: function () {
                c.stream === c.STREAM.CONNECTED && this.onResume()
            },
            onResume: function () {
                this.filter(_.property("_uiObservers")).forEach(function (e) {
                    Store.Status.find(e.id)["catch"](i.WapDrop, _.noop)
                })
            },
            _find: function (e) {
                return a.statusFind(e).then(function (t) {
                    return _.isNumber(t.status) ? 423 === t.status ? {
                        id: e,
                        stale: !0,
                        status: ""
                    } : t.status >= 400 ? {
                        id: e,
                        status: ""
                    } : void 0 : {
                        id: e,
                        status: t.status
                    }
                })
            },
            _handle: function (e) {
                return e
            }
        });
    e.exports = new u
}, function (e, t, n) {
    var r;
    !
    function (o, a) {
        "use strict";
        var i = "0.7.3",
            s = "",
            c = "?",
            u = "function",
            l = "undefined",
            d = "object",
            p = "major",
            h = "model",
            g = "name",
            f = "type",
            m = "vendor",
            b = "version",
            y = "architecture",
            _ = "console",
            A = "mobile",
            E = "tablet",
            v = "smarttv",
            N = "wearable",
            C = "embedded",
            S = {
                extend: function (e, t) {
                    for (var n in t) - 1 !== "browser cpu device engine os".indexOf(n) && t[n].length % 2 === 0 && (e[n] = t[n].concat(e[n]));
                    return e
                },
                has: function (e, t) {
                    return "string" == typeof e ? -1 !== t.toLowerCase().indexOf(e.toLowerCase()) : void 0
                },
                lowerize: function (e) {
                    return e.toLowerCase()
                }
            },
            R = {
                rgx: function () {
                    for (var e, t, n, r, o, i, s, c = 0, p = arguments; c < p.length && !i;) {
                        var h = p[c],
                            g = p[c + 1];
                        if (typeof e === l) {
                            e = {};
                            for (r in g) o = g[r], typeof o === d ? e[o[0]] = a : e[o] = a
                        }
                        for (t = n = 0; t < h.length && !i;) if (i = h[t++].exec(this.getUA())) for (r = 0; r < g.length; r++) s = i[++n], o = g[r], typeof o === d && o.length > 0 ? 2 == o.length ? e[o[0]] = typeof o[1] == u ? o[1].call(this, s) : o[1] : 3 == o.length ? e[o[0]] = typeof o[1] !== u || o[1].exec && o[1].test ? s ? s.replace(o[1], o[2]) : a : s ? o[1].call(this, s, o[2]) : a : 4 == o.length && (e[o[0]] = s ? o[3].call(this, s.replace(o[1], o[2])) : a) : e[o] = s ? s : a;
                        c += 2
                    }
                    return e
                },
                str: function (e, t) {
                    for (var n in t) if (typeof t[n] === d && t[n].length > 0) {
                        for (var r = 0; r < t[n].length; r++) if (S.has(t[n][r], e)) return n === c ? a : n
                    } else if (S.has(t[n], e)) return n === c ? a : n;
                    return e
                }
            },
            w = {
                browser: {
                    oldsafari: {
                        major: {
                            1: ["/8", "/1", "/3"],
                            2: "/4",
                            "?": "/"
                        },
                        version: {
                            "1.0": "/8",
                            1.2: "/1",
                            1.3: "/3",
                            "2.0": "/412",
                            "2.0.2": "/416",
                            "2.0.3": "/417",
                            "2.0.4": "/419",
                            "?": "/"
                        }
                    }
                },
                device: {
                    amazon: {
                        model: {
                            "Fire Phone": ["SD", "KF"]
                        }
                    },
                    sprint: {
                        model: {
                            "Evo Shift 4G": "7373KT"
                        },
                        vendor: {
                            HTC: "APA",
                            Sprint: "Sprint"
                        }
                    }
                },
                os: {
                    windows: {
                        version: {
                            ME: "4.90",
                            "NT 3.11": "NT3.51",
                            "NT 4.0": "NT4.0",
                            2000: "NT 5.0",
                            XP: ["NT 5.1", "NT 5.2"],
                            Vista: "NT 6.0",
                            7: "NT 6.1",
                            8: "NT 6.2",
                            8.1: "NT 6.3",
                            10: "NT 6.4",
                            RT: "ARM"
                        }
                    }
                }
            },
            T = {
                browser: [
                    [/(opera\smini)\/((\d+)?[\w\.-]+)/i, /(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i, /(opera).+version\/((\d+)?[\w\.]+)/i, /(opera)[\/\s]+((\d+)?[\w\.]+)/i],
                    [g, b, p],
                    [/\s(opr)\/((\d+)?[\w\.]+)/i],
                    [
                        [g, "Opera"], b, p],
                    [/(kindle)\/((\d+)?[\w\.]+)/i, /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i, /(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i, /(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i, /(rekonq)((?:\/)[\w\.]+)*/i, /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],
                    [g, b, p],
                    [/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],
                    [
                        [g, "IE"], b, p],
                    [/(yabrowser)\/((\d+)?[\w\.]+)/i],
                    [
                        [g, "Yandex"], b, p],
                    [/(comodo_dragon)\/((\d+)?[\w\.]+)/i],
                    [
                        [g, /_/g, " "], b, p],
                    [/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i, /(uc\s?browser|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i],
                    [g, b, p],
                    [/(dolfin)\/((\d+)?[\w\.]+)/i],
                    [
                        [g, "Dolphin"], b, p],
                    [/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],
                    [
                        [g, "Chrome"], b, p],
                    [/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],
                    [b, p, [g, "Mobile Safari"]],
                    [/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],
                    [b, p, g],
                    [/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
                    [g, [p, R.str, w.browser.oldsafari.major],
                        [b, R.str, w.browser.oldsafari.version]
                    ],
                    [/(konqueror)\/((\d+)?[\w\.]+)/i, /(webkit|khtml)\/((\d+)?[\w\.]+)/i],
                    [g, b, p],
                    [/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],
                    [
                        [g, "Netscape"], b, p],
                    [/(swiftfox)/i, /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i, /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i, /(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i, /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?((\d+)?[\w\.]+)/i, /(links)\s\(((\d+)?[\w\.]+)/i, /(gobrowser)\/?((\d+)?[\w\.]+)*/i, /(ice\s?browser)\/v?((\d+)?[\w\._]+)/i, /(mosaic)[\/\s]((\d+)?[\w\.]+)/i],
                    [g, b, p]
                ],
                cpu: [
                    [/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],
                    [
                        [y, "amd64"]
                    ],
                    [/(ia32(?=;))/i],
                    [
                        [y, S.lowerize]
                    ],
                    [/((?:i[346]|x)86)[;\)]/i],
                    [
                        [y, "ia32"]
                    ],
                    [/windows\s(ce|mobile);\sppc;/i],
                    [
                        [y, "arm"]
                    ],
                    [/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],
                    [
                        [y, /ower/, "", S.lowerize]
                    ],
                    [/(sun4\w)[;\)]/i],
                    [
                        [y, "sparc"]
                    ],
                    [/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],
                    [
                        [y, S.lowerize]
                    ]
                ],
                device: [
                    [/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],
                    [h, m, [f, E]],
                    [/applecoremedia\/[\w\.]+ \((ipad)/],
                    [h, [m, "Apple"],
                        [f, E]
                    ],
                    [/(apple\s{0,1}tv)/i],
                    [
                        [h, "Apple TV"],
                        [m, "Apple"]
                    ],
                    [/(archos)\s(gamepad2?)/i, /(hp).+(touchpad)/i, /(kindle)\/([\w\.]+)/i, /\s(nook)[\w\s]+build\/(\w+)/i, /(dell)\s(strea[kpr\s\d]*[\dko])/i],
                    [m, h, [f, E]],
                    [/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],
                    [h, [m, "Amazon"],
                        [f, E]
                    ],
                    [/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],
                    [
                        [h, R.str, w.device.amazon.model],
                        [m, "Amazon"],
                        [f, A]
                    ],
                    [/\((ip[honed|\s\w*]+);.+(apple)/i],
                    [h, m, [f, A]],
                    [/\((ip[honed|\s\w*]+);/i],
                    [h, [m, "Apple"],
                        [f, A]
                    ],
                    [/(blackberry)[\s-]?(\w+)/i, /(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i, /(hp)\s([\w\s]+\w)/i, /(asus)-?(\w+)/i],
                    [m, h, [f, A]],
                    [/\(bb10;\s(\w+)/i],
                    [h, [m, "BlackBerry"],
                        [f, A]
                    ],
                    [/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],
                    [h, [m, "Asus"],
                        [f, E]
                    ],
                    [/(sony)\s(tablet\s[ps])/i],
                    [m, h, [f, E]],
                    [/\s(ouya)\s/i, /(nintendo)\s([wids3u]+)/i],
                    [m, h, [f, _]],
                    [/android.+;\s(shield)\sbuild/i],
                    [h, [m, "Nvidia"],
                        [f, _]
                    ],
                    [/(playstation\s[3portablevi]+)/i],
                    [h, [m, "Sony"],
                        [f, _]
                    ],
                    [/(sprint\s(\w+))/i],
                    [
                        [m, R.str, w.device.sprint.vendor],
                        [h, R.str, w.device.sprint.model],
                        [f, A]
                    ],
                    [/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],
                    [m, h, [f, E]],
                    [/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i, /(zte)-(\w+)*/i, /(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],
                    [m, [h, /_/g, " "],
                        [f, A]
                    ],
                    [/[\s\(;](xbox(?:\sone)?)[\s\);]/i],
                    [h, [m, "Microsoft"],
                        [f, _]
                    ],
                    [/(kin\.[onetw]{3})/i],
                    [
                        [h, /\./g, " "],
                        [m, "Microsoft"],
                        [f, A]
                    ],
                    [/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i, /(mot)[\s-]?(\w+)*/i],
                    [
                        [m, "Motorola"], h, [f, A]
                    ],
                    [/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],
                    [h, [m, "Motorola"],
                        [f, E]
                    ],
                    [/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i, /((SM-T\w+))/i],
                    [
                        [m, "Samsung"], h, [f, E]
                    ],
                    [/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i, /(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i, /sec-((sgh\w+))/i],
                    [
                        [m, "Samsung"], h, [f, A]
                    ],
                    [/(samsung);smarttv/i],
                    [m, h, [f, v]],
                    [/\(dtv[\);].+(aquos)/i],
                    [h, [m, "Sharp"],
                        [f, v]
                    ],
                    [/sie-(\w+)*/i],
                    [h, [m, "Siemens"],
                        [f, A]
                    ],
                    [/(maemo|nokia).*(n900|lumia\s\d+)/i, /(nokia)[\s_-]?([\w-]+)*/i],
                    [
                        [m, "Nokia"], h, [f, A]
                    ],
                    [/android\s3\.[\s\w-;]{10}(a\d{3})/i],
                    [h, [m, "Acer"],
                        [f, E]
                    ],
                    [/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],
                    [
                        [m, "LG"], h, [f, E]
                    ],
                    [/(lg) netcast\.tv/i],
                    [m, h, [f, v]],
                    [/(nexus\s[45])/i, /lg[e;\s\/-]+(\w+)*/i],
                    [h, [m, "LG"],
                        [f, A]
                    ],
                    [/android.+(ideatab[a-z0-9\-\s]+)/i],
                    [h, [m, "Lenovo"],
                        [f, E]
                    ],
                    [/linux;.+((jolla));/i],
                    [m, h, [f, A]],
                    [/((pebble))app\/[\d\.]+\s/i],
                    [m, h, [f, N]],
                    [/android.+;\s(glass)\s\d/i],
                    [h, [m, "Google"],
                        [f, N]
                    ],
                    [/(mobile|tablet);.+rv\:.+gecko\//i],
                    [
                        [f, S.lowerize], m, h]
                ],
                engine: [
                    [/(presto)\/([\w\.]+)/i, /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i, /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i, /(icab)[\/\s]([23]\.[\d\.]+)/i],
                    [g, b],
                    [/rv\:([\w\.]+).*(gecko)/i],
                    [b, g]
                ],
                os: [
                    [/microsoft\s(windows)\s(vista|xp)/i],
                    [g, b],
                    [/(windows)\snt\s6\.2;\s(arm)/i, /(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],
                    [g, [b, R.str, w.os.windows.version]],
                    [/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],
                    [
                        [g, "Windows"],
                        [b, R.str, w.os.windows.version]
                    ],
                    [/\((bb)(10);/i],
                    [
                        [g, "BlackBerry"], b],
                    [/(blackberry)\w*\/?([\w\.]+)*/i, /(tizen)[\/\s]([\w\.]+)/i, /(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i, /linux;.+(sailfish);/i],
                    [g, b],
                    [/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],
                    [
                        [g, "Symbian"], b],
                    [/\((series40);/i],
                    [g],
                    [/mozilla.+\(mobile;.+gecko.+firefox/i],
                    [
                        [g, "Firefox OS"], b],
                    [/(nintendo|playstation)\s([wids3portablevu]+)/i, /(mint)[\/\s\(]?(\w+)*/i, /(mageia|vectorlinux)[;\s]/i, /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i, /(hurd|linux)\s?([\w\.]+)*/i, /(gnu)\s?([\w\.]+)*/i],
                    [g, b],
                    [/(cros)\s[\w]+\s([\w\.]+\w)/i],
                    [
                        [g, "Chromium OS"], b],
                    [/(sunos)\s?([\w\.]+\d)*/i],
                    [
                        [g, "Solaris"], b],
                    [/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
                    [g, b],
                    [/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],
                    [
                        [g, "iOS"],
                        [b, /_/g, "."]
                    ],
                    [/(mac\sos\sx)\s?([\w\s\.]+\w)*/i, /(macintosh|mac(?=_powerpc)\s)/i],
                    [
                        [g, "Mac OS"],
                        [b, /_/g, "."]
                    ],
                    [/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i, /(haiku)\s(\w+)/i, /(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i, /(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i, /(unix)\s?([\w\.]+)*/i],
                    [g, b]
                ]
            },
            F = function (e, t) {
                if (!(this instanceof F)) return new F(e, t).getResult();
                var n = e || (o && o.navigator && o.navigator.userAgent ? o.navigator.userAgent : s),
                    r = t ? S.extend(T, t) : T;
                this.getBrowser = function () {
                    return R.rgx.apply(this, r.browser)
                }, this.getCPU = function () {
                    return R.rgx.apply(this, r.cpu)
                }, this.getDevice = function () {
                    return R.rgx.apply(this, r.device)
                }, this.getEngine = function () {
                    return R.rgx.apply(this, r.engine)
                }, this.getOS = function () {
                    return R.rgx.apply(this, r.os)
                }, this.getResult = function () {
                    return {
                        ua: this.getUA(),
                        browser: this.getBrowser(),
                        engine: this.getEngine(),
                        os: this.getOS(),
                        device: this.getDevice(),
                        cpu: this.getCPU()
                    }
                }, this.getUA = function () {
                    return n
                }, this.setUA = function (e) {
                    return n = e, this
                }, this.setUA(n)
            };
        if (F.VERSION = i, F.BROWSER = {
            NAME: g,
            MAJOR: p,
            VERSION: b
        }, F.CPU = {
            ARCHITECTURE: y
        }, F.DEVICE = {
            MODEL: h,
            VENDOR: m,
            TYPE: f,
            CONSOLE: _,
            MOBILE: A,
            SMARTTV: v,
            TABLET: E,
            WEARABLE: N,
            EMBEDDED: C
        }, F.ENGINE = {
            NAME: g,
            VERSION: b
        }, F.OS = {
            NAME: g,
            VERSION: b
        }, typeof t !== l) typeof e !== l && e.exports && (t = e.exports = F), t.UAParser = F;
        else {
            o.UAParser = F, "function" === u && n(104) && (r = function () {
                return F
            }.call(t, n, t, e), !(r !== a && (e.exports = r)));
            var D = o.jQuery || o.Zepto;
            if (typeof D !== l) {
                var B = new F;
                D.ua = B.getResult(), D.ua.get = function () {
                    return B.getUA()
                }, D.ua.set = function (e) {
                    B.setUA(e);
                    var t = B.getResult();
                    for (var n in t) D.ua[n] = t[n]
                }
            }
        }
    }(this)
}, function (e, t) {
    /*!
     * XRegExp v2.0.0
     * (c) 2007-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     */
    var n;
    n = n ||
    function (e) {
        "use strict";

        function n(e, t, n) {
            var r;
            for (r in d.prototype) d.prototype.hasOwnProperty(r) && (e[r] = d.prototype[r]);
            return e.xregexp = {
                captureNames: t,
                isNative: !! n
            }, e
        }
        function r(e) {
            return (e.global ? "g" : "") + (e.ignoreCase ? "i" : "") + (e.multiline ? "m" : "") + (e.extended ? "x" : "") + (e.sticky ? "y" : "")
        }
        function o(e, t, o) {
            if (!d.isRegExp(e)) throw new TypeError("type RegExp expected");
            var a = f.replace.call(r(e) + (t || ""), N, "");
            return o && (a = f.replace.call(a, new RegExp("[" + o + "]+", "g"), "")), e = e.xregexp && !e.xregexp.isNative ? n(d(e.source, a), e.xregexp.captureNames ? e.xregexp.captureNames.slice(0) : null) : n(new RegExp(e.source, a), null, !0)
        }
        function a(e, t) {
            var n = e.length;
            if (Array.prototype.lastIndexOf) return e.lastIndexOf(t);
            for (; n--;) if (e[n] === t) return n;
            return -1
        }
        function i(e, t) {
            return Object.prototype.toString.call(e).toLowerCase() === "[object " + t + "]"
        }
        function s(e) {
            return e = e || {}, "all" === e || e.all ? e = {
                natives: !0,
                extensibility: !0
            } : i(e, "string") && (e = d.forEach(e, /[^\s,]+/, function (e) {
                this[e] = !0
            }, {})), e
        }
        function c(e, t, n, r) {
            var o, a, i = y.length,
                s = null;
            w = !0;
            try {
                for (; i--;) if (a = y[i], !("all" !== a.scope && a.scope !== n || a.trigger && !a.trigger.call(r)) && (a.pattern.lastIndex = t, o = m.exec.call(a.pattern, e), o && o.index === t)) {
                    s = {
                        output: a.handler.call(r, o, n),
                        match: o
                    };
                    break
                }
            } catch (c) {
                throw c
            } finally {
                w = !1
            }
            return s
        }
        function u(e) {
            d.addToken = p[e ? "on" : "off"], g.extensibility = e
        }
        function l(e) {
            RegExp.prototype.exec = (e ? m : f).exec, RegExp.prototype.test = (e ? m : f).test, String.prototype.match = (e ? m : f).match, String.prototype.replace = (e ? m : f).replace, String.prototype.split = (e ? m : f).split, g.natives = e
        }
        var d, p, h, g = {
            natives: !1,
            extensibility: !1
        },
            f = {
                exec: RegExp.prototype.exec,
                test: RegExp.prototype.test,
                match: String.prototype.match,
                replace: String.prototype.replace,
                split: String.prototype.split
            },
            m = {},
            b = {},
            y = [],
            _ = "default",
            A = "class",
            E = {
                "default": /^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/,
                "class": /^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/
            },
            v = /\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,
            N = /([\s\S])(?=[\s\S]*\1)/g,
            C = /^(?:[?*+]|{\d+(?:,\d*)?})\??/,
            S = f.exec.call(/()??/, "")[1] === e,
            R = RegExp.prototype.sticky !== e,
            w = !1,
            T = "gim" + (R ? "y" : "");
        return d = function (t, r) {
            if (d.isRegExp(t)) {
                if (r !== e) throw new TypeError("can't supply flags when constructing one RegExp from another");
                return o(t)
            }
            if (w) throw new Error("can't call the XRegExp constructor within token definition functions");
            var a, i, s, u = [],
                l = _,
                p = {
                    hasNamedCapture: !1,
                    captureNames: [],
                    hasFlag: function (e) {
                        return r.indexOf(e) > -1
                    }
                },
                h = 0;
            if (t = t === e ? "" : String(t), r = r === e ? "" : String(r), f.match.call(r, N)) throw new SyntaxError("invalid duplicate regular expression flag");
            for (t = f.replace.call(t, /^\(\?([\w$]+)\)/, function (e, t) {
                if (f.test.call(/[gy]/, t)) throw new SyntaxError("can't use flag g or y in mode modifier");
                return r = f.replace.call(r + t, N, ""), ""
            }), d.forEach(r, /[\s\S]/, function (e) {
                if (T.indexOf(e[0]) < 0) throw new SyntaxError("invalid regular expression flag " + e[0])
            }); h < t.length;) a = c(t, h, l, p), a ? (u.push(a.output), h += a.match[0].length || 1) : (i = f.exec.call(E[l], t.slice(h)), i ? (u.push(i[0]), h += i[0].length) : (s = t.charAt(h), "[" === s ? l = A : "]" === s && (l = _), u.push(s), ++h));
            return n(new RegExp(u.join(""), f.replace.call(r, /[^gimy]+/g, "")), p.hasNamedCapture ? p.captureNames : null)
        }, p = {
            on: function (e, t, n) {
                n = n || {}, e && y.push({
                    pattern: o(e, "g" + (R ? "y" : "")),
                    handler: t,
                    scope: n.scope || _,
                    trigger: n.trigger || null
                }), n.customFlags && (T = f.replace.call(T + n.customFlags, N, ""))
            },
            off: function () {
                throw new Error("extensibility must be installed before using addToken")
            }
        }, d.addToken = p.off, d.cache = function (e, t) {
            var n = e + "/" + (t || "");
            return b[n] || (b[n] = d(e, t))
        }, d.escape = function (e) {
            return f.replace.call(e, /[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
        }, d.exec = function (e, t, n, r) {
            var a, i = o(t, "g" + (r && R ? "y" : ""), r === !1 ? "y" : "");
            return i.lastIndex = n = n || 0, a = m.exec.call(i, e), r && a && a.index !== n && (a = null), t.global && (t.lastIndex = a ? i.lastIndex : 0), a
        }, d.forEach = function (e, t, n, r) {
            for (var o, a = 0, i = -1; o = d.exec(e, t, a);) n.call(r, o, ++i, e, t), a = o.index + (o[0].length || 1);
            return r
        }, d.globalize = function (e) {
            return o(e, "g")
        }, d.install = function (e) {
            e = s(e), !g.natives && e.natives && l(!0), !g.extensibility && e.extensibility && u(!0)
        }, d.isInstalled = function (e) {
            return !!g[e]
        }, d.isRegExp = function (e) {
            return i(e, "regexp")
        }, d.matchChain = function (e, t) {
            return function n(e, r) {
                var o, a = t[r].regex ? t[r] : {
                    regex: t[r]
                },
                    i = [],
                    s = function (e) {
                        i.push(a.backref ? e[a.backref] || "" : e[0])
                    };
                for (o = 0; o < e.length; ++o) d.forEach(e[o], a.regex, s);
                return r !== t.length - 1 && i.length ? n(i, r + 1) : i
            }([e], 0)
        }, d.replace = function (t, n, r, a) {
            var i, s = d.isRegExp(n),
                c = n;
            return s ? (a === e && n.global && (a = "all"), c = o(n, "all" === a ? "g" : "", "all" === a ? "" : "g")) : "all" === a && (c = new RegExp(d.escape(String(n)), "g")), i = m.replace.call(String(t), c, r), s && n.global && (n.lastIndex = 0), i
        }, d.split = function (e, t, n) {
            return m.split.call(e, t, n)
        }, d.test = function (e, t, n, r) {
            return !!d.exec(e, t, n, r)
        }, d.uninstall = function (e) {
            e = s(e), g.natives && e.natives && l(!1), g.extensibility && e.extensibility && u(!1)
        }, d.union = function (e, t) {
            var n, r, o, a, s = /(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,
                c = 0,
                u = function (e, t, o) {
                    var a = r[c - n];
                    if (t) {
                        if (++c, a) return "(?<" + a + ">"
                    } else if (o) return "\\" + (+o + n);
                    return e
                },
                l = [];
            if (!i(e, "array") || !e.length) throw new TypeError("patterns must be a nonempty array");
            for (a = 0; a < e.length; ++a) o = e[a], d.isRegExp(o) ? (n = c, r = o.xregexp && o.xregexp.captureNames || [], l.push(d(o.source).source.replace(s, u))) : l.push(d.escape(o));
            return d(l.join("|"), t)
        }, d.version = "2.0.0", m.exec = function (t) {
            var n, o, i, s, c;
            if (this.global || (s = this.lastIndex), n = f.exec.apply(this, arguments)) {
                if (!S && n.length > 1 && a(n, "") > -1 && (i = new RegExp(this.source, f.replace.call(r(this), "g", "")), f.replace.call(String(t).slice(n.index), i, function () {
                    var t;
                    for (t = 1; t < arguments.length - 2; ++t) arguments[t] === e && (n[t] = e)
                })), this.xregexp && this.xregexp.captureNames) for (c = 1; c < n.length; ++c) o = this.xregexp.captureNames[c - 1], o && (n[o] = n[c]);
                this.global && !n[0].length && this.lastIndex > n.index && (this.lastIndex = n.index)
            }
            return this.global || (this.lastIndex = s), n
        }, m.test = function (e) {
            return !!m.exec.call(this, e)
        }, m.match = function (e) {
            if (d.isRegExp(e)) {
                if (e.global) {
                    var t = f.match.apply(this, arguments);
                    return e.lastIndex = 0, t
                }
            } else e = new RegExp(e);
            return m.exec.call(e, this)
        }, m.replace = function (e, t) {
            var n, r, o, s, c = d.isRegExp(e);
            return c ? (e.xregexp && (n = e.xregexp.captureNames), e.global || (s = e.lastIndex)) : e += "", i(t, "function") ? r = f.replace.call(String(this), e, function () {
                var r, o = arguments;
                if (n) for (o[0] = new String(o[0]), r = 0; r < n.length; ++r) n[r] && (o[0][n[r]] = o[r + 1]);
                return c && e.global && (e.lastIndex = o[o.length - 2] + o[0].length), t.apply(null, o)
            }) : (o = String(this), r = f.replace.call(o, e, function () {
                var e = arguments;
                return f.replace.call(String(t), v, function (t, r, o) {
                    var i;
                    if (r) {
                        if (i = +r, i <= e.length - 3) return e[i] || "";
                        if (i = n ? a(n, r) : -1, 0 > i) throw new SyntaxError("backreference to undefined group " + t);
                        return e[i + 1] || ""
                    }
                    if ("$" === o) return "$";
                    if ("&" === o || 0 === +o) return e[0];
                    if ("`" === o) return e[e.length - 1].slice(0, e[e.length - 2]);
                    if ("'" === o) return e[e.length - 1].slice(e[e.length - 2] + e[0].length);
                    if (o = +o, !isNaN(o)) {
                        if (o > e.length - 3) throw new SyntaxError("backreference to undefined group " + t);
                        return e[o] || ""
                    }
                    throw new SyntaxError("invalid token " + t)
                })
            })), c && (e.lastIndex = e.global ? 0 : s), r
        }, m.split = function (t, n) {
            if (!d.isRegExp(t)) return f.split.apply(this, arguments);
            var r, o = String(this),
                a = t.lastIndex,
                i = [],
                s = 0;
            return n = (n === e ? -1 : n) >>> 0, d.forEach(o, t, function (e) {
                e.index + e[0].length > s && (i.push(o.slice(s, e.index)), e.length > 1 && e.index < o.length && Array.prototype.push.apply(i, e.slice(1)), r = e[0].length, s = e.index + r)
            }), s === o.length ? (!f.test.call(t, "") || r) && i.push("") : i.push(o.slice(s)), t.lastIndex = a, i.length > n ? i.slice(0, n) : i
        }, h = p.on, h(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4})|x(?![\dA-Fa-f]{2}))/, function (e, t) {
            if ("B" === e[1] && t === _) return e[0];
            throw new SyntaxError("invalid escape " + e[0])
        }, {
            scope: "all"
        }), h(/\[(\^?)]/, function (e) {
            return e[1] ? "[\\s\\S]" : "\\b\\B"
        }), h(/(?:\(\?#[^)]*\))+/, function (e) {
            return f.test.call(C, e.input.slice(e.index + e[0].length)) ? "" : "(?:)"
        }), h(/\\k<([\w$]+)>/, function (e) {
            var t = isNaN(e[1]) ? a(this.captureNames, e[1]) + 1 : +e[1],
                n = e.index + e[0].length;
            if (!t || t > this.captureNames.length) throw new SyntaxError("backreference to undefined group " + e[0]);
            return "\\" + t + (n === e.input.length || isNaN(e.input.charAt(n)) ? "" : "(?:)")
        }), h(/(?:\s+|#.*)+/, function (e) {
            return f.test.call(C, e.input.slice(e.index + e[0].length)) ? "" : "(?:)"
        }, {
            trigger: function () {
                return this.hasFlag("x")
            },
            customFlags: "x"
        }), h(/\./, function () {
            return "[\\s\\S]"
        }, {
            trigger: function () {
                return this.hasFlag("s")
            },
            customFlags: "s"
        }), h(/\(\?P?<([\w$]+)>/, function (e) {
            if (!isNaN(e[1])) throw new SyntaxError("can't use integer as capture name " + e[0]);
            return this.captureNames.push(e[1]), this.hasNamedCapture = !0, "("
        }), h(/\\(\d+)/, function (e, t) {
            if (!(t === _ && /^[1-9]/.test(e[1]) && +e[1] <= this.captureNames.length) && "0" !== e[1]) throw new SyntaxError("can't use octal escape or backreference to undefined group " + e[0]);
            return e[0]
        }, {
            scope: "all"
        }), h(/\((?!\?)/, function () {
            return this.hasFlag("n") ? "(?:" : (this.captureNames.push(null), "(")
        }, {
            customFlags: "n"
        }), t.XRegExp = d, d
    }(),
    /*!
     * XRegExp Unicode Base v1.0.0
     * (c) 2008-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Uses Unicode 6.1 <http://unicode.org/>
     */

    function (e) {
        "use strict";

        function t(e) {
            return e.replace(/[- _]+/g, "").toLowerCase()
        }
        function n(e) {
            return e.replace(/\w{4}/g, "\\u$&")
        }
        function r(e) {
            for (; e.length < 4;) e = "0" + e;
            return e
        }
        function o(e) {
            return parseInt(e, 16)
        }
        function a(e) {
            return parseInt(e, 10).toString(16)
        }
        function i(t) {
            var n, i = [],
                s = -1;
            return e.forEach(t, /\\u(\w{4})(?:-\\u(\w{4}))?/, function (e) {
                n = o(e[1]), n > s + 1 && (i.push("\\u" + r(a(s + 1))), n > s + 2 && i.push("-\\u" + r(a(n - 1)))), s = o(e[2] || e[1])
            }), 65535 > s && (i.push("\\u" + r(a(s + 1))), 65534 > s && i.push("-\\uFFFF")), i.join("")
        }
        function s(e) {
            return c["^" + e] || (c["^" + e] = i(c[e]))
        }
        var c = {};
        e.install("extensibility"), e.addUnicodePackage = function (r, o) {
            var a;
            if (!e.isInstalled("extensibility")) throw new Error("extensibility must be installed before adding Unicode packages");
            if (r) for (a in r) r.hasOwnProperty(a) && (c[t(a)] = n(r[a]));
            if (o) for (a in o) o.hasOwnProperty(a) && (c[t(o[a])] = c[t(a)])
        }, e.addUnicodePackage({
            L: "0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05270531-055605590561-058705D0-05EA05F0-05F20620-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280840-085808A008A2-08AC0904-0939093D09500958-09610971-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510C710CD10D0-10FA10FC-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11CF51CF61D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209C21022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2CF22CF32D00-2D252D272D2D2D30-2D672D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78B-A78EA790-A793A7A0-A7AAA7F8-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDAAE0-AAEAAAF2-AAF4AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC"
        }, {
            L: "Letter"
        }), e.addToken(/\\([pP]){(\^?)([^}]*)}/, function (e, n) {
            var r = "P" === e[1] || e[2] ? "^" : "",
                o = t(e[3]);
            if ("P" === e[1] && e[2]) throw new SyntaxError("invalid double negation \\P{^");
            if (!c.hasOwnProperty(o)) throw new SyntaxError("invalid or unknown Unicode property " + e[0]);
            return "class" === n ? r ? s(o) : c[o] : "[" + r + c[o] + "]"
        }, {
            scope: "all"
        })
    }(n),
    /*!
     * XRegExp Unicode Categories v1.2.0
     * (c) 2010-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Uses Unicode 6.1 <http://unicode.org/>
     */

    function (e) {
        "use strict";
        if (!e.addUnicodePackage) throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");
        e.install("extensibility"), e.addUnicodePackage({
            Ll: "0061-007A00B500DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F05210523052505270561-05871D00-1D2B1D6B-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7B2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2CF32D00-2D252D272D2DA641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA661A663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CA78EA791A793A7A1A7A3A7A5A7A7A7A9A7FAFB00-FB06FB13-FB17FF41-FF5A",
            Lu: "0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E05200522052405260531-055610A0-10C510C710CD1E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CED2CF2A640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA660A662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BA78DA790A792A7A0A7A2A7A4A7A6A7A8A7AAFF21-FF3A",
            Lt: "01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",
            Lm: "02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D6A1D781D9B-1DBF2071207F2090-209C2C7C2C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A7F8A7F9A9CFAA70AADDAAF3AAF4FF70FF9EFF9F",
            Lo: "00AA00BA01BB01C0-01C3029405D0-05EA05F0-05F20620-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150840-085808A008A2-08AC0904-0939093D09500958-09610972-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA10FD-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF11CF51CF62135-21382D30-2D672D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCAAE0-AAEAAAF2AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",
            M: "0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0903093A-093C093E-094F0951-0957096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F8D-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135D-135F1712-17141732-1734175217531772177317B4-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAD1BE6-1BF31C24-1C371CD0-1CD21CD4-1CE81CED1CF2-1CF41DC0-1DE61DFC-1DFF20D0-20F02CEF-2CF12D7F2DE0-2DFF302A-302F3099309AA66F-A672A674-A67DA69FA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAEB-AAEFAAF5AAF6ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",
            Mn: "0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0902093A093C0941-0948094D0951-095709620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F8D-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135D-135F1712-17141732-1734175217531772177317B417B517B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91BAB1BE61BE81BE91BED1BEF-1BF11C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1CF41DC0-1DE61DFC-1DFF20D0-20DC20E120E5-20F02CEF-2CF12D7F2DE0-2DFF302A-302D3099309AA66FA674-A67DA69FA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAECAAEDAAF6ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",
            Mc: "0903093B093E-09400949-094C094E094F0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1BAC1BAD1BE71BEA-1BEC1BEE1BF21BF31C24-1C2B1C341C351CE11CF21CF3302E302FA823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BAAEBAAEEAAEFAAF5ABE3ABE4ABE6ABE7ABE9ABEAABEC",
            Me: "0488048920DD-20E020E2-20E4A670-A672",
            N: "0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0B72-0B770BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",
            Nd: "0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19D91A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",
            Nl: "16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",
            No: "00B200B300B900BC-00BE09F4-09F90B72-0B770BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F919DA20702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA830-A835",
            P: "0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100A700AB00B600B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F3A-0F3D0F850FD0-0FD40FD90FDA104A-104F10FB1360-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2D702E00-2E2E2E30-2E3B3001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",
            Pd: "002D058A05BE140018062010-20152E172E1A2E3A2E3B301C303030A0FE31FE32FE58FE63FF0D",
            Ps: "0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",
            Pe: "0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",
            Pi: "00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",
            Pf: "00BB2019201D203A2E032E052E0A2E0D2E1D2E21",
            Pc: "005F203F20402054FE33FE34FE4D-FE4FFF3F",
            Po: "0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100A700B600B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F850FD0-0FD40FD90FDA104A-104F10FB1360-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2D702E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E30-2E393001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",
            S: "0024002B003C-003E005E0060007C007E00A2-00A600A800A900AC00AE-00B100B400B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F60482058F0606-0608060B060E060F06DE06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0D790E3F0F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-139917DB194019DE-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B9210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23F32400-24262440-244A249C-24E92500-26FF2701-27672794-27C427C7-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FBB2-FBC1FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",
            Sm: "002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C21182140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",
            Sc: "002400A2-00A5058F060B09F209F309FB0AF10BF90E3F17DB20A0-20B9A838FDFCFE69FF04FFE0FFE1FFE5FFE6",
            Sk: "005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFBB2-FBC1FF3EFF40FFE3",
            So: "00A600A900AE00B00482060E060F06DE06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0D790F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-1399194019DE-19FF1B61-1B6A1B74-1B7C210021012103-210621082109211421162117211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23F32400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26FF2701-27672794-27BF2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",
            Z: "002000A01680180E2000-200A20282029202F205F3000",
            Zs: "002000A01680180E2000-200A202F205F3000",
            Zl: "2028",
            Zp: "2029",
            C: "0000-001F007F-009F00AD03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-0605061C061D06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",
            Cc: "0000-001F007F-009F",
            Cf: "00AD0600-060406DD070F200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",
            Co: "E000-F8FF",
            Cs: "D800-DFFF",
            Cn: "03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-05FF0605061C061D070E074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"
        }, {
            Ll: "Lowercase_Letter",
            Lu: "Uppercase_Letter",
            Lt: "Titlecase_Letter",
            Lm: "Modifier_Letter",
            Lo: "Other_Letter",
            M: "Mark",
            Mn: "Nonspacing_Mark",
            Mc: "Spacing_Mark",
            Me: "Enclosing_Mark",
            N: "Number",
            Nd: "Decimal_Number",
            Nl: "Letter_Number",
            No: "Other_Number",
            P: "Punctuation",
            Pd: "Dash_Punctuation",
            Ps: "Open_Punctuation",
            Pe: "Close_Punctuation",
            Pi: "Initial_Punctuation",
            Pf: "Final_Punctuation",
            Pc: "Connector_Punctuation",
            Po: "Other_Punctuation",
            S: "Symbol",
            Sm: "Math_Symbol",
            Sc: "Currency_Symbol",
            Sk: "Modifier_Symbol",
            So: "Other_Symbol",
            Z: "Separator",
            Zs: "Space_Separator",
            Zl: "Line_Separator",
            Zp: "Paragraph_Separator",
            C: "Other",
            Cc: "Control",
            Cf: "Format",
            Co: "Private_Use",
            Cs: "Surrogate",
            Cn: "Unassigned"
        })
    }(n),
    /*!
     * XRegExp Unicode Scripts v1.2.0
     * (c) 2010-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Uses Unicode 6.1 <http://unicode.org/>
     */

    function (e) {
        "use strict";
        if (!e.addUnicodePackage) throw new ReferenceError("Unicode Base must be loaded before Unicode Scripts");
        e.install("extensibility"), e.addUnicodePackage({
            Arabic: "0600-06040606-060B060D-061A061E0620-063F0641-064A0656-065E066A-066F0671-06DC06DE-06FF0750-077F08A008A2-08AC08E4-08FEFB50-FBC1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFCFE70-FE74FE76-FEFC",
            Armenian: "0531-05560559-055F0561-0587058A058FFB13-FB17",
            Balinese: "1B00-1B4B1B50-1B7C",
            Bamum: "A6A0-A6F7",
            Batak: "1BC0-1BF31BFC-1BFF",
            Bengali: "0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BC-09C409C709C809CB-09CE09D709DC09DD09DF-09E309E6-09FB",
            Bopomofo: "02EA02EB3105-312D31A0-31BA",
            Braille: "2800-28FF",
            Buginese: "1A00-1A1B1A1E1A1F",
            Buhid: "1740-1753",
            Canadian_Aboriginal: "1400-167F18B0-18F5",
            Cham: "AA00-AA36AA40-AA4DAA50-AA59AA5C-AA5F",
            Cherokee: "13A0-13F4",
            Common: "0000-0040005B-0060007B-00A900AB-00B900BB-00BF00D700F702B9-02DF02E5-02E902EC-02FF0374037E038503870589060C061B061F06400660-066906DD096409650E3F0FD5-0FD810FB16EB-16ED173517361802180318051CD31CE11CE9-1CEC1CEE-1CF31CF51CF62000-200B200E-2064206A-20702074-207E2080-208E20A0-20B92100-21252127-2129212C-21312133-214D214F-215F21892190-23F32400-24262440-244A2460-26FF2701-27FF2900-2B4C2B50-2B592E00-2E3B2FF0-2FFB3000-300430063008-30203030-3037303C-303F309B309C30A030FB30FC3190-319F31C0-31E33220-325F327F-32CF3358-33FF4DC0-4DFFA700-A721A788-A78AA830-A839FD3EFD3FFDFDFE10-FE19FE30-FE52FE54-FE66FE68-FE6BFEFFFF01-FF20FF3B-FF40FF5B-FF65FF70FF9EFF9FFFE0-FFE6FFE8-FFEEFFF9-FFFD",
            Coptic: "03E2-03EF2C80-2CF32CF9-2CFF",
            Cyrillic: "0400-04840487-05271D2B1D782DE0-2DFFA640-A697A69F",
            Devanagari: "0900-09500953-09630966-09770979-097FA8E0-A8FB",
            Ethiopic: "1200-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135D-137C1380-13992D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDEAB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2E",
            Georgian: "10A0-10C510C710CD10D0-10FA10FC-10FF2D00-2D252D272D2D",
            Glagolitic: "2C00-2C2E2C30-2C5E",
            Greek: "0370-03730375-0377037A-037D038403860388-038A038C038E-03A103A3-03E103F0-03FF1D26-1D2A1D5D-1D611D66-1D6A1DBF1F00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FC41FC6-1FD31FD6-1FDB1FDD-1FEF1FF2-1FF41FF6-1FFE2126",
            Gujarati: "0A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABC-0AC50AC7-0AC90ACB-0ACD0AD00AE0-0AE30AE6-0AF1",
            Gurmukhi: "0A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3C0A3E-0A420A470A480A4B-0A4D0A510A59-0A5C0A5E0A66-0A75",
            Han: "2E80-2E992E9B-2EF32F00-2FD5300530073021-30293038-303B3400-4DB54E00-9FCCF900-FA6DFA70-FAD9",
            Hangul: "1100-11FF302E302F3131-318E3200-321E3260-327EA960-A97CAC00-D7A3D7B0-D7C6D7CB-D7FBFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",
            Hanunoo: "1720-1734",
            Hebrew: "0591-05C705D0-05EA05F0-05F4FB1D-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FB4F",
            Hiragana: "3041-3096309D-309F",
            Inherited: "0300-036F04850486064B-0655065F0670095109521CD0-1CD21CD4-1CE01CE2-1CE81CED1CF41DC0-1DE61DFC-1DFF200C200D20D0-20F0302A-302D3099309AFE00-FE0FFE20-FE26",
            Javanese: "A980-A9CDA9CF-A9D9A9DEA9DF",
            Kannada: "0C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBC-0CC40CC6-0CC80CCA-0CCD0CD50CD60CDE0CE0-0CE30CE6-0CEF0CF10CF2",
            Katakana: "30A1-30FA30FD-30FF31F0-31FF32D0-32FE3300-3357FF66-FF6FFF71-FF9D",
            Kayah_Li: "A900-A92F",
            Khmer: "1780-17DD17E0-17E917F0-17F919E0-19FF",
            Lao: "0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60EC8-0ECD0ED0-0ED90EDC-0EDF",
            Latin: "0041-005A0061-007A00AA00BA00C0-00D600D8-00F600F8-02B802E0-02E41D00-1D251D2C-1D5C1D62-1D651D6B-1D771D79-1DBE1E00-1EFF2071207F2090-209C212A212B2132214E2160-21882C60-2C7FA722-A787A78B-A78EA790-A793A7A0-A7AAA7F8-A7FFFB00-FB06FF21-FF3AFF41-FF5A",
            Lepcha: "1C00-1C371C3B-1C491C4D-1C4F",
            Limbu: "1900-191C1920-192B1930-193B19401944-194F",
            Lisu: "A4D0-A4FF",
            Malayalam: "0D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4E0D570D60-0D630D66-0D750D79-0D7F",
            Mandaic: "0840-085B085E",
            Meetei_Mayek: "AAE0-AAF6ABC0-ABEDABF0-ABF9",
            Mongolian: "1800180118041806-180E1810-18191820-18771880-18AA",
            Myanmar: "1000-109FAA60-AA7B",
            New_Tai_Lue: "1980-19AB19B0-19C919D0-19DA19DE19DF",
            Nko: "07C0-07FA",
            Ogham: "1680-169C",
            Ol_Chiki: "1C50-1C7F",
            Oriya: "0B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3C-0B440B470B480B4B-0B4D0B560B570B5C0B5D0B5F-0B630B66-0B77",
            Phags_Pa: "A840-A877",
            Rejang: "A930-A953A95F",
            Runic: "16A0-16EA16EE-16F0",
            Samaritan: "0800-082D0830-083E",
            Saurashtra: "A880-A8C4A8CE-A8D9",
            Sinhala: "0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCA0DCF-0DD40DD60DD8-0DDF0DF2-0DF4",
            Sundanese: "1B80-1BBF1CC0-1CC7",
            Syloti_Nagri: "A800-A82B",
            Syriac: "0700-070D070F-074A074D-074F",
            Tagalog: "1700-170C170E-1714",
            Tagbanwa: "1760-176C176E-177017721773",
            Tai_Le: "1950-196D1970-1974",
            Tai_Tham: "1A20-1A5E1A60-1A7C1A7F-1A891A90-1A991AA0-1AAD",
            Tai_Viet: "AA80-AAC2AADB-AADF",
            Tamil: "0B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCD0BD00BD70BE6-0BFA",
            Telugu: "0C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4D0C550C560C580C590C60-0C630C66-0C6F0C78-0C7F",
            Thaana: "0780-07B1",
            Thai: "0E01-0E3A0E40-0E5B",
            Tibetan: "0F00-0F470F49-0F6C0F71-0F970F99-0FBC0FBE-0FCC0FCE-0FD40FD90FDA",
            Tifinagh: "2D30-2D672D6F2D702D7F",
            Vai: "A500-A62B",
            Yi: "A000-A48CA490-A4C6"
        })
    }(n),
    /*!
     * XRegExp Unicode Blocks v1.2.0
     * (c) 2010-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Uses Unicode 6.1 <http://unicode.org/>
     */

    function (e) {
        "use strict";
        if (!e.addUnicodePackage) throw new ReferenceError("Unicode Base must be loaded before Unicode Blocks");
        e.install("extensibility"), e.addUnicodePackage({
            InBasic_Latin: "0000-007F",
            InLatin_1_Supplement: "0080-00FF",
            InLatin_Extended_A: "0100-017F",
            InLatin_Extended_B: "0180-024F",
            InIPA_Extensions: "0250-02AF",
            InSpacing_Modifier_Letters: "02B0-02FF",
            InCombining_Diacritical_Marks: "0300-036F",
            InGreek_and_Coptic: "0370-03FF",
            InCyrillic: "0400-04FF",
            InCyrillic_Supplement: "0500-052F",
            InArmenian: "0530-058F",
            InHebrew: "0590-05FF",
            InArabic: "0600-06FF",
            InSyriac: "0700-074F",
            InArabic_Supplement: "0750-077F",
            InThaana: "0780-07BF",
            InNKo: "07C0-07FF",
            InSamaritan: "0800-083F",
            InMandaic: "0840-085F",
            InArabic_Extended_A: "08A0-08FF",
            InDevanagari: "0900-097F",
            InBengali: "0980-09FF",
            InGurmukhi: "0A00-0A7F",
            InGujarati: "0A80-0AFF",
            InOriya: "0B00-0B7F",
            InTamil: "0B80-0BFF",
            InTelugu: "0C00-0C7F",
            InKannada: "0C80-0CFF",
            InMalayalam: "0D00-0D7F",
            InSinhala: "0D80-0DFF",
            InThai: "0E00-0E7F",
            InLao: "0E80-0EFF",
            InTibetan: "0F00-0FFF",
            InMyanmar: "1000-109F",
            InGeorgian: "10A0-10FF",
            InHangul_Jamo: "1100-11FF",
            InEthiopic: "1200-137F",
            InEthiopic_Supplement: "1380-139F",
            InCherokee: "13A0-13FF",
            InUnified_Canadian_Aboriginal_Syllabics: "1400-167F",
            InOgham: "1680-169F",
            InRunic: "16A0-16FF",
            InTagalog: "1700-171F",
            InHanunoo: "1720-173F",
            InBuhid: "1740-175F",
            InTagbanwa: "1760-177F",
            InKhmer: "1780-17FF",
            InMongolian: "1800-18AF",
            InUnified_Canadian_Aboriginal_Syllabics_Extended: "18B0-18FF",
            InLimbu: "1900-194F",
            InTai_Le: "1950-197F",
            InNew_Tai_Lue: "1980-19DF",
            InKhmer_Symbols: "19E0-19FF",
            InBuginese: "1A00-1A1F",
            InTai_Tham: "1A20-1AAF",
            InBalinese: "1B00-1B7F",
            InSundanese: "1B80-1BBF",
            InBatak: "1BC0-1BFF",
            InLepcha: "1C00-1C4F",
            InOl_Chiki: "1C50-1C7F",
            InSundanese_Supplement: "1CC0-1CCF",
            InVedic_Extensions: "1CD0-1CFF",
            InPhonetic_Extensions: "1D00-1D7F",
            InPhonetic_Extensions_Supplement: "1D80-1DBF",
            InCombining_Diacritical_Marks_Supplement: "1DC0-1DFF",
            InLatin_Extended_Additional: "1E00-1EFF",
            InGreek_Extended: "1F00-1FFF",
            InGeneral_Punctuation: "2000-206F",
            InSuperscripts_and_Subscripts: "2070-209F",
            InCurrency_Symbols: "20A0-20CF",
            InCombining_Diacritical_Marks_for_Symbols: "20D0-20FF",
            InLetterlike_Symbols: "2100-214F",
            InNumber_Forms: "2150-218F",
            InArrows: "2190-21FF",
            InMathematical_Operators: "2200-22FF",
            InMiscellaneous_Technical: "2300-23FF",
            InControl_Pictures: "2400-243F",
            InOptical_Character_Recognition: "2440-245F",
            InEnclosed_Alphanumerics: "2460-24FF",
            InBox_Drawing: "2500-257F",
            InBlock_Elements: "2580-259F",
            InGeometric_Shapes: "25A0-25FF",
            InMiscellaneous_Symbols: "2600-26FF",
            InDingbats: "2700-27BF",
            InMiscellaneous_Mathematical_Symbols_A: "27C0-27EF",
            InSupplemental_Arrows_A: "27F0-27FF",
            InBraille_Patterns: "2800-28FF",
            InSupplemental_Arrows_B: "2900-297F",
            InMiscellaneous_Mathematical_Symbols_B: "2980-29FF",
            InSupplemental_Mathematical_Operators: "2A00-2AFF",
            InMiscellaneous_Symbols_and_Arrows: "2B00-2BFF",
            InGlagolitic: "2C00-2C5F",
            InLatin_Extended_C: "2C60-2C7F",
            InCoptic: "2C80-2CFF",
            InGeorgian_Supplement: "2D00-2D2F",
            InTifinagh: "2D30-2D7F",
            InEthiopic_Extended: "2D80-2DDF",
            InCyrillic_Extended_A: "2DE0-2DFF",
            InSupplemental_Punctuation: "2E00-2E7F",
            InCJK_Radicals_Supplement: "2E80-2EFF",
            InKangxi_Radicals: "2F00-2FDF",
            InIdeographic_Description_Characters: "2FF0-2FFF",
            InCJK_Symbols_and_Punctuation: "3000-303F",
            InHiragana: "3040-309F",
            InKatakana: "30A0-30FF",
            InBopomofo: "3100-312F",
            InHangul_Compatibility_Jamo: "3130-318F",
            InKanbun: "3190-319F",
            InBopomofo_Extended: "31A0-31BF",
            InCJK_Strokes: "31C0-31EF",
            InKatakana_Phonetic_Extensions: "31F0-31FF",
            InEnclosed_CJK_Letters_and_Months: "3200-32FF",
            InCJK_Compatibility: "3300-33FF",
            InCJK_Unified_Ideographs_Extension_A: "3400-4DBF",
            InYijing_Hexagram_Symbols: "4DC0-4DFF",
            InCJK_Unified_Ideographs: "4E00-9FFF",
            InYi_Syllables: "A000-A48F",
            InYi_Radicals: "A490-A4CF",
            InLisu: "A4D0-A4FF",
            InVai: "A500-A63F",
            InCyrillic_Extended_B: "A640-A69F",
            InBamum: "A6A0-A6FF",
            InModifier_Tone_Letters: "A700-A71F",
            InLatin_Extended_D: "A720-A7FF",
            InSyloti_Nagri: "A800-A82F",
            InCommon_Indic_Number_Forms: "A830-A83F",
            InPhags_pa: "A840-A87F",
            InSaurashtra: "A880-A8DF",
            InDevanagari_Extended: "A8E0-A8FF",
            InKayah_Li: "A900-A92F",
            InRejang: "A930-A95F",
            InHangul_Jamo_Extended_A: "A960-A97F",
            InJavanese: "A980-A9DF",
            InCham: "AA00-AA5F",
            InMyanmar_Extended_A: "AA60-AA7F",
            InTai_Viet: "AA80-AADF",
            InMeetei_Mayek_Extensions: "AAE0-AAFF",
            InEthiopic_Extended_A: "AB00-AB2F",
            InMeetei_Mayek: "ABC0-ABFF",
            InHangul_Syllables: "AC00-D7AF",
            InHangul_Jamo_Extended_B: "D7B0-D7FF",
            InHigh_Surrogates: "D800-DB7F",
            InHigh_Private_Use_Surrogates: "DB80-DBFF",
            InLow_Surrogates: "DC00-DFFF",
            InPrivate_Use_Area: "E000-F8FF",
            InCJK_Compatibility_Ideographs: "F900-FAFF",
            InAlphabetic_Presentation_Forms: "FB00-FB4F",
            InArabic_Presentation_Forms_A: "FB50-FDFF",
            InVariation_Selectors: "FE00-FE0F",
            InVertical_Forms: "FE10-FE1F",
            InCombining_Half_Marks: "FE20-FE2F",
            InCJK_Compatibility_Forms: "FE30-FE4F",
            InSmall_Form_Variants: "FE50-FE6F",
            InArabic_Presentation_Forms_B: "FE70-FEFF",
            InHalfwidth_and_Fullwidth_Forms: "FF00-FFEF",
            InSpecials: "FFF0-FFFF"
        })
    }(n),
    /*!
     * XRegExp Unicode Properties v1.0.0
     * (c) 2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Uses Unicode 6.1 <http://unicode.org/>
     */

    function (e) {
        "use strict";
        if (!e.addUnicodePackage) throw new ReferenceError("Unicode Base must be loaded before Unicode Properties");
        e.install("extensibility"), e.addUnicodePackage({
            Alphabetic: "0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE03450370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05270531-055605590561-058705B0-05BD05BF05C105C205C405C505C705D0-05EA05F0-05F20610-061A0620-06570659-065F066E-06D306D5-06DC06E1-06E806ED-06EF06FA-06FC06FF0710-073F074D-07B107CA-07EA07F407F507FA0800-0817081A-082C0840-085808A008A2-08AC08E4-08E908F0-08FE0900-093B093D-094C094E-09500955-09630971-09770979-097F0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BD-09C409C709C809CB09CC09CE09D709DC09DD09DF-09E309F009F10A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3E-0A420A470A480A4B0A4C0A510A59-0A5C0A5E0A70-0A750A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD-0AC50AC7-0AC90ACB0ACC0AD00AE0-0AE30B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D-0B440B470B480B4B0B4C0B560B570B5C0B5D0B5F-0B630B710B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCC0BD00BD70C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4C0C550C560C580C590C60-0C630C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD-0CC40CC6-0CC80CCA-0CCC0CD50CD60CDE0CE0-0CE30CF10CF20D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4C0D4E0D570D60-0D630D7A-0D7F0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCF-0DD40DD60DD8-0DDF0DF20DF30E01-0E3A0E40-0E460E4D0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60ECD0EDC-0EDF0F000F40-0F470F49-0F6C0F71-0F810F88-0F970F99-0FBC1000-10361038103B-103F1050-10621065-1068106E-1086108E109C109D10A0-10C510C710CD10D0-10FA10FC-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135F1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA16EE-16F01700-170C170E-17131720-17331740-17531760-176C176E-1770177217731780-17B317B6-17C817D717DC1820-18771880-18AA18B0-18F51900-191C1920-192B1930-19381950-196D1970-19741980-19AB19B0-19C91A00-1A1B1A20-1A5E1A61-1A741AA71B00-1B331B35-1B431B45-1B4B1B80-1BA91BAC-1BAF1BBA-1BE51BE7-1BF11C00-1C351C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF31CF51CF61D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209C21022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E2160-218824B6-24E92C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2CF22CF32D00-2D252D272D2D2D30-2D672D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2DE0-2DFF2E2F3005-30073021-30293031-30353038-303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A66EA674-A67BA67F-A697A69F-A6EFA717-A71FA722-A788A78B-A78EA790-A793A7A0-A7AAA7F8-A801A803-A805A807-A80AA80C-A827A840-A873A880-A8C3A8F2-A8F7A8FBA90A-A92AA930-A952A960-A97CA980-A9B2A9B4-A9BFA9CFAA00-AA36AA40-AA4DAA60-AA76AA7AAA80-AABEAAC0AAC2AADB-AADDAAE0-AAEFAAF2-AAF5AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABEAAC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1D-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",
            Uppercase: "0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E05200522052405260531-055610A0-10C510C710CD1E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F21452160-216F218324B6-24CF2C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CED2CF2A640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA660A662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BA78DA790A792A7A0A7A2A7A4A7A6A7A8A7AAFF21-FF3A",
            Lowercase: "0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02B802C002C102E0-02E40345037103730377037A-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F05210523052505270561-05871D00-1DBF1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF72071207F2090-209C210A210E210F2113212F21342139213C213D2146-2149214E2170-217F218424D0-24E92C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7D2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2CF32D00-2D252D272D2DA641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA661A663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76F-A778A77AA77CA77FA781A783A785A787A78CA78EA791A793A7A1A7A3A7A5A7A7A7A9A7F8-A7FAFB00-FB06FB13-FB17FF41-FF5A",
            White_Space: "0009-000D0020008500A01680180E2000-200A20282029202F205F3000",
            Noncharacter_Code_Point: "FDD0-FDEFFFFEFFFF",
            Default_Ignorable_Code_Point: "00AD034F115F116017B417B5180B-180D200B-200F202A-202E2060-206F3164FE00-FE0FFEFFFFA0FFF0-FFF8",
            Any: "0000-FFFF",
            Ascii: "0000-007F",
            Assigned: "0000-0377037A-037E0384-038A038C038E-03A103A3-05270531-05560559-055F0561-05870589058A058F0591-05C705D0-05EA05F0-05F40600-06040606-061B061E-070D070F-074A074D-07B107C0-07FA0800-082D0830-083E0840-085B085E08A008A2-08AC08E4-08FE0900-09770979-097F0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BC-09C409C709C809CB-09CE09D709DC09DD09DF-09E309E6-09FB0A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3C0A3E-0A420A470A480A4B-0A4D0A510A59-0A5C0A5E0A66-0A750A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABC-0AC50AC7-0AC90ACB-0ACD0AD00AE0-0AE30AE6-0AF10B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3C-0B440B470B480B4B-0B4D0B560B570B5C0B5D0B5F-0B630B66-0B770B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCD0BD00BD70BE6-0BFA0C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4D0C550C560C580C590C60-0C630C66-0C6F0C78-0C7F0C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBC-0CC40CC6-0CC80CCA-0CCD0CD50CD60CDE0CE0-0CE30CE6-0CEF0CF10CF20D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4E0D570D60-0D630D66-0D750D79-0D7F0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCA0DCF-0DD40DD60DD8-0DDF0DF2-0DF40E01-0E3A0E3F-0E5B0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60EC8-0ECD0ED0-0ED90EDC-0EDF0F00-0F470F49-0F6C0F71-0F970F99-0FBC0FBE-0FCC0FCE-0FDA1000-10C510C710CD10D0-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135D-137C1380-139913A0-13F41400-169C16A0-16F01700-170C170E-17141720-17361740-17531760-176C176E-1770177217731780-17DD17E0-17E917F0-17F91800-180E1810-18191820-18771880-18AA18B0-18F51900-191C1920-192B1930-193B19401944-196D1970-19741980-19AB19B0-19C919D0-19DA19DE-1A1B1A1E-1A5E1A60-1A7C1A7F-1A891A90-1A991AA0-1AAD1B00-1B4B1B50-1B7C1B80-1BF31BFC-1C371C3B-1C491C4D-1C7F1CC0-1CC71CD0-1CF61D00-1DE61DFC-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FC41FC6-1FD31FD6-1FDB1FDD-1FEF1FF2-1FF41FF6-1FFE2000-2064206A-20712074-208E2090-209C20A0-20B920D0-20F02100-21892190-23F32400-24262440-244A2460-26FF2701-2B4C2B50-2B592C00-2C2E2C30-2C5E2C60-2CF32CF9-2D252D272D2D2D30-2D672D6F2D702D7F-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2DE0-2E3B2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB3000-303F3041-30963099-30FF3105-312D3131-318E3190-31BA31C0-31E331F0-321E3220-32FE3300-4DB54DC0-9FCCA000-A48CA490-A4C6A4D0-A62BA640-A697A69F-A6F7A700-A78EA790-A793A7A0-A7AAA7F8-A82BA830-A839A840-A877A880-A8C4A8CE-A8D9A8E0-A8FBA900-A953A95F-A97CA980-A9CDA9CF-A9D9A9DEA9DFAA00-AA36AA40-AA4DAA50-AA59AA5C-AA7BAA80-AAC2AADB-AAF6AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABEDABF0-ABF9AC00-D7A3D7B0-D7C6D7CB-D7FBD800-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1D-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBC1FBD3-FD3FFD50-FD8FFD92-FDC7FDF0-FDFDFE00-FE19FE20-FE26FE30-FE52FE54-FE66FE68-FE6BFE70-FE74FE76-FEFCFEFFFF01-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDCFFE0-FFE6FFE8-FFEEFFF9-FFFD"
        })
    }(n),
    /*!
     * XRegExp.matchRecursive v0.2.0
     * (c) 2009-2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     */

    function (e) {
        "use strict";

        function t(e, t, n, r) {
            return {
                value: e,
                name: t,
                start: n,
                end: r
            }
        }
        e.matchRecursive = function (n, r, o, a, i) {
            a = a || "", i = i || {};
            var s, c, u, l, d, p = a.indexOf("g") > -1,
                h = a.indexOf("y") > -1,
                g = a.replace(/y/g, ""),
                f = i.escapeChar,
                m = i.valueNames,
                b = [],
                y = 0,
                _ = 0,
                A = 0,
                E = 0;
            if (r = e(r, g), o = e(o, g), f) {
                if (f.length > 1) throw new SyntaxError("can't use more than one escape character");
                f = e.escape(f), d = new RegExp("(?:" + f + "[\\S\\s]|(?:(?!" + e.union([r, o]).source + ")[^" + f + "])+)+", a.replace(/[^im]+/g, ""))
            }
            for (;;) {
                if (f && (A += (e.exec(n, d, A, "sticky") || [""])[0].length), u = e.exec(n, r, A), l = e.exec(n, o, A), u && l && (u.index <= l.index ? l = null : u = null), u || l) _ = (u || l).index, A = _ + (u || l)[0].length;
                else if (!y) break;
                if (h && !y && _ > E) break;
                if (u) y || (s = _, c = A), ++y;
                else {
                    if (!l || !y) throw new Error("string contains unbalanced delimiters");
                    if (!--y && (m ? (m[0] && s > E && b.push(t(m[0], n.slice(E, s), E, s)), m[1] && b.push(t(m[1], n.slice(s, c), s, c)), m[2] && b.push(t(m[2], n.slice(c, _), c, _)), m[3] && b.push(t(m[3], n.slice(_, A), _, A))) : b.push(n.slice(c, _)), E = A, !p)) break
                }
                _ === A && ++A
            }
            return p && !h && m && m[0] && n.length > E && b.push(t(m[0], n.slice(E), E, n.length)), b
        }
    }(n),
    /*!
     * XRegExp.build v0.1.0
     * (c) 2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     * Inspired by RegExp.create by Lea Verou <http://lea.verou.me/>
     */

    function (e) {
        "use strict";

        function t(e) {
            var t = /^(?:\(\?:\))?\^/,
                n = /\$(?:\(\?:\))?$/;
            return n.test(e.replace(/\\[\s\S]/g, "")) ? e.replace(t, "").replace(n, "") : e
        }
        function n(t) {
            return e.isRegExp(t) ? t.xregexp && !t.xregexp.isNative ? t : e(t.source) : e(t)
        }
        var r = /(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,
            o = e.union([/\({{([\w$]+)}}\)|{{([\w$]+)}}/, r], "g");
        e.build = function (a, i, s) {
            var c, u, l, d, p = /^\(\?([\w$]+)\)/.exec(a),
                h = {},
                g = 0,
                f = 0,
                m = [0];
            p && (s = s || "", p[1].replace(/./g, function (e) {
                s += s.indexOf(e) > -1 ? "" : e
            }));
            for (d in i) i.hasOwnProperty(d) && (l = n(i[d]), h[d] = {
                pattern: t(l.source),
                names: l.xregexp.captureNames || []
            });
            return a = n(a), u = a.xregexp.captureNames || [], a = a.source.replace(o, function (e, t, n, o, a) {
                var i, s, l = t || n;
                if (l) {
                    if (!h.hasOwnProperty(l)) throw new ReferenceError("undefined property " + e);
                    return t ? (i = u[f], m[++f] = ++g, s = "(?<" + (i || l) + ">") : s = "(?:", c = g, s + h[l].pattern.replace(r, function (e, t, n) {
                        if (t) {
                            if (i = h[l].names[g - c], ++g, i) return "(?<" + i + ">"
                        } else if (n) return "\\" + (+n + c);
                        return e
                    }) + ")"
                }
                if (o) {
                    if (i = u[f], m[++f] = ++g, i) return "(?<" + i + ">"
                } else if (a) return "\\" + m[+a];
                return e
            }), e(a, s)
        }
    }(n),
    /*!
     * XRegExp Prototype Methods v1.0.0
     * (c) 2012 Steven Levithan <http://xregexp.com/>
     * MIT License
     */

    function (e) {
        "use strict";

        function t(e, t) {
            for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n])
        }
        t(e.prototype, {
            apply: function (e, t) {
                return this.test(t[0])
            },
            call: function (e, t) {
                return this.test(t)
            },
            forEach: function (t, n, r) {
                return e.forEach(t, this, n, r)
            },
            globalize: function () {
                return e.globalize(this)
            },
            xexec: function (t, n, r) {
                return e.exec(t, this, n, r)
            },
            xtest: function (t, n, r) {
                return e.test(t, this, n, r)
            }
        })
    }(n)
}, function (e, t, n) {
    (function (t, n) {
        (function (e, n, r, o) {
            "use strict";

            function a(e, t) {
                return "object" != typeof t && (t = t()), Object.keys(t).forEach(function (n) {
                    e[n] = t[n]
                }), e
            }
            function i(e) {
                return {
                    from: function (t) {
                        return e.prototype = Object.create(t.prototype), e.prototype.constructor = e, {
                            extend: function (n) {
                                a(e.prototype, "object" != typeof n ? n(t.prototype) : n)
                            }
                        }
                    }
                }
            }
            function s(e, t) {
                return t(e)
            }
            function c(t) {
                function n() {
                    r && St.on("versionchange", function (t) {
                        St.close(), t.newVersion && e.location.reload(!0)
                    })
                }
                function p(e) {
                    this._cfg = {
                        version: e,
                        storesSource: null,
                        dbschema: {},
                        tables: {},
                        contentUpgrade: null
                    }, this.stores({})
                }
                function f(e, t, n, r) {
                    if (0 === e) {
                        Object.keys(gt).forEach(function (e) {
                            D(t, e, gt[e].primKey, gt[e].indexes)
                        });
                        var o = St._createTransaction(Ct, mt, gt);
                        o.idbtrans = t, o.idbtrans.onerror = I(n, ["populating database"]), o.on("error").subscribe(n), $.newPSD(function () {
                            $.PSD.trans = o;
                            try {
                                St.on("populate").fire(o)
                            } catch (e) {
                                r.onerror = t.onerror = function (e) {
                                    e.preventDefault()
                                };
                                try {
                                    t.abort()
                                } catch (a) {}
                                t.db.close(), n(e)
                            }
                        })
                    } else {
                        var a = [],
                            i = ft.filter(function (t) {
                                return t._cfg.version === e
                            })[0];
                        if (!i) throw new ht("Dexie specification of currently installed DB version is missing");
                        gt = St._dbSchema = i._cfg.dbschema;
                        var c = !1,
                            u = ft.filter(function (t) {
                                return t._cfg.version > e
                            });
                        u.forEach(function (e) {
                            var r = gt,
                                o = e._cfg.dbschema;
                            ct(r, t), ct(o, t), gt = St._dbSchema = o;
                            var i = A(r, o);
                            i.add.forEach(function (e) {
                                a.push(function (t, n) {
                                    D(t, e[0], e[1].primKey, e[1].indexes), n()
                                })
                            }), i.change.forEach(function (e) {
                                if (e.recreate) throw new ht("Not yet support for changing primary key");
                                a.push(function (t, n) {
                                    var r = t.objectStore(e.name);
                                    e.add.forEach(function (e) {
                                        G(r, e)
                                    }), e.change.forEach(function (e) {
                                        r.deleteIndex(e.name), G(r, e)
                                    }), e.del.forEach(function (e) {
                                        r.deleteIndex(e)
                                    }), n()
                                })
                            }), e._cfg.contentUpgrade && a.push(function (t, r) {
                                c = !0;
                                var a = St._createTransaction(Ct, [].slice.call(t.db.objectStoreNames, 0), o);
                                a.idbtrans = t;
                                var i = 0;
                                a._promise = s(a._promise, function (e) {
                                    return function (t, n, o) {
                                        function a(e) {
                                            return function () {
                                                e.apply(this, arguments), 0 === --i && r()
                                            }
                                        }
                                        return ++i, e.call(this, t, function (e, t) {
                                            arguments[0] = a(e), arguments[1] = a(t), n.apply(this, arguments)
                                        }, o)
                                    }
                                }), t.onerror = I(n, ["running upgrader function for version", e._cfg.version]), a.on("error").subscribe(n), e._cfg.contentUpgrade(a), 0 === i && r()
                            }), c && it() || a.push(function (e, t) {
                                j(o, e), t()
                            })
                        });
                        var l = function () {
                                try {
                                    a.length ? a.shift()(t, l) : W(gt, t)
                                } catch (e) {
                                    r.onerror = t.onerror = function (e) {
                                        e.preventDefault()
                                    }, t.abort(), t.db.close(), n(e)
                                }
                            };
                        l()
                    }
                }
                function A(e, t) {
                    var n = {
                        del: [],
                        add: [],
                        change: []
                    };
                    for (var r in e) t[r] || n.del.push(r);
                    for (var r in t) {
                        var o = e[r],
                            a = t[r];
                        if (o) {
                            var i = {
                                name: r,
                                def: t[r],
                                recreate: !1,
                                del: [],
                                add: [],
                                change: []
                            };
                            if (o.primKey.src !== a.primKey.src) i.recreate = !0, n.change.push(i);
                            else {
                                var s = o.indexes.reduce(function (e, t) {
                                    return e[t.name] = t, e
                                }, {}),
                                    c = a.indexes.reduce(function (e, t) {
                                        return e[t.name] = t, e
                                    }, {});
                                for (var u in s) c[u] || i.del.push(u);
                                for (var u in c) {
                                    var l = s[u],
                                        d = c[u];
                                    l ? l.src !== d.src && i.change.push(d) : i.add.push(d)
                                }(i.recreate || i.del.length > 0 || i.add.length > 0 || i.change.length > 0) && n.change.push(i)
                            }
                        } else n.add.push([r, a])
                    }
                    return n
                }
                function D(e, t, n, r) {
                    var o = e.db.createObjectStore(t, n.keyPath ? {
                        keyPath: n.keyPath,
                        autoIncrement: n.auto
                    } : {
                        autoIncrement: n.auto
                    });
                    return r.forEach(function (e) {
                        G(o, e)
                    }), o
                }
                function W(e, t) {
                    Object.keys(e).forEach(function (n) {
                        t.db.objectStoreNames.contains(n) || D(t, n, e[n].primKey, e[n].indexes)
                    })
                }
                function j(e, t) {
                    for (var n = 0; n < t.db.objectStoreNames.length; ++n) {
                        var r = t.db.objectStoreNames[n];
                        (null === e[r] || e[r] === o) && t.db.deleteObjectStore(r)
                    }
                }
                function G(e, t) {
                    e.createIndex(t.name, t.keyPath, {
                        unique: t.unique,
                        multiEntry: t.multi
                    })
                }
                function K(e, t) {
                    throw new ht("Table " + t[0] + " not part of transaction. Original Scope Function Source: " + c.Promise.PSD.trans.scopeFunc.toString())
                }
                function H(e, t, n, r) {
                    this.name = e, this.schema = n, this.hook = bt[e] ? bt[e].hook : _(null, {
                        creating: [h, u],
                        reading: [d, l],
                        updating: [g, u],
                        deleting: [b, u]
                    }), this._tpf = t, this._collClass = r || q
                }
                function Y(e, t, n, r) {
                    H.call(this, e, t, n, r || X)
                }
                function V(e, t, n, r) {
                    function o(e, t, n, r) {
                        return a._promise(e, n, r)
                    }
                    var a = this;
                    this.db = St, this.mode = e, this.storeNames = t, this.idbtrans = null, this.on = _(this, ["complete", "error"], "abort"), this._reculock = 0, this._blockedFuncs = [], this._psd = null, this.active = !0, this._dbschema = n, r && (this.parent = r), this._tpf = o, this.tables = Object.create(yt);
                    for (var i = t.length - 1; - 1 !== i; --i) {
                        var s = t[i],
                            c = St._tableFactory(e, n[s], o);
                        this.tables[s] = c, this[s] || (this[s] = c)
                    }
                }
                function z(e, t, n) {
                    this._ctx = {
                        table: e,
                        index: ":id" === t ? null : t,
                        collClass: e._collClass,
                        or: n
                    }
                }
                function q(e, t) {
                    var n = e._ctx;
                    this._ctx = {
                        table: n.table,
                        index: n.index,
                        isPrimKey: !n.index || n.table.schema.primKey.keyPath && n.index === n.table.schema.primKey.name,
                        range: t,
                        op: "openCursor",
                        dir: "next",
                        unique: "",
                        algorithm: null,
                        filter: null,
                        isMatch: null,
                        offset: 0,
                        limit: 1 / 0,
                        error: null,
                        or: n.or
                    }
                }
                function X() {
                    q.apply(this, arguments)
                }
                function Z(e, t) {
                    return e._cfg.version - t._cfg.version
                }
                function J(e, t, n, r, o, a) {
                    n.forEach(function (n) {
                        var i = St._tableFactory(r, o[n], t);
                        e.forEach(function (e) {
                            e[n] || (a ? Object.defineProperty(e, n, {
                                configurable: !0,
                                enumerable: !0,
                                get: function () {
                                    return $.PSD && $.PSD.trans ? $.PSD.trans.tables[n] : i
                                }
                            }) : e[n] = i)
                        })
                    })
                }
                function Q(e) {
                    e.forEach(function (e) {
                        for (var t in e) e[t] instanceof H && delete e[t]
                    })
                }
                function et(e, t, n, r, o, a) {
                    var i = $.PSD;
                    a = a || l, e.onerror || (e.onerror = I(o)), e.onsuccess = t ? N(function () {
                        var i = e.result;
                        if (i) {
                            var s = function () {
                                    i["continue"]()
                                };
                            t(i, function (e) {
                                s = e
                            }, r, o) && n(a(i.value), i, function (e) {
                                s = e
                            }), s()
                        } else r()
                    }, o, i) : N(function () {
                        var t = e.result;
                        if (t) {
                            var o = function () {
                                    t["continue"]()
                                };
                            n(a(t.value), t, function (e) {
                                o = e
                            }), o()
                        } else r()
                    }, o, i)
                }
                function tt(e) {
                    var t = [];
                    return e.split(",").forEach(function (e) {
                        e = e.trim();
                        var n = e.replace("&", "").replace("++", "").replace("*", ""),
                            r = 0 !== n.indexOf("[") ? n : e.substring(e.indexOf("[") + 1, e.indexOf("]")).split("+");
                        t.push(new M(n, r || null, -1 !== e.indexOf("&"), -1 !== e.indexOf("*"), -1 !== e.indexOf("++"), Array.isArray(r), -1 !== r.indexOf(".")))
                    }), t
                }
                function nt(e, t) {
                    return t > e ? -1 : e > t ? 1 : 0
                }
                function rt(e, t) {
                    return t > e ? 1 : e > t ? -1 : 0
                }
                function ot(e) {
                    return function (t, n) {
                        for (var r = 0;;) {
                            var o = e(t[r], n[r]);
                            if (0 !== o) return o;
                            if (++r, r === t.length || r === n.length) return e(t.length, n.length)
                        }
                    }
                }
                function at(e, t) {
                    return e ? t ?
                    function () {
                        return e.apply(this, arguments) && t.apply(this, arguments)
                    } : e : t
                }
                function it() {
                    return navigator.userAgent.indexOf("Trident") >= 0 || navigator.userAgent.indexOf("MSIE") >= 0
                }
                function st() {
                    if (St.verno = _t.version / 10, St._dbSchema = gt = {}, mt = [].slice.call(_t.objectStoreNames, 0), 0 !== mt.length) {
                        var e = _t.transaction(U(mt), "readonly");
                        mt.forEach(function (t) {
                            for (var n = e.objectStore(t), r = n.keyPath, o = r && "string" == typeof r && -1 !== r.indexOf("."), a = new M(r, r || "", !1, !1, !! n.autoIncrement, r && "string" != typeof r, o), i = [], s = 0; s < n.indexNames.length; ++s) {
                                var c = n.index(n.indexNames[s]);
                                r = c.keyPath, o = r && "string" == typeof r && -1 !== r.indexOf(".");
                                var u = new M(c.name, r, !! c.unique, !! c.multiEntry, !1, r && "string" != typeof r, o);
                                i.push(u)
                            }
                            gt[t] = new L(t, a, i, {})
                        }), J([bt], St._transPromiseFactory, Object.keys(gt), Ct, gt)
                    }
                }
                function ct(e, t) {
                    for (var n = t.db.objectStoreNames, r = 0; r < n.length; ++r) for (var o = n[r], a = t.objectStore(o), i = 0; i < a.indexNames.length; ++i) {
                        var s = a.indexNames[i],
                            c = a.index(s).keyPath,
                            u = "string" == typeof c ? c : "[" + [].slice.call(c).join("+") + "]";
                        if (e[o]) {
                            var l = e[o].idxByName[u];
                            l && (l.name = s)
                        }
                    }
                }
                var ut = c.dependencies,
                    lt = ut.indexedDB,
                    dt = ut.IDBKeyRange,
                    pt = (ut.IDBTransaction, ut.DOMError, ut.TypeError),
                    ht = ut.Error,
                    gt = this._dbSchema = {},
                    ft = [],
                    mt = [],
                    bt = {},
                    yt = {},
                    _t = null,
                    At = !0,
                    Et = null,
                    vt = !1,
                    Nt = "readonly",
                    Ct = "readwrite",
                    St = this,
                    Rt = [],
                    wt = !1;
                this.version = function (e) {
                    if (_t) throw new ht("Cannot add version when database is open");
                    this.verno = Math.max(this.verno, e);
                    var t = ft.filter(function (t) {
                        return t._cfg.version === e
                    })[0];
                    return t ? t : (t = new p(e), ft.push(t), ft.sort(Z), t)
                }, a(p.prototype, {
                    stores: function (e) {
                        this._cfg.storesSource = this._cfg.storesSource ? a(this._cfg.storesSource, e) : e;
                        var t = {};
                        ft.forEach(function (e) {
                            a(t, e._cfg.storesSource)
                        });
                        var n = this._cfg.dbschema = {};
                        return this._parseStoresSpec(t, n), gt = St._dbSchema = n, Q([bt, St, yt]), J([yt], K, Object.keys(n), Ct, n), J([bt, St, this._cfg.tables], St._transPromiseFactory, Object.keys(n), Ct, n, !0), mt = Object.keys(n), this
                    },
                    upgrade: function (e) {
                        var t = this;
                        return v(function () {
                            e(St._createTransaction(Ct, Object.keys(t._cfg.dbschema), t._cfg.dbschema))
                        }), this._cfg.contentUpgrade = e, this
                    },
                    _parseStoresSpec: function (e, t) {
                        Object.keys(e).forEach(function (n) {
                            if (null !== e[n]) {
                                var r = {},
                                    o = tt(e[n]),
                                    a = o.shift();
                                if (a.multi) throw new ht("Primary key cannot be multi-valued");
                                a.keyPath && a.auto && S(r, a.keyPath, 0), o.forEach(function (e) {
                                    if (e.auto) throw new ht("Only primary key can be marked as autoIncrement (++)");
                                    if (!e.keyPath) throw new ht("Index must have a name and cannot be an empty string");
                                    S(r, e.keyPath, e.compound ? e.keyPath.map(function () {
                                        return ""
                                    }) : "")
                                }), t[n] = new L(n, a, o, r)
                            }
                        })
                    }
                }), this._allTables = bt, this._tableFactory = function (e, t, n) {
                    return e === Nt ? new H(t.name, n, t, q) : new Y(t.name, n, t)
                }, this._createTransaction = function (e, t, n, r) {
                    return new V(e, t, n, r)
                }, this._transPromiseFactory = function (e, t, n) {
                    if (!At || $.PSD && $.PSD.letThrough) {
                        var r = St._createTransaction(e, t, gt);
                        return r._promise(e, function (e, t) {
                            r.error(function (e) {
                                St.on("error").fire(e)
                            }), n(function (t) {
                                r.complete(function () {
                                    e(t)
                                })
                            }, t, r)
                        })
                    }
                    var o = new $(function (r, a) {
                        Rt.push({
                            resume: function () {
                                var i = St._transPromiseFactory(e, t, n);
                                o.onuncatched = i.onuncatched, i.then(r, a)
                            }
                        })
                    });
                    return o
                }, this._whenReady = function (e) {
                    return new $(!At || $.PSD && $.PSD.letThrough ? e : function (t, n) {
                        v(function () {
                            new $(function () {
                                e(t, n)
                            })
                        }), Rt.push({
                            resume: function () {
                                e(t, n)
                            }
                        })
                    })
                }, this.verno = 0, this.open = function () {
                    return new $(function (e, n) {
                        function r(e) {
                            vt = !1, Et = e, At = !1, n(Et), Rt.forEach(function (e) {
                                e.resume()
                            }), Rt = []
                        }
                        if (_t || vt) throw new ht("Database already opened or being opened");
                        try {
                            if (Et = null, vt = !0, 0 === ft.length && (wt = !0), !lt) throw new ht("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using Safari, make sure to include indexedDB polyfill.");
                            var o = !1,
                                a = wt ? lt.open(t) : lt.open(t, Math.round(10 * St.verno));
                            a.onerror = I(r, ["opening database", t]), a.onblocked = function (e) {
                                St.on("blocked").fire(e)
                            }, a.onupgradeneeded = N(function (e) {
                                if (wt && !St._allowEmptyDB) {
                                    a.onerror = function (e) {
                                        e.preventDefault()
                                    }, a.transaction.abort(), a.result.close();
                                    var n = lt.deleteDatabase(t);
                                    n.onsuccess = n.onerror = function () {
                                        r(new ht("Database '" + t + "' doesnt exist"))
                                    }
                                } else {
                                    0 === e.oldVersion && (o = !0), a.transaction.onerror = I(r);
                                    var i = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;
                                    f(i / 10, a.transaction, r, a)
                                }
                            }, r), a.onsuccess = N(function () {
                                vt = !1, _t = a.result, wt ? st() : _t.objectStoreNames.length > 0 && ct(gt, _t.transaction(U(_t.objectStoreNames), Nt)), _t.onversionchange = St.on("versionchange").fire, O(function (e) {
                                    return -1 === e.indexOf(t) ? e.push(t) : void 0
                                }), $.newPSD(function () {
                                    function t() {
                                        At = !1, Rt.forEach(function (e) {
                                            e.resume()
                                        }), Rt = [], e()
                                    }
                                    $.PSD.letThrough = !0;
                                    try {
                                        var n = St.on.ready.fire();
                                        n && "function" == typeof n.then ? n.then(t, function (e) {
                                            _t.close(), _t = null, r(e)
                                        }) : E(t)
                                    } catch (o) {
                                        r(o)
                                    }
                                })
                            }, r)
                        } catch (i) {
                            r(i)
                        }
                    })
                }, this.close = function () {
                    _t && (_t.close(), _t = null, At = !0, Et = null)
                }, this["delete"] = function () {
                    var e = arguments;
                    return new $(function (n, r) {
                        function o() {
                            St.close();
                            var e = lt.deleteDatabase(t);
                            e.onsuccess = function () {
                                O(function (e) {
                                    var n = e.indexOf(t);
                                    return n >= 0 ? e.splice(n, 1) : void 0
                                }), n()
                            }, e.onerror = I(r, ["deleting", t]), e.onblocked = function () {
                                St.on("blocked").fire()
                            }
                        }
                        if (e.length > 0) throw new ht("Arguments not allowed in db.delete()");
                        vt ? Rt.push({
                            resume: o
                        }) : o()
                    })
                }, this.backendDB = function () {
                    return _t
                }, this.isOpen = function () {
                    return null !== _t
                }, this.hasFailed = function () {
                    return null !== Et
                }, this.name = t, Object.defineProperty(this, "tables", {
                    get: function () {
                        return Object.keys(bt).map(function (e) {
                            return bt[e]
                        })
                    }
                }), this.on = _(this, "error", "populate", "blocked", {
                    ready: [y, u],
                    versionchange: [m, u]
                }), this.on.ready.subscribe = s(this.on.ready.subscribe, function (e) {
                    return function (t, n) {
                        function r() {
                            return n || St.on.ready.unsubscribe(r), t.apply(this, arguments)
                        }
                        e.call(this, r), St.isOpen() && (At ? Rt.push({
                            resume: r
                        }) : r())
                    }
                }), v(function () {
                    St.on("populate").fire(St._createTransaction(Ct, mt, gt)), St.on("error").fire(new ht)
                }), this.transaction = function (e, t, n) {
                    function r(t, r) {
                        var a = null;
                        try {
                            if (c) throw c;
                            a = St._createTransaction(e, u, gt, o);
                            var i = u.map(function (e) {
                                return a.tables[e]
                            });
                            i.push(a);
                            var l, d = 0;
                            $.newPSD(function () {
                                $.PSD.trans = a, a.scopeFunc = n, o && (a.idbtrans = o.idbtrans, a._promise = s(a._promise, function (e) {
                                    return function (t, n, r) {
                                        function o(e) {
                                            return function (t) {
                                                var n = e(t);
                                                return 0 === --d && a.active && (a.active = !1, a.on.complete.fire()), n
                                            }
                                        }
                                        return ++d, e.call(this, t, function (e, t, r) {
                                            return n(o(e), o(t), r)
                                        }, r)
                                    }
                                })), a.complete(function () {
                                    t(l)
                                }), a.error(function (e) {
                                    a.idbtrans.onerror = k, a.abort(), o && (o.active = !1, o.on.error.fire(e));
                                    var t = r(e);
                                    o || t || St.on.error.fire(e)
                                }), l = n.apply(a, i)
                            }), (!a.idbtrans || o && 0 === d) && a._nop()
                        } catch (p) {
                            a && a.idbtrans && (a.idbtrans.onerror = k), a && a.abort(), o && o.on.error.fire(p), E(function () {
                                r(p) || St.on("error").fire(p)
                            })
                        }
                    }
                    t = [].slice.call(arguments, 1, arguments.length - 1), n = arguments[arguments.length - 1];
                    var o = $.PSD && $.PSD.trans; - 1 !== e.indexOf("!") && (o = null);
                    var a = -1 !== e.indexOf("?");
                    e = e.replace("!", "").replace("?", "");
                    var i = Array.isArray(t[0]) ? t.reduce(function (e, t) {
                        return e.concat(t)
                    }) : t,
                        c = null,
                        u = i.map(function (e) {
                            return "string" == typeof e ? e : (e instanceof H || (c = c || new pt("Invalid type. Arguments following mode must be instances of Table or String")), e.name)
                        });
                    return "r" == e || e == Nt ? e = Nt : "rw" == e || e == Ct ? e = Ct : c = new ht("Invalid transaction mode: " + e), o && (c || (o.db !== St && (a ? o = null : c = new ht("Current transaction bound to different database instance")), o && o.mode === Nt && e === Ct && (a ? o = null : c = c || new ht("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY")), o && u.forEach(function (e) {
                        o.tables.hasOwnProperty(e) || (a ? o = null : c = c || new ht("Table " + e + " not included in parent transaction. Parent Transaction function: " + o.scopeFunc.toString()))
                    }))), o ? o._promise(e, r, "lock") : St._whenReady(r)
                }, this.table = function (e) {
                    if (!wt && !bt.hasOwnProperty(e)) throw new ht("Table does not exist");
                    return bt[e]
                }, a(H.prototype, function () {
                    function e() {
                        throw new ht("Current Transaction is READONLY")
                    }
                    return {
                        _trans: function (e, t, n) {
                            return this._tpf(e, [this.name], t, n)
                        },
                        _idbstore: function (e, t, n) {
                            var r = this;
                            return this._tpf(e, [this.name], function (e, n, o) {
                                t(e, n, o.idbtrans.objectStore(r.name), o)
                            }, n)
                        },
                        get: function (e, t) {
                            var n = this;
                            return v(function () {
                                t(n.schema.instanceTemplate)
                            }), this._idbstore(Nt, function (t, r, o) {
                                var a = o.get(e);
                                a.onerror = I(r, ["getting", e, "from", n.name]), a.onsuccess = function () {
                                    t(n.hook.reading.fire(a.result))
                                }
                            }).then(t)
                        },
                        where: function (e) {
                            return new z(this, e)
                        },
                        count: function (e) {
                            return this.toCollection().count(e)
                        },
                        offset: function (e) {
                            return this.toCollection().offset(e)
                        },
                        limit: function (e) {
                            return this.toCollection().limit(e)
                        },
                        reverse: function () {
                            return this.toCollection().reverse()
                        },
                        filter: function (e) {
                            return this.toCollection().and(e)
                        },
                        each: function (e) {
                            var t = this;
                            return v(function () {
                                e(t.schema.instanceTemplate)
                            }), this._idbstore(Nt, function (n, r, o) {
                                var a = o.openCursor();
                                a.onerror = I(r, ["calling", "Table.each()", "on", t.name]), et(a, null, e, n, r, t.hook.reading.fire)
                            })
                        },
                        toArray: function (e) {
                            var t = this;
                            return v(function () {
                                e([t.schema.instanceTemplate])
                            }), this._idbstore(Nt, function (e, n, r) {
                                var o = [],
                                    a = r.openCursor();
                                a.onerror = I(n, ["calling", "Table.toArray()", "on", t.name]), et(a, null, function (e) {
                                    o.push(e)
                                }, function () {
                                    e(o)
                                }, n, t.hook.reading.fire)
                            }).then(e)
                        },
                        orderBy: function (e) {
                            return new this._collClass(new z(this, e))
                        },
                        toCollection: function () {
                            return new this._collClass(new z(this))
                        },
                        mapToClass: function (e, t) {
                            this.schema.mappedClass = e;
                            var n = Object.create(e.prototype);
                            this.schema.primKey.keyPath && (S(n, this.schema.primKey.keyPath, this.schema.primKey.auto ? 0 : ""), R(e.prototype, this.schema.primKey.keyPath)), t && B(n, t), this.schema.instanceTemplate = n;
                            var r = Object.setPrototypeOf ?
                            function (t) {
                                return t ? (Object.setPrototypeOf(t, e.prototype), t) : t
                            } : function (t) {
                                if (!t) return t;
                                var n = Object.create(e.prototype);
                                for (var r in t) t.hasOwnProperty(r) && (n[r] = t[r]);
                                return n
                            };
                            return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = r, this.hook("reading", r), e
                        },
                        defineClass: function (e) {
                            return this.mapToClass(c.defineClass(e), e)
                        },
                        add: e,
                        put: e,
                        "delete": e,
                        clear: e,
                        update: e
                    }
                }), i(Y).from(H).extend(function () {
                    return {
                        add: function (e, t) {
                            var n = this,
                                r = this.hook.creating.fire;
                            return this._idbstore(Ct, function (a, i, s, c) {
                                var l = {};
                                if (r !== u) {
                                    var d = t || (s.keyPath ? C(e, s.keyPath) : o),
                                        p = r.call(l, d, e, c);
                                    d === o && p !== o && (s.keyPath ? S(e, s.keyPath, p) : t = p)
                                }
                                var h = t ? s.add(e, t) : s.add(e);
                                h.onerror = I(function (e) {
                                    return l.onerror && l.onerror(e), i(e)
                                }, ["adding", e, "into", n.name]), h.onsuccess = function (t) {
                                    var n = s.keyPath;
                                    n && S(e, n, t.target.result), l.onsuccess && l.onsuccess(t.target.result), a(h.result)
                                }
                            })
                        },
                        put: function (e, t) {
                            var n = this,
                                r = this.hook.creating.fire,
                                a = this.hook.updating.fire;
                            return r !== u || a !== u ? this._trans(Ct, function (r, a, i) {
                                var s = t || n.schema.primKey.keyPath && C(e, n.schema.primKey.keyPath);
                                s === o ? i.tables[n.name].add(e).then(r, a) : (i._lock(), e = T(e), i.tables[n.name].where(":id").equals(s).modify(function () {
                                    this.value = e
                                }).then(function (r) {
                                    return 0 === r ? i.tables[n.name].add(e, t) : s
                                })["finally"](function () {
                                    i._unlock()
                                }).then(r, a))
                            }) : this._idbstore(Ct, function (r, o, a) {
                                var i = t ? a.put(e, t) : a.put(e);
                                i.onerror = I(o, ["putting", e, "into", n.name]), i.onsuccess = function (t) {
                                    var n = a.keyPath;
                                    n && S(e, n, t.target.result), r(i.result)
                                }
                            })
                        },
                        "delete": function (e) {
                            return this.hook.deleting.subscribers.length ? this.where(":id").equals(e)["delete"]() : this._idbstore(Ct, function (t, n, r) {
                                var o = r["delete"](e);
                                o.onerror = I(n, ["deleting", e, "from", r.name]), o.onsuccess = function () {
                                    t(o.result)
                                }
                            })
                        },
                        clear: function () {
                            return this.hook.deleting.subscribers.length ? this.toCollection()["delete"]() : this._idbstore(Ct, function (e, t, n) {
                                var r = n.clear();
                                r.onerror = I(t, ["clearing", n.name]), r.onsuccess = function () {
                                    e(r.result)
                                }
                            })
                        },
                        update: function (e, t) {
                            if ("object" != typeof t || Array.isArray(t)) throw new ht("db.update(keyOrObject, modifications). modifications must be an object.");
                            if ("object" != typeof e || Array.isArray(e)) return this.where(":id").equals(e).modify(t);
                            Object.keys(t).forEach(function (n) {
                                S(e, n, t[n])
                            });
                            var n = C(e, this.schema.primKey.keyPath);
                            return n === o && $.reject(new ht("Object does not contain its primary key")), this.where(":id").equals(n).modify(t)
                        }
                    }
                }), a(V.prototype, {
                    _lock: function () {
                        return ++this._reculock, 1 === this._reculock && $.PSD && ($.PSD.lockOwnerFor = this), this
                    },
                    _unlock: function () {
                        if (0 === --this._reculock) for ($.PSD && ($.PSD.lockOwnerFor = null); this._blockedFuncs.length > 0 && !this._locked();) {
                            var e = this._blockedFuncs.shift();
                            try {
                                e()
                            } catch (t) {}
                        }
                        return this
                    },
                    _locked: function () {
                        return this._reculock && (!$.PSD || $.PSD.lockOwnerFor !== this)
                    },
                    _nop: function (e) {
                        this.tables[this.storeNames[0]].get(0).then(e)
                    },
                    _promise: function (e, t, n) {
                        var r = this;
                        return $.newPSD(function () {
                            var o;
                            return r._locked() ? o = new $(function (o, a) {
                                r._blockedFuncs.push(function () {
                                    r._promise(e, t, n).then(o, a)
                                })
                            }) : (o = r.active ? new $(function (o, a) {
                                if (!r.idbtrans && e) {
                                    if (!_t) throw new ht(Et ? "Database not open. Following error in populate, ready or upgrade function made Dexie.open() fail: " + Et : "Database not open");
                                    var i = r.idbtrans = _t.transaction(U(r.storeNames), r.mode);
                                    i.onerror = function (e) {
                                        r.on("error").fire(e && e.target.error), e.preventDefault(), r.abort()
                                    }, i.onabort = function (e) {
                                        r.active = !1, r.on("abort").fire(e)
                                    }, i.oncomplete = function (e) {
                                        r.active = !1, r.on("complete").fire(e)
                                    }
                                }
                                n && r._lock();
                                try {
                                    t(o, a, r)
                                } catch (s) {
                                    c.spawn(function () {
                                        r.on("error").fire(s)
                                    }), r.abort(), a(s)
                                }
                            }) : $.reject(P(new ht("Transaction is inactive. Original Scope Function Source: " + r.scopeFunc.toString()))), r.active && n && o["finally"](function () {
                                r._unlock()
                            })), o.onuncatched = function (e) {
                                c.spawn(function () {
                                    r.on("error").fire(e)
                                }), r.abort()
                            }, o
                        })
                    },
                    complete: function (e) {
                        return this.on("complete", e)
                    },
                    error: function (e) {
                        return this.on("error", e)
                    },
                    abort: function () {
                        if (this.idbtrans && this.active) try {
                            this.active = !1, this.idbtrans.abort(), this.on.error.fire(new ht("Transaction Aborted"))
                        } catch (e) {}
                    },
                    table: function (e) {
                        if (!this.tables.hasOwnProperty(e)) throw new ht("Table " + e + " not in transaction");
                        return this.tables[e]
                    }
                }), a(z.prototype, function () {
                    function e(e, t) {
                        try {
                            throw t
                        } catch (n) {
                            e._ctx.error = n
                        }
                        return e
                    }
                    function t(e) {
                        return Array.prototype.slice.call(1 === e.length && Array.isArray(e[0]) ? e[0] : e)
                    }
                    function n(e) {
                        return "next" === e ?
                        function (e) {
                            return e.toUpperCase()
                        } : function (e) {
                            return e.toLowerCase()
                        }
                    }
                    function r(e) {
                        return "next" === e ?
                        function (e) {
                            return e.toLowerCase()
                        } : function (e) {
                            return e.toUpperCase()
                        }
                    }
                    function o(e, t, n, r, o, a) {
                        for (var i = Math.min(e.length, r.length), s = -1, c = 0; i > c; ++c) {
                            var u = t[c];
                            if (u !== r[c]) return o(e[c], n[c]) < 0 ? e.substr(0, c) + n[c] + n.substr(c + 1) : o(e[c], r[c]) < 0 ? e.substr(0, c) + r[c] + n.substr(c + 1) : s >= 0 ? e.substr(0, s) + t[s] + n.substr(s + 1) : null;
                            o(e[c], u) < 0 && (s = c)
                        }
                        return i < r.length && "next" === a ? e + n.substr(e.length) : i < e.length && "prev" === a ? e.substr(0, n.length) : 0 > s ? null : e.substr(0, s) + r[s] + n.substr(s + 1)
                    }
                    function a(e, t, a) {
                        function i(e) {
                            s = n(e), c = r(e), u = "next" === e ? nt : rt, l = s(a), d = c(a), p = e
                        }
                        var s, c, u, l, d, p;
                        i("next"), e._ondirectionchange = function (e) {
                            i(e)
                        }, e._addAlgorithm(function (e, n, r) {
                            var a = e.key;
                            if ("string" != typeof a) return !1;
                            var i = c(a);
                            if (t(i, d)) return n(function () {
                                e["continue"]()
                            }), !0;
                            var s = o(a, i, l, d, u, p);
                            return n(s ?
                            function () {
                                e["continue"](s)
                            } : r), !1
                        })
                    }
                    return {
                        between: function (e, t, n, r) {
                            return n = n !== !1, r = r === !0, e > t || e === t && (n || r) && (!n || !r) ? new this._ctx.collClass(this, dt.only(e)).limit(0) : new this._ctx.collClass(this, dt.bound(e, t, !n, !r))
                        },
                        equals: function (e) {
                            return new this._ctx.collClass(this, dt.only(e))
                        },
                        above: function (e) {
                            return new this._ctx.collClass(this, dt.lowerBound(e, !0))
                        },
                        aboveOrEqual: function (e) {
                            return new this._ctx.collClass(this, dt.lowerBound(e))
                        },
                        below: function (e) {
                            return new this._ctx.collClass(this, dt.upperBound(e, !0))
                        },
                        belowOrEqual: function (e) {
                            return new this._ctx.collClass(this, dt.upperBound(e))
                        },
                        startsWith: function (t) {
                            return "string" != typeof t ? e(new this._ctx.collClass(this), new pt("String expected")) : this.between(t, t + String.fromCharCode(65535), !0, !0)
                        },
                        startsWithIgnoreCase: function (t) {
                            if ("string" != typeof t) return e(new this._ctx.collClass(this), new pt("String expected"));
                            if ("" === t) return this.startsWith(t);
                            var n = new this._ctx.collClass(this, dt.bound(t.toUpperCase(), t.toLowerCase() + String.fromCharCode(65535)));
                            return a(n, function (e, t) {
                                return 0 === e.indexOf(t)
                            }, t), n._ondirectionchange = function () {
                                e(n, new ht("reverse() not supported with WhereClause.startsWithIgnoreCase()"))
                            }, n
                        },
                        equalsIgnoreCase: function (t) {
                            if ("string" != typeof t) return e(new this._ctx.collClass(this), new pt("String expected"));
                            var n = new this._ctx.collClass(this, dt.bound(t.toUpperCase(), t.toLowerCase()));
                            return a(n, function (e, t) {
                                return e === t
                            }, t), n
                        },
                        anyOf: function () {
                            var e = this._ctx,
                                n = e.table.schema,
                                r = e.index ? n.idxByName[e.index] : n.primKey,
                                o = r && r.compound,
                                a = t(arguments),
                                i = o ? ot(nt) : nt;
                            if (a.sort(i), 0 === a.length) return new this._ctx.collClass(this, dt.only("")).limit(0);
                            var s = new this._ctx.collClass(this, dt.bound(a[0], a[a.length - 1]));
                            s._ondirectionchange = function (e) {
                                i = "next" === e ? nt : rt, o && (i = ot(i)), a.sort(i)
                            };
                            var c = 0;
                            return s._addAlgorithm(function (e, t, n) {
                                for (var r = e.key; i(r, a[c]) > 0;) if (++c, c === a.length) return t(n), !1;
                                return 0 === i(r, a[c]) ? (t(function () {
                                    e["continue"]()
                                }), !0) : (t(function () {
                                    e["continue"](a[c])
                                }), !1)
                            }), s
                        }
                    }
                }), a(q.prototype, function () {
                    function e(e, t) {
                        e.filter = at(e.filter, t)
                    }
                    function t(e, t) {
                        e.isMatch = at(e.isMatch, t)
                    }
                    function n(e, t) {
                        if (e.isPrimKey) return t;
                        var n = e.table.schema.idxByName[e.index];
                        if (!n) throw new ht("KeyPath " + e.index + " on object store " + t.name + " is not indexed");
                        return e.isPrimKey ? t : t.index(n.name)
                    }
                    function r(e, t) {
                        return n(e, t)[e.op](e.range || null, e.dir + e.unique)
                    }
                    function o(e, t, n, o, a) {
                        e.or ? !
                        function () {
                            function i() {
                                2 === ++l && n()
                            }
                            function s(e, n, r) {
                                if (!c || c(n, r, i, o)) {
                                    var a = n.primaryKey.toString();
                                    u.hasOwnProperty(a) || (u[a] = !0, t(e, n, r))
                                }
                            }
                            var c = e.filter,
                                u = {},
                                l = (e.table.schema.primKey.keyPath, 0);
                            e.or._iterate(s, i, o, a), et(r(e, a), e.algorithm, s, i, o, e.table.hook.reading.fire)
                        }() : et(r(e, a), at(e.algorithm, e.filter), t, n, o, e.table.hook.reading.fire)
                    }
                    function a(e) {
                        return e.table.schema.instanceTemplate
                    }
                    return {
                        _read: function (e, t) {
                            var n = this._ctx;
                            return n.error ? n.table._trans(null, function (e, t) {
                                t(n.error)
                            }) : n.table._idbstore(Nt, e).then(t)
                        },
                        _write: function (e) {
                            var t = this._ctx;
                            return t.error ? t.table._trans(null, function (e, n) {
                                n(t.error)
                            }) : t.table._idbstore(Ct, e, "locked")
                        },
                        _addAlgorithm: function (e) {
                            var t = this._ctx;
                            t.algorithm = at(t.algorithm, e)
                        },
                        _iterate: function (e, t, n, r) {
                            return o(this._ctx, e, t, n, r)
                        },
                        each: function (e) {
                            var t = this._ctx;
                            return v(function () {
                                e(a(t))
                            }), this._read(function (n, r, a) {
                                o(t, e, n, r, a)
                            })
                        },
                        count: function (e) {
                            v(function () {
                                e(0)
                            });
                            var t = this,
                                r = this._ctx;
                            if (r.filter || r.algorithm || r.or) {
                                var a = 0;
                                return this._read(function (e, t, n) {
                                    o(r, function () {
                                        return ++a, !1
                                    }, function () {
                                        e(a)
                                    }, t, n)
                                }, e)
                            }
                            return this._read(function (e, o, a) {
                                var i = n(r, a),
                                    s = r.range ? i.count(r.range) : i.count();
                                s.onerror = I(o, ["calling", "count()", "on", t.name]), s.onsuccess = function (t) {
                                    e(Math.min(t.target.result, Math.max(0, r.limit - r.offset)))
                                }
                            }, e)
                        },
                        sortBy: function (e, t) {
                            function n(e, t) {
                                return t ? n(e[i[t]], t - 1) : e[s]
                            }
                            function r(e, t) {
                                var r = n(e, c),
                                    o = n(t, c);
                                return o > r ? -u : r > o ? u : 0
                            }
                            var o = this._ctx;
                            v(function () {
                                t([a(o)])
                            });
                            var i = e.split(".").reverse(),
                                s = i[0],
                                c = i.length - 1,
                                u = "next" === this._ctx.dir ? 1 : -1;
                            return this.toArray(function (e) {
                                return e.sort(r)
                            }).then(t)
                        },
                        toArray: function (e) {
                            var t = this._ctx;
                            return v(function () {
                                e([a(t)])
                            }), this._read(function (e, n, r) {
                                var a = [];
                                o(t, function (e) {
                                    a.push(e)
                                }, function () {
                                    e(a)
                                }, n, r)
                            }, e)
                        },
                        offset: function (t) {
                            var n = this._ctx;
                            return 0 >= t ? this : (n.offset += t, n.or || n.algorithm || n.filter ? e(n, function () {
                                return --t < 0
                            }) : e(n, function (e, n) {
                                return 0 === t ? !0 : 1 === t ? (--t, !1) : (n(function () {
                                    e.advance(t), t = 0
                                }), !1)
                            }), this)
                        },
                        limit: function (t) {
                            return this._ctx.limit = Math.min(this._ctx.limit, t), e(this._ctx, function (e, n, r) {
                                return --t <= 0 && n(r), t >= 0
                            }), this
                        },
                        until: function (t, n) {
                            var r = this._ctx;
                            return v(function () {
                                t(a(r))
                            }), e(this._ctx, function (e, r, o) {
                                return t(e.value) ? (r(o), n) : !0
                            }), this
                        },
                        first: function (e) {
                            var t = this;
                            return v(function () {
                                e(a(t._ctx))
                            }), this.limit(1).toArray(function (e) {
                                return e[0]
                            }).then(e)
                        },
                        last: function (e) {
                            return this.reverse().first(e)
                        },
                        and: function (n) {
                            var r = this;
                            return v(function () {
                                n(a(r._ctx))
                            }), e(this._ctx, function (e) {
                                return n(e.value)
                            }), t(this._ctx, n), this
                        },
                        or: function (e) {
                            return new z(this._ctx.table, e, this)
                        },
                        reverse: function () {
                            return this._ctx.dir = "prev" === this._ctx.dir ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this
                        },
                        desc: function () {
                            return this.reverse()
                        },
                        eachKey: function (e) {
                            var t = this,
                                n = this._ctx;
                            return v(function () {
                                e(a(t._ctx)[t._ctx.index])
                            }), n.isPrimKey || (n.op = "openKeyCursor"), this.each(function (t, n) {
                                e(n.key, n)
                            })
                        },
                        eachUniqueKey: function (e) {
                            return this._ctx.unique = "unique", this.eachKey(e)
                        },
                        keys: function (e) {
                            v(function () {
                                e([a(n)[t._ctx.index]])
                            });
                            var t = this,
                                n = this._ctx;
                            n.isPrimKey || (n.op = "openKeyCursor");
                            var r = [];
                            return this.each(function (e, t) {
                                r.push(t.key)
                            }).then(function () {
                                return r
                            }).then(e)
                        },
                        uniqueKeys: function (e) {
                            return this._ctx.unique = "unique", this.keys(e)
                        },
                        firstKey: function (e) {
                            return this.limit(1).keys(function (e) {
                                return e[0]
                            }).then(e)
                        },
                        lastKey: function (e) {
                            return this.reverse().firstKey(e)
                        },
                        distinct: function () {
                            var t = {};
                            return e(this._ctx, function (e) {
                                var n = e.primaryKey.toString(),
                                    r = t.hasOwnProperty(n);
                                return t[n] = !0, !r
                            }), this
                        }
                    }
                }), i(X).from(q).extend({
                    modify: function (e) {
                        var t = this,
                            n = this._ctx,
                            r = n.table.hook,
                            o = r.updating.fire,
                            i = r.deleting.fire;
                        return v(function () {
                            "function" == typeof e && e.call({
                                value: n.table.schema.instanceTemplate
                            }, n.table.schema.instanceTemplate)
                        }), this._write(function (r, s, c, l) {
                            function d(e, t) {
                                N = t.primaryKey;
                                var r = {
                                    primKey: t.primaryKey,
                                    value: e
                                };
                                if (g.call(r, e) !== !1) {
                                    var o = !r.hasOwnProperty("value"),
                                        a = o ? t["delete"]() : t.update(r.value);
                                    ++y, a.onerror = I(function (e) {
                                        return E.push(e), v.push(r.primKey), r.onerror && r.onerror(e), !0
                                    }, o ? ["deleting", e, "from", n.table.name] : ["modifying", e, "on", n.table.name]), a.onsuccess = function () {
                                        r.onsuccess && r.onsuccess(r.value), ++_, h()
                                    }
                                }
                            }
                            function p(e) {
                                return e && (E.push(e), v.push(N)), s(new x("Error modifying one or more objects", E, _, v))
                            }
                            function h() {
                                A && _ + E.length === y && (E.length > 0 ? p() : r(_))
                            }
                            var g;
                            if ("function" == typeof e) g = o === u && i === u ? e : function (t) {
                                var n = T(t);
                                if (e.call(this, t) === !1) return !1;
                                if (this.hasOwnProperty("value")) {
                                    var r = F(n, this.value),
                                        a = o.call(this, r, this.primKey, n, l);
                                    a && (t = this.value, Object.keys(a).forEach(function (e) {
                                        S(t, e, a[e])
                                    }))
                                } else i.call(this, this.primKey, t, l)
                            };
                            else if (o === u) {
                                var f = Object.keys(e),
                                    m = f.length;
                                g = function (t) {
                                    for (var n = !1, r = 0; m > r; ++r) {
                                        var o = f[r],
                                            a = e[o];
                                        C(t, o) !== a && (S(t, o, a), n = !0)
                                    }
                                    return n
                                }
                            } else {
                                var b = e;
                                e = w(b), g = function (t) {
                                    var n = !1,
                                        r = o.call(this, e, this.primKey, T(t), l);
                                    return r && a(e, r), Object.keys(e).forEach(function (r) {
                                        var o = e[r];
                                        C(t, r) !== o && (S(t, r, e[r]), n = !0)
                                    }), r && (e = w(b)), n
                                }
                            }
                            var y = 0,
                                _ = 0,
                                A = !1,
                                E = [],
                                v = [],
                                N = null;
                            t._iterate(d, function () {
                                A = !0, h()
                            }, p, c)
                        })
                    },
                    "delete": function () {
                        return this.modify(function () {
                            delete this.value
                        })
                    }
                }), a(this, {
                    Collection: q,
                    Table: H,
                    Transaction: V,
                    Version: p,
                    WhereClause: z,
                    WriteableCollection: X,
                    WriteableTable: Y
                }), n(), c.addons.forEach(function (e) {
                    e(St)
                })
            }
            function u() {}
            function l(e) {
                return e
            }
            function d(e, t) {
                return e === l ? t : function (n) {
                    return t(e(n))
                }
            }
            function p(e, t) {
                return function () {
                    e.apply(this, arguments), t.apply(this, arguments)
                }
            }
            function h(e, t) {
                return e === u ? t : function () {
                    var n = e.apply(this, arguments);
                    n !== o && (arguments[0] = n);
                    var r = this.onsuccess,
                        a = this.onerror;
                    delete this.onsuccess, delete this.onerror;
                    var i = t.apply(this, arguments);
                    return r && (this.onsuccess = this.onsuccess ? p(r, this.onsuccess) : r), a && (this.onerror = this.onerror ? p(a, this.onerror) : a), i !== o ? i : n
                }
            }
            function g(e, t) {
                return e === u ? t : function () {
                    var n = e.apply(this, arguments);
                    n !== o && a(arguments[0], n);
                    var r = this.onsuccess,
                        i = this.onerror;
                    delete this.onsuccess, delete this.onerror;
                    var s = t.apply(this, arguments);
                    return r && (this.onsuccess = this.onsuccess ? p(r, this.onsuccess) : r), i && (this.onerror = this.onerror ? p(i, this.onerror) : i), n === o ? s === o ? o : s : s === o ? n : a(n, s)
                }
            }
            function f(e, t) {
                return e === u ? t : function () {
                    return e.apply(this, arguments) === !1 ? !1 : t.apply(this, arguments)
                }
            }
            function m(e, t) {
                return e === u ? t : function () {
                    return t.apply(this, arguments) === !1 ? !1 : e.apply(this, arguments)
                }
            }
            function b(e, t) {
                return e === u ? t : function () {
                    e.apply(this, arguments), t.apply(this, arguments)
                }
            }
            function y(e, t) {
                return e === u ? t : function () {
                    var n = e.apply(this, arguments);
                    if (n && "function" == typeof n.then) {
                        var r = this,
                            o = arguments;
                        return n.then(function () {
                            return t.apply(r, o)
                        })
                    }
                    return t.apply(this, arguments)
                }
            }
            function _(t) {
                function n(e, t, n) {
                    if (Array.isArray(e)) return o(e);
                    if ("object" == typeof e) return r(e);
                    t || (t = f), n || (n = u);
                    var a = {
                        subscribers: [],
                        fire: n,
                        subscribe: function (e) {
                            a.subscribers.push(e), a.fire = t(a.fire, e)
                        },
                        unsubscribe: function (e) {
                            a.subscribers = a.subscribers.filter(function (t) {
                                return t !== e
                            }), a.fire = a.subscribers.reduce(t, n)
                        }
                    };
                    return i[e] = s[e] = a, a
                }
                function r(t) {
                    Object.keys(t).forEach(function (r) {
                        var o = t[r];
                        if (Array.isArray(o)) n(r, t[r][0], t[r][1]);
                        else {
                            if ("asap" !== o) throw new Error("Invalid event config");
                            var a = n(r, null, function () {
                                var t = arguments;
                                a.subscribers.forEach(function (n) {
                                    E(function () {
                                        n.apply(e, t)
                                    })
                                })
                            });
                            a.subscribe = function (e) {
                                -1 === a.subscribers.indexOf(e) && a.subscribers.push(e)
                            }, a.unsubscribe = function (e) {
                                var t = a.subscribers.indexOf(e); - 1 !== t && a.subscribers.splice(t, 1)
                            }
                        }
                    })
                }
                function o(e) {
                    function t() {
                        return r ? !1 : void(r = !0)
                    }
                    var r = !1;
                    e.forEach(function (e) {
                        n(e).subscribe(t)
                    })
                }
                var a = arguments,
                    i = {},
                    s = function (e, n) {
                        if (n) {
                            var r = [].slice.call(arguments, 1),
                                o = i[e];
                            return o.subscribe.apply(o, r), t
                        }
                        return "string" == typeof e ? i[e] : void 0
                    };
                s.addEventType = n;
                for (var c = 1, l = a.length; l > c; ++c) n(a[c]);
                return s
            }
            function A(e) {
                if (!e) throw new Error("Assertion failed")
            }
            function E(n) {
                e.setImmediate ? t(n) : setTimeout(n, 0)
            }
            function v(e) {
                var t = setTimeout(e, 1e3);
                clearTimeout(t)
            }
            function N(e, t, n) {
                return function () {
                    var r = $.PSD;
                    $.PSD = n;
                    try {
                        e.apply(this, arguments)
                    } catch (o) {
                        t(o)
                    } finally {
                        $.PSD = r
                    }
                }
            }
            function C(e, t) {
                if (e.hasOwnProperty(t)) return e[t];
                if (!t) return e;
                if ("string" != typeof t) {
                    for (var n = [], r = 0, a = t.length; a > r; ++r) {
                        var i = C(e, t[r]);
                        n.push(i)
                    }
                    return n
                }
                var s = t.indexOf(".");
                if (-1 !== s) {
                    var c = e[t.substr(0, s)];
                    return c === o ? o : C(c, t.substr(s + 1))
                }
                return o
            }
            function S(e, t, n) {
                if (e && t !== o) if ("string" != typeof t && "length" in t) {
                    A("string" != typeof n && "length" in n);
                    for (var r = 0, a = t.length; a > r; ++r) S(e, t[r], n[r])
                } else {
                    var i = t.indexOf(".");
                    if (-1 !== i) {
                        var s = t.substr(0, i),
                            c = t.substr(i + 1);
                        if ("" === c) n === o ? delete e[s] : e[s] = n;
                        else {
                            var u = e[s];
                            u || (u = e[s] = {}), S(u, c, n)
                        }
                    } else n === o ? delete e[t] : e[t] = n
                }
            }
            function R(e, t) {
                S(e, t, o)
            }
            function w(e) {
                var t = {};
                for (var n in e) e.hasOwnProperty(n) && (t[n] = e[n]);
                return t
            }
            function T(e) {
                if (!e || "object" != typeof e) return e;
                var t;
                if (Array.isArray(e)) {
                    t = [];
                    for (var n = 0, r = e.length; r > n; ++n) t.push(T(e[n]))
                } else if (e instanceof Date) t = new Date, t.setTime(e.getTime());
                else {
                    t = e.constructor ? Object.create(e.constructor.prototype) : {};
                    for (var o in e) e.hasOwnProperty(o) && (t[o] = T(e[o]))
                }
                return t
            }
            function F(e, t) {
                var n = {};
                for (var r in e) e.hasOwnProperty(r) && (t.hasOwnProperty(r) ? e[r] !== t[r] && JSON.stringify(e[r]) != JSON.stringify(t[r]) && (n[r] = t[r]) : n[r] = o);
                for (var r in t) t.hasOwnProperty(r) && !e.hasOwnProperty(r) && (n[r] = t[r]);
                return n
            }
            function D(e) {
                if ("function" == typeof e) return new e;
                if (Array.isArray(e)) return [D(e[0])];
                if (e && "object" == typeof e) {
                    var t = {};
                    return B(t, e), t
                }
                return e
            }
            function B(e, t) {
                Object.keys(t).forEach(function (n) {
                    var r = D(t[n]);
                    e[n] = r
                })
            }
            function I(e, t) {
                return function (n) {
                    var r = n && n.target.error || new Error;
                    if (t) {
                        var o = " occured when " + t.map(function (e) {
                            switch (typeof e) {
                            case "function":
                                return e();
                            case "string":
                                return e;
                            default:
                                return JSON.stringify(e)
                            }
                        }).join(" ");
                        r.name ? r.toString = function () {
                            return r.name + o + (r.message ? ". " + r.message : "")
                        } : r += o
                    }
                    return e(r), n.stopPropagation(), n.preventDefault(), !1
                }
            }
            function P(e) {
                try {
                    throw e
                } catch (t) {
                    return t
                }
            }
            function k(e) {
                e.preventDefault()
            }
            function O(e) {
                var t;
                try {
                    t = JSON.parse(localStorage.getItem("Dexie.DatabaseNames") || "[]")
                } catch (n) {
                    t = []
                }
                e(t) && localStorage.setItem("Dexie.DatabaseNames", JSON.stringify(t))
            }
            function M(e, t, n, r, o, a, i) {
                this.name = e, this.keyPath = t, this.unique = n, this.multi = r, this.auto = o, this.compound = a, this.dotted = i;
                var s = "string" == typeof t ? t : t && "[" + [].join.call(t, "+") + "]";
                this.src = (n ? "&" : "") + (r ? "*" : "") + (o ? "++" : "") + s
            }
            function L(e, t, n, r) {
                this.name = e, this.primKey = t || new M, this.indexes = n || [new M], this.instanceTemplate = r, this.mappedClass = null, this.idxByName = n.reduce(function (e, t) {
                    return e[t.name] = t, e
                }, {})
            }
            function x(e, t, n, r) {
                this.name = "ModifyError", this.failures = t, this.failedKeys = r, this.successCount = n, this.message = t.join("\n")
            }
            function U(e) {
                return 1 === e.length ? e[0] : e
            }
            var $ = function () {
                    function n(e) {
                        m.push([e, p.call(arguments, 1)])
                    }
                    function r() {
                        var t = m;
                        m = [];
                        for (var n = 0, r = t.length; r > n; ++n) {
                            var o = t[n];
                            o[0].apply(e, o[1])
                        }
                    }
                    function o(e) {
                        if ("object" != typeof this) throw new TypeError("Promises must be constructed via new");
                        if ("function" != typeof e) throw new TypeError("not a function");
                        this._state = null, this._value = null, this._deferreds = [], this._catched = !1;
                        var t = this,
                            n = !0;
                        this._PSD = o.PSD;
                        try {
                            d(this, e, function (e) {
                                n ? g(s, t, e) : s(t, e)
                            }, function (e) {
                                return n ? (g(c, t, e), !1) : c(t, e)
                            })
                        } finally {
                            n = !1
                        }
                    }
                    function a(e, t) {
                        if (null === e._state) return void e._deferreds.push(t);
                        var o = e._state ? t.onFulfilled : t.onRejected;
                        if (null === o) return (e._state ? t.resolve : t.reject)(e._value);
                        var a, s = f;
                        f = !1, g = n;
                        try {
                            a = o(e._value), e._state || a && "function" == typeof a.then && a._state === !1 || i(e)
                        } catch (c) {
                            var u = t.reject(c);
                            if (!u && e.onuncatched) try {
                                e.onuncatched(c)
                            } catch (c) {}
                            return
                        }
                        if (t.resolve(a), s) {
                            for (; m.length > 0;) r();
                            g = h, f = !0
                        }
                    }
                    function i(e) {
                        e._catched = !0, e._parent && i(e._parent)
                    }
                    function s(e, t) {
                        var n = o.PSD;
                        o.PSD = e._PSD;
                        try {
                            if (t === e) throw new TypeError("A promise cannot be resolved with itself.");
                            if (t && ("object" == typeof t || "function" == typeof t) && "function" == typeof t.then) return void d(e, function (e, n) {
                                t.then(e, n)
                            }, function (t) {
                                s(e, t)
                            }, function (t) {
                                c(e, t)
                            });
                            e._state = !0, e._value = t, u.call(e)
                        } catch (r) {
                            c(r)
                        } finally {
                            o.PSD = n
                        }
                    }
                    function c(e, t) {
                        var n = o.PSD;
                        if (o.PSD = e._PSD, e._state = !1, e._value = t, u.call(e), !e._catched && e.onuncatched) try {
                            e.onuncatched(e._value)
                        } catch (r) {}
                        return o.PSD = n, e._catched
                    }
                    function u() {
                        for (var e = 0, t = this._deferreds.length; t > e; e++) a(this, this._deferreds[e]);
                        this._deferreds = []
                    }
                    function l(e, t, n, r) {
                        this.onFulfilled = "function" == typeof e ? e : null, this.onRejected = "function" == typeof t ? t : null, this.resolve = n, this.reject = r
                    }
                    function d(e, t, n, r) {
                        var o = !1;
                        try {
                            t(function (e) {
                                o || (o = !0, n(e))
                            }, function (t) {
                                return o ? e._catched : (o = !0, r(t))
                            })
                        } catch (a) {
                            if (o) return;
                            return r(a)
                        }
                    }
                    var p = [].slice,
                        h = "undefined" == typeof t ?
                    function (t) {
                        var n = arguments;
                        setTimeout(function () {
                            t.apply(e, p.call(n, 1))
                        }, 0)
                    } : t, g = h, f = !0, m = [];
                    return o.all = function () {
                        var e = Array.prototype.slice.call(1 === arguments.length && Array.isArray(arguments[0]) ? arguments[0] : arguments);
                        return new o(function (t, n) {
                            function r(a, i) {
                                try {
                                    if (i && ("object" == typeof i || "function" == typeof i)) {
                                        var s = i.then;
                                        if ("function" == typeof s) return void s.call(i, function (e) {
                                            r(a, e)
                                        }, n)
                                    }
                                    e[a] = i, 0 === --o && t(e)
                                } catch (c) {
                                    n(c)
                                }
                            }
                            if (0 === e.length) return t([]);
                            for (var o = e.length, a = 0; a < e.length; a++) r(a, e[a])
                        })
                    }, o.prototype.then = function (e, t) {
                        var n = this,
                            r = new o(function (r, o) {
                                null === n._state ? a(n, new l(e, t, r, o)) : g(a, n, new l(e, t, r, o))
                            });
                        return r._PSD = this._PSD, r.onuncatched = this.onuncatched, r._parent = this, r
                    }, o.prototype["catch"] = function (e) {
                        if (1 === arguments.length) return this.then(null, e);
                        var t = arguments[0],
                            n = arguments[1];
                        return "function" == typeof t ? this.then(null, function (e) {
                            return e instanceof t ? n(e) : o.reject(e)
                        }) : this.then(null, function (e) {
                            return e && e.name === t ? n(e) : o.reject(e)
                        })
                    }, o.prototype["finally"] = function (e) {
                        return this.then(function (t) {
                            return e(), t
                        }, function (t) {
                            return e(), o.reject(t)
                        })
                    }, o.prototype.onuncatched = null, o.resolve = function (e) {
                        var t = new o(function () {});
                        return t._state = !0, t._value = e, t
                    }, o.reject = function (e) {
                        var t = new o(function () {});
                        return t._state = !1, t._value = e, t
                    }, o.race = function (e) {
                        return new o(function (t, n) {
                            e.map(function (e) {
                                e.then(t, n)
                            })
                        })
                    }, o.PSD = null, o.newPSD = function (e) {
                        var t = o.PSD;
                        o.PSD = t ? Object.create(t) : {};
                        try {
                            return e()
                        } finally {
                            o.PSD = t
                        }
                    }, o
                }();
            i(x).from(Error), c["delete"] = function (e) {
                var t = new c(e),
                    n = t["delete"]();
                return n.onblocked = function (e) {
                    return t.on("blocked", e), this
                }, n
            }, c.getDatabaseNames = function (e) {
                return new $(function (e, t) {
                    if ("webkitGetDatabaseNames" in indexedDB || "getDatabaseNames" in indexedDB) {
                        var n = "getDatabaseNames" in indexedDB ? indexedDB.getDatabaseNames() : indexedDB.webkitGetDatabaseNames();
                        n.onsuccess = function (t) {
                            e([].slice.call(t.target.result, 0))
                        }, n.onerror = I(t)
                    } else O(function (t) {
                        return e(t), !1
                    })
                }).then(e)
            }, c.defineClass = function (e) {
                function t(e) {
                    e && a(this, e)
                }
                return B(t.prototype, e), t
            }, c.spawn = function (e) {
                return $.newPSD(function () {
                    return $.PSD.trans = null, e()
                })
            }, c.vip = function (e) {
                return $.newPSD(function () {
                    return $.PSD.letThrough = !0, e()
                })
            }, Object.defineProperty(c, "currentTransaction", {
                get: function () {
                    return $.PSD && $.PSD.trans || null
                }
            }), c.Promise = $, c.derive = i, c.extend = a, c.override = s, c.events = _, c.getByKeyPath = C, c.setByKeyPath = S, c.delByKeyPath = R, c.shallowClone = w, c.deepClone = T, c.addons = [], c.fakeAutoComplete = v, c.asap = E, c.ModifyError = x, c.MultiModifyError = x, c.IndexSpec = M, c.TableSchema = L, c.dependencies = {
                indexedDB: e._indexedDB || e.indexedDB || e.mozIndexedDB || e.webkitIndexedDB || e.msIndexedDB,
                IDBKeyRange: e._IDBKeyRange || e.IDBKeyRange || e.webkitIDBKeyRange,
                IDBTransaction: e._IDBTransaction || e.IDBTransaction || e.webkitIDBTransaction,
                Error: e.Error || String,
                SyntaxError: e.SyntaxError || String,
                TypeError: e.TypeError || String,
                DOMError: e.DOMError || String
            }, c.version = 1.03, n("Dexie", c)
        }).apply(this, "undefined" == typeof e || "undefined" != typeof window && this == window ? [window, function (e, t) {
            window[e] = t
        }, !0] : [n, function (t, n) {
            e.exports = n
        }, !1])
    }).call(t, n(105).setImmediate, function () {
        return this
    }())
}, function (e, t, n) {
    (function (t, n) {
        /* @preserve
         * The MIT License (MIT)
         * 
         * Copyright (c) 2014 Petka Antonov
         * 
         * Permission is hereby granted, free of charge, to any person obtaining a copy
         * of this software and associated documentation files (the "Software"), to deal
         * in the Software without restriction, including without limitation the rights
         * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
         * copies of the Software, and to permit persons to whom the Software is
         * furnished to do so, subject to the following conditions:</p>
         * 
         * The above copyright notice and this permission notice shall be included in
         * all copies or substantial portions of the Software.
         * 
         * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
         * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
         * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
         * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
         * THE SOFTWARE.
         * 
         */
        !
        function (t) {
            e.exports = t()
        }(function () {
            var e, r, o;
            return function a(e, t, n) {
                function r(i, s) {
                    if (!t[i]) {
                        if (!e[i]) {
                            var c = "function" == typeof _dereq_ && _dereq_;
                            if (!s && c) return c(i, !0);
                            if (o) return o(i, !0);
                            var u = new Error("Cannot find module '" + i + "'");
                            throw u.code = "MODULE_NOT_FOUND", u
                        }
                        var l = t[i] = {
                            exports: {}
                        };
                        e[i][0].call(l.exports, function (t) {
                            var n = e[i][1][t];
                            return r(n ? n : t)
                        }, l, l.exports, a, e, t, n)
                    }
                    return t[i].exports
                }
                for (var o = "function" == typeof _dereq_ && _dereq_, i = 0; i < n.length; i++) r(n[i]);
                return r
            }({
                1: [function (e, t) {
                    "use strict";
                    t.exports = function (e) {
                        function t(e) {
                            var t = new n(e),
                                r = t.promise();
                            return t.setHowMany(1), t.setUnwrap(), t.init(), r
                        }
                        var n = e._SomePromiseArray;
                        e.any = function (e) {
                            return t(e)
                        }, e.prototype.any = function () {
                            return t(this)
                        }
                    }
                }, {}],
                2: [function (e, n) {
                    "use strict";

                    function r() {
                        this._isTickUsed = !1, this._lateQueue = new s(16), this._normalQueue = new s(16);
                        var e = this;
                        this.drainQueues = function () {
                            e._drainQueues()
                        }, this._schedule = i.isStatic ? i(this.drainQueues) : i
                    }
                    var o;
                    try {
                        throw new Error
                    } catch (a) {
                        o = a
                    }
                    var i = e("./schedule.js"),
                        s = e("./queue.js"),
                        c = "undefined" != typeof t ? t : void 0;
                    r.prototype.haveItemsQueued = function () {
                        return this._normalQueue.length() > 0
                    }, r.prototype._withDomain = function (e) {
                        return void 0 === c || null == c.domain || e.domain || (e = c.domain.bind(e)), e
                    }, r.prototype.throwLater = function (e, t) {
                        if (1 === arguments.length && (t = e, e = function () {
                            throw t
                        }), e = this._withDomain(e), "undefined" != typeof setTimeout) setTimeout(function () {
                            e(t)
                        }, 0);
                        else try {
                            this._schedule(function () {
                                e(t)
                            })
                        } catch (n) {
                            throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")
                        }
                    }, r.prototype.invokeLater = function (e, t, n) {
                        e = this._withDomain(e), this._lateQueue.push(e, t, n), this._queueTick()
                    }, r.prototype.invokeFirst = function (e, t, n) {
                        e = this._withDomain(e), this._normalQueue.unshift(e, t, n), this._queueTick()
                    }, r.prototype.invoke = function (e, t, n) {
                        e = this._withDomain(e), this._normalQueue.push(e, t, n), this._queueTick()
                    }, r.prototype.settlePromises = function (e) {
                        this._normalQueue._pushOne(e), this._queueTick()
                    }, r.prototype._drainQueue = function (e) {
                        for (; e.length() > 0;) {
                            var t = e.shift();
                            if ("function" == typeof t) {
                                var n = e.shift(),
                                    r = e.shift();
                                t.call(n, r)
                            } else t._settlePromises()
                        }
                    }, r.prototype._drainQueues = function () {
                        this._drainQueue(this._normalQueue), this._reset(), this._drainQueue(this._lateQueue)
                    }, r.prototype._queueTick = function () {
                        this._isTickUsed || (this._isTickUsed = !0, this._schedule(this.drainQueues))
                    }, r.prototype._reset = function () {
                        this._isTickUsed = !1
                    }, n.exports = new r, n.exports.firstLineError = o
                }, {
                    "./queue.js": 28,
                    "./schedule.js": 31
                }],
                3: [function (e, t) {
                    "use strict";
                    t.exports = function (e, t, n) {
                        function r() {
                            return this.value
                        }
                        function o() {
                            throw this.reason
                        }
                        function a(e) {
                            return this._then(r, null, null, {
                                value: e
                            }, void 0)
                        }
                        function i(e) {
                            return this._then(o, o, null, {
                                reason: e
                            }, void 0)
                        }
                        function s(e) {
                            this._setBoundTo(e)
                        }
                        e.prototype.bind = function (t) {
                            var r = n(t);
                            if (r instanceof e) {
                                if (!r.isFulfilled()) {
                                    if (r.isRejected()) return e.reject(r.reason());
                                    var o = this.then(),
                                        c = o;
                                    return o = o._then(a, i, null, r, void 0), r._then(s, o._reject, null, o, null), o._cancellable() || o._setPendingCancellationParent(c), o
                                }
                                t = r.value()
                            }
                            var o = this.then();
                            return o._setBoundTo(t), o
                        }, e.bind = function (t, n) {
                            return e.resolve(n).bind(t)
                        }, e.prototype._setPendingCancellationParent = function (e) {
                            this._settledValue = e
                        }, e.prototype._pendingCancellationParent = function () {
                            if (this.isPending() && void 0 !== this._settledValue) {
                                var e = this._settledValue;
                                return e.cancellable(), this._settledValue = void 0, e
                            }
                        }, e.prototype._setIsBound = function () {
                            this._bitField = 131072 | this._bitField
                        }, e.prototype._unsetIsBound = function () {
                            this._bitField = -131073 & this._bitField
                        }, e.prototype._isBound = function () {
                            return 131072 === (131072 & this._bitField)
                        }, e.prototype._setIsMigratingBinding = function () {
                            this._bitField = 8388608 | this._bitField
                        }, e.prototype._unsetIsMigratingBinding = function () {
                            this._bitField = -8388609 & this._bitField
                        }, e.prototype._isMigratingBinding = function () {
                            return 8388608 === (8388608 & this._bitField)
                        }, e.prototype._setBoundTo = function (e) {
                            void 0 === e ? (this._isBound() && (this._boundTo = void 0), this._unsetIsBound()) : (this._setIsBound(), this._boundTo = e)
                        }
                    }
                }, {}],
                4: [function (e, t) {
                    "use strict";

                    function n() {
                        try {
                            Promise === o && (Promise = r)
                        } catch (e) {}
                        return o
                    }
                    var r;
                    "undefined" != typeof Promise && (r = Promise);
                    var o = e("./promise.js")();
                    o.noConflict = n, t.exports = o
                }, {
                    "./promise.js": 23
                }],
                5: [function (e, t) {
                    "use strict";
                    var n = Object.create;
                    if (n) {
                        var r = n(null),
                            o = n(null);
                        r[" size"] = o[" size"] = 0
                    }
                    t.exports = function (t) {
                        function n(e, n) {
                            var r;
                            if (null != e && (r = e[n]), "function" != typeof r) {
                                var o = "Object " + s.classString(e) + " has no method '" + s.toString(n) + "'";
                                throw new t.TypeError(o)
                            }
                            return r
                        }
                        function r(e) {
                            var t = this.pop(),
                                r = n(e, t);
                            return r.apply(e, this)
                        }
                        function o(e) {
                            return e[this]
                        }
                        function a(e) {
                            var t = +this;
                            return 0 > t && (t = Math.max(0, t + e.length)), e[t]
                        } {
                            var i, s = e("./util.js"),
                                c = s.canEvaluate;
                            s.isIdentifier
                        }
                        t.prototype.call = function (e) {
                            for (var t = arguments.length, n = new Array(t - 1), o = 1; t > o; ++o) n[o - 1] = arguments[o];
                            return n.push(e), this._then(r, void 0, void 0, n, void 0)
                        }, t.prototype.get = function (e) {
                            var t, n = "number" == typeof e;
                            if (n) t = a;
                            else if (c) {
                                var r = i(e);
                                t = null !== r ? r : o
                            } else t = o;
                            return this._then(t, void 0, void 0, e, void 0)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                6: [function (e, t) {
                    "use strict";
                    t.exports = function (t) {
                        var n = e("./errors.js"),
                            r = e("./async.js"),
                            o = n.CancellationError;
                        t.prototype._cancel = function (e) {
                            if (!this.isCancellable()) return this;
                            for (var t, n = this; void 0 !== (t = n._cancellationParent) && t.isCancellable();) n = t;
                            this._unsetCancellable(), n._target()._rejectCallback(e, !1, !0)
                        }, t.prototype.cancel = function (e) {
                            return this.isCancellable() ? (void 0 === e && (e = new o), r.invokeLater(this._cancel, this, e), this) : this
                        }, t.prototype.cancellable = function () {
                            return this._cancellable() ? this : (this._setCancellable(), this._cancellationParent = this._pendingCancellationParent(), this)
                        }, t.prototype.uncancellable = function () {
                            var e = this.then();
                            return e._unsetCancellable(), e
                        }, t.prototype.fork = function (e, t, n) {
                            var r = this._then(e, t, n, void 0, void 0);
                            return r._setCancellable(), r._cancellationParent = void 0, r
                        }
                    }
                }, {
                    "./async.js": 2,
                    "./errors.js": 13
                }],
                7: [function (e, n) {
                    "use strict";
                    n.exports = function () {
                        function n(e) {
                            this._parent = e;
                            var t = this._length = 1 + (void 0 === e ? 0 : e._length);
                            E(this, n), t > 32 && this.uncycle()
                        }
                        function r(e, t) {
                            for (var n = 0; n < t.length - 1; ++n) t[n].push("From previous event:"), t[n] = t[n].join("\n");
                            return n < t.length && (t[n] = t[n].join("\n")), e + "\n" + t.join("\n")
                        }
                        function o(e) {
                            for (var t = 0; t < e.length; ++t)(0 === e[t].length || t + 1 < e.length && e[t][0] === e[t + 1][0]) && (e.splice(t, 1), t--)
                        }
                        function a(e) {
                            for (var t = e[0], n = 1; n < e.length; ++n) {
                                for (var r = e[n], o = t.length - 1, a = t[o], i = -1, s = r.length - 1; s >= 0; --s) if (r[s] === a) {
                                    i = s;
                                    break
                                }
                                for (var s = i; s >= 0; --s) {
                                    var c = r[s];
                                    if (t[o] !== c) break;
                                    t.pop(), o--
                                }
                                t = r
                            }
                        }
                        function i(e) {
                            for (var t = [], n = 0; n < e.length; ++n) {
                                var r = e[n],
                                    o = f.test(r) || "    (No stack trace)" === r,
                                    a = o && y(r);
                                o && !a && (b && " " !== r.charAt(0) && (r = "    " + r), t.push(r))
                            }
                            return t
                        }
                        function s(e) {
                            for (var t = e.stack.replace(/\s+$/g, "").split("\n"), n = 0; n < t.length; ++n) {
                                var r = t[n];
                                if ("    (No stack trace)" === r || f.test(r)) break
                            }
                            return n > 0 && (t = t.slice(n)), t
                        }
                        function c(e) {
                            var t;
                            if ("function" == typeof e) t = "[function " + (e.name || "anonymous") + "]";
                            else {
                                t = e.toString();
                                var n = /\[object [a-zA-Z0-9$_]+\]/;
                                if (n.test(t)) try {
                                    var r = JSON.stringify(e);
                                    t = r
                                } catch (o) {}
                                0 === t.length && (t = "(empty array)")
                            }
                            return "(<" + u(t) + ">, no stack trace)"
                        }
                        function u(e) {
                            var t = 41;
                            return e.length < t ? e : e.substr(0, t - 3) + "..."
                        }
                        function l(e) {
                            var t = e.match(_);
                            return t ? {
                                fileName: t[1],
                                line: parseInt(t[2], 10)
                            } : void 0
                        }
                        var d, p = e("./async.js"),
                            h = e("./util.js"),
                            g = /[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,
                            f = null,
                            m = null,
                            b = !1;
                        h.inherits(n, Error), n.prototype.uncycle = function () {
                            var e = this._length;
                            if (!(2 > e)) {
                                for (var t = [], n = {}, r = 0, o = this; void 0 !== o; ++r) t.push(o), o = o._parent;
                                e = this._length = r;
                                for (var r = e - 1; r >= 0; --r) {
                                    var a = t[r].stack;
                                    void 0 === n[a] && (n[a] = r)
                                }
                                for (var r = 0; e > r; ++r) {
                                    var i = t[r].stack,
                                        s = n[i];
                                    if (void 0 !== s && s !== r) {
                                        s > 0 && (t[s - 1]._parent = void 0, t[s - 1]._length = 1), t[r]._parent = void 0, t[r]._length = 1;
                                        var c = r > 0 ? t[r - 1] : this;
                                        e - 1 > s ? (c._parent = t[s + 1], c._parent.uncycle(), c._length = c._parent._length + 1) : (c._parent = void 0, c._length = 1);
                                        for (var u = c._length + 1, l = r - 2; l >= 0; --l) t[l]._length = u, u++;
                                        return
                                    }
                                }
                            }
                        }, n.prototype.parent = function () {
                            return this._parent
                        }, n.prototype.hasParent = function () {
                            return void 0 !== this._parent
                        }, n.prototype.attachExtraTrace = function (e) {
                            if (!e.__stackCleaned__) {
                                this.uncycle();
                                for (var t = n.parseStackAndMessage(e), s = t.message, c = [t.stack], u = this; void 0 !== u;) c.push(i(u.stack.split("\n"))), u = u._parent;
                                a(c), o(c), e.stack = r(s, c), e.__stackCleaned__ = !0
                            }
                        }, n.parseStackAndMessage = function (e) {
                            var t = e.stack,
                                n = e.toString();
                            return t = "string" == typeof t && t.length > 0 ? s(e) : ["    (No stack trace)"], {
                                message: n,
                                stack: i(t)
                            }
                        }, n.formatAndLogError = function (e, t) {
                            if ("undefined" != typeof console) {
                                var n;
                                if ("object" == typeof e || "function" == typeof e) {
                                    var r = e.stack;
                                    n = t + m(r, e)
                                } else n = t + String(e);
                                "function" == typeof d ? d(n) : ("function" == typeof console.log || "object" == typeof console.log) && console.log(n)
                            }
                        }, n.unhandledRejection = function (e) {
                            n.formatAndLogError(e, "^--- With additional stack trace: ")
                        }, n.isSupported = function () {
                            return "function" == typeof E
                        }, n.fireRejectionEvent = function (e, t, r, o) {
                            var a = !1;
                            try {
                                "function" == typeof t && (a = !0, "rejectionHandled" === e ? t(o) : t(r, o))
                            } catch (i) {
                                p.throwLater(i)
                            }
                            var s = !1;
                            try {
                                s = v(e, r, o)
                            } catch (i) {
                                s = !0, p.throwLater(i)
                            }
                            var c = !1;
                            if (A) try {
                                c = A(e.toLowerCase(), {
                                    reason: r,
                                    promise: o
                                })
                            } catch (i) {
                                c = !0, p.throwLater(i)
                            }
                            s || a || c || "unhandledRejection" !== e || n.formatAndLogError(r, "Unhandled rejection ")
                        };
                        var y = function () {
                                return !1
                            },
                            _ = /[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;
                        n.setBounds = function (e, t) {
                            if (n.isSupported()) {
                                for (var r, o, a = e.stack.split("\n"), i = t.stack.split("\n"), s = -1, c = -1, u = 0; u < a.length; ++u) {
                                    var d = l(a[u]);
                                    if (d) {
                                        r = d.fileName, s = d.line;
                                        break
                                    }
                                }
                                for (var u = 0; u < i.length; ++u) {
                                    var d = l(i[u]);
                                    if (d) {
                                        o = d.fileName, c = d.line;
                                        break
                                    }
                                }
                                0 > s || 0 > c || !r || !o || r !== o || s >= c || (y = function (e) {
                                    if (g.test(e)) return !0;
                                    var t = l(e);
                                    return t && t.fileName === r && s <= t.line && t.line <= c ? !0 : !1
                                })
                            }
                        };
                        var A, E = function () {
                                var e = /^\s*at\s*/,
                                    t = function (e, t) {
                                        return "string" == typeof e ? e : void 0 !== t.name && void 0 !== t.message ? t.toString() : c(t)
                                    };
                                if ("number" == typeof Error.stackTraceLimit && "function" == typeof Error.captureStackTrace) {
                                    Error.stackTraceLimit = Error.stackTraceLimit + 6, f = e, m = t;
                                    var n = Error.captureStackTrace;
                                    return y = function (e) {
                                        return g.test(e)
                                    }, function (e, t) {
                                        Error.stackTraceLimit = Error.stackTraceLimit + 6, n(e, t), Error.stackTraceLimit = Error.stackTraceLimit - 6
                                    }
                                }
                                var r = new Error;
                                if ("string" == typeof r.stack && r.stack.split("\n")[0].indexOf("stackDetection@") >= 0) return f = /@/, m = t, b = !0, function (e) {
                                    e.stack = (new Error).stack
                                };
                                var o;
                                try {
                                    throw new Error
                                } catch (a) {
                                    o = "stack" in a
                                }
                                return "stack" in r || !o ? (m = function (e, t) {
                                    return "string" == typeof e ? e : "object" != typeof t && "function" != typeof t || void 0 === t.name || void 0 === t.message ? c(t) : t.toString()
                                }, null) : (f = e, m = t, function (e) {
                                    Error.stackTraceLimit = Error.stackTraceLimit + 6;
                                    try {
                                        throw new Error
                                    } catch (t) {
                                        e.stack = t.stack
                                    }
                                    Error.stackTraceLimit = Error.stackTraceLimit - 6
                                })
                            }([]),
                            v = function () {
                                if (h.isNode) return function (e, n, r) {
                                    return "rejectionHandled" === e ? t.emit(e, r) : t.emit(e, n, r)
                                };
                                var e = !1,
                                    n = !0;
                                try {
                                    var r = new self.CustomEvent("test");
                                    e = r instanceof CustomEvent
                                } catch (o) {}
                                if (!e) try {
                                    var a = document.createEvent("CustomEvent");
                                    a.initCustomEvent("testingtheevent", !1, !0, {}), self.dispatchEvent(a)
                                } catch (o) {
                                    n = !1
                                }
                                n && (A = function (t, n) {
                                    var r;
                                    return e ? r = new self.CustomEvent(t, {
                                        detail: n,
                                        bubbles: !1,
                                        cancelable: !0
                                    }) : self.dispatchEvent && (r = document.createEvent("CustomEvent"), r.initCustomEvent(t, !1, !0, n)), r ? !self.dispatchEvent(r) : !1
                                });
                                var i = {};
                                return i.unhandledRejection = "onunhandledRejection".toLowerCase(), i.rejectionHandled = "onrejectionHandled".toLowerCase(), function (e, t, n) {
                                    var r = i[e],
                                        o = self[r];
                                    return o ? ("rejectionHandled" === e ? o.call(self, n) : o.call(self, t, n), !0) : !1
                                }
                            }();
                        return "undefined" != typeof console && "undefined" != typeof console.warn && (d = function (e) {
                            console.warn(e)
                        }, h.isNode && t.stderr.isTTY ? d = function (e) {
                            t.stderr.write("[31m" + e + "[39m\n")
                        } : h.isNode || "string" != typeof (new Error).stack || (d = function (e) {
                            console.warn("%c" + e, "color: red")
                        })), n
                    }
                }, {
                    "./async.js": 2,
                    "./util.js": 38
                }],
                8: [function (e, t) {
                    "use strict";
                    t.exports = function (t) {
                        function n(e, t, n) {
                            this._instances = e, this._callback = t, this._promise = n
                        }
                        function r(e, t) {
                            var n = {},
                                r = i(e).call(n, t);
                            if (r === s) return r;
                            var o = c(n);
                            return o.length ? (s.e = new u("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"), s) : r
                        }
                        var o = e("./util.js"),
                            a = e("./errors.js"),
                            i = o.tryCatch,
                            s = o.errorObj,
                            c = e("./es5.js").keys,
                            u = a.TypeError;
                        return n.prototype.doFilter = function (e) {
                            for (var n = this._callback, o = this._promise, a = o._boundTo, c = 0, u = this._instances.length; u > c; ++c) {
                                var l = this._instances[c],
                                    d = l === Error || null != l && l.prototype instanceof Error;
                                if (d && e instanceof l) {
                                    var p = i(n).call(a, e);
                                    return p === s ? (t.e = p.e, t) : p
                                }
                                if ("function" == typeof l && !d) {
                                    var h = r(l, e);
                                    if (h === s) {
                                        e = s.e;
                                        break
                                    }
                                    if (h) {
                                        var p = i(n).call(a, e);
                                        return p === s ? (t.e = p.e, t) : p
                                    }
                                }
                            }
                            return t.e = e, t
                        }, n
                    }
                }, {
                    "./errors.js": 13,
                    "./es5.js": 14,
                    "./util.js": 38
                }],
                9: [function (e, t) {
                    "use strict";
                    t.exports = function (e, t, n) {
                        function r() {
                            this._trace = new t(a())
                        }
                        function o() {
                            return n() ? new r : void 0
                        }
                        function a() {
                            var e = i.length - 1;
                            return e >= 0 ? i[e] : void 0
                        }
                        var i = [];
                        return r.prototype._pushContext = function () {
                            n() && void 0 !== this._trace && i.push(this._trace)
                        }, r.prototype._popContext = function () {
                            n() && void 0 !== this._trace && i.pop()
                        }, e.prototype._peekContext = a, e.prototype._pushContext = r.prototype._pushContext, e.prototype._popContext = r.prototype._popContext, o
                    }
                }, {}],
                10: [function (e, n) {
                    "use strict";
                    n.exports = function (n, r) {
                        var o, a, i = e("./async.js"),
                            s = e("./errors.js").Warning,
                            c = e("./util.js"),
                            u = c.canAttachTrace,
                            l = !1 || c.isNode && ( !! t.env.BLUEBIRD_DEBUG || "development" === t.env.NODE_ENV);
                        return n.prototype._ensurePossibleRejectionHandled = function () {
                            this._setRejectionIsUnhandled(), i.invokeLater(this._notifyUnhandledRejection, this, void 0)
                        }, n.prototype._notifyUnhandledRejectionIsHandled = function () {
                            r.fireRejectionEvent("rejectionHandled", o, void 0, this)
                        }, n.prototype._notifyUnhandledRejection = function () {
                            if (this._isRejectionUnhandled()) {
                                var e = this._getCarriedStackTrace() || this._settledValue;
                                this._setUnhandledRejectionIsNotified(), r.fireRejectionEvent("unhandledRejection", a, e, this)
                            }
                        }, n.prototype._setUnhandledRejectionIsNotified = function () {
                            this._bitField = 524288 | this._bitField
                        }, n.prototype._unsetUnhandledRejectionIsNotified = function () {
                            this._bitField = -524289 & this._bitField
                        }, n.prototype._isUnhandledRejectionNotified = function () {
                            return (524288 & this._bitField) > 0
                        }, n.prototype._setRejectionIsUnhandled = function () {
                            this._bitField = 2097152 | this._bitField
                        }, n.prototype._unsetRejectionIsUnhandled = function () {
                            this._bitField = -2097153 & this._bitField, this._isUnhandledRejectionNotified() && (this._unsetUnhandledRejectionIsNotified(), this._notifyUnhandledRejectionIsHandled())
                        }, n.prototype._isRejectionUnhandled = function () {
                            return (2097152 & this._bitField) > 0
                        }, n.prototype._setCarriedStackTrace = function (e) {
                            this._bitField = 1048576 | this._bitField, this._fulfillmentHandler0 = e
                        }, n.prototype._isCarryingStackTrace = function () {
                            return (1048576 & this._bitField) > 0
                        }, n.prototype._getCarriedStackTrace = function () {
                            return this._isCarryingStackTrace() ? this._fulfillmentHandler0 : void 0
                        }, n.prototype._captureStackTrace = function () {
                            return l && (this._trace = new r(this._peekContext())), this
                        }, n.prototype._attachExtraTrace = function (e, t) {
                            if (l && u(e)) {
                                var n = this._trace;
                                if (void 0 !== n && t && (n = n._parent), void 0 !== n) n.attachExtraTrace(e);
                                else if (!e.__stackCleaned__) {
                                    var o = r.parseStackAndMessage(e);
                                    e.stack = o.message + "\n" + o.stack.join("\n"), e.__stackCleaned__ = !0
                                }
                            }
                        }, n.prototype._warn = function (e) {
                            var t = new s(e),
                                n = this._peekContext();
                            if (n) n.attachExtraTrace(t);
                            else {
                                var o = r.parseStackAndMessage(t);
                                t.stack = o.message + "\n" + o.stack.join("\n")
                            }
                            r.formatAndLogError(t, "")
                        }, n.onPossiblyUnhandledRejection = function (e) {
                            a = "function" == typeof e ? e : void 0
                        }, n.onUnhandledRejectionHandled = function (e) {
                            o = "function" == typeof e ? e : void 0
                        }, n.longStackTraces = function () {
                            if (i.haveItemsQueued() && l === !1) throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");
                            l = r.isSupported()
                        }, n.hasLongStackTraces = function () {
                            return l && r.isSupported()
                        }, r.isSupported() || (n.longStackTraces = function () {}, l = !1), function () {
                            return l
                        }
                    }
                }, {
                    "./async.js": 2,
                    "./errors.js": 13,
                    "./util.js": 38
                }],
                11: [function (e, t) {
                    "use strict";
                    var n = e("./util.js"),
                        r = n.isPrimitive,
                        o = n.wrapsPrimitiveReceiver;
                    t.exports = function (e) {
                        var t = function () {
                                return this
                            },
                            n = function () {
                                throw this
                            },
                            a = function (e, t) {
                                return 1 === t ?
                                function () {
                                    throw e
                                } : 2 === t ?
                                function () {
                                    return e
                                } : void 0
                            };
                        e.prototype["return"] = e.prototype.thenReturn = function (e) {
                            return o && r(e) ? this._then(a(e, 2), void 0, void 0, void 0, void 0) : this._then(t, void 0, void 0, e, void 0)
                        }, e.prototype["throw"] = e.prototype.thenThrow = function (e) {
                            return o && r(e) ? this._then(a(e, 1), void 0, void 0, void 0, void 0) : this._then(n, void 0, void 0, e, void 0)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                12: [function (e, t) {
                    "use strict";
                    t.exports = function (e, t) {
                        var n = e.reduce;
                        e.prototype.each = function (e) {
                            return n(this, e, null, t)
                        }, e.each = function (e, r) {
                            return n(e, r, null, t)
                        }
                    }
                }, {}],
                13: [function (e, t) {
                    "use strict";

                    function n(e, t) {
                        function n(r) {
                            return this instanceof n ? (l(this, "message", "string" == typeof r ? r : t), l(this, "name", e), void(Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : Error.call(this))) : new n(r)
                        }
                        return u(n, Error), n
                    }
                    function r(e) {
                        return this instanceof r ? (l(this, "name", "OperationalError"), l(this, "message", e), this.cause = e, this.isOperational = !0, void(e instanceof Error ? (l(this, "message", e.message), l(this, "stack", e.stack)) : Error.captureStackTrace && Error.captureStackTrace(this, this.constructor))) : new r(e)
                    }
                    var o, a, i = e("./es5.js"),
                        s = i.freeze,
                        c = e("./util.js"),
                        u = c.inherits,
                        l = c.notEnumerableProp,
                        d = n("Warning", "warning"),
                        p = n("CancellationError", "cancellation error"),
                        h = n("TimeoutError", "timeout error"),
                        g = n("AggregateError", "aggregate error");
                    try {
                        o = TypeError, a = RangeError
                    } catch (f) {
                        o = n("TypeError", "type error"), a = n("RangeError", "range error")
                    }
                    for (var m = "join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "), b = 0; b < m.length; ++b)"function" == typeof Array.prototype[m[b]] && (g.prototype[m[b]] = Array.prototype[m[b]]);
                    i.defineProperty(g.prototype, "length", {
                        value: 0,
                        configurable: !1,
                        writable: !0,
                        enumerable: !0
                    }), g.prototype.isOperational = !0;
                    var y = 0;
                    g.prototype.toString = function () {
                        var e = Array(4 * y + 1).join(" "),
                            t = "\n" + e + "AggregateError of:\n";
                        y++, e = Array(4 * y + 1).join(" ");
                        for (var n = 0; n < this.length; ++n) {
                            for (var r = this[n] === this ? "[Circular AggregateError]" : this[n] + "", o = r.split("\n"), a = 0; a < o.length; ++a) o[a] = e + o[a];
                            r = o.join("\n"), t += r + "\n"
                        }
                        return y--, t
                    }, u(r, Error);
                    var _ = Error.__BluebirdErrorTypes__;
                    _ || (_ = s({
                        CancellationError: p,
                        TimeoutError: h,
                        OperationalError: r,
                        RejectionError: r,
                        AggregateError: g
                    }), l(Error, "__BluebirdErrorTypes__", _)), t.exports = {
                        Error: Error,
                        TypeError: o,
                        RangeError: a,
                        CancellationError: _.CancellationError,
                        OperationalError: _.OperationalError,
                        TimeoutError: _.TimeoutError,
                        AggregateError: _.AggregateError,
                        Warning: d
                    }
                }, {
                    "./es5.js": 14,
                    "./util.js": 38
                }],
                14: [function (e, t) {
                    var n = function () {
                            "use strict";
                            return void 0 === this
                        }();
                    if (n) t.exports = {
                        freeze: Object.freeze,
                        defineProperty: Object.defineProperty,
                        getDescriptor: Object.getOwnPropertyDescriptor,
                        keys: Object.keys,
                        names: Object.getOwnPropertyNames,
                        getPrototypeOf: Object.getPrototypeOf,
                        isArray: Array.isArray,
                        isES5: n,
                        propertyIsWritable: function (e, t) {
                            var n = Object.getOwnPropertyDescriptor(e, t);
                            return !(n && !n.writable && !n.set)
                        }
                    };
                    else {
                        var r = {}.hasOwnProperty,
                            o = {}.toString,
                            a = {}.constructor.prototype,
                            i = function (e) {
                                var t = [];
                                for (var n in e) r.call(e, n) && t.push(n);
                                return t
                            },
                            s = function (e, t) {
                                return {
                                    value: e[t]
                                }
                            },
                            c = function (e, t, n) {
                                return e[t] = n.value, e
                            },
                            u = function (e) {
                                return e
                            },
                            l = function (e) {
                                try {
                                    return Object(e).constructor.prototype
                                } catch (t) {
                                    return a
                                }
                            },
                            d = function (e) {
                                try {
                                    return "[object Array]" === o.call(e)
                                } catch (t) {
                                    return !1
                                }
                            };
                        t.exports = {
                            isArray: d,
                            keys: i,
                            names: i,
                            defineProperty: c,
                            getDescriptor: s,
                            freeze: u,
                            getPrototypeOf: l,
                            isES5: n,
                            propertyIsWritable: function () {
                                return !0
                            }
                        }
                    }
                }, {}],
                15: [function (e, t) {
                    "use strict";
                    t.exports = function (e, t) {
                        var n = e.map;
                        e.prototype.filter = function (e, r) {
                            return n(this, e, r, t)
                        }, e.filter = function (e, r, o) {
                            return n(e, r, o, t)
                        }
                    }
                }, {}],
                16: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r) {
                        function o() {
                            return this
                        }
                        function a() {
                            throw this
                        }
                        function i(e) {
                            return function () {
                                return e
                            }
                        }
                        function s(e) {
                            return function () {
                                throw e
                            }
                        }
                        function c(e, t, n) {
                            var r;
                            return r = p && h(t) ? n ? i(t) : s(t) : n ? o : a, e._then(r, g, void 0, t, void 0)
                        }
                        function u(e) {
                            var o = this.promise,
                                a = this.handler,
                                i = o._isBound() ? a.call(o._boundTo) : a();
                            if (void 0 !== i) {
                                var s = r(i, o);
                                if (s instanceof t) return s = s._target(), c(s, e, o.isFulfilled())
                            }
                            return o.isRejected() ? (n.e = e, n) : e
                        }
                        function l(e) {
                            var n = this.promise,
                                o = this.handler,
                                a = n._isBound() ? o.call(n._boundTo, e) : o(e);
                            if (void 0 !== a) {
                                var i = r(a, n);
                                if (i instanceof t) return i = i._target(), c(i, e, !0)
                            }
                            return e
                        }
                        var d = e("./util.js"),
                            p = d.wrapsPrimitiveReceiver,
                            h = d.isPrimitive,
                            g = d.thrower;
                        t.prototype._passThroughHandler = function (e, t) {
                            if ("function" != typeof e) return this.then();
                            var n = {
                                promise: this,
                                handler: e
                            };
                            return this._then(t ? u : l, t ? u : void 0, void 0, n, void 0)
                        }, t.prototype.lastly = t.prototype["finally"] = function (e) {
                            return this._passThroughHandler(e, !0)
                        }, t.prototype.tap = function (e) {
                            return this._passThroughHandler(e, !1)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                17: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        function a(e, n, r) {
                            for (var a = 0; a < n.length; ++a) {
                                r._pushContext();
                                var i = d(n[a])(e);
                                if (r._popContext(), i === l) {
                                    r._pushContext();
                                    var s = t.reject(l.e);
                                    return r._popContext(), s
                                }
                                var c = o(i, r);
                                if (c instanceof t) return c
                            }
                            return null
                        }
                        function i(e, n, o, a) {
                            var i = this._promise = new t(r);
                            i._captureStackTrace(), this._stack = a, this._generatorFunction = e, this._receiver = n, this._generator = void 0, this._yieldHandlers = "function" == typeof o ? [o].concat(p) : p
                        }
                        var s = e("./errors.js"),
                            c = s.TypeError,
                            u = e("./util.js"),
                            l = u.errorObj,
                            d = u.tryCatch,
                            p = [];
                        i.prototype.promise = function () {
                            return this._promise
                        }, i.prototype._run = function () {
                            this._generator = this._generatorFunction.call(this._receiver), this._receiver = this._generatorFunction = void 0, this._next(void 0)
                        }, i.prototype._continue = function (e) {
                            if (e === l) return this._promise._rejectCallback(e.e, !1, !0);
                            var n = e.value;
                            if (e.done === !0) this._promise._resolveCallback(n);
                            else {
                                var r = o(n, this._promise);
                                if (!(r instanceof t) && (r = a(r, this._yieldHandlers, this._promise), null === r)) return void this._throw(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s", n) + "From coroutine:\n" + this._stack.split("\n").slice(1, -7).join("\n")));
                                r._then(this._next, this._throw, void 0, this, null)
                            }
                        }, i.prototype._throw = function (e) {
                            this._promise._attachExtraTrace(e), this._promise._pushContext();
                            var t = d(this._generator["throw"]).call(this._generator, e);
                            this._promise._popContext(), this._continue(t)
                        }, i.prototype._next = function (e) {
                            this._promise._pushContext();
                            var t = d(this._generator.next).call(this._generator, e);
                            this._promise._popContext(), this._continue(t)
                        }, t.coroutine = function (e, t) {
                            if ("function" != typeof e) throw new c("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");
                            var n = Object(t).yieldHandler,
                                r = i,
                                o = (new Error).stack;
                            return function () {
                                var t = e.apply(this, arguments),
                                    a = new r(void 0, void 0, n, o);
                                return a._generator = t, a._next(void 0), a.promise()
                            }
                        }, t.coroutine.addYieldHandler = function (e) {
                            if ("function" != typeof e) throw new c("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            p.push(e)
                        }, t.spawn = function (e) {
                            if ("function" != typeof e) return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");
                            var r = new i(e, this),
                                o = r.promise();
                            return r._run(t.spawn), o
                        }
                    }
                }, {
                    "./errors.js": 13,
                    "./util.js": 38
                }],
                18: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        {
                            var a = e("./util.js");
                            a.canEvaluate, a.tryCatch, a.errorObj
                        }
                        t.join = function () {
                            var e, t = arguments.length - 1;
                            if (t > 0 && "function" == typeof arguments[t]) {
                                e = arguments[t];
                                var r
                            }
                            for (var o = arguments.length, a = new Array(o), i = 0; o > i; ++i) a[i] = arguments[i];
                            e && a.pop();
                            var r = new n(a).promise();
                            return void 0 !== e ? r.spread(e) : r
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                19: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o, a) {
                        function i(e, t, n, r) {
                            this.constructor$(e), this._promise._captureStackTrace(), this._callback = t, this._preservedValues = r === a ? new Array(this.length()) : null, this._limit = n, this._inFlight = 0, this._queue = n >= 1 ? [] : p, this._init$(void 0, -2)
                        }
                        function s(e, t, n, r) {
                            var o = "object" == typeof n && null !== n ? n.concurrency : 0;
                            return o = "number" == typeof o && isFinite(o) && o >= 1 ? o : 0, new i(e, t, o, r)
                        }
                        var c = e("./util.js"),
                            u = c.tryCatch,
                            l = c.errorObj,
                            d = {},
                            p = [];
                        c.inherits(i, n), i.prototype._init = function () {}, i.prototype._promiseFulfilled = function (e, n) {
                            var r = this._values,
                                a = this.length(),
                                i = this._preservedValues,
                                s = this._limit;
                            if (r[n] === d) {
                                if (r[n] = e, s >= 1 && (this._inFlight--, this._drainQueue(), this._isResolved())) return
                            } else {
                                if (s >= 1 && this._inFlight >= s) return r[n] = e, void this._queue.push(n);
                                null !== i && (i[n] = e);
                                var c = this._callback,
                                    p = this._promise._boundTo;
                                this._promise._pushContext();
                                var h = u(c).call(p, e, n, a);
                                if (this._promise._popContext(), h === l) return this._reject(h.e);
                                var g = o(h, this._promise);
                                if (g instanceof t) {
                                    if (g = g._target(), g._isPending()) return s >= 1 && this._inFlight++, r[n] = d, g._proxyPromiseArray(this, n);
                                    if (!g._isFulfilled()) return this._reject(g._reason());
                                    h = g._value()
                                }
                                r[n] = h
                            }
                            var f = ++this._totalResolved;
                            f >= a && (null !== i ? this._filter(r, i) : this._resolve(r))
                        }, i.prototype._drainQueue = function () {
                            for (var e = this._queue, t = this._limit, n = this._values; e.length > 0 && this._inFlight < t;) {
                                if (this._isResolved()) return;
                                var r = e.pop();
                                this._promiseFulfilled(n[r], r)
                            }
                        }, i.prototype._filter = function (e, t) {
                            for (var n = t.length, r = new Array(n), o = 0, a = 0; n > a; ++a) e[a] && (r[o++] = t[a]);
                            r.length = o, this._resolve(r)
                        }, i.prototype.preservedValues = function () {
                            return this._preservedValues
                        }, t.prototype.map = function (e, t) {
                            return "function" != typeof e ? r("fn must be a function\n\n    See http://goo.gl/916lJJ\n") : s(this, e, t, null).promise()
                        }, t.map = function (e, t, n, o) {
                            return "function" != typeof t ? r("fn must be a function\n\n    See http://goo.gl/916lJJ\n") : s(e, t, n, o).promise()
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                20: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        var a = e("./util.js"),
                            i = a.tryCatch;
                        t.method = function (e) {
                            if ("function" != typeof e) throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            return function () {
                                var r = new t(n);
                                r._captureStackTrace(), r._pushContext();
                                var o = i(e).apply(this, arguments);
                                return r._popContext(), r._resolveFromSyncValue(o), r
                            }
                        }, t.attempt = t["try"] = function (e, r, s) {
                            if ("function" != typeof e) return o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            var c = new t(n);
                            c._captureStackTrace(), c._pushContext();
                            var u = a.isArray(r) ? i(e).apply(s, r) : i(e).call(s, r);
                            return c._popContext(), c._resolveFromSyncValue(u), c
                        }, t.prototype._resolveFromSyncValue = function (e) {
                            e === a.errorObj ? this._rejectCallback(e.e, !1, !0) : this._resolveCallback(e, !0)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                21: [function (e, t) {
                    "use strict";
                    t.exports = function (t) {
                        function n(e, t) {
                            var n = this;
                            if (!a.isArray(e)) return r.call(n, e, t);
                            var o = s(t).apply(n._boundTo, [null].concat(e));
                            o === c && i.throwLater(o.e)
                        }
                        function r(e, t) {
                            var n = this,
                                r = n._boundTo,
                                o = void 0 === e ? s(t).call(r, null) : s(t).call(r, null, e);
                            o === c && i.throwLater(o.e)
                        }
                        function o(e, t) {
                            var n = this;
                            if (!e) {
                                var r = n._target(),
                                    o = r._getCarriedStackTrace();
                                o.cause = e, e = o
                            }
                            var a = s(t).call(n._boundTo, e);
                            a === c && i.throwLater(a.e)
                        }
                        var a = e("./util.js"),
                            i = e("./async.js"),
                            s = a.tryCatch,
                            c = a.errorObj;
                        t.prototype.nodeify = function (e, t) {
                            if ("function" == typeof e) {
                                var a = r;
                                void 0 !== t && Object(t).spread && (a = n), this._then(a, o, void 0, this, e)
                            }
                            return this
                        }
                    }
                }, {
                    "./async.js": 2,
                    "./util.js": 38
                }],
                22: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n) {
                        var r = e("./util.js"),
                            o = e("./async.js"),
                            a = r.tryCatch,
                            i = r.errorObj;
                        t.prototype.progressed = function (e) {
                            return this._then(void 0, void 0, e, void 0, void 0)
                        }, t.prototype._progress = function (e) {
                            this._isFollowingOrFulfilledOrRejected() || this._target()._progressUnchecked(e)
                        }, t.prototype._progressHandlerAt = function (e) {
                            return 0 === e ? this._progressHandler0 : this[(e << 2) + e - 5 + 2]
                        }, t.prototype._doProgressWith = function (e) {
                            var n = e.value,
                                o = e.handler,
                                s = e.promise,
                                c = e.receiver,
                                u = a(o).call(c, n);
                            if (u === i) {
                                if (null != u.e && "StopProgressPropagation" !== u.e.name) {
                                    var l = r.canAttachTrace(u.e) ? u.e : new Error(r.toString(u.e));
                                    s._attachExtraTrace(l), s._progress(u.e)
                                }
                            } else u instanceof t ? u._then(s._progress, null, null, s, void 0) : s._progress(u)
                        }, t.prototype._progressUnchecked = function (e) {
                            for (var r = this._length(), a = this._progress, i = 0; r > i; i++) {
                                var s = this._progressHandlerAt(i),
                                    c = this._promiseAt(i);
                                if (c instanceof t)"function" == typeof s ? o.invoke(this._doProgressWith, this, {
                                    handler: s,
                                    promise: c,
                                    receiver: this._receiverAt(i),
                                    value: e
                                }) : o.invoke(a, c, e);
                                else {
                                    var u = this._receiverAt(i);
                                    "function" == typeof s ? s.call(u, e, c) : u instanceof n && !u._isResolved() && u._promiseProgressed(e, c)
                                }
                            }
                        }
                    }
                }, {
                    "./async.js": 2,
                    "./util.js": 38
                }],
                23: [function (e, t) {
                    "use strict";
                    t.exports = function () {
                        function t(e) {
                            if ("function" != typeof e) throw new u("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");
                            if (this.constructor !== t) throw new u("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");
                            this._bitField = 0, this._fulfillmentHandler0 = void 0, this._rejectionHandler0 = void 0, this._progressHandler0 = void 0, this._promise0 = void 0, this._receiver0 = void 0, this._settledValue = void 0, e !== l && this._resolveFromResolver(e)
                        }
                        function n(e) {
                            var n = new t(l);
                            n._fulfillmentHandler0 = e, n._rejectionHandler0 = e, n._progressHandler0 = e, n._promise0 = e, n._receiver0 = e, n._settledValue = e
                        }
                        var r = function () {
                                return new u("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")
                            },
                            o = function () {
                                return new t.PromiseInspection(this._target())
                            },
                            a = function (e) {
                                return t.reject(new u(e))
                            },
                            i = e("./util.js"),
                            s = e("./async.js"),
                            c = e("./errors.js"),
                            u = t.TypeError = c.TypeError;
                        t.RangeError = c.RangeError, t.CancellationError = c.CancellationError, t.TimeoutError = c.TimeoutError, t.OperationalError = c.OperationalError, t.RejectionError = c.OperationalError, t.AggregateError = c.AggregateError;
                        var l = function () {},
                            d = {},
                            p = {
                                e: null
                            },
                            h = e("./thenables.js")(t, l),
                            g = e("./promise_array.js")(t, l, h, a),
                            f = e("./captured_trace.js")(),
                            m = e("./debuggability.js")(t, f),
                            b = e("./context.js")(t, f, m),
                            y = e("./catch_filter.js")(p),
                            _ = e("./promise_resolver.js"),
                            A = _._nodebackForPromise,
                            E = i.errorObj,
                            v = i.tryCatch;
                        return t.prototype.toString = function () {
                            return "[object Promise]"
                        }, t.prototype.caught = t.prototype["catch"] = function (e) {
                            var n = arguments.length;
                            if (n > 1) {
                                var r, o = new Array(n - 1),
                                    a = 0;
                                for (r = 0; n - 1 > r; ++r) {
                                    var i = arguments[r];
                                    if ("function" != typeof i) return t.reject(new u("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));
                                    o[a++] = i
                                }
                                o.length = a, e = arguments[r];
                                var s = new y(o, e, this);
                                return this._then(void 0, s.doFilter, void 0, s, void 0)
                            }
                            return this._then(void 0, e, void 0, void 0, void 0)
                        }, t.prototype.reflect = function () {
                            return this._then(o, o, void 0, this, void 0)
                        }, t.prototype.then = function (e, t, n) {
                            if (m() && arguments.length > 0 && "function" != typeof e && "function" != typeof t) {
                                var r = ".then() only accepts functions but was passed: " + i.classString(e);
                                arguments.length > 1 && (r += ", " + i.classString(t)), this._warn(r)
                            }
                            return this._then(e, t, n, void 0, void 0)
                        }, t.prototype.done = function (e, t, n) {
                            var r = this._then(e, t, n, void 0, void 0);
                            r._setIsFinal()
                        }, t.prototype.spread = function (e, t) {
                            return this.all()._then(e, t, void 0, d, void 0)
                        }, t.prototype.isCancellable = function () {
                            return !this.isResolved() && this._cancellable()
                        }, t.prototype.toJSON = function () {
                            var e = {
                                isFulfilled: !1,
                                isRejected: !1,
                                fulfillmentValue: void 0,
                                rejectionReason: void 0
                            };
                            return this.isFulfilled() ? (e.fulfillmentValue = this.value(), e.isFulfilled = !0) : this.isRejected() && (e.rejectionReason = this.reason(), e.isRejected = !0), e
                        }, t.prototype.all = function () {
                            return new g(this).promise()
                        }, t.prototype.error = function (e) {
                            return this.caught(i.originatesFromRejection, e)
                        }, t.is = function (e) {
                            return e instanceof t
                        }, t.fromNode = function (e) {
                            var n = new t(l),
                                r = v(e)(A(n));
                            return r === E && n._rejectCallback(r.e, !0, !0), n
                        }, t.all = function (e) {
                            return new g(e).promise()
                        }, t.defer = t.pending = function () {
                            var e = new t(l);
                            return new _(e)
                        }, t.cast = function (e) {
                            var n = h(e);
                            if (!(n instanceof t)) {
                                var r = n;
                                n = new t(l), n._fulfillUnchecked(r)
                            }
                            return n
                        }, t.resolve = t.fulfilled = t.cast, t.reject = t.rejected = function (e) {
                            var n = new t(l);
                            return n._captureStackTrace(), n._rejectCallback(e, !0), n
                        }, t.setScheduler = function (e) {
                            if ("function" != typeof e) throw new u("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            var t = s._schedule;
                            return s._schedule = e, t
                        }, t.prototype._then = function (e, n, r, o, a) {
                            var i = void 0 !== a,
                                c = i ? a : new t(l);
                            i || (c._propagateFrom(this, 5), c._captureStackTrace());
                            var u = this._target();
                            u !== this && (i || (c._setIsMigrated(), void 0 === o && (c._setIsMigratingBinding(), o = this)));
                            var d = u._addCallbacks(e, n, r, c, o);
                            return u._isResolved() && !u._isSettlePromisesQueued() && s.invoke(u._settlePromiseAtPostResolution, u, d), c
                        }, t.prototype._settlePromiseAtPostResolution = function (e) {
                            this._isRejectionUnhandled() && this._unsetRejectionIsUnhandled(), this._settlePromiseAt(e)
                        }, t.prototype._length = function () {
                            return 131071 & this._bitField
                        }, t.prototype._isFollowingOrFulfilledOrRejected = function () {
                            return (939524096 & this._bitField) > 0
                        }, t.prototype._isFollowing = function () {
                            return 536870912 === (536870912 & this._bitField)
                        }, t.prototype._setLength = function (e) {
                            this._bitField = -131072 & this._bitField | 131071 & e
                        }, t.prototype._setFulfilled = function () {
                            this._bitField = 268435456 | this._bitField
                        }, t.prototype._setRejected = function () {
                            this._bitField = 134217728 | this._bitField
                        }, t.prototype._setFollowing = function () {
                            this._bitField = 536870912 | this._bitField
                        }, t.prototype._setIsFinal = function () {
                            this._bitField = 33554432 | this._bitField
                        }, t.prototype._isFinal = function () {
                            return (33554432 & this._bitField) > 0
                        }, t.prototype._cancellable = function () {
                            return (67108864 & this._bitField) > 0
                        }, t.prototype._setCancellable = function () {
                            this._bitField = 67108864 | this._bitField
                        }, t.prototype._unsetCancellable = function () {
                            this._bitField = -67108865 & this._bitField
                        }, t.prototype._setIsMigrated = function () {
                            this._bitField = 4194304 | this._bitField
                        }, t.prototype._unsetIsMigrated = function () {
                            this._bitField = -4194305 & this._bitField
                        }, t.prototype._isMigrated = function () {
                            return (4194304 & this._bitField) > 0
                        }, t.prototype._receiverAt = function (e) {
                            var t = 0 === e ? this._receiver0 : this[5 * e - 5 + 4];
                            return void 0 === t && this._isBound() ? this._boundTo : t
                        }, t.prototype._promiseAt = function (e) {
                            return 0 === e ? this._promise0 : this[5 * e - 5 + 3]
                        }, t.prototype._fulfillmentHandlerAt = function (e) {
                            return 0 === e ? this._fulfillmentHandler0 : this[5 * e - 5 + 0]
                        }, t.prototype._rejectionHandlerAt = function (e) {
                            return 0 === e ? this._rejectionHandler0 : this[5 * e - 5 + 1]
                        }, t.prototype._migrateCallbacks = function (e, n) {
                            var r = e._fulfillmentHandlerAt(n),
                                o = e._rejectionHandlerAt(n),
                                a = e._progressHandlerAt(n),
                                i = e._promiseAt(n),
                                s = e._receiverAt(n);
                            i instanceof t && (i._setIsMigrated(), void 0 === s && (s = e, i._setIsMigratingBinding())), this._addCallbacks(r, o, a, i, s)
                        }, t.prototype._addCallbacks = function (e, t, n, r, o) {
                            var a = this._length();
                            if (a >= 131066 && (a = 0, this._setLength(0)), 0 === a) this._promise0 = r, void 0 !== o && (this._receiver0 = o), "function" != typeof e || this._isCarryingStackTrace() || (this._fulfillmentHandler0 = e), "function" == typeof t && (this._rejectionHandler0 = t), "function" == typeof n && (this._progressHandler0 = n);
                            else {
                                var i = 5 * a - 5;
                                this[i + 3] = r, this[i + 4] = o, "function" == typeof e && (this[i + 0] = e), "function" == typeof t && (this[i + 1] = t), "function" == typeof n && (this[i + 2] = n)
                            }
                            return this._setLength(a + 1), a
                        }, t.prototype._setProxyHandlers = function (e, t) {
                            var n = this._length();
                            if (n >= 131066 && (n = 0, this._setLength(0)), 0 === n) this._promise0 = t, this._receiver0 = e;
                            else {
                                var r = 5 * n - 5;
                                this[r + 3] = t, this[r + 4] = e
                            }
                            this._setLength(n + 1)
                        }, t.prototype._proxyPromiseArray = function (e, t) {
                            this._setProxyHandlers(e, t)
                        }, t.prototype._resolveCallback = function (e, n) {
                            if (!this._isFollowingOrFulfilledOrRejected()) {
                                if (e === this) return this._rejectCallback(r(), !1, !0);
                                var o = h(e, this);
                                if (!(o instanceof t)) return this._fulfill(e);
                                var a = 1 | (n ? 4 : 0);
                                this._propagateFrom(o, a);
                                var i = o._target();
                                if (i._isPending()) {
                                    for (var s = this._length(), c = 0; s > c; ++c) i._migrateCallbacks(this, c);
                                    this._setFollowing(), this._setLength(0), this._setFollowee(i)
                                } else i._isFulfilled() ? this._fulfillUnchecked(i._value()) : this._rejectUnchecked(i._reason(), i._getCarriedStackTrace())
                            }
                        }, t.prototype._rejectCallback = function (e, t, n) {
                            n || i.markAsOriginatingFromRejection(e);
                            var r = i.ensureErrorObject(e),
                                o = i.canAttachTrace(e) && "string" == typeof r.stack && r.stack.length > 0;
                            this._attachExtraTrace(r, t ? o : !1), this._reject(e, r === e ? void 0 : r)
                        }, t.prototype._resolveFromResolver = function (e) {
                            var t = this;
                            this._captureStackTrace(), this._pushContext();
                            var n = !0,
                                r = v(e)(function (e) {
                                    null !== t && (t._resolveCallback(e), t = null)
                                }, function (e) {
                                    null !== t && (t._rejectCallback(e, n), t = null)
                                });
                            n = !1, this._popContext(), void 0 !== r && r === E && null !== t && (t._rejectCallback(r.e, !0, !0), t = null)
                        }, t.prototype._settlePromiseFromHandler = function (e, t, n, o) {
                            if (!o._isRejected()) {
                                o._pushContext();
                                var a;
                                if (a = t !== d || this._isRejected() ? v(e).call(t, n) : v(e).apply(this._boundTo, n), o._popContext(), a === E || a === o || a === p) {
                                    var i = a === o ? r() : a.e;
                                    o._rejectCallback(i, !1, !0)
                                } else o._resolveCallback(a)
                            }
                        }, t.prototype._target = function () {
                            for (var e = this; e._isFollowing();) e = e._followee();
                            return e
                        }, t.prototype._followee = function () {
                            return this._rejectionHandler0
                        }, t.prototype._setFollowee = function (e) {
                            this._rejectionHandler0 = e
                        }, t.prototype._cleanValues = function () {
                            this._cancellable() && (this._cancellationParent = void 0)
                        }, t.prototype._propagateFrom = function (e, t) {
                            (1 & t) > 0 && e._cancellable() && (this._setCancellable(), this._cancellationParent = e), (4 & t) > 0 && e._isBound() && this._setBoundTo(e._boundTo)
                        }, t.prototype._fulfill = function (e) {
                            this._isFollowingOrFulfilledOrRejected() || this._fulfillUnchecked(e)
                        }, t.prototype._reject = function (e, t) {
                            this._isFollowingOrFulfilledOrRejected() || this._rejectUnchecked(e, t)
                        }, t.prototype._settlePromiseAt = function (e) {
                            var n = this._promiseAt(e),
                                r = n instanceof t;
                            if (r && n._isMigrated()) return n._unsetIsMigrated(), s.invoke(this._settlePromiseAt, this, e);
                            var o = this._isFulfilled() ? this._fulfillmentHandlerAt(e) : this._rejectionHandlerAt(e),
                                a = this._isCarryingStackTrace() ? this._getCarriedStackTrace() : void 0,
                                i = this._settledValue,
                                c = this._receiverAt(e);
                            r && n._isMigratingBinding() && (n._unsetIsMigratingBinding(), c = c._boundTo), this._clearCallbackDataAtIndex(e), "function" == typeof o ? r ? this._settlePromiseFromHandler(o, c, i, n) : o.call(c, i, n) : c instanceof g ? c._isResolved() || (this._isFulfilled() ? c._promiseFulfilled(i, n) : c._promiseRejected(i, n)) : r && (this._isFulfilled() ? n._fulfill(i) : n._reject(i, a)), e >= 4 && 4 === (31 & e) && s.invokeLater(this._setLength, this, 0)
                        }, t.prototype._clearCallbackDataAtIndex = function (e) {
                            if (0 === e) this._isCarryingStackTrace() || (this._fulfillmentHandler0 = void 0), this._rejectionHandler0 = this._progressHandler0 = this._receiver0 = this._promise0 = void 0;
                            else {
                                var t = 5 * e - 5;
                                this[t + 3] = this[t + 4] = this[t + 0] = this[t + 1] = this[t + 2] = void 0
                            }
                        }, t.prototype._isSettlePromisesQueued = function () {
                            return -1073741824 === (-1073741824 & this._bitField)
                        }, t.prototype._setSettlePromisesQueued = function () {
                            this._bitField = -1073741824 | this._bitField
                        }, t.prototype._unsetSettlePromisesQueued = function () {
                            this._bitField = 1073741823 & this._bitField
                        }, t.prototype._queueSettlePromises = function () {
                            s.settlePromises(this), this._setSettlePromisesQueued()
                        }, t.prototype._fulfillUnchecked = function (e) {
                            if (e === this) {
                                var t = r();
                                return this._attachExtraTrace(t), this._rejectUnchecked(t, void 0)
                            }
                            this._setFulfilled(), this._settledValue = e, this._cleanValues(), this._length() > 0 && this._queueSettlePromises()
                        }, t.prototype._rejectUncheckedCheckError = function (e) {
                            var t = i.ensureErrorObject(e);
                            this._rejectUnchecked(e, t === e ? void 0 : t)
                        }, t.prototype._rejectUnchecked = function (e, t) {
                            if (e === this) {
                                var n = r();
                                return this._attachExtraTrace(n), this._rejectUnchecked(n)
                            }
                            return this._setRejected(), this._settledValue = e, this._cleanValues(), this._isFinal() ? void s.throwLater(function (e) {
                                throw "stack" in e && s.invokeFirst(f.unhandledRejection, void 0, e), e
                            }, void 0 === t ? e : t) : (void 0 !== t && t !== e && this._setCarriedStackTrace(t), void(this._length() > 0 ? this._queueSettlePromises() : this._ensurePossibleRejectionHandled()))
                        }, t.prototype._settlePromises = function () {
                            this._unsetSettlePromisesQueued();
                            for (var e = this._length(), t = 0; e > t; t++) this._settlePromiseAt(t)
                        }, t._makeSelfResolutionError = r, e("./method.js")(t, l, h, a), e("./bind.js")(t, l, h), e("./finally.js")(t, p, h), e("./direct_resolve.js")(t), e("./synchronous_inspection.js")(t), e("./join.js")(t, g, h, l), t.Promise = t, e("./map.js")(t, g, a, h, l), e("./using.js")(t, a, h, b), e("./generators.js")(t, a, l, h), e("./nodeify.js")(t), e("./cancel.js")(t), e("./promisify.js")(t, l), e("./props.js")(t, g, h, a), e("./race.js")(t, l, h, a), e("./reduce.js")(t, g, a, h, l), e("./settle.js")(t, g), e("./call_get.js")(t), e("./some.js")(t, g, a), e("./progress.js")(t, g), e("./any.js")(t), e("./each.js")(t, l), e("./timers.js")(t, l), e("./filter.js")(t, l), i.toFastProperties(t), i.toFastProperties(t.prototype), n({
                            a: 1
                        }), n({
                            b: 2
                        }), n({
                            c: 3
                        }), n(1), n(function () {}), n(void 0), n(!1), n(new t(l)), f.setBounds(s.firstLineError, i.lastLineError), t
                    }
                }, {
                    "./any.js": 1,
                    "./async.js": 2,
                    "./bind.js": 3,
                    "./call_get.js": 5,
                    "./cancel.js": 6,
                    "./captured_trace.js": 7,
                    "./catch_filter.js": 8,
                    "./context.js": 9,
                    "./debuggability.js": 10,
                    "./direct_resolve.js": 11,
                    "./each.js": 12,
                    "./errors.js": 13,
                    "./filter.js": 15,
                    "./finally.js": 16,
                    "./generators.js": 17,
                    "./join.js": 18,
                    "./map.js": 19,
                    "./method.js": 20,
                    "./nodeify.js": 21,
                    "./progress.js": 22,
                    "./promise_array.js": 24,
                    "./promise_resolver.js": 25,
                    "./promisify.js": 26,
                    "./props.js": 27,
                    "./race.js": 29,
                    "./reduce.js": 30,
                    "./settle.js": 32,
                    "./some.js": 33,
                    "./synchronous_inspection.js": 34,
                    "./thenables.js": 35,
                    "./timers.js": 36,
                    "./using.js": 37,
                    "./util.js": 38
                }],
                24: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        function a(e) {
                            switch (e) {
                            case -2:
                                return [];
                            case -3:
                                return {}
                            }
                        }
                        function i(e) {
                            var r, o = this._promise = new t(n);
                            e instanceof t && (r = e, o._propagateFrom(r, 5)), this._values = e, this._length = 0, this._totalResolved = 0, this._init(void 0, -2)
                        }
                        var s = e("./util.js"),
                            c = s.isArray;
                        return i.prototype.length = function () {
                            return this._length
                        }, i.prototype.promise = function () {
                            return this._promise
                        }, i.prototype._init = function u(e, n) {
                            var i = r(this._values, this._promise);
                            if (i instanceof t) {
                                if (i = i._target(), this._values = i, !i._isFulfilled()) return i._isPending() ? void i._then(u, this._reject, void 0, this, n) : void this._reject(i._reason());
                                if (i = i._value(), !c(i)) {
                                    var s = new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");
                                    return void this.__hardReject__(s)
                                }
                            } else if (!c(i)) return void this._promise._reject(o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());
                            if (0 === i.length) return void(-5 === n ? this._resolveEmptyArray() : this._resolve(a(n)));
                            var l = this.getActualLength(i.length);
                            this._length = l, this._values = this.shouldCopyValues() ? new Array(l) : this._values;
                            for (var d = this._promise, p = 0; l > p; ++p) {
                                var h = this._isResolved(),
                                    g = r(i[p], d);
                                g instanceof t ? (g = g._target(), h ? g._unsetRejectionIsUnhandled() : g._isPending() ? g._proxyPromiseArray(this, p) : g._isFulfilled() ? this._promiseFulfilled(g._value(), p) : this._promiseRejected(g._reason(), p)) : h || this._promiseFulfilled(g, p)
                            }
                        }, i.prototype._isResolved = function () {
                            return null === this._values
                        }, i.prototype._resolve = function (e) {
                            this._values = null, this._promise._fulfill(e)
                        }, i.prototype.__hardReject__ = i.prototype._reject = function (e) {
                            this._values = null, this._promise._rejectCallback(e, !1, !0)
                        }, i.prototype._promiseProgressed = function (e, t) {
                            this._promise._progress({
                                index: t,
                                value: e
                            })
                        }, i.prototype._promiseFulfilled = function (e, t) {
                            this._values[t] = e;
                            var n = ++this._totalResolved;
                            n >= this._length && this._resolve(this._values)
                        }, i.prototype._promiseRejected = function (e) {
                            this._totalResolved++, this._reject(e)
                        }, i.prototype.shouldCopyValues = function () {
                            return !0
                        }, i.prototype.getActualLength = function (e) {
                            return e
                        }, i
                    }
                }, {
                    "./util.js": 38
                }],
                25: [function (e, t) {
                    "use strict";

                    function n(e) {
                        return e instanceof Error && p.getPrototypeOf(e) === Error.prototype
                    }
                    function r(e) {
                        var t;
                        if (n(e)) {
                            t = new l(e), t.name = e.name, t.message = e.message, t.stack = e.stack;
                            for (var r = p.keys(e), o = 0; o < r.length; ++o) {
                                var a = r[o];
                                h.test(a) || (t[a] = e[a])
                            }
                            return t
                        }
                        return i.markAsOriginatingFromRejection(e), e
                    }
                    function o(e) {
                        return function (t, n) {
                            if (null !== e) {
                                if (t) {
                                    var o = r(s(t));
                                    e._attachExtraTrace(o), e._reject(o)
                                } else if (arguments.length > 2) {
                                    for (var a = arguments.length, i = new Array(a - 1), c = 1; a > c; ++c) i[c - 1] = arguments[c];
                                    e._fulfill(i)
                                } else e._fulfill(n);
                                e = null
                            }
                        }
                    }
                    var a, i = e("./util.js"),
                        s = i.maybeWrapAsError,
                        c = e("./errors.js"),
                        u = c.TimeoutError,
                        l = c.OperationalError,
                        d = i.haveGetters,
                        p = e("./es5.js"),
                        h = /^(?:name|message|stack|cause)$/;
                    if (a = d ?
                    function (e) {
                        this.promise = e
                    } : function (e) {
                        this.promise = e, this.asCallback = o(e), this.callback = this.asCallback
                    }, d) {
                        var g = {
                            get: function () {
                                return o(this.promise)
                            }
                        };
                        p.defineProperty(a.prototype, "asCallback", g), p.defineProperty(a.prototype, "callback", g)
                    }
                    a._nodebackForPromise = o, a.prototype.toString = function () {
                        return "[object PromiseResolver]"
                    }, a.prototype.resolve = a.prototype.fulfill = function (e) {
                        if (!(this instanceof a)) throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");
                        this.promise._resolveCallback(e)
                    }, a.prototype.reject = function (e) {
                        if (!(this instanceof a)) throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");
                        this.promise._rejectCallback(e)
                    }, a.prototype.progress = function (e) {
                        if (!(this instanceof a)) throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");
                        this.promise._progress(e)
                    }, a.prototype.cancel = function (e) {
                        this.promise.cancel(e)
                    }, a.prototype.timeout = function () {
                        this.reject(new u("timeout"))
                    }, a.prototype.isResolved = function () {
                        return this.promise.isResolved()
                    }, a.prototype.toJSON = function () {
                        return this.promise.toJSON()
                    }, t.exports = a
                }, {
                    "./errors.js": 13,
                    "./es5.js": 14,
                    "./util.js": 38
                }],
                26: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n) {
                        function r(e) {
                            return !E.test(e)
                        }
                        function o(e) {
                            try {
                                return e.__isPromisified__ === !0
                            } catch (t) {
                                return !1
                            }
                        }
                        function a(e, t, n) {
                            var r = h.getDataPropertyOrDefault(e, t + n, A);
                            return r ? o(r) : !1
                        }
                        function i(e, t, n) {
                            for (var r = 0; r < e.length; r += 2) {
                                var o = e[r];
                                if (n.test(o)) for (var a = o.replace(n, ""), i = 0; i < e.length; i += 2) if (e[i] === a) throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s", t))
                            }
                        }
                        function s(e, t, n, r) {
                            for (var s = h.inheritedDataKeys(e), c = [], u = 0; u < s.length; ++u) {
                                var l = s[u],
                                    d = e[l],
                                    p = r === v ? !0 : v(l, d, e);
                                "function" != typeof d || o(d) || a(e, l, t) || !r(l, d, e, p) || c.push(l, d)
                            }
                            return i(c, t, n), c
                        }
                        function c(e, r, o, a) {
                            function i() {
                                var o = r;
                                r === p && (o = this);
                                var a = new t(n);
                                a._captureStackTrace();
                                var i = "string" == typeof c && this !== s ? this[c] : e,
                                    u = g(a);
                                try {
                                    i.apply(o, f(arguments, u))
                                } catch (l) {
                                    a._rejectCallback(m(l), !0, !0)
                                }
                                return a
                            }
                            var s = function () {
                                    return this
                                }(),
                                c = e;
                            return "string" == typeof c && (e = a), i.__isPromisified__ = !0, i
                        }
                        function u(e, t, n, r) {
                            for (var o = new RegExp(N(t) + "$"), a = s(e, t, o, n), i = 0, c = a.length; c > i; i += 2) {
                                var u = a[i],
                                    l = a[i + 1],
                                    d = u + t;
                                e[d] = r === C ? C(u, p, u, l, t) : r(l, function () {
                                    return C(u, p, u, l, t)
                                })
                            }
                            return h.toFastProperties(e), e
                        }
                        function l(e, t) {
                            return C(e, t, void 0, e)
                        }
                        var d, p = {},
                            h = e("./util.js"),
                            g = e("./promise_resolver.js")._nodebackForPromise,
                            f = h.withAppended,
                            m = h.maybeWrapAsError,
                            b = h.canEvaluate,
                            y = e("./errors").TypeError,
                            _ = "Async",
                            A = {
                                __isPromisified__: !0
                            },
                            E = /^(?:length|name|arguments|caller|prototype|__isPromisified__)$/,
                            v = function (e, t) {
                                return h.isIdentifier(e) && "_" !== e.charAt(0) && !h.isClass(t)
                            },
                            N = function (e) {
                                return e.replace(/([$])/, "\\$")
                            },
                            C = b ? d : c;
                        t.promisify = function (e, t) {
                            if ("function" != typeof e) throw new y("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            if (o(e)) return e;
                            var n = l(e, arguments.length < 2 ? p : t);
                            return h.copyDescriptors(e, n, r), n
                        }, t.promisifyAll = function (e, t) {
                            if ("function" != typeof e && "object" != typeof e) throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");
                            t = Object(t);
                            var n = t.suffix;
                            "string" != typeof n && (n = _);
                            var r = t.filter;
                            "function" != typeof r && (r = v);
                            var o = t.promisifier;
                            if ("function" != typeof o && (o = C), !h.isIdentifier(n)) throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");
                            for (var a = h.inheritedDataKeys(e), i = 0; i < a.length; ++i) {
                                var s = e[a[i]];
                                "constructor" !== a[i] && h.isClass(s) && (u(s.prototype, n, r, o), u(s, n, r, o))
                            }
                            return u(e, n, r, o)
                        }
                    }
                }, {
                    "./errors": 13,
                    "./promise_resolver.js": 25,
                    "./util.js": 38
                }],
                27: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        function a(e) {
                            for (var t = u.keys(e), n = t.length, r = new Array(2 * n), o = 0; n > o; ++o) {
                                var a = t[o];
                                r[o] = e[a], r[o + n] = a
                            }
                            this.constructor$(r)
                        }
                        function i(e) {
                            var n, i = r(e);
                            return c(i) ? (n = i instanceof t ? i._then(t.props, void 0, void 0, void 0, void 0) : new a(i).promise(), i instanceof t && n._propagateFrom(i, 4), n) : o("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")
                        }
                        var s = e("./util.js"),
                            c = s.isObject,
                            u = e("./es5.js");
                        s.inherits(a, n), a.prototype._init = function () {
                            this._init$(void 0, -3)
                        }, a.prototype._promiseFulfilled = function (e, t) {
                            this._values[t] = e;
                            var n = ++this._totalResolved;
                            if (n >= this._length) {
                                for (var r = {}, o = this.length(), a = 0, i = this.length(); i > a; ++a) r[this._values[a + o]] = this._values[a];
                                this._resolve(r)
                            }
                        }, a.prototype._promiseProgressed = function (e, t) {
                            this._promise._progress({
                                key: this._values[t + this.length()],
                                value: e
                            })
                        }, a.prototype.shouldCopyValues = function () {
                            return !1
                        }, a.prototype.getActualLength = function (e) {
                            return e >> 1
                        }, t.prototype.props = function () {
                            return i(this)
                        }, t.props = function (e) {
                            return i(e)
                        }
                    }
                }, {
                    "./es5.js": 14,
                    "./util.js": 38
                }],
                28: [function (e, t) {
                    "use strict";

                    function n(e, t, n, r, o) {
                        for (var a = 0; o > a; ++a) n[a + r] = e[a + t], e[a + t] = void 0
                    }
                    function r(e) {
                        this._capacity = e, this._length = 0, this._front = 0
                    }
                    r.prototype._willBeOverCapacity = function (e) {
                        return this._capacity < e
                    }, r.prototype._pushOne = function (e) {
                        var t = this.length();
                        this._checkCapacity(t + 1);
                        var n = this._front + t & this._capacity - 1;
                        this[n] = e, this._length = t + 1
                    }, r.prototype._unshiftOne = function (e) {
                        var t = this._capacity;
                        this._checkCapacity(this.length() + 1);
                        var n = this._front,
                            r = (n - 1 & t - 1 ^ t) - t;
                        this[r] = e, this._front = r, this._length = this.length() + 1
                    }, r.prototype.unshift = function (e, t, n) {
                        this._unshiftOne(n), this._unshiftOne(t), this._unshiftOne(e)
                    }, r.prototype.push = function (e, t, n) {
                        var r = this.length() + 3;
                        if (this._willBeOverCapacity(r)) return this._pushOne(e), this._pushOne(t), void this._pushOne(n);
                        var o = this._front + r - 3;
                        this._checkCapacity(r);
                        var a = this._capacity - 1;
                        this[o + 0 & a] = e, this[o + 1 & a] = t, this[o + 2 & a] = n, this._length = r
                    }, r.prototype.shift = function () {
                        var e = this._front,
                            t = this[e];
                        return this[e] = void 0, this._front = e + 1 & this._capacity - 1, this._length--, t
                    }, r.prototype.length = function () {
                        return this._length
                    }, r.prototype._checkCapacity = function (e) {
                        this._capacity < e && this._resizeTo(this._capacity << 1)
                    }, r.prototype._resizeTo = function (e) {
                        var t = this._capacity;
                        this._capacity = e;
                        var r = this._front,
                            o = this._length,
                            a = r + o & t - 1;
                        n(this, 0, this, t, a)
                    }, t.exports = r
                }, {}],
                29: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        function a(e, a) {
                            var c = r(e);
                            if (c instanceof t) return s(c);
                            if (!i(e)) return o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");
                            var u = new t(n);
                            void 0 !== a && u._propagateFrom(a, 5);
                            for (var l = u._fulfill, d = u._reject, p = 0, h = e.length; h > p; ++p) {
                                var g = e[p];
                                (void 0 !== g || p in e) && t.cast(g)._then(l, d, void 0, u, null)
                            }
                            return u
                        }
                        var i = e("./util.js").isArray,
                            s = function (e) {
                                return e.then(function (t) {
                                    return a(t, e)
                                })
                            };
                        t.race = function (e) {
                            return a(e, void 0)
                        }, t.prototype.race = function () {
                            return a(this, void 0)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                30: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o, a) {
                        function i(e, n, r, i) {
                            this.constructor$(e), this._promise._captureStackTrace(), this._preservedValues = i === a ? [] : null, this._zerothIsAccum = void 0 === r, this._gotAccum = !1, this._reducingIndex = this._zerothIsAccum ? 1 : 0, this._valuesPhase = void 0;
                            var s = o(r, this._promise),
                                c = !1,
                                u = s instanceof t;
                            u && (s = s._target(), s._isPending() ? s._proxyPromiseArray(this, -1) : s._isFulfilled() ? (r = s._value(), this._gotAccum = !0) : (this._reject(s._reason()), c = !0)), u || this._zerothIsAccum || (this._gotAccum = !0), this._callback = n, this._accum = r, c || this._init$(void 0, -5)
                        }
                        function s(e, t, n, o) {
                            if ("function" != typeof t) return r("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            var a = new i(e, t, n, o);
                            return a.promise()
                        }
                        var c = e("./util.js"),
                            u = c.tryCatch,
                            l = c.errorObj;
                        c.inherits(i, n), i.prototype._init = function () {}, i.prototype._resolveEmptyArray = function () {
                            (this._gotAccum || this._zerothIsAccum) && this._resolve(null !== this._preservedValues ? [] : this._accum)
                        }, i.prototype._promiseFulfilled = function (e, n) {
                            var r = this._values;
                            r[n] = e;
                            var a, i = this.length(),
                                s = this._preservedValues,
                                c = null !== s,
                                d = this._gotAccum,
                                p = this._valuesPhase;
                            if (!p) for (p = this._valuesPhase = new Array(i), a = 0; i > a; ++a) p[a] = 0;
                            if (a = p[n], 0 === n && this._zerothIsAccum ? (this._accum = e, this._gotAccum = d = !0, p[n] = 0 === a ? 1 : 2) : -1 === n ? (this._accum = e, this._gotAccum = d = !0) : 0 === a ? p[n] = 1 : (p[n] = 2, this._accum = e), d) {
                                for (var h, g = this._callback, f = this._promise._boundTo, m = this._reducingIndex; i > m; ++m) if (a = p[m], 2 !== a) {
                                    if (1 !== a) return;
                                    if (e = r[m], this._promise._pushContext(), c ? (s.push(e), h = u(g).call(f, e, m, i)) : h = u(g).call(f, this._accum, e, m, i), this._promise._popContext(), h === l) return this._reject(h.e);
                                    var b = o(h, this._promise);
                                    if (b instanceof t) {
                                        if (b = b._target(), b._isPending()) return p[m] = 4, b._proxyPromiseArray(this, m);
                                        if (!b._isFulfilled()) return this._reject(b._reason());
                                        h = b._value()
                                    }
                                    this._reducingIndex = m + 1, this._accum = h
                                } else this._reducingIndex = m + 1;
                                this._resolve(c ? s : this._accum)
                            }
                        }, t.prototype.reduce = function (e, t) {
                            return s(this, e, t, null)
                        }, t.reduce = function (e, t, n, r) {
                            return s(e, t, n, r)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                31: [function (e, r) {
                    "use strict";
                    var o;
                    if (e("./util.js").isNode) {
                        var a = t.versions.node.split(".").map(Number);
                        o = 0 === a[0] && a[1] > 10 || a[0] > 0 ? n.setImmediate : t.nextTick
                    } else "undefined" != typeof MutationObserver ? (o = function (e) {
                        var t = document.createElement("div"),
                            n = new MutationObserver(e);
                        return n.observe(t, {
                            attributes: !0
                        }), function () {
                            t.classList.toggle("foo")
                        }
                    }, o.isStatic = !0) : o = "undefined" != typeof setTimeout ?
                    function (e) {
                        setTimeout(e, 0)
                    } : function () {
                        throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")
                    };
                    r.exports = o
                }, {
                    "./util.js": 38
                }],
                32: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n) {
                        function r(e) {
                            this.constructor$(e)
                        }
                        var o = t.PromiseInspection,
                            a = e("./util.js");
                        a.inherits(r, n), r.prototype._promiseResolved = function (e, t) {
                            this._values[e] = t;
                            var n = ++this._totalResolved;
                            n >= this._length && this._resolve(this._values)
                        }, r.prototype._promiseFulfilled = function (e, t) {
                            var n = new o;
                            n._bitField = 268435456, n._settledValue = e, this._promiseResolved(t, n)
                        }, r.prototype._promiseRejected = function (e, t) {
                            var n = new o;
                            n._bitField = 134217728, n._settledValue = e, this._promiseResolved(t, n)
                        }, t.settle = function (e) {
                            return new r(e).promise()
                        }, t.prototype.settle = function () {
                            return new r(this).promise()
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                33: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r) {
                        function o(e) {
                            this.constructor$(e), this._howMany = 0, this._unwrap = !1, this._initialized = !1
                        }
                        function a(e, t) {
                            if ((0 | t) !== t || 0 > t) return r("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");
                            var n = new o(e),
                                a = n.promise();
                            return n.setHowMany(t), n.init(), a
                        }
                        var i = e("./util.js"),
                            s = e("./errors.js").RangeError,
                            c = e("./errors.js").AggregateError,
                            u = i.isArray;
                        i.inherits(o, n), o.prototype._init = function () {
                            if (this._initialized) {
                                if (0 === this._howMany) return void this._resolve([]);
                                this._init$(void 0, -5);
                                var e = u(this._values);
                                !this._isResolved() && e && this._howMany > this._canPossiblyFulfill() && this._reject(this._getRangeError(this.length()))
                            }
                        }, o.prototype.init = function () {
                            this._initialized = !0, this._init()
                        }, o.prototype.setUnwrap = function () {
                            this._unwrap = !0
                        }, o.prototype.howMany = function () {
                            return this._howMany
                        }, o.prototype.setHowMany = function (e) {
                            this._howMany = e
                        }, o.prototype._promiseFulfilled = function (e) {
                            this._addFulfilled(e), this._fulfilled() === this.howMany() && (this._values.length = this.howMany(), this._resolve(1 === this.howMany() && this._unwrap ? this._values[0] : this._values))
                        }, o.prototype._promiseRejected = function (e) {
                            if (this._addRejected(e), this.howMany() > this._canPossiblyFulfill()) {
                                for (var t = new c, n = this.length(); n < this._values.length; ++n) t.push(this._values[n]);
                                this._reject(t)
                            }
                        }, o.prototype._fulfilled = function () {
                            return this._totalResolved
                        }, o.prototype._rejected = function () {
                            return this._values.length - this.length()
                        }, o.prototype._addRejected = function (e) {
                            this._values.push(e)
                        }, o.prototype._addFulfilled = function (e) {
                            this._values[this._totalResolved++] = e
                        }, o.prototype._canPossiblyFulfill = function () {
                            return this.length() - this._rejected()
                        }, o.prototype._getRangeError = function (e) {
                            var t = "Input array must contain at least " + this._howMany + " items but contains only " + e + " items";
                            return new s(t)
                        }, o.prototype._resolveEmptyArray = function () {
                            this._reject(this._getRangeError(0))
                        }, t.some = function (e, t) {
                            return a(e, t)
                        }, t.prototype.some = function (e) {
                            return a(this, e)
                        }, t._SomePromiseArray = o
                    }
                }, {
                    "./errors.js": 13,
                    "./util.js": 38
                }],
                34: [function (e, t) {
                    "use strict";
                    t.exports = function (e) {
                        function t(e) {
                            void 0 !== e ? (e = e._target(), this._bitField = e._bitField, this._settledValue = e._settledValue) : (this._bitField = 0, this._settledValue = void 0)
                        }
                        t.prototype.value = function () {
                            if (!this.isFulfilled()) throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");
                            return this._settledValue
                        }, t.prototype.error = t.prototype.reason = function () {
                            if (!this.isRejected()) throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");
                            return this._settledValue
                        }, t.prototype.isFulfilled = e.prototype._isFulfilled = function () {
                            return (268435456 & this._bitField) > 0
                        }, t.prototype.isRejected = e.prototype._isRejected = function () {
                            return (134217728 & this._bitField) > 0
                        }, t.prototype.isPending = e.prototype._isPending = function () {
                            return 0 === (402653184 & this._bitField)
                        }, t.prototype.isResolved = e.prototype._isResolved = function () {
                            return (402653184 & this._bitField) > 0
                        }, e.prototype.isPending = function () {
                            return this._target()._isPending()
                        }, e.prototype.isRejected = function () {
                            return this._target()._isRejected()
                        }, e.prototype.isFulfilled = function () {
                            return this._target()._isFulfilled()
                        }, e.prototype.isResolved = function () {
                            return this._target()._isResolved()
                        }, e.prototype._value = function () {
                            return this._settledValue
                        }, e.prototype._reason = function () {
                            return this._unsetRejectionIsUnhandled(), this._settledValue
                        }, e.prototype.value = function () {
                            var e = this._target();
                            if (!e.isFulfilled()) throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");
                            return e._settledValue
                        }, e.prototype.reason = function () {
                            var e = this._target();
                            if (!e.isRejected()) throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");
                            return e._unsetRejectionIsUnhandled(), e._settledValue
                        }, e.PromiseInspection = t
                    }
                }, {}],
                35: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n) {
                        function r(e, r) {
                            if (u(e)) {
                                if (e instanceof t) return e;
                                if (a(e)) {
                                    var l = new t(n);
                                    return e._then(l._fulfillUnchecked, l._rejectUncheckedCheckError, l._progressUnchecked, l, null), l
                                }
                                var d = s.tryCatch(o)(e);
                                if (d === c) {
                                    r && r._pushContext();
                                    var l = t.reject(d.e);
                                    return r && r._popContext(), l
                                }
                                if ("function" == typeof d) return i(e, d, r)
                            }
                            return e
                        }
                        function o(e) {
                            return e.then
                        }
                        function a(e) {
                            return l.call(e, "_promise0")
                        }
                        function i(e, r, o) {
                            function a(n) {
                                l && (e === n ? l._rejectCallback(t._makeSelfResolutionError(), !1, !0) : l._resolveCallback(n), l = null)
                            }
                            function i(e) {
                                l && (l._rejectCallback(e, p, !0), l = null)
                            }
                            function u(e) {
                                l && "function" == typeof l._progress && l._progress(e)
                            }
                            var l = new t(n),
                                d = l;
                            o && o._pushContext(), l._captureStackTrace(), o && o._popContext();
                            var p = !0,
                                h = s.tryCatch(r).call(e, a, i, u);
                            return p = !1, l && h === c && (l._rejectCallback(h.e, !0, !0), l = null), d
                        }
                        var s = e("./util.js"),
                            c = s.errorObj,
                            u = s.isObject,
                            l = {}.hasOwnProperty;
                        return r
                    }
                }, {
                    "./util.js": 38
                }],
                36: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n) {
                        function r(e) {
                            var t = this;
                            return t instanceof Number && (t = +t), clearTimeout(t), e
                        }
                        function o(e) {
                            var t = this;
                            throw t instanceof Number && (t = +t), clearTimeout(t), e
                        }
                        var a = e("./util.js"),
                            i = t.TimeoutError,
                            s = function (e, t) {
                                if (e.isPending()) {
                                    "string" != typeof t && (t = "operation timed out");
                                    var n = new i(t);
                                    a.markAsOriginatingFromRejection(n), e._attachExtraTrace(n), e._cancel(n)
                                }
                            },
                            c = function (e) {
                                return u(+this).thenReturn(e)
                            },
                            u = t.delay = function (e, r) {
                                if (void 0 === r) {
                                    r = e, e = void 0;
                                    var o = new t(n);
                                    return setTimeout(function () {
                                        o._fulfill()
                                    }, r), o
                                }
                                return r = +r, t.resolve(e)._then(c, null, null, r, void 0)
                            };
                        t.prototype.delay = function (e) {
                            return u(this, e)
                        }, t.prototype.timeout = function (e, t) {
                            e = +e;
                            var n = this.then().cancellable();
                            n._cancellationParent = this;
                            var a = setTimeout(function () {
                                s(n, t)
                            }, e);
                            return n._then(r, o, void 0, a, void 0)
                        }
                    }
                }, {
                    "./util.js": 38
                }],
                37: [function (e, t) {
                    "use strict";
                    t.exports = function (t, n, r, o) {
                        function a(e) {
                            for (var n = e.length, r = 0; n > r; ++r) {
                                var o = e[r];
                                if (o.isRejected()) return t.reject(o.error());
                                e[r] = o._settledValue
                            }
                            return e
                        }
                        function i(e) {
                            setTimeout(function () {
                                throw e
                            }, 0)
                        }
                        function s(e) {
                            var t = r(e);
                            return t !== e && "function" == typeof e._isDisposable && "function" == typeof e._getDisposer && e._isDisposable() && t._setDisposable(e._getDisposer()), t
                        }
                        function c(e, n) {
                            function o() {
                                if (a >= c) return u.resolve();
                                var l = s(e[a++]);
                                if (l instanceof t && l._isDisposable()) {
                                    try {
                                        l = r(l._getDisposer().tryDispose(n), e.promise)
                                    } catch (d) {
                                        return i(d)
                                    }
                                    if (l instanceof t) return l._then(o, i, null, null, null)
                                }
                                o()
                            }
                            var a = 0,
                                c = e.length,
                                u = t.defer();
                            return o(), u.promise
                        }
                        function u(e) {
                            var t = new m;
                            return t._settledValue = e, t._bitField = 268435456, c(this, t).thenReturn(e)
                        }
                        function l(e) {
                            var t = new m;
                            return t._settledValue = e, t._bitField = 134217728, c(this, t).thenThrow(e)
                        }
                        function d(e, t, n) {
                            this._data = e, this._promise = t, this._context = n
                        }
                        function p(e, t, n) {
                            this.constructor$(e, t, n)
                        }
                        function h(e) {
                            return d.isDisposer(e) ? (this.resources[this.index]._setDisposable(e), e.promise()) : e
                        }
                        var g = e("./errors.js").TypeError,
                            f = e("./util.js").inherits,
                            m = t.PromiseInspection;
                        d.prototype.data = function () {
                            return this._data
                        }, d.prototype.promise = function () {
                            return this._promise
                        }, d.prototype.resource = function () {
                            return this.promise().isFulfilled() ? this.promise().value() : null
                        }, d.prototype.tryDispose = function (e) {
                            var t = this.resource(),
                                n = this._context;
                            void 0 !== n && n._pushContext();
                            var r = null !== t ? this.doDispose(t, e) : null;
                            return void 0 !== n && n._popContext(), this._promise._unsetDisposable(), this._data = null, r
                        }, d.isDisposer = function (e) {
                            return null != e && "function" == typeof e.resource && "function" == typeof e.tryDispose
                        }, f(p, d), p.prototype.doDispose = function (e, t) {
                            var n = this.data();
                            return n.call(e, e, t)
                        }, t.using = function () {
                            var e = arguments.length;
                            if (2 > e) return n("you must pass at least 2 arguments to Promise.using");
                            var o = arguments[e - 1];
                            if ("function" != typeof o) return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
                            e--;
                            for (var i = new Array(e), s = 0; e > s; ++s) {
                                var c = arguments[s];
                                if (d.isDisposer(c)) {
                                    var p = c;
                                    c = c.promise(), c._setDisposable(p)
                                } else {
                                    var g = r(c);
                                    g instanceof t && (c = g._then(h, null, null, {
                                        resources: i,
                                        index: s
                                    }, void 0))
                                }
                                i[s] = c
                            }
                            var f = t.settle(i).then(a).then(function (e) {
                                f._pushContext();
                                var t;
                                try {
                                    t = o.apply(void 0, e)
                                } finally {
                                    f._popContext()
                                }
                                return t
                            })._then(u, l, void 0, i, void 0);
                            return i.promise = f, f
                        }, t.prototype._setDisposable = function (e) {
                            this._bitField = 262144 | this._bitField, this._disposer = e
                        }, t.prototype._isDisposable = function () {
                            return (262144 & this._bitField) > 0
                        }, t.prototype._getDisposer = function () {
                            return this._disposer
                        }, t.prototype._unsetDisposable = function () {
                            this._bitField = -262145 & this._bitField, this._disposer = void 0
                        }, t.prototype.disposer = function (e) {
                            if ("function" == typeof e) return new p(e, this, o());
                            throw new g
                        }
                    }
                }, {
                    "./errors.js": 13,
                    "./util.js": 38
                }],
                38: [function (e, n, r) {
                    "use strict";

                    function o() {
                        try {
                            return w.apply(this, arguments)
                        } catch (e) {
                            return R.e = e, R
                        }
                    }
                    function a(e) {
                        return w = e, o
                    }
                    function i(e) {
                        return null == e || e === !0 || e === !1 || "string" == typeof e || "number" == typeof e
                    }
                    function s(e) {
                        return !i(e)
                    }
                    function c(e) {
                        return i(e) ? new Error(b(e)) : e
                    }
                    function u(e, t) {
                        var n, r = e.length,
                            o = new Array(r + 1);
                        for (n = 0; r > n; ++n) o[n] = e[n];
                        return o[n] = t, o
                    }
                    function l(e, t, n) {
                        if (!N.isES5) return {}.hasOwnProperty.call(e, t) ? e[t] : void 0;
                        var r = Object.getOwnPropertyDescriptor(e, t);
                        return null != r ? null == r.get && null == r.set ? r.value : n : void 0
                    }
                    function d(e, t, n) {
                        if (i(e)) return e;
                        var r = {
                            value: n,
                            configurable: !0,
                            enumerable: !1,
                            writable: !0
                        };
                        return N.defineProperty(e, t, r), e
                    }
                    function p(e) {
                        throw e
                    }
                    function h(e) {
                        try {
                            if ("function" == typeof e) {
                                var t = N.names(e.prototype);
                                return N.isES5 ? t.length > 1 : t.length > 0 && !(1 === t.length && "constructor" === t[0])
                            }
                            return !1
                        } catch (n) {
                            return !1
                        }
                    }
                    function g(e) {
                        function t() {}
                        return t.prototype = e, t
                    }
                    function f(e) {
                        return B.test(e)
                    }
                    function m(e, t, n) {
                        for (var r = new Array(e), o = 0; e > o; ++o) r[o] = t + o + n;
                        return r
                    }
                    function b(e) {
                        try {
                            return e + ""
                        } catch (t) {
                            return "[no string representation]"
                        }
                    }
                    function y(e) {
                        try {
                            d(e, "isOperational", !0)
                        } catch (t) {}
                    }
                    function _(e) {
                        return null == e ? !1 : e instanceof Error.__BluebirdErrorTypes__.OperationalError || e.isOperational === !0
                    }
                    function A(e) {
                        return e instanceof Error && N.propertyIsWritable(e, "stack")
                    }
                    function E(e) {
                        return {}.toString.call(e)
                    }
                    function v(e, t, n) {
                        for (var r = N.names(e), o = 0; o < r.length; ++o) {
                            var a = r[o];
                            n(a) && N.defineProperty(t, a, N.getDescriptor(e, a))
                        }
                    }
                    var N = e("./es5.js"),
                        C = "undefined" == typeof navigator,
                        S = function () {
                            try {
                                var e = {};
                                return N.defineProperty(e, "f", {
                                    get: function () {
                                        return 3
                                    }
                                }), 3 === e.f
                            } catch (t) {
                                return !1
                            }
                        }(),
                        R = {
                            e: {}
                        },
                        w, T = function (e, t) {
                            function n() {
                                this.constructor = e, this.constructor$ = t;
                                for (var n in t.prototype) r.call(t.prototype, n) && "$" !== n.charAt(n.length - 1) && (this[n + "$"] = t.prototype[n])
                            }
                            var r = {}.hasOwnProperty;
                            return n.prototype = t.prototype, e.prototype = new n, e.prototype
                        },
                        F = function () {
                            return "string" !== this
                        }.call("string"),
                        D = function () {
                            if (N.isES5) {
                                var e = Object.prototype,
                                    t = Object.getOwnPropertyNames;
                                return function (n) {
                                    for (var r = [], o = Object.create(null); null != n && n !== e;) {
                                        var a;
                                        try {
                                            a = t(n)
                                        } catch (i) {
                                            return r
                                        }
                                        for (var s = 0; s < a.length; ++s) {
                                            var c = a[s];
                                            if (!o[c]) {
                                                o[c] = !0;
                                                var u = Object.getOwnPropertyDescriptor(n, c);
                                                null != u && null == u.get && null == u.set && r.push(c)
                                            }
                                        }
                                        n = N.getPrototypeOf(n)
                                    }
                                    return r
                                }
                            }
                            return function (e) {
                                var t = [];
                                for (var n in e) t.push(n);
                                return t
                            }
                        }(),
                        B = /^[a-z$_][a-z$_0-9]*$/i,
                        I = function () {
                            return "stack" in new Error ?
                            function (e) {
                                return A(e) ? e : new Error(b(e))
                            } : function (e) {
                                if (A(e)) return e;
                                try {
                                    throw new Error(b(e))
                                } catch (t) {
                                    return t
                                }
                            }
                        }(),
                        P = {
                            isClass: h,
                            isIdentifier: f,
                            inheritedDataKeys: D,
                            getDataPropertyOrDefault: l,
                            thrower: p,
                            isArray: N.isArray,
                            haveGetters: S,
                            notEnumerableProp: d,
                            isPrimitive: i,
                            isObject: s,
                            canEvaluate: C,
                            errorObj: R,
                            tryCatch: a,
                            inherits: T,
                            withAppended: u,
                            maybeWrapAsError: c,
                            wrapsPrimitiveReceiver: F,
                            toFastProperties: g,
                            filledRange: m,
                            toString: b,
                            canAttachTrace: A,
                            ensureErrorObject: I,
                            originatesFromRejection: _,
                            markAsOriginatingFromRejection: y,
                            classString: E,
                            copyDescriptors: v,
                            isNode: "undefined" != typeof t && "[object process]" === E(t).toLowerCase()
                        };
                    try {
                        throw new Error
                    } catch (k) {
                        P.lastLineError = k
                    }
                    n.exports = P
                }, {
                    "./es5.js": 14
                }]
            }, {}, [4])(4)
        }), "undefined" != typeof window && null !== window ? window.P = window.Promise : "undefined" != typeof self && null !== self && (self.P = self.Promise)
    }).call(t, n(108), function () {
        return this
    }())
}, function (e) {
    e.exports = {
        intro_title: "Keep your phone connected",
        intro_connection: "WhatsApp Web connects to your phone to sync messages. To reduce data usage, connect your phone to Wi-Fi.",
        enumeration_comma: ", ",
        archive_chat: "Archive chat",
        unarchive_chat: "Unarchive chat",
        web_archive_broadcast: "Archive broadcast list",
        web_unarchive_broadcast: "Unarchive broadcast list",
        conversation_archived: "Conversation archived",
        broadcast_archived: "Broadcast list archived",
        group_archived: "Group archived",
        web_undo_comment: "If a chat is muted/archived, we show a small confirmation pop up. 'undo' is used to allow undo (unmute/unarchive)",
        web_undo: "undo",
        web_menuitem_groupchat: "New group",
        web_menuitem_new: "New chat",
        menuitem_profile_status: "Profile & status",
        menuitem_send_logs: "Send logs",
        menuitem_help: "Help",
        menuitem_keep_me_signed_in: "Keep me signed in",
        menuitem_notification_sounds: "Notification sounds",
        menuitem_notifications: "Notifications",
        menuitem_logout: "Log out",
        menutitle_attach: "Attach",
        menutitle_menu: "Menu",
        web_settings_faq: "FAQ",
        if_unchecked_you_will_be_logged_out_afterawhile: "You'll be logged out after several minutes of inactivity",
        change_group_icon: "Change group icon",
        add_group_icon: "Add group icon",
        change_profile_photo: "Change profile photo",
        add_profile_photo: "Add profile photo",
        web_status: "Status",
        web_delete: "Delete",
        web_exit: "Exit",
        subject: "Subject",
        group_subject: "Group Subject",
        web_contact_phone: "Phone",
        web_group_creation_time: "Created __when__",
        group_participant_hint: "Type contact name",
        new_chat_flow_title: "New chat",
        new_group_flow_title: "New group",
        add_group_participants_title: "Add group participants",
        web_contact_info: "Contact info",
        web_contact_info_comment: "Contact info, button, keep as short as possible [S]",
        web_group_info: "Group info",
        web_group_info_comment: "Group info, button, keep as short as possible [S]",
        web_groups_participation_you_and_name: "Your groups with __user__",
        web_participants_title: "Participants",
        web_recipients_title: "Recipients",
        web_participants_count: "__count__ of __max__",
        missing_photo_title: "Photo Unavailable",
        missing_photo_text: "Can’t view this photo because it's no longer on your phone.",
        missing_video_title: "Video Unavailable",
        missing_video_text: "Can’t play this video because it's no longer on your phone.",
        missing_audio_title: "Voice Message Unavailable",
        missing_audio_text: "Can’t play this Voice Message because it's no longer on your phone.",
        guide_desktop_notifications_title_comment: "Title of the popup requesting the user to enable desktop notifications on the browser",
        guide_desktop_notifications_title: "Allow notifications",
        guide_desktop_notifications_description_comment: "Description for requesting the user to enable desktop notifications on the browser.",
        guide_desktop_notifications_description: "To get notifications for new messages, click “Allow” above.",
        guide_desktop_notifications_description_firefox: "To get notifications for new messages, select “Always show notifications” from the prompt below the URL bar.",
        guide_desktop_camera_title: "Allow camera",
        guide_desktop_camera_description: "To take photos, click “Allow” above to give WhatsApp Web access to your computer's camera.",
        guide_desktop_camera_description_firefox: "To take photos, WhatsApp Web needs access to your computer’s camera. Select “Always share” from the prompt below the URL bar.",
        guide_desktop_mic_title: "Allow microphone",
        guide_desktop_mic_description: "To record Voice Messages, click “Allow” above to give WhatsApp Web access to your computer's microphone.",
        guide_desktop_mic_description_firefox: "To record Voice Messages, WhatsApp Web needs access to your computer’s microphone. Select “Always share” from the prompt below the URL bar. Note: selecting “Share selected device” won’t let you record Voice Messages.",
        guide_desktop_camera_fail_description: "To take photos, WhatsApp Web needs access to your computer's camera. Click __chrome_media_error__ in the URL bar and choose “Always allow web.whatsapp.com to access your camera.”",
        guide_desktop_camera_fail_description_firefox: "To take photos, WhatsApp Web needs access to your computer’s camera. Click __firefox_lock__ in the URL bar and set “Use the Camera” to “Allow.”",
        guide_desktop_camera_fail_description_opera: "To take photos, WhatsApp Web needs access to your computer’s camera. Click __opera_media__ in the URL bar and click “Clear This Setting and Reload.”",
        guide_desktop_mic_fail_description: "To record Voice Messages, WhatsApp Web needs access to your microphone. Click __chrome_media_error__ in the URL bar and choose “Always allow web.whatsapp.com to access your microphone.”",
        guide_desktop_mic_fail_description_firefox: "To record Voice Messages, WhatsApp Web needs access to your computer’s microphone. Click __firefox_lock__ in the URL bar and set “Use the Microphone” to “Allow.”",
        guide_desktop_mic_fail_description_opera: "To record Voice Messages, WhatsApp Web needs access to your computer’s microphone. Click __opera_media__ in the URL bar and click “Clear This Setting and Reload.”",
        guide_desktop_camera_missing_title: "Camera Not Found",
        guide_desktop_camera_missing_description: "You can’t take a photo because it looks like your computer doesn’t have a camera. Try connecting one or if you have one connected, try restarting your browser.",
        guide_desktop_mic_missing_title: "Microphone Not Found",
        guide_desktop_mic_missing_description: "You can’t record a Voice Message because it looks like your computer doesn’t have a microphone. Try connecting one or if you have one connected, try restarting your browser.",
        guide_help_title: "Help",
        guide_help_faq: "Click FAQ for help using WhatsApp Web.",
        guide_help_description_android: "To contact support, open WhatsApp on your phone and tap Menu – Settings – Help – Contact us.",
        guide_help_description_symbian: "To contact support, open WhatsApp on your phone and select Options - About - Contact support.",
        guide_help_description_bb: "To contact support, open WhatsApp on your phone and tap Settings – About – Contact support.",
        guide_help_description_bbx: "To contact support, open WhatsApp on your phone and swipe down from the top of the screen - Settings - Contact support.",
        guide_help_description_wp7: "To contact support, open WhatsApp on your phone and tap menu (three dots at the bottom of the screen) – Settings – About – Contact support.",
        guide_help_description_s40: "To contact support, open WhatsApp on your phone – swipe up from bottom – Settings - About - Options – Contact support.",
        turn_off_all_desktop_notifications_for: "Turn off all desktop notifications for:",
        learn_more: "Learn more",
        ok_got_it: "OK, got it",
        web_view_comment: "In a conversation, used to view a location message without an address.",
        web_view: "View",
        web_preview_msg: "Preview",
        add_a_caption: "Add a caption",
        add_media: "Add media",
        drag_media_here_comment: "Used in attach image/video panel",
        drag_media_here: "Drag media here",
        take_photo: "Take photo",
        upload_photo: "Upload photo",
        invalid_media_files_comment: "Displayed if user tries to send an  image or video with an unsupported file type",
        invalid_media_files: "WhatsApp Web doesn't support the type of image or video you tried adding. Try adding a different one.",
        image_too_big_comment: "Displayed if user adds an image that's too large.",
        image_too_big: "The image you tried adding is larger than the 16MB limit. Try adding a different one.",
        video_too_big_comment: "Displayed if user adds an video that's too large.",
        video_too_big: "The video you tried adding is larger than the 16MB limit. Try adding a different one.",
        option_select_mute: "Turn off alerts and sounds for...",
        option_desktop_notifications: "Desktop Alerts",
        option_sounds: "Sounds",
        web_menuitem_mute_off_comment: "Cancel group mute, button (should be 1 word)",
        web_menuitem_mute_off: "Cancel mute",
        web_menuitem_mute_comment: "Mute group, button (should be 1 word)",
        web_menuitem_mute: "Mute",
        group_muted: "Group muted",
        web_mute_time: "Mute group for…",
        web_list_info_comment: "Broadcast list info, button, keep as short as possible [S]",
        web_list_info: "Broadcast list info",
        click_here_for_group_info: "click here for group info",
        click_here_for_user_info: "click here for contact info",
        web_delete_contact_dialog_title: "Delete chat with “__name__”?",
        web_exit_group_dialog_title: "Exit “__groupName__” group?",
        web_delete_group_dialog_title: "Delete “__groupName__” group?",
        web_exit_group: "Exit group",
        web_delete_group: "Delete group",
        delete_chat: "Delete chat",
        web_delete_list: "Delete broadcast list",
        conversation_deleted: "Conversation deleted",
        broadcast_deleted: "Broadcast list deleted",
        group_deleted: "Group deleted",
        unread_message_count_comment: "The unread message divider count",
        unread_message_count: "__count__ unread message",
        unread_message_count_plural: "__count__ unread messages",
        web_chats: "Chats",
        web_contacts: "Contacts",
        web_conversation_is_composing: "typing…",
        web_conversation_is_recording: "recording audio…",
        web_conversation_contact_online: "online",
        web_conversation_name_is_composing: "__participant__ is typing…",
        web_conversation_name_is_recording: "__participant__ is recording audio…",
        web_conversations_most_recent_image: "Image",
        web_conversations_most_recent_audio: "Audio",
        web_conversations_most_recent_voice: "Voice message",
        web_conversations_most_recent_video: "Video",
        web_conversations_most_recent_contact: "Contact",
        web_conversations_most_recent_location: "Location",
        search_no_chats_or_contacts: "No chats or contacts found",
        no_chats_comment: "The user has no chats to display [S]",
        no_chats: "No chats",
        all_chats_archived_comment: "No chats are shown because they are all archived [S]",
        all_chats_archived: "All chats are archived",
        web_group_admin: "Group Admin",
        contact_status_loading: "Loading status…",
        retry_now: "Retry Now",
        retake_comment: "Retake button on image captures.",
        retake: "Retake",
        web_cancel: "Cancel",
        web_ok: "OK",
        web_close: "Close",
        web_share: "Share",
        web_button_download: "Download",
        trying_to_reach_phone: "Trying to reach phone",
        connecting_to_whatsapp: "Connecting to WhatsApp",
        connecting_to_whatsapp_or_phone: "Connecting",
        retrying: "Retrying…",
        retrying_in: "Retrying in __duration__…",
        loading_messages: "loading messages…",
        load_earlier_messages: "load earlier messages…",
        resend_message: "Click to resend",
        web_today_at: "today at __time__",
        web_yesterday_at: "yesterday at __time__",
        web_time_at: "__date__ at __time__",
        web_conversation_last_seen: "last seen",
        web_you: "You",
        web_today: "today",
        web_yesterday: "yesterday",
        retrying_in_some_seconds: "Retrying in __number__ second…",
        retrying_in_some_seconds_plural: "Retrying in __number__ seconds…",
        web_you_created_list_unnamed: "You created a broadcast list with __count__ recipient",
        web_you_created_list_unnamed_plural: "You created a broadcast list with __count__ recipients",
        web_list_recipient_added: "__name__ added to the list",
        web_list_recipient_removed: "__name__ removed from the list",
        web_group_subject_changed_by_you: "You changed the subject to “__subject__”",
        web_group_subject_changed_by_name: "__name__ changed the subject to “__subject__”",
        web_group_participant_added_name: "__name__ was added",
        web_group_participant_added_you: "You were added",
        web_group_participant_removed_name: "__name__ was removed",
        web_group_participant_removed_you: "You were removed",
        web_group_participant_left_name: "__name__ left",
        web_group_participant_left_you: "You left",
        web_group_participant_changed_number: "__name__ changed from __old_number__ to __new_number__",
        web_group_participant_changed_number_unknown_name: "__name__ changed to __new_number__",
        web_group_participants_name_added_names: "__name__ added __participants__",
        web_group_participants_you_added_names: "You added __participants__",
        web_group_participants_name_removed_names: "__name__ removed __participants__",
        web_group_participants_you_removed_names: "You removed __participants__",
        web_group_participants_name_added_you: "__name__ added you",
        web_group_participants_name_removed_you: "__name__ removed you",
        web_group_participant_promoted_names: "__participants__ is now an admin",
        web_group_participant_promoted_names_plural: "__participants__ are now admins",
        web_group_participant_demoted_names: "__participants__ is no longer an admin",
        web_group_participant_demoted_names_plural: "__participants__ are no longer admins",
        web_group_participant_promoted_you: "You're now an admin",
        web_group_participant_demoted_you: "You're no longer an admin",
        web_group_created_by_you: "You created group “__subject__”",
        web_group_created_by_name: "__name__ created group “__subject__”",
        web_group_created_by_you_no_subject: "You created this group",
        web_group_created_by_name_no_subject: "__name__ created this group",
        web_group_ended_you: "You ended this group",
        web_group_ended_name: "__name__ ended this group",
        web_photo_changed_by: "__name__ changed this group's icon",
        web_photo_removed_by: "__name__ deleted this group's icon",
        web_photo_changed_by_you: "You changed this group's icon",
        web_photo_removed_by_you: "You deleted this group's icon",
        web_mute_8hours: "8 Hours",
        web_mute_1week: "1 Week",
        web_mute_1year: "1 Year",
        mute_1hour: "1 Hour",
        mute_1day: "1 Day",
        mute_1week: "1 Week",
        global_muted: "Alerts and sounds off",
        global_muted_1hour: "Alerts and sounds off for 1 hour",
        global_muted_1day: "Alerts and sounds off for 1 day",
        global_muted_1week: "Alerts and sounds off for 1 week",
        global_notification_sounds_on: "Notification sounds on",
        global_notification_sounds_off: "Notification sounds off",
        global_unmuted: "Notifications enabled",
        global_unmute: "Alerts and sounds off. Click to restore.",
        web_cannot_send_not_a_group_participant: "You can't send messages to this group because you're no longer a participant.",
        web_cannot_send_to_blocked_contact_1: "Can't send a message to blocked contact __contact__.",
        type_a_message_comment: "placeholder hint in message composition box",
        type_a_message: "type a message",
        whatsapp_web: "WhatsApp Web",
        default_group_message_notification_title_comment: "Desktop notifications show group title. This is default title if we don't have actual title",
        default_group_message_notification_title: "WhatsApp group message",
        default_contact_message_notification_title_comment: "Desktop notifications show contact name as title.  This is default if we don't have actual name",
        default_contact_message_notification_title: "WhatsApp message",
        search_or_start_new_chat: "Search or start new chat",
        update_available: "Update Available",
        click_to_update_whatsapp_web: "Click to update WhatsApp Web",
        phone_battery_low: "Phone Battery Low",
        charge_phone_description: "Charge your phone to keep using WhatsApp Web",
        computer_not_connected: "Computer Not Connected",
        make_sure_computer_active_internet_connection: "Make sure your computer has an active Internet connection",
        check_internet_connection: "No Internet connection",
        phone_not_connected: "Phone Not Connected",
        make_sure_phone_active_internet_connection_comment: "Part of a larger string that has a link to the faq article.",
        make_sure_phone_active_internet_connection: "Make sure your phone has an active Internet connection.",
        enable_desktop_notifications: "Turn on desktop notifications",
        get_notified_of_new_messages: "Get Notified of New Messages",
        phone_has_another_active_webclient_session: "WhatsApp Web is open on another computer or browser. Click “Use Here” to use WhatsApp Web in this window.",
        whatsapp_web_is_open_in_another_window: "WhatsApp Web is open in another window. Click “Use Here” to use WhatsApp Web in this window.",
        button_use_here: "Use Here",
        open_whatsapp: "Open WhatsApp",
        click_to_reload_qr_code: "Click to reload QR code",
        scan_code_with_phone_to_login: "Scan code with your phone to log in",
        reduce_data_usage_connect_phone_to_wifi: "To reduce data usage, connect your phone to Wi-Fi",
        android: "Android",
        android_login_path: "Open WhatsApp — Menu — WhatsApp Web",
        blackberry: "BlackBerry",
        blackberry_login_path: "Open WhatsApp — Chats — Menu key — WhatsApp Web",
        windows_phone: "Windows Phone",
        windows_phone_login_path: "Open WhatsApp — Menu — WhatsApp Web",
        nokia_symbian_s60: "Nokia S60",
        nokia_symbian_s60_login_path: "Open WhatsApp — Menu — WhatsApp Web",
        nokia_s40: "Nokia S40",
        nokia_s40_login_path: "Open WhatsApp – Swipe up from bottom of screen – WhatsApp Web",
        bb10: "BlackBerry 10",
        bb10_login_path: "Open WhatsApp — Swipe down from top of screen — WhatsApp Web",
        login_hint_version: "Requires the latest version of WhatsApp",
        download_google_chrome: "Download Google Chrome",
        only_works_in_google_chrome: "WhatsApp Web only works in Google Chrome.",
        more_browsers_coming_soon: "More browsers coming soon.",
        message_too_large_title: "Message Too Long",
        message_too_large_text: "The message you’re pasting is too long. Try shortening it or sending it in multiple parts.",
        video_playback_not_supported: "Your browser doesn’t support video playback.",
        audio_playback_not_supported: "Your browser doesn’t support audio playback."
    }
}, function (e, t, n) {
    function r(e) {
        return function (t) {
            return "number" == typeof t.status && t.status >= 500 ? t : void e(t)
        }
    }
    function o(e, t) {
        return function (n) {
            if ("object" == typeof n && "number" == typeof n.status) {
                if (401 === n.status) throw new R.E401;
                if (n.status >= 500) return n;
                t(n)
            } else e(n)
        }
    }
    function a(e, t) {
        return ["action", {
            type: e
        }, t]
    }
    function i(e, t) {
        return ["query", e, t]
    }
    function s(e, t) {
        return e.reduce(function (e, t) {
            return e || t
        }, !1) ? void 0 : t
    }
    function c(e) {
        var t = {};
        if ("action" !== P.tag(e)) return t;
        var n = P.attr("add", e),
            r = P.attr("missing", e);
        switch (n) {
        case "after":
        case "before":
        case "last":
        case "relay":
        case "update":
            t.add = n
        }
        switch (r) {
        case "remove":
            t.missing = r
        }
        return t
    }
    function u(e) {
        var t = {};
        if (!_.isArray(e)) return t;
        var n, r, o = e.length;
        for (r = 0; o > r; r++) switch (n = e[r], P.tag(n)) {
        case "broadcast":
            switch (P.attr("type", n)) {
            case "create":
            case "add":
            case "remove":
                t.msg || (t.msg = []), t.msg.push(n);
                break;
            case "modify":
                t.bcUpdate || (t.bcUpdate = []), t.bcUpdate.push(n)
            }
            break;
        case "message":
        case "groups_v2":
        case "notification":
            t.msg || (t.msg = []), t.msg.push(n);
            break;
        case "read":
        case "log":
            t.cmd || (t.cmd = []), t.cmd.push(n);
            break;
        case "received":
            t.ack || (t.ack = []), t.ack.push(n);
            break;
        case "user":
            t.contact || (t.contact = []), t.contact.push(n);
            break;
        case "chat":
            switch (P.attr("type", n)) {
            case "mute":
                t.mute || (t.mute = []), t.mute.push(n);
                break;
            default:
                t.chat || (t.chat = []), t.chat.push(n)
            }
            break;
        case "battery":
            t.battery || (t.battery = []), t.battery.push(n);
            break;
        default:
            Wa.debug("Wap:groupActionsByType unknown action: " + P.toString(n), "red", n, !0)
        }
        return t
    }
    function l(e, t) {
        var n = parseInt(P.attr(t, e), 10);
        return _.isNaN(n) ? void 0 : n
    }
    function d(e) {
        if ("chat" === P.tag(e)) {
            var t = P.attr("jid", e),
                n = parseInt(P.attr("t", e), 10) || void 0,
                r = P.attr("type", e),
                o = parseInt(P.attr("mute", e), 10) || void 0,
                a = parseInt(P.attr("before", e), 10) || void 0,
                i = "true" === P.attr("archive", e),
                c = "true" === P.attr("read_only", e),
                u = parseInt(P.attr("modify_tag", e), 10) || void 0,
                d = P.attr("name", e) || void 0,
                p = l(e, "count");
            "ahead" === r && (r = "clear");
            var h, g = P.children(e);
            if (_.isArray(g)) {
                h = [];
                var f, m, b = g.length;
                for (f = 0; b > f; f++) if (m = g[f], "item" === P.tag(m)) {
                    var y = P.attr("index", m);
                    y && h.push([y, "true" === P.attr("owner", m)])
                }
            }
            var A = {
                id: t,
                t: n,
                type: r,
                keys: h,
                before: a,
                archive: i,
                isReadOnly: c,
                unreadCount: p,
                muteExpiration: o,
                modifyTag: u,
                name: d
            },
                E = [r && "delete" !== r && "clear" !== r && "archive" !== r && "unarchive" !== r && "mute" !== r, !r && !t, i && r && "clear" !== r, "clear" !== r && a && a > 0, "clear" !== r && h && h.length > 0];
            return s(E, A)
        }
    }
    function p(e) {
        if ("user" === P.tag(e)) {
            var t = P.attr("jid", e),
                n = P.attr("name", e),
                r = P.attr("short", e) || void 0,
                o = P.attr("type", e) || "in",
                a = {
                    id: t,
                    name: n,
                    type: o,
                    shortName: r
                },
                i = [!t, "in" !== o && "out" !== o && !! o];
            return s(i, a)
        }
    }
    function h(e) {
        var t = P.tag(e);
        if ("read" === t) {
            var n = P.attr("jid", e),
                r = {
                    type: "read",
                    jid: n
                },
                o = [!n];
            return s(o, r)
        }
    }
    function g(e) {
        if ("received" === P.tag(e)) {
            var t, n = P.attr("type", e),
                r = P.attr("id", e),
                o = P.attr("to", e);
            switch (n) {
            case "message":
                t = 2;
                break;
            case "read":
                t = 3;
                break;
            case "played":
                t = 4;
                break;
            default:
                t = 0
            }
            var a = {
                cmd: "ack",
                id: r,
                ack: t,
                from: Wa.me,
                to: o
            },
                i = [!r, !o, "message" !== n && "read" !== n && "played" !== n];
            return s(i, a)
        }
    }
    function f(e) {
        if ("broadcast" === P.tag(e) && "modify" === P.attr("type", e)) {
            var t = P.attr("jid", e),
                n = P.children(e),
                r = [];
            if (_.isArray(n)) {
                var o, a, i, c = n.length;
                for (o = 0; c > o; o++) a = n[o], i = P.attr("jid", a), "recipient" === P.tag(a) && i && 2 === i.split("@").length && "c.us" === i.split("@")[1] && r.push({
                    id: i
                })
            }
            var u = {
                id: t,
                participants: r
            },
                l = [!t, "broadcast" !== t.split("@")[1], 0 === r.length];
            return s(l, u)
        }
    }
    function m(e) {
        if ("battery" === P.tag(e)) {
            var t = Math.min(parseInt(P.attr("value", e), 10) || -1, 100),
                n = P.attr("live", e),
                r = {
                    battery: 0 > t ? void 0 : t,
                    plugged: n ? "true" === n : void 0
                },
                o = [0 > t && !n];
            return s(o, r)
        }
    }
    function b(e) {
        return e.from === Wa.me ? e.to : e.from
    }
    function y(e, t) {
        switch (P.tag(e)) {
        case "message":
            return A(e, t);
        case "groups_v2":
            return v(e);
        case "broadcast":
            return N(e);
        case "notification":
            return C(e);
        default:
            return
        }
    }
    function A(e, t) {
        if ("message" === P.tag(e)) {
            var n;
            P.attr("from", e) !== Wa.me || P.attr("to", e) ? P.attr("to", e) !== Wa.me || P.attr("from", e) || (n = "out") : n = "in";
            var r, o = P.attr("id", e),
                a = parseInt(P.attr("t", e), 10) || 0,
                i = P.attr("to", e) || Wa.me,
                c = P.attr("from", e) || Wa.me,
                u = "broadcast" === c.split("@")[1],
                l = P.attr("participant", e),
                d = u ? l : c,
                p = u ? void 0 : l,
                h = u ? !1 : P.child("broadcast", e) && c === Wa.me,
                g = "invis" === P.attr("web", e),
                f = P.attr("notify", e) || "",
                m = parseInt(P.attr("status", e)) || 0,
                b = [],
                y = P.child("broadcast", e);
            if (n && (o += "_" + n), "broadcast" !== i) {
                switch (t) {
                case "fresh":
                    r = 1;
                    break;
                default:
                    r = m >= -1 && 4 >= m ? m : 1
                }
                if (_.isArray(y)) {
                    var A, v = y.length;
                    for (A = 0; v > A; A++) {
                        var N = y[A],
                            C = P.attr("jid", N);
                        "to" === P.tag(N) && C && b.push(C)
                    }
                }
                var S, R = [];
                switch (P.attr("type", e)) {
                case "text":
                    var w = P.dataStr(P.child("body", e)) || "";
                    S = {
                        id: o,
                        body: w,
                        type: "chat",
                        t: a,
                        notifyName: f,
                        from: d,
                        to: i,
                        self: n,
                        author: p,
                        invis: g,
                        ack: r,
                        broadcast: h,
                        recipients: b
                    }, R = [!o, !a, !d, !i];
                    break;
                case "media":
                    var T, F, D, B, I, k = P.child("media", e),
                        O = P.attr("type", k);
                    if ("retry" === P.attr("reason", k)) return;
                    switch (O) {
                    case "image":
                    case "video":
                        var M = P.attr("caption", k);
                        T = E(k), F = P.attr("url", k), D = P.attr("filehash", k), B = parseInt(P.attr("size", k), 10) || 0, I = P.attr("seconds", k), S = {
                            id: o,
                            body: T,
                            type: O,
                            t: a,
                            notifyName: f,
                            from: d,
                            to: i,
                            author: p,
                            invis: g,
                            ack: r,
                            clientUrl: F,
                            duration: I,
                            broadcast: h,
                            recipients: b,
                            filehash: D,
                            size: B,
                            caption: M
                        }, R = [!o, !a, !d, !i];
                        break;
                    case "location":
                        var L = P.attr("latitude", k),
                            x = P.attr("longitude", k),
                            U = P.attr("name", k);
                        T = E(k), F = P.attr("url", k), S = {
                            id: o,
                            body: T,
                            type: O,
                            t: a,
                            notifyName: f,
                            from: d,
                            to: i,
                            author: p,
                            invis: g,
                            ack: r,
                            clientUrl: F,
                            loc: U,
                            lat: L,
                            lng: x,
                            broadcast: h,
                            recipients: b
                        }, R = [!o, !a, !d, !i, !L || !x];
                        break;
                    case "audio":
                        var $ = "live" === P.attr("origin", k) ? "ptt" : O;
                        F = P.attr("url", k), D = P.attr("filehash", k), B = parseInt(P.attr("size", k), 10) || 0, I = P.attr("seconds", k), S = {
                            id: o,
                            type: $,
                            t: a,
                            notifyName: f,
                            from: d,
                            to: i,
                            author: p,
                            invis: g,
                            ack: r,
                            clientUrl: F,
                            duration: I,
                            broadcast: h,
                            recipients: b,
                            filehash: D,
                            size: B
                        }, R = [!o, !a, !d, !i];
                        break;
                    case "vcard":
                        var W = P.child("vcard", k),
                            j = P.dataStr(W),
                            G = P.attr("name", W);
                        S = {
                            id: o,
                            body: j,
                            type: O,
                            subtype: G,
                            t: a,
                            notifyName: f,
                            from: d,
                            to: i,
                            author: p,
                            invis: g,
                            ack: r,
                            broadcast: h,
                            recipients: b
                        }, R = [!o, !a, !d, !i, !j, !G];
                        break;
                    default:
                        Wa.debug("unknown media type: " + P.toString(e), "red", e)
                    }
                    break;
                default:
                    Wa.debug("unknown message type: " + P.toString(e), "red", e)
                }
                return s(R, S)
            }
        }
    }
    function E(e) {
        return "raw" === P.attr("encoding", e) ? T.isByteBuffer(P.children(e)) ? P.children(e).toBase64() : "" : P.dataStr(e)
    }
    function v(e) {
        if ("groups_v2" === P.tag(e)) {
            var t, n = parseInt(P.attr("t", e), 10) || 0,
                r = P.attr("id", e),
                o = P.attr("jid", e),
                a = "invis" === P.attr("web", e),
                i = P.attr("type", e),
                c = P.attr("author", e),
                u = P.children(e),
                l = [];
            switch (i) {
            case "create":
                t = P.attr("subject", e);
                break;
            case "subject":
                t = P.attr("subject", e);
                break;
            case "picture":
                t = P.attr("picture", e)
            }
            if (_.isArray(u)) {
                var d, p = u.length;
                for (d = 0; p > d; d++) {
                    var h = u[d],
                        g = P.attr("jid", h);
                    "participant" === P.tag(h) && g && l.push(g)
                }
            }
            var f = {
                t: n,
                id: r,
                to: o,
                from: o,
                author: c,
                body: t ? t.toString() : void 0,
                type: "gp2",
                subtype: i,
                invis: a,
                recipients: l
            },
                m = [!r, !n, "subject" !== i && "add" !== i && "remove" !== i && "leave" !== i && "picture" !== i && "modify" !== i && "create" !== i && "delete" !== i && "promote" !== i && "demote" !== i, "subject" === i && !t, ("add" === i || "remove" === i || "leave" === i || "promote" === i || "demote" === i || "modify" === i) && 0 === l.length, !o, "string" == typeof o && "g.us" !== o.split("@")[1]];
            return s(m, f)
        }
    }
    function N(e) {
        if ("broadcast" === P.tag(e)) {
            var t, n = P.attr("type", e),
                r = P.attr("id", e),
                o = parseInt(P.attr("t", e), 10) || 0,
                a = P.attr("jid", e);
            switch (n) {
            case "create":
                t = parseInt(P.attr("count", e), 10) || 0;
                break;
            case "add":
            case "remove":
                t = P.attr("participant", e)
            }
            var i = {
                id: r,
                t: o,
                type: "broadcast_notification",
                subtype: n,
                from: a,
                to: a,
                body: t ? t.toString() : void 0
            },
                c = [!r, !o, !a, "string" == typeof a && "broadcast" !== a.split("@")[1], "create" !== n && "add" !== n && "remove" !== n, ("add" === n || "remove" === n) && 2 !== t.split("@").length];
            return s(c, i)
        }
    }
    function C(e) {
        if ("notification" === P.tag(e)) {
            var t = P.attr("id", e),
                n = parseInt(P.attr("t", e), 10) || 0,
                r = P.attr("jid", e),
                o = "invis" === P.attr("web", e),
                a = P.dataStr(e),
                i = "true" === P.attr("owner", e) ? Wa.me : r,
                c = "true" === P.attr("owner", e) ? r : Wa.me,
                u = {
                    id: t,
                    type: "notification",
                    t: n,
                    invis: o,
                    from: i,
                    to: c,
                    body: a
                },
                l = [!t, !n, !r, 2 !== r.split("@").length];
            return s(l, u)
        }
    }
    function S(e) {
        return new Promise(function (t, n) {
            w.send({
                data: ["query", "sendMedia", e],
                onSend: r(t),
                onDrop: n
            })
        })
    }
    var R = n(33),
        w = n(30),
        T = n(74),
        F = n(122),
        D = new F("01"),
        B = new F("03"),
        I = D,
        P = D.Node,
        k = {
            DEBUG_LOG: 1,
            QUERY_RESUME: 2,
            QUERY_RECEIPT: 3,
            QUERY_MEDIA: 4,
            QUERY_CHAT: 5,
            QUERY_CONTACTS: 6,
            QUERY_MESSAGES: 7,
            PRESENCE: 8,
            PRESENCE_SUBSCRIBE: 9,
            GROUP: 10,
            READ: 11,
            CHAT: 12,
            RECEIVED: 13,
            PIC: 14,
            STATUS: 15,
            MESSAGE: 16
        },
        O = {
            setSubProtocol: function (e) {
                1 === e ? (I = D, P = D.Node) : (I = B, P = B.Node)
            },
            setSharedSecret: function (e) {
                function t(e) {
                    return CryptoJS.lib.WordArray.create(new Uint8Array(e))
                }
                Wa.debug("Wap:saveSharedSecret start");
                var n = goog.crypt.base64.encodeByteArray,
                    r = goog.crypt.base64.decodeStringToByteArray,
                    o = r(e),
                    a = o.slice(0, 32),
                    i = n(o.slice(32, 64)),
                    s = t(o.slice(64)),
                    c = t(a.concat(o.slice(64))),
                    u = e2e.ecc.PrimeCurve.CURVE_25519,
                    l = new e2e.ecc.Ecdh(u, Wa.secretBundle.keyPair),
                    d = l.bob(a).secret,
                    p = new e2e.Hkdf(new e2e.hash.Sha256),
                    h = p.getHKDF(d, [], 80),
                    g = t(h.slice(0, 32)),
                    f = t(h.slice(32, 64)),
                    m = t(h.slice(64, 80)),
                    b = CryptoJS.HmacSHA256(c, f).toString(CryptoJS.enc.Base64);
                if (i !== b) return void Wa.debug("Wap:saveSharedSecret hmac mismatch " + i + " " + b, "red");
                var y = CryptoJS.AES.decrypt({
                    ciphertext: s,
                    salt: void 0
                }, g, {
                    iv: m,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                }),
                    _ = T.fromBase64(y.toString(CryptoJS.enc.Base64)),
                    A = _.slice(0, 32).toBuffer(),
                    E = _.slice(32, 64).toBuffer(),
                    v = CryptoJS.lib.WordArray.create(A),
                    N = CryptoJS.lib.WordArray.create(E);
                Wa.setSecretKeys("0.1", v, N), Wa.debug("Wap:saveSharedSecret done")
            },
            handle: function (e, t, n) {
                var r, o, a, i, s, l, A = I.read(e);
                switch (P.tag(A)) {
                case "response":
                    if (0 === n.indexOf("preempt")) switch (P.attr("type", A)) {
                    case "chat":
                        if (Wa.debug("bin-recv: " + n + ",response,chat", "green", A), o = P.children(A) || [], _.isArray(o)) {
                            for (i = o.length, r = [], a = 0; i > a; a++) l = d(o[a]), l && r.push(l);
                            Store.Chat.handle([{
                                cmd: "preempt",
                                response: r
                            }], t)
                        }
                        break;
                    case "contacts":
                        if (Wa.debug("bin-recv: " + n + ",response,contact", "green", A), o = P.children(A), _.isArray(o)) {
                            for (i = o.length, r = [], a = 0; i > a; a++) s = p(o[a]), s && r.push(s);
                            Store.Contact.handle([{
                                cmd: "preempt",
                                response: r
                            }], t)
                        }
                        break;
                    default:
                        Wa.debug("Wap:handle unknown response type: " + P.toString(A, !0), "red", A)
                    } else Wa.debug("Wap:handle non-preemptive response: " + P.toString(A, !0), "red", A);
                    break;
                case "action":
                    var E = c(A),
                        v = u(P.children(A)),
                        N = Object.keys(v);
                    if (_.isArray(N)) {
                        var C, S, R, w, T = N.length;
                        if (0 === T && "last" === E.add) Store.Msg.handle([{
                            recent: !0
                        }], t);
                        else for (a = 0; T > a; a++) {
                            S = N[a], C = v[S];
                            var F, D = C.length;
                            switch (S) {
                            case "msg":
                                var B;
                                switch (E.add) {
                                case "relay":
                                case "update":
                                    B = y(C[0], "relay"), 1 !== D && Wa.debug("Wap:handle action msg relay length not 1", "red", A), B ? (Wa.debug("bin-recv: " + [n, "action", "msg", E.add, C.length, B.from, B.to, B.id].join(","), "green", A), w = b(B), Store.Msg.handle([{
                                        meta: {
                                            add: E.add
                                        },
                                        chat: w,
                                        msg: B
                                    }], t)) : Wa.debug("Wap:handle action msg relay dropped", "red", C[0]);
                                    break;
                                case "last":
                                    for (Wa.debug("bin-recv: " + [n, "action", "msg", "last", C.length].join(","), "green", A), R = [], F = 0; D > F; F++) B = y(C[F], "last"), B ? R.push(B) : Wa.debug("Wap:handle action msg last dropped", "red", C[F]);
                                    if (R.length > 0) {
                                        for (var k = {
                                            recent: !0
                                        }, O = 0; O < R.length; O++) k[b(R[O])] = R[O];
                                        Store.Msg.handle([k], t)
                                    } else Wa.debug("Wap:handle action msg last dropped to 0", "red");
                                    break;
                                case "before":
                                case "after":
                                    if (D > 0) {
                                        for (R = [], F = 0; D > F; F++) B = y(C[F], E.add), B ? R.push(B) : Wa.debug("Wap:handle action msg before/after dropped", "red", C[F]);
                                        Wa.debug("bin-recv: " + [n, "action", "msg", E.add, R.length].join(","), "green", A), R.length > 0 ? (w = b(R[0]), Store.Msg.handle([{
                                            meta: {
                                                add: E.add
                                            },
                                            chat: w,
                                            msgs: R
                                        }], t)) : Wa.debug("Wap:handle action msg before/after droppped to 0", "red")
                                    } else Wa.debug("Wap:handle action msg before/after 0 msgs", "red");
                                    break;
                                default:
                                    Wa.debug("Wap:handle action msg no meta.add", "red", A)
                                }
                                break;
                            case "cmd":
                                for (F = 0; D > F; F++) {
                                    var M = h(C[F]);
                                    if (M) {
                                        var L = Object.keys(M).map(function (e) {
                                            return M[e]
                                        }).join(",");
                                        Wa.debug("bin-recv: " + [n, "action", "cmd", L].join(","), "green", A), Store.Cmd.handle([M], t)
                                    } else Wa.debug("Wap:handle action cmd invalid", "red", A)
                                }
                                break;
                            case "bcUpdate":
                                var x = [];
                                for (F = 0; D > F; F++) {
                                    var U = f(C[F]);
                                    U ? x.push(U) : Wa.debug("Wap:handle action bc update invalid", "red", C[F])
                                }
                                Wa.debug("bin-recv: " + [n, "action", "bcUpdate", x.length].join(","), "green", A), x.length > 0 && Store.GroupMetadata.handle(x, t);
                                break;
                            case "ack":
                                for (F = 0; D > F; F++) {
                                    var $ = g(C[F]);
                                    $ ? (Wa.debug("bin-recv: " + [n, "action", "ack", $.to, $.id, $.ack].join(","), "green", A), Store.Msg.handle([$], t)) : Wa.debug("Wap:handle action ack invalid", "red", A)
                                }
                                break;
                            case "contact":
                                for (contacts = [], F = 0; D > F; F++) s = p(C[F]), s ? contacts.push(s) : Wa.debug("Wap:handle action contact dropped", "red", C[F]);
                                if (Wa.debug("bin-recv: " + [n, "action", "contact", contacts.length, E.missing].join(","), "green", A), contacts.length > 0) {
                                    var W = [contacts];
                                    E.missing && W.push({
                                        missing: E.missing
                                    }), Store.Contact.handle(W, t)
                                }
                                break;
                            case "chat":
                                for (chats = [], F = 0; D > F; F++) l = d(C[F]), l ? chats.push(l) : Wa.debug("Wap:handle action chat dropped", "red", C[F]);
                                Wa.debug("bin-recv: " + [n, "action", "chat", chats.length].join(","), "green", A), chats.length > 0 && Store.Chat.handle([chats], t);
                                break;
                            case "battery":
                                var j = m(C[0]);
                                j ? (Wa.debug("bin-recv: " + [n, "action", "battery", j.battery, j.plugged].join(","), "green", A), Store.Conn.handle([j], t)) : Wa.debug("Wap:handle action battery dropped", "red", C[0]);
                                break;
                            case "mute":
                                for (chats = [], F = 0; D > F; F++) l = d(C[F]), l ? chats.push(l) : Wa.debug("Wap:handle action mute dropped", "red", C[F]);
                                Wa.debug("bin-recv: " + [n, "action", "mute", chats.length].join(","), "green", A), chats.length > 0 && Store.Mute.handle(chats, t);
                                break;
                            default:
                                Wa.debug("Wap:handle action unknown " + S, "red", A)
                            }
                        }
                    }
                    break;
                default:
                    Wa.debug("TODO " + P.toString(A, !0), "red", A, !0)
                }
                return !0
            },
            requestDeviceUploadLogs: function () {
                return new Promise(function (e, t) {
                    var n = a("debug", [
                        ["log", void 0, void 0]
                    ]),
                        r = e;
                    r.drop = !0, w.send({
                        data: I.write(n),
                        onSend: r,
                        onDrop: t,
                        binaryOpts: {
                            debugString: "debug,log",
                            debugObj: n,
                            metric: k.DEBUG_LOG,
                            ackRequest: !0
                        }
                    })
                })
            },
            resyncMessages: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            var n = [],
                                r = I.read(e),
                                o = P.children(r);
                            if (Wa.debug("bin-recv: response,resume", "green", r), "response" === P.tag(r) && "resume" === P.attr("type", r) && _.isArray(o)) {
                                var a, i = o.length;
                                for (a = 0; i > a; a++) {
                                    var s = d(o[a]);
                                    s && n.push(s)
                                }
                            }
                            t(n)
                        },
                        a = e.map(function (e) {
                            var t = {
                                jid: e.wid,
                                index: e.id,
                                owner: e.fromMe,
                                archive: ( !! e.archive).toString()
                            };
                            return e.mute && (t.mute = e.mute.toString()), e.active && (t.active = "true"), Wa.isGroupWid(e.wid) && (t.read_only = ( !! e.isReadOnly).toString()), e.modifyTag && (t.modify_tag = e.modifyTag.toString()), e.unreadCount && (t.count = e.unreadCount.toString()), ["last", t, void 0]
                        }),
                        s = i({
                            type: "resume"
                        }, a);
                    w.sendEphemeral({
                        data: I.write(s),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,resume",
                            debugObj: s,
                            metric: k.QUERY_RESUME,
                            ackRequest: !1
                        }
                    })
                })
            },
            resyncReceipts: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            var n = [],
                                r = I.read(e),
                                o = P.children(r);
                            if (Wa.debug("bin-recv: response,receipt", "green", r), "response" === P.tag(r) && "receipt" === P.attr("type", r) && _.isArray(o)) {
                                var a, i, s, c = o.length;
                                for (a = 0; c > a; a++) {
                                    i = o[a], s = P.children(i);
                                    var u = P.attr("jid", i),
                                        l = P.attr("t", i);
                                    if ("receipt" === P.tag(i) && u && l && _.isArray(s)) {
                                        var d, p = [],
                                            h = s.length;
                                        for (d = 0; h > d; d++) {
                                            var g = s[d];
                                            if ("item" === P.tag(g)) {
                                                var f = P.attr("index", g),
                                                    m = parseInt(P.attr("status", g), 10) || 0;
                                                f && 0 !== m && 4 >= m && p.push([f, m])
                                            }
                                        }
                                        p.length > 0 && n.push({
                                            id: u,
                                            t: parseInt(l, 10),
                                            acks: p
                                        })
                                    }
                                }
                            }
                            t(n)
                        },
                        a = e.map(function (e) {
                            return ["last", {
                                jid: e.wid,
                                index: e.id,
                                t: e.t.toString()
                            }, void 0]
                        }),
                        s = i({
                            type: "receipt"
                        }, a);
                    w.sendEphemeral({
                        data: I.write(s),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,receipt",
                            debugObj: s,
                            metric: k.QUERY_RECEIPT,
                            ackRequest: !1
                        }
                    })
                })
            },
            addParticipant: function (e, t) {
                return new Promise(function (n, o) {
                    var i = w.tag(),
                        s = r(n);
                    s.tag = i;
                    var c = ["participant",
                    {
                        jid: t
                    },
                    void 0],
                        u = ["group",
                        {
                            id: i,
                            jid: e,
                            type: "add",
                            author: Wa.me
                        }, [c]],
                        l = a("set", [u]);
                    w.send({
                        data: I.write(l),
                        onSend: s,
                        onDrop: o,
                        binaryOpts: {
                            debugString: "action,group,add_participant",
                            debugObj: l,
                            metric: k.GROUP,
                            ackRequest: !1
                        }
                    })
                })
            },
            changeSubject: function (e, t) {
                return new Promise(function (n, o) {
                    var i = w.tag(),
                        s = r(n);
                    s.tag = i;
                    var c = ["group",
                    {
                        id: i,
                        jid: e,
                        type: "subject",
                        author: Wa.me,
                        subject: t
                    },
                    void 0],
                        u = a("set", [c]);
                    w.send({
                        data: I.write(u),
                        onSend: s,
                        onDrop: o,
                        binaryOpts: {
                            debugString: "action,group,subject",
                            debugObj: u,
                            metric: k.GROUP,
                            ackRequest: !1
                        }
                    })
                })
            },
            createGroup: function (e, t) {
                return new Promise(function (n, o) {
                    var i = w.tag(),
                        s = r(n);
                    s.tag = i;
                    var c = t.map(function (e) {
                        return ["participant", {
                            jid: e
                        }, void 0]
                    });
                    Wa.debug("create group tag", "black", i);
                    var u = ["group",
                    {
                        id: i,
                        type: "create",
                        author: Wa.me,
                        subject: e
                    },
                    c],
                        l = a("set", [u]);
                    w.send({
                        data: I.write(l),
                        onSend: s,
                        onDrop: o,
                        binaryOpts: {
                            debugString: "action,group,create",
                            debugObj: l,
                            metric: k.GROUP,
                            ackRequest: !1
                        }
                    })
                })
            },
            leaveGroup: function (e) {
                return new Promise(function (t, n) {
                    var o = w.tag(),
                        i = r(t);
                    i.tag = o;
                    var s = ["group",
                    {
                        id: o,
                        jid: e,
                        type: "leave",
                        author: Wa.me
                    },
                    void 0],
                        c = a("set", [s]);
                    w.send({
                        data: I.write(c),
                        onSend: i,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,group,delete",
                            debugObj: c,
                            metric: k.GROUP,
                            ackRequest: !1
                        }
                    })
                })
            },
            removeParticipant: function (e, t) {
                return new Promise(function (n, o) {
                    var i = w.tag(),
                        s = r(n);
                    s.tag = i;
                    var c = ["participant",
                    {
                        jid: t
                    },
                    void 0],
                        u = ["group",
                        {
                            id: i,
                            jid: e,
                            type: "remove",
                            author: Wa.me
                        }, [c]],
                        l = a("set", [u]);
                    w.send({
                        data: I.write(l),
                        onSend: s,
                        onDrop: o,
                        binaryOpts: {
                            debugString: "action,group,rem_participant",
                            debugObj: l,
                            metric: k.GROUP,
                            ackRequest: !1
                        }
                    })
                })
            },
            requestMediaReupload: function (e) {
                return new Promise(function (t, n) {
                    var r = e.id,
                        a = (e.toJSON(), function (e) {
                            var n = I.read(e);
                            if ("response" === P.tag(n) && "media" === P.attr("type", n)) {
                                var r = parseInt(P.attr("code", n)) || 400,
                                    o = P.attr("url", n);
                                t(r >= 500 && 502 !== r ? {
                                    status: r
                                } : 200 === r && o ? {
                                    status: 200,
                                    url: o
                                } : 200 !== r || o ? {
                                    status: r
                                } : {
                                    status: 400
                                })
                            }
                        }),
                        s = Wa.splitMsgKey(r),
                        c = i({
                            type: "media",
                            index: s.id,
                            jid: s.remote,
                            owner: s.fromMe.toString()
                        }, void 0);
                    w.sendEphemeral({
                        data: I.write(c),
                        onSend: o(a, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,media",
                            debugObj: c,
                            metric: k.QUERY_MEDIA,
                            ackRequest: !1
                        }
                    })
                })
            },
            sendConversationSeen: function (e, t, n) {
                return new Promise(function (r, o) {
                    var i = r,
                        s = a("set", [
                            ["read",
                            {
                                jid: e,
                                index: t ? t.id : void 0,
                                owner: t ? t.fromMe.toString() : void 0,
                                count: n && t ? n.toString() : void 0
                            },
                            void 0]
                        ]);
                    w.sendEphemeral({
                        data: I.write(s),
                        onSend: i,
                        onDrop: o,
                        binaryOpts: {
                            debugString: "action,chat,read," + JSON.stringify(t) + "," + n,
                            debugObj: s,
                            metric: k.READ,
                            ackRequest: !0
                        }
                    })
                })
            },
            sendConversationDelete: function (e) {
                return new Promise(function (t, n) {
                    var r = t,
                        o = a("set", [
                            ["chat",
                            {
                                type: "delete",
                                jid: e
                            },
                            void 0]
                        ]);
                    w.send({
                        data: I.write(o),
                        onSend: r,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,chat,delete",
                            debugObj: o,
                            metric: k.CHAT,
                            ackRequest: !0
                        }
                    })
                })
            },
            sendConversationArchive: function (e, t) {
                return new Promise(function (n, r) {
                    var o = n,
                        i = t ? "archive" : "unarchive",
                        s = a("set", [
                            ["chat",
                            {
                                type: i,
                                jid: e
                            },
                            void 0]
                        ]);
                    w.send({
                        data: I.write(s),
                        onSend: o,
                        onDrop: r,
                        binaryOpts: {
                            debugString: "action,chat," + i,
                            debugObj: s,
                            metric: k.CHAT,
                            ackRequest: !0
                        }
                    })
                })
            },
            sendConversationMute: function (e, t) {
                return new Promise(function (n, r) {
                    var o = n,
                        i = t ? t.toString() : void 0,
                        s = a("set", [
                            ["chat",
                            {
                                type: "mute",
                                mute: i,
                                jid: e
                            },
                            void 0]
                        ]);
                    w.send({
                        data: I.write(s),
                        onSend: o,
                        onDrop: r,
                        binaryOpts: {
                            debugString: "action,chat," + e + "," + (i ? "mute," + i : "unmute"),
                            debugObj: s,
                            metric: k.CHAT,
                            ackRequest: !0
                        }
                    })
                })
            },
            sendMessagePlayed: function (e) {
                return new Promise(function (t, n) {
                    var r = t,
                        o = e.remote,
                        i = e.id,
                        s = a("set", [
                            ["received",
                            {
                                type: "played",
                                index: i,
                                from: o
                            },
                            void 0]
                        ]);
                    w.send({
                        data: I.write(s),
                        onSend: r,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,played," + o + "_" + i,
                            debugObj: s,
                            metric: k.RECEIVED,
                            ackRequest: !0
                        }
                    })
                })
            },
            profilePicFindThumbFromPhone: function (e, t) {
                return new Promise(function (n, r) {
                    var a = function (o) {
                            var a = I.read(o);
                            ("response" !== P.tag(a) || "preview" !== P.attr("type", a)) && r();
                            var i = P.children(a),
                                s = i && i[0];
                            if (s || r(), "missing" === P.attr("type", s)) n({
                                id: e,
                                tag: void 0,
                                raw: void 0
                            });
                            else {
                                var c, u = P.attr("id", s);
                                if (t && u === t.tag && t.raw) c = t.raw;
                                else {
                                    var l = P.children(s);
                                    c = l ? l.toBase64() : void 0
                                }
                                n({
                                    id: e,
                                    tag: u,
                                    raw: c
                                })
                            }
                        },
                        s = {
                            type: "preview",
                            jid: e
                        };
                    t && t.tag && (s.id = t.tag);
                    var c = i(s, []);
                    w.sendEphemeral({
                        data: I.write(c),
                        onSend: o(a, n),
                        onDrop: r,
                        binaryOpts: {
                            debugString: "query,thumb," + e,
                            debugObj: c,
                            ackRequest: !1
                        }
                    })
                })
            },
            groupMetadataFindFromPhone: function (e) {
                return new Promise(function (t, n) {
                    var r = function (n) {
                            var r = I.read(n);
                            if ("response" !== P.tag(r) || "group" !== P.attr("type", r)) return void t({
                                status: "error",
                                info: "bad format: response incorrect"
                            });
                            var o = P.children(r),
                                a = o && o[0];
                            if (!a) return void t({
                                status: "error",
                                info: "bad format: no group node"
                            });
                            if ("missing" === P.attr("type")) return void t({
                                status: "missing"
                            });
                            var i = _.map(P.children(a), function (e) {
                                return {
                                    id: P.attr("jid", e),
                                    isAdmin: "admin" === P.attr("type", e)
                                }
                            });
                            t({
                                status: "ok",
                                data: {
                                    id: e,
                                    owner: P.attr("creator", a),
                                    creation: parseInt(P.attr("create", a), 10) || void 0,
                                    participants: i,
                                    stale: !1
                                }
                            })
                        },
                        a = i({
                            type: "group",
                            jid: e
                        }, []);
                    w.sendEphemeral({
                        data: I.write(a),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,group," + e,
                            debugObj: a,
                            ackRequest: !1
                        }
                    })
                })
            },
            sendPresenceUpdate: function (e) {
                return ["available", "unavailable"].indexOf(e) > -1 ? new Promise(function (t, n) {
                    var r = t,
                        o = (moment().unix(), a("set", [
                            ["presence",
                            {
                                type: e
                            },
                            void 0]
                        ]));
                    w.sendEphemeral({
                        data: I.write(o),
                        onSend: r,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,presence," + e,
                            debugObj: o,
                            metric: k.PRESENCE,
                            available: "available" === e,
                            ackRequest: !0
                        }
                    })
                }) : void 0
            },
            sendChatstateUpdate: function (e, t) {
                return ["composing", "paused", "recording"].indexOf(e) > -1 ? new Promise(function (n, r) {
                    var o = n,
                        i = a("set", [
                            ["presence",
                            {
                                type: e,
                                to: t
                            },
                            void 0]
                        ]);
                    w.sendEphemeralIgnore({
                        data: I.write(i),
                        onSend: o,
                        onDrop: r,
                        binaryOpts: {
                            debugString: "action,chatstate," + e,
                            debugObj: i,
                            metric: k.PRESENCE,
                            skipOffline: !0,
                            ackRequest: !1
                        }
                    }, !0)
                }) : void 0
            },
            sendSetPicture: function (e, t, n) {
                return new Promise(function (o, i) {
                    var s = Wa.parseDataURL(t).data,
                        c = Wa.parseDataURL(n).data,
                        u = T.fromBase64(s, !1),
                        l = T.fromBase64(c, !1),
                        d = w.tag(),
                        p = r(o);
                    p.tag = d;
                    var h = ["picture",
                    {
                        id: d,
                        jid: e,
                        type: "set"
                    }, [
                        ["image", void 0, l],
                        ["preview", void 0, u]
                    ]],
                        g = a("set", [h]);
                    w.send({
                        data: I.write(g),
                        onSend: p,
                        onDrop: i,
                        binaryOpts: {
                            debugString: "action,set_pic," + e,
                            debugObj: g,
                            metric: k.PIC,
                            ackRequest: !1
                        }
                    })
                })
            },
            deletePicture: function (e) {
                return new Promise(function (t, n) {
                    var o = w.tag(),
                        i = r(t);
                    i.tag = o;
                    var s = ["picture",
                    {
                        id: o,
                        jid: e,
                        type: "delete"
                    },
                    void 0],
                        c = a("set", [s]);
                    w.send({
                        data: I.write(c),
                        onSend: i,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,delete_pic," + e,
                            debugObj: c,
                            metric: k.PIC,
                            ackRequest: !1
                        }
                    })
                })
            },
            sendSetStatus: function (e) {
                return new Promise(function (t, n) {
                    var o = w.tag(),
                        i = r(t);
                    i.tag = o;
                    var s = a("set", [
                        ["status", void 0, e]
                    ]);
                    w.send({
                        data: I.write(s),
                        onSend: i,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,status,set",
                            debugObj: s,
                            metric: k.STATUS,
                            ackRequest: !1
                        }
                    })
                })
            },
            chatFindQuery: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            var n = [],
                                r = I.read(e),
                                o = P.children(r);
                            if ("response" === P.tag(r) && "chat" === P.attr("type", r)) if ("true" === P.attr("duplicate", r)) n = "preempted";
                            else if (_.isArray(o)) {
                                var a, i = o.length;
                                for (a = 0; i > a; a++) {
                                    var s = d(o[a]);
                                    s && n.push(s)
                                }
                            }
                            t(n)
                        },
                        a = i({
                            type: "chat",
                            kind: e ? "retry" : void 0
                        }, void 0);
                    w.sendEphemeral({
                        data: I.write(a),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,chat," + e,
                            debugObj: a,
                            metric: k.QUERY_CHAT,
                            ackRequest: !1
                        }
                    })
                })
            },
            contactFindQuery: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            var n = [],
                                r = I.read(e),
                                o = P.children(r);
                            if ("response" === P.tag(r) && "contacts" === P.attr("type", r)) if ("true" === P.attr("duplicate", r)) n = "preempted";
                            else if (_.isArray(o)) {
                                var a, i = o.length;
                                for (a = 0; i > a; a++) {
                                    var s = p(o[a]);
                                    s && n.push(s)
                                }
                            }
                            t(n)
                        },
                        a = i({
                            type: "contacts",
                            kind: e ? "retry" : void 0
                        }, void 0);
                    w.send({
                        data: I.write(a),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,contacts," + e,
                            debugObj: a,
                            metric: k.QUERY_CONTACTS,
                            ackRequest: !1
                        }
                    })
                })
            },
            msgCreateRecord: function (e) {
                return new Promise(function (t, n) {
                    var o, i, s = e.id;
                    e.to === Wa.me && (e.self = "out"), "chat" === e.type ? i = Promise.cast(["message",
                    {
                        type: "text",
                        to: e.to,
                        id: e.id,
                        t: e.t.toString()
                    }, [
                        ["body", void 0, e.body]
                    ]]) : "location" === e.type ? (o = e.body ? T.fromBase64(e.body, !1) : void 0, i = Promise.cast(["message",
                    {
                        type: "media",
                        to: e.to,
                        id: e.id,
                        t: e.t.toString()
                    }, [
                        ["media",
                        {
                            type: "location",
                            latitude: e.lat || void 0,
                            longitude: e.lng || void 0,
                            name: e.loc && e.url ? e.loc : void 0,
                            url: e.loc && e.url ? e.url : void 0,
                            encoding: e.body ? "raw" : void 0
                        },
                        o]
                    ]])) : (o = e.body ? T.fromBase64(e.body, !1) : void 0, i = S(e.avparams.url).then(function (t) {
                        if (200 === t.status) {
                            var n = t.url;
                            return Promise.cast(["message",
                            {
                                type: "media",
                                to: e.to,
                                id: e.id,
                                t: e.t.toString()
                            }, [
                                ["media",
                                {
                                    encoding: e.body ? "raw" : void 0,
                                    origin: "ptt" === e.type ? "live" : void 0,
                                    seconds: "ptt" === e.type && e.duration ? e.duration.toString() : void 0,
                                    type: e.avparams.type,
                                    mimetype: e.mimetype || void 0,
                                    size: e.size ? e.size.toString() : void 0,
                                    filehash: e.avparams.filehash,
                                    url: n,
                                    duration: e.avparams.duration ? e.avparams.duration.toString() : void 0,
                                    vcodec: e.avparams.vcodec || void 0,
                                    width: e.avparams.width ? e.avparams.width.toString() : void 0,
                                    height: e.avparams.height ? e.avparams.height.toString() : void 0,
                                    fps: e.avparams.fps ? e.avparams.fps.toString() : void 0,
                                    vbitrate: e.avparams.vbitrate ? e.avparams.vbitrate.toString() : void 0,
                                    acodec: e.avparams.acodec || void 0,
                                    asampfreq: e.avparams.asampfreq ? e.avparams.asampfreq.toString() : void 0,
                                    asampfmt: e.avparams.asampfmt || void 0,
                                    abitrate: e.avparams.abitrate ? e.avparams.abitrate.toString() : void 0
                                },
                                o]
                            ]])
                        }
                        return Wa.debug("wap:msgCreateRecord:sendMedia error " + t.status, "red"), Promise.reject()
                    })["catch"](function () {
                        return Wa.debug("wap:msgCreateRecord:sendMedia dropped", "red"), Promise.reject()
                    })), i.then(function (o) {
                        var i = a("relay", [o]),
                            c = r(t);
                        c.tag = s, c.meta = {
                            type: "message",
                            key: Wa.createMsgKey(e.from, e.to, e.id)
                        }, w.send({
                            data: I.write(i),
                            onSend: c,
                            onDrop: n,
                            binaryOpts: {
                                debugString: "action,message," + e.type,
                                debugObj: i,
                                metric: k.MESSAGE,
                                ackRequest: !1
                            }
                        })
                    })["catch"](function () {
                        Wa.debug("wap:msgCreateRecord mPromise error", "red"), n()
                    })
                })
            },
            msgFindQuery: function (e) {
                return new Promise(function (t, n) {
                    var r = function (e) {
                            var n = [],
                                r = I.read(e),
                                o = P.children(r);
                            if ("response" === P.tag(r) && "message" === P.attr("type", r) && _.isArray(o)) {
                                var a, i = o.length;
                                for (a = 0; i > a; a++) {
                                    var s = y(o[a], "response");
                                    s && n.push(s)
                                }
                            }
                            t(n)
                        },
                        a = i({
                            type: "message",
                            jid: e.wid,
                            count: e.count.toString(),
                            index: e.id,
                            owner: e.fromMe
                        }, void 0);
                    w.sendEphemeral({
                        data: I.write(a),
                        onSend: o(r, t),
                        onDrop: n,
                        binaryOpts: {
                            debugString: "query,message," + e.wid + "_" + e.id + "_" + e.fromMe + "_" + e.count,
                            debugObj: a,
                            metric: k.QUERY_MESSAGES,
                            ackRequest: !1
                        }
                    })
                })
            },
            presenceSubscribe: function (e) {
                return new Promise(function (t, n) {
                    var r = t,
                        o = a("set", [
                            ["presence",
                            {
                                type: "subscribe",
                                to: e
                            },
                            void 0]
                        ]);
                    w.sendEphemeral({
                        data: I.write(o),
                        onSend: r,
                        onDrop: n,
                        binaryOpts: {
                            debugString: "action,presence,subscribe," + e,
                            debugObj: o,
                            metric: k.PRESENCE_SUBSCRIBE,
                            ackRequest: !0
                        }
                    })
                })
            },
            logoutToken: function () {
                var e = Wa.secretBundle.encKey.toString(CryptoJS.enc.Base64),
                    t = Wa.secretBundle.macKey.toString(CryptoJS.enc.Base64),
                    n = CryptoJS.enc.Base64.parse(e),
                    r = CryptoJS.enc.Base64.parse(t);
                return CryptoJS.HmacSHA256(n, r).toString(CryptoJS.enc.Base64)
            }
        };
    e.exports = O
}, function (e, t, n) {
    var r = n(100),
        o = {
            listenTo: function (e, t, n) {
                if (!_.isObject(e)) throw Error("obj is not an object");
                if (_.isObject(t));
                else if (!_.isFunction(n)) throw Error("callback is not a function");
                r.listenTo.apply(this, arguments)
            },
            listenToOnce: function (e, t, n) {
                if (!_.isObject(e)) throw Error("obj is not an object");
                if (_.isObject(t));
                else if (!_.isFunction(n)) throw Error("callback is not a function");
                r.listenToOnce.apply(this, arguments)
            }
        };
    e.exports = o
}, function (e, t, n) {
    function r(e, t) {
        var n = -1,
            r = _.find(e, function (e) {
                return n++, t(e)
            });
        return void 0 === r ? void 0 : {
            index: n,
            value: r
        }
    }
    function o(e) {
        this.name = "SocketClosed", this.message = "Event: " + JSON.stringify(e), this.event = e
    }
    function a(e) {
        this.name = "SocketNotOpen", this.socketState = e, this.message = "SocketNotOpen state: " + e
    }
    function i(e) {
        this.name = "SocketError", this.message = "Event: " + e, this.event = e
    }
    function s(e) {
        var t;
        try {
            t = new g(e)
        } catch (n) {
            return Wa.debug("WatchedSocket error constructing: " + n, "red", n), Promise.reject(n)
        }
        return Promise.bind(t).then(function () {
            Wa.debug("WatchedSocket opening socket " + this.id);
            var e = new WebSocket(this.url);
            return e.binaryType = "arraybuffer", this.socket = e, new Promise(function (t, n) {
                e.onopen = t, e.onerror = function (e) {
                    n(new i(e))
                }
            })
        }).cancellable()["catch"](function (e) {
            if (Wa.debug("WatchedSocket error on open of " + this.id + ": " + e, "red", e), this.socket) {
                var t = this.socket;
                switch (t.readyState) {
                case WebSocket.OPENING:
                case WebSocket.OPEN:
                    t.onopen = null, t.onerror = null, t.close();
                    break;
                case WebSocket.CLOSING:
                case WebSocket.CLOSED:
                }
            }
            throw e
        }).then(function () {
            Wa.debug("WatchedSocket opened socket " + this.id);
            var e = this.socket;
            return e.onmessage = this._onMessage.bind(this, !0), e.onerror = this._onCloseOrError.bind(this, !0), e.onclose = this._onCloseOrError.bind(this, !1), this._offlineListener = u.waitForOfflineNaive().then(this._onCloseOrError.bind(this, !1, "offline")), this._feedPing && this._feedPing(), this._feedKill && this._feedKill(), this.state = h.OPEN, this
        })
    }
    var c = n(102),
        u = n(45),
        l = n(73),
        d = 2e4,
        p = c.extend({
            extraProperties: "reject",
            session: {
                data: "object",
                hasData: "boolean",
                filter: "function",
                resolver: "function",
                promise: "object"
            },
            resolve: function (e) {
                this.set({
                    data: e,
                    hasData: !0
                }), this.resolver && this.resolver(e)
            },
            reject: function (e) {
                this.hasData = !0, this.promise.cancel(e)
            }
        });
    o.prototype = Object.create(Error.prototype), a.prototype = Object.create(Error.prototype), i.prototype = Object.create(Error.prototype);
    var h = {
        OPEN: "open",
        CLOSED: "closed"
    },
        g = c.extend({
            extraProperties: "reject",
            session: {
                id: {
                    type: "integer",
                    required: !0,
                    allowNull: !1
                },
                url: {
                    type: "string",
                    required: !0,
                    allowNull: !1
                },
                onmessage: "function",
                onactivity: "function",
                pingTime: "number",
                killTime: "number",
                pingString: "string",
                pongString: "string",
                messageTransform: "function",
                state: {
                    type: "string",
                    values: [h.OPEN, h.CLOSED]
                },
                error: "any",
                socket: "object",
                isQueueing: {
                    type: "boolean",
                    "default": !0
                },
                maxQueueSize: "number",
                messageQueue: "array",
                _offlineListener: "object",
                _messageListeners: "array",
                _feedPing: "function",
                _feedKill: "function"
            },
            initialize: function () {
                this._messageListeners = [], this.messageQueue = [];
                var e = this;
                this.pingString && (this._feedPing = _.c_debounce(function () {
                    e.send(e.pingString), e._feedPing()
                }, this.pingTime)), this.killTime && (this._feedKill = _.c_debounce(function () {
                    Wa.debug("Watchdog Socket Timeout!", "red"), e.close()
                }, this.killTime))
            },
            detachCallbacks: function () {
                this.set({
                    onactivity: void 0,
                    onmessage: void 0
                })
            },
            send: function (e) {
                if ("open" !== this.state) throw "socket not open, is " + this.state;
                this.socket.send(e)
            },
            cast: function (e) {
                this.send(e)
            },
            partingSend: function (e, t) {
                var n = this,
                    r = this.socket;
                return new Promise(function (o) {
                    function a() {
                        o(void 0)
                    }
                    r.onclose = a, r.onerror = a, r.onmessage = function (e) {
                        var n = e.data;
                        (!t || t(n)) && o(n)
                    }, n.send(e), n._onCloseOrError(!1, void 0)
                }).timeout(d)["catch"](_.noop)["finally"](function () {
                    r.onclose = void 0, r.onerror = void 0, r.onmessage = void 0, r.readyState === WebSocket.OPEN && r.close()
                })
            },
            close: function (e, t) {
                this.socket.onclose = void 0, this.socket.onerror = void 0, this.socket.onmessage = void 0, this.socket.close(), this._onCloseOrError( !! e, t)
            },
            _onMessage: function (e, t) {
                if (e) {
                    if (this._feedPing && this._feedPing(), this._feedKill && this._feedKill(), this.pongString && this.pongString === t.data) return void(this.onactivity && this.onactivity());
                    this.messageTransform && (t = this.messageTransform(t)), this.onactivity && this.onactivity(t)
                }
                var n = r(this._messageListeners, function (e) {
                    return !e.filter || e.filter(t)
                });
                n ? (this._messageListeners.splice(n.index, 1), n.value.resolve(t)) : this.isQueueing ? (Wa.debug("enqueued", "orange", t), this.messageQueue.push(t), void 0 !== this.maxQueueSize && this.messageQueue.length > this.maxQueueSize && this.close(!0, "Queue Overflow")) : this.onmessage ? this.onmessage(t) : Wa.debug("dropped!", "red", t)
            },
            _onCloseOrError: function (e, t) {
                Wa.debug("Socket closing " + t, "orange"), this._feedPing && this._feedPing().cancel(), this._feedKill && this._feedKill().cancel(), this.set({
                    state: "closed",
                    error: e ? t : void 0
                });
                var n = this._messageListeners;
                this._messageListeners = [], _.forEach(n, function (n) {
                    var r = e ? new i(t) : new o(t);
                    n.reject(r)
                })
            },
            holdMessages: function (e) {
                var t = this.isQueueing && void 0 !== e && this.messageQueue > e;
                this.set({
                    isQueueing: !0,
                    messageQueue: this.messageQueue || [],
                    maxQueueSize: e
                }), t && this.close(!0, "Queue Overflow")
            },
            releaseMessages: function (e) {
                if (!this.isQueueing) return void Wa.debug("WatchedSocket:releaseMessages not queued!", "red");
                var t = this.messageQueue;
                if (this.set({
                    isQueueing: !1,
                    messageQueue: void 0
                }), e) t.length > 0 && Wa.debug("WatchedSocket:releaseMessages dropping " + t.length + " messages.", "red");
                else {
                    var n = this;
                    _.forEach(t, function (e) {
                        n._onMessage(!1, e)
                    })
                }
            },
            nextMessage: function (e) {
                if ("open" !== this.state && "opening" !== this.state) return Promise.reject(new a).cancellable();
                if (e instanceof l && (e = e.test.bind(e)), this.isQueueing) {
                    var t;
                    if (e) {
                        var n = r(this.messageQueue, e);
                        n && (t = n.value, this.messageQueue.splice(n.index, 1))
                    } else this.messageQueue.length > 0 && (t = this.messageQueue.shift());
                    if (t) return Promise.resolve(t).cancellable()
                }
                var o = new p({
                    filter: e
                }),
                    i = new Promise(function (e) {
                        o.hasData ? e(o.data) : o.resolver = e
                    }).cancellable().bind(this)["finally"](function () {
                        o.hasData || (this._messageListeners = _.without(this._messageListeners, o))
                    });
                return o.promise = i, this._messageListeners.push(o), i
            }
        });
    g.STATE = h, g.open = s, g.SocketClosed = o, g.SocketNotOpen = a, g.SocketError = i, e.exports = g
}, function (e, t, n) {
    function r(e, t, n) {
        return "number" == typeof n ?
        function (r) {
            switch (r.failGeneration) {
            case 0:
                return Math.min(n, t);
            case 1:
                return Math.min(n, e + t);
            default:
                return Math.min(n, r.waitDuration + r.prevWaitDuration)
            }
        } : function (n) {
            switch (n.failGeneration) {
            case 0:
                return t;
            case 1:
                return e + t;
            default:
                return n.waitDuration + n.prevWaitDuration
            }
        }
    }
    var o = n(102),
        a = n(33),
        i = a.define("WatchdogFed"),
        s = a.define("Deactivated"),
        c = a.define("ForceTimeout"),
        u = o.extend({
            extraProperties: "reject",
            session: {
                failGeneration: {
                    type: "number",
                    allowNull: !1,
                    "default": 0
                },
                waitDuration: {
                    type: "number",
                    allowNull: !1,
                    "default": 0
                },
                prevWaitDuration: {
                    type: "number",
                    allowNull: !1,
                    "default": 0
                },
                runPromise: "object",
                waitAlgorithm: {
                    type: "function",
                    required: !0,
                    allowNull: !1
                },
                onActivated: "function",
                onDeactivated: "function",
                onFed: "function",
                onTimeout: "function"
            },
            activate: function () {
                this.runPromise || (this._run(!0), this.onActivated && this.onActivated(this))
            },
            deactivate: function () {
                this.runPromise && (this.runPromise.cancel(new s), this.runPromise = null, this.onDeactivated && this.onDeactivated(this))
            },
            feed: function () {
                this.runPromise && (this.runPromise.cancel(new i), this._run(!0), this.onFed && this.onFed(this))
            },
            forceTimeout: function () {
                if (!this.runPromise) throw "Can't force non-running watchdog";
                this.runPromise.cancel(new c)
            },
            _run: function (e) {
                e && (this.failGeneration = 0), this.set({
                    waitDuration: this.waitAlgorithm(this),
                    prevWaitDuration: this.waitDuration
                }), this.runPromise = Promise.delay(this.waitDuration).cancellable().bind(this)["catch"](c, _.noop).then(function () {
                    if (!this.onTimeout) throw "Watchdog timed-out without handler!";
                    this.failGeneration++, this.onTimeout(this) ? this._run(!1) : this.runPromise = null
                })["catch"](i, _.noop)["catch"](s, _.noop)
            }
        });
    u.FIBONACCI = r, e.exports = u
}, function (e) {
    function t(e) {
        var t = [],
            r = !1,
            o = 0;
        _.each(e, function (e, a) {
            function i(e) {
                return e.hasOwnProperty(a) && s(e[a])
            }
            if (e === _) return void(r = !0);
            o++;
            var s = n(e);
            t.push(i)
        });
        var a = _.reduceRight(t, function (e, t) {
            return e ?
            function (n) {
                return t(n) && e(n)
            } : t
        });
        return function (e) {
            if ("object" != typeof e) return !1;
            var t = _.keys(e).length;
            return o > t ? !1 : !r && t > o ? !1 : a(e)
        }
    }
    function n(e) {
        switch (typeof e) {
        case "object":
            return t(e);
        case "function":
            return e;
        case "boolean":
        case "null":
        case "undefined":
        case "number":
        case "string":
            return function (t) {
                return t === e
            }
        }
    }
    function r(e) {
        this.predicate = n(e)
    }
    r.ANY = _.constant(!0), r.OBJECT = _.isObject, r.STRING = _.isString, r.BOOLEAN = _.isBoolean, r.prototype = {
        test: function (e) {
            return this.predicate(e)
        }
    }, e.exports = r
}, function (e, t, n) {
    (function (e) {
        /**
         * @license ByteBuffer.js (c) 2013-2014 Daniel Wirtz <dcode@dcode.io>
         * This version of ByteBuffer.js uses an ArrayBuffer (AB) as its backing buffer and is compatible with modern browsers.
         * Released under the Apache License, Version 2.0
         * see: https://github.com/dcodeIO/ByteBuffer.js for details
         */
        !
        function () {
            "use strict";

            function t(e) {
                var t = function (e, r, o) {
                        if ("undefined" == typeof e && (e = t.DEFAULT_CAPACITY), "undefined" == typeof r && (r = t.DEFAULT_ENDIAN), "undefined" == typeof o && (o = t.DEFAULT_NOASSERT), !o) {
                            if (e = 0 | e, 0 > e) throw new RangeError("Illegal capacity: 0 <= " + e);
                            if ("boolean" != typeof r) throw new TypeError("Illegal littleEndian: Not a boolean");
                            if ("boolean" != typeof o) throw new TypeError("Illegal noAssert: Not a boolean")
                        }
                        this.buffer = 0 === e ? n : new ArrayBuffer(e), this.view = 0 === e ? null : new DataView(this.buffer), this.offset = 0, this.markedOffset = -1, this.limit = e, this.littleEndian = "undefined" != typeof r ? !! r : !1, this.noAssert = !! o
                    };
                t.VERSION = "3.1.0", t.LITTLE_ENDIAN = !0, t.BIG_ENDIAN = !1, t.DEFAULT_CAPACITY = 16, t.DEFAULT_ENDIAN = t.BIG_ENDIAN, t.DEFAULT_NOASSERT = !1, t.Long = e || null;
                var n = new ArrayBuffer(0);
                t.allocate = function (e, n, r) {
                    return new t(e, n, r)
                }, t.concat = function (e, n, r, o) {
                    ("boolean" == typeof n || "string" != typeof n) && (o = r, r = n, n = void 0);
                    for (var a, i = 0, s = 0, c = e.length; c > s; ++s) t.isByteBuffer(e[s]) || (e[s] = t.wrap(e[s], n)), a = e[s].limit - e[s].offset, a > 0 && (i += a);
                    if (0 === i) return new t(0, r, o);
                    var u, l = new t(i, r, o),
                        d = new Uint8Array(l.buffer);
                    for (s = 0; c > s;) u = e[s++], a = u.limit - u.offset, 0 >= a || (d.set(new Uint8Array(u.buffer).subarray(u.offset, u.limit), l.offset), l.offset += a);
                    return l.limit = l.offset, l.offset = 0, l
                }, t.isByteBuffer = function (e) {
                    return e && e instanceof t
                }, t.type = function () {
                    return ArrayBuffer
                }, t.wrap = function (e, n, r, o) {
                    if ("string" != typeof n && (o = r, r = n, n = void 0), "string" == typeof e) switch ("undefined" == typeof n && (n = "utf8"), n) {
                    case "base64":
                        return t.fromBase64(e, r);
                    case "hex":
                        return t.fromHex(e, r);
                    case "binary":
                        return t.fromBinary(e, r);
                    case "utf8":
                        return t.fromUTF8(e, r);
                    case "debug":
                        return t.fromDebug(e, r);
                    default:
                        throw new TypeError("Unsupported encoding: " + n)
                    }
                    if (null === e || "object" != typeof e) throw new TypeError("Illegal buffer: null or non-object");
                    var a;
                    if (t.isByteBuffer(e)) return a = t.prototype.clone.call(e), a.markedOffset = -1, a;
                    if (e instanceof Uint8Array) a = new t(0, r, o), e.length > 0 && (a.buffer = e.buffer, a.offset = e.byteOffset, a.limit = e.byteOffset + e.length, a.view = e.length > 0 ? new DataView(e.buffer) : null);
                    else if (e instanceof ArrayBuffer) a = new t(0, r, o), e.byteLength > 0 && (a.buffer = e, a.offset = 0, a.limit = e.byteLength, a.view = e.byteLength > 0 ? new DataView(e) : null);
                    else {
                        if ("[object Array]" !== Object.prototype.toString.call(e)) throw new TypeError("Illegal buffer");
                        for (a = new t(e.length, r, o), a.limit = e.length, i = 0; i < e.length; ++i) a.view.setUint8(i, e[i])
                    }
                    return a
                }, t.prototype.writeInt8 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 1;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view.setInt8(t, e), n && (this.offset += 1), this
                }, t.prototype.writeByte = t.prototype.writeInt8, t.prototype.readInt8 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getInt8(e);
                    return t && (this.offset += 1), n
                }, t.prototype.readByte = t.prototype.readInt8, t.prototype.writeUint8 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 1;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view.setUint8(t, e), n && (this.offset += 1), this
                }, t.prototype.readUint8 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getUint8(e);
                    return t && (this.offset += 1), n
                }, t.prototype.writeInt16 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 2;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.view.setInt16(t, e, this.littleEndian), n && (this.offset += 2), this
                }, t.prototype.writeShort = t.prototype.writeInt16, t.prototype.readInt16 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 2 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getInt16(e, this.littleEndian);
                    return t && (this.offset += 2), n
                }, t.prototype.readShort = t.prototype.readInt16, t.prototype.writeUint16 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 2;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.view.setUint16(t, e, this.littleEndian), n && (this.offset += 2), this
                }, t.prototype.readUint16 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 2 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getUint16(e, this.littleEndian);
                    return t && (this.offset += 2), n
                }, t.prototype.writeInt32 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 4;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.view.setInt32(t, e, this.littleEndian), n && (this.offset += 4), this
                }, t.prototype.writeInt = t.prototype.writeInt32, t.prototype.readInt32 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getInt32(e, this.littleEndian);
                    return t && (this.offset += 4), n
                }, t.prototype.readInt = t.prototype.readInt32, t.prototype.writeUint32 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 4;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.view.setUint32(t, e, this.littleEndian), n && (this.offset += 4), this
                }, t.prototype.readUint32 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getUint32(e, this.littleEndian);
                    return t && (this.offset += 4), n
                }, e && (t.prototype.writeInt64 = function (t, n) {
                    var r = "undefined" == typeof n;
                    if (r && (n = this.offset), !this.noAssert) {
                        if ("number" == typeof t) t = e.fromNumber(t);
                        else if (!(t && t instanceof e)) throw new TypeError("Illegal value: " + t + " (not an integer or Long)");
                        if ("number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal offset: " + n + " (not an integer)");
                        if (n >>>= 0, 0 > n || n + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength)
                    }
                    "number" == typeof t && (t = e.fromNumber(t)), n += 8;
                    var o = this.buffer.byteLength;
                    return n > o && this.resize((o *= 2) > n ? o : n), n -= 8, this.littleEndian ? (this.view.setInt32(n, t.low, !0), this.view.setInt32(n + 4, t.high, !0)) : (this.view.setInt32(n, t.high, !1), this.view.setInt32(n + 4, t.low, !1)), r && (this.offset += 8), this
                }, t.prototype.writeLong = t.prototype.writeInt64, t.prototype.readInt64 = function (t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 8 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
                    }
                    var r = this.littleEndian ? new e(this.view.getInt32(t, !0), this.view.getInt32(t + 4, !0), !1) : new e(this.view.getInt32(t + 4, !1), this.view.getInt32(t, !1), !1);
                    return n && (this.offset += 8), r
                }, t.prototype.readLong = t.prototype.readInt64, t.prototype.writeUint64 = function (t, n) {
                    var r = "undefined" == typeof n;
                    if (r && (n = this.offset), !this.noAssert) {
                        if ("number" == typeof t) t = e.fromNumber(t);
                        else if (!(t && t instanceof e)) throw new TypeError("Illegal value: " + t + " (not an integer or Long)");
                        if ("number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal offset: " + n + " (not an integer)");
                        if (n >>>= 0, 0 > n || n + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength)
                    }
                    "number" == typeof t && (t = e.fromNumber(t)), n += 8;
                    var o = this.buffer.byteLength;
                    return n > o && this.resize((o *= 2) > n ? o : n), n -= 8, this.littleEndian ? (this.view.setInt32(n, t.low, !0), this.view.setInt32(n + 4, t.high, !0)) : (this.view.setInt32(n, t.high, !1), this.view.setInt32(n + 4, t.low, !1)), r && (this.offset += 8), this
                }, t.prototype.readUint64 = function (t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 8 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
                    }
                    var r = this.littleEndian ? new e(this.view.getInt32(t, !0), this.view.getInt32(t + 4, !0), !0) : new e(this.view.getInt32(t + 4, !1), this.view.getInt32(t, !1), !0);
                    return n && (this.offset += 8), r
                }), t.prototype.writeFloat32 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e) throw new TypeError("Illegal value: " + e + " (not a number)");
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 4;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.view.setFloat32(t, e, this.littleEndian), n && (this.offset += 4), this
                }, t.prototype.writeFloat = t.prototype.writeFloat32, t.prototype.readFloat32 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getFloat32(e, this.littleEndian);
                    return t && (this.offset += 4), n
                }, t.prototype.readFloat = t.prototype.readFloat32, t.prototype.writeFloat64 = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof e) throw new TypeError("Illegal value: " + e + " (not a number)");
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    t += 8;
                    var r = this.buffer.byteLength;
                    return t > r && this.resize((r *= 2) > t ? r : t), t -= 8, this.view.setFloat64(t, e, this.littleEndian), n && (this.offset += 8), this
                }, t.prototype.writeDouble = t.prototype.writeFloat64, t.prototype.readFloat64 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 8 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+8) <= " + this.buffer.byteLength)
                    }
                    var n = this.view.getFloat64(e, this.littleEndian);
                    return t && (this.offset += 8), n
                }, t.prototype.readDouble = t.prototype.readFloat64, t.MAX_VARINT32_BYTES = 5, t.calculateVarint32 = function (e) {
                    return e >>>= 0, 128 > e ? 1 : 16384 > e ? 2 : 1 << 21 > e ? 3 : 1 << 28 > e ? 4 : 5
                }, t.zigZagEncode32 = function (e) {
                    return ((e |= 0) << 1 ^ e >> 31) >>> 0
                }, t.zigZagDecode32 = function (e) {
                    return e >>> 1 ^ -(1 & e) | 0
                }, t.prototype.writeVarint32 = function (e, n) {
                    var r = "undefined" == typeof n;
                    if (r && (n = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal offset: " + n + " (not an integer)");
                        if (n >>>= 0, 0 > n || n + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength)
                    }
                    var o, a = t.calculateVarint32(e);
                    n += a;
                    var i = this.buffer.byteLength;
                    return n > i && this.resize((i *= 2) > n ? i : n), n -= a, this.view.setUint8(n, o = 128 | e), e >>>= 0, e >= 128 ? (o = e >> 7 | 128, this.view.setUint8(n + 1, o), e >= 16384 ? (o = e >> 14 | 128, this.view.setUint8(n + 2, o), e >= 1 << 21 ? (o = e >> 21 | 128, this.view.setUint8(n + 3, o), e >= 1 << 28 ? (this.view.setUint8(n + 4, e >> 28 & 15), a = 5) : (this.view.setUint8(n + 3, 127 & o), a = 4)) : (this.view.setUint8(n + 2, 127 & o), a = 3)) : (this.view.setUint8(n + 1, 127 & o), a = 2)) : (this.view.setUint8(n, 127 & o), a = 1), r ? (this.offset += a, this) : a
                }, t.prototype.writeVarint32ZigZag = function (e, n) {
                    return this.writeVarint32(t.zigZagEncode32(e), n)
                }, t.prototype.readVarint32 = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                    }
                    var n, r = 0,
                        o = 0;
                    do n = this.view.getUint8(e + r), 5 > r && (o |= (127 & n) << 7 * r >>> 0), ++r;
                    while (128 === (128 & n));
                    return o = 0 | o, t ? (this.offset += r, o) : {
                        value: o,
                        length: r
                    }
                }, t.prototype.readVarint32ZigZag = function (e) {
                    var n = this.readVarint32(e);
                    return "object" == typeof n ? n.value = t.zigZagDecode32(n.value) : n = t.zigZagDecode32(n), n
                }, e && (t.MAX_VARINT64_BYTES = 10, t.calculateVarint64 = function (t) {
                    "number" == typeof t && (t = e.fromNumber(t));
                    var n = t.toInt() >>> 0,
                        r = t.shiftRightUnsigned(28).toInt() >>> 0,
                        o = t.shiftRightUnsigned(56).toInt() >>> 0;
                    return 0 == o ? 0 == r ? 16384 > n ? 128 > n ? 1 : 2 : 1 << 21 > n ? 3 : 4 : 16384 > r ? 128 > r ? 5 : 6 : 1 << 21 > r ? 7 : 8 : 128 > o ? 9 : 10
                }, t.zigZagEncode64 = function (t) {
                    return "number" == typeof t ? t = e.fromNumber(t, !1) : t.unsigned !== !1 && (t = t.toSigned()), t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()
                }, t.zigZagDecode64 = function (t) {
                    return "number" == typeof t ? t = e.fromNumber(t, !1) : t.unsigned !== !1 && (t = t.toSigned()), t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()
                }, t.prototype.writeVarint64 = function (n, r) {
                    var o = "undefined" == typeof r;
                    if (o && (r = this.offset), !this.noAssert) {
                        if ("number" == typeof n) n = e.fromNumber(n);
                        else if (!(n && n instanceof e)) throw new TypeError("Illegal value: " + n + " (not an integer or Long)");
                        if ("number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal offset: " + r + " (not an integer)");
                        if (r >>>= 0, 0 > r || r + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
                    }
                    "number" == typeof n ? n = e.fromNumber(n, !1) : n.unsigned !== !1 && (n = n.toSigned());
                    var a = t.calculateVarint64(n),
                        i = n.toInt() >>> 0,
                        s = n.shiftRightUnsigned(28).toInt() >>> 0,
                        c = n.shiftRightUnsigned(56).toInt() >>> 0;
                    r += a;
                    var u = this.buffer.byteLength;
                    switch (r > u && this.resize((u *= 2) > r ? u : r), r -= a, a) {
                    case 10:
                        this.view.setUint8(r + 9, c >>> 7 & 1);
                    case 9:
                        this.view.setUint8(r + 8, 9 !== a ? 128 | c : 127 & c);
                    case 8:
                        this.view.setUint8(r + 7, 8 !== a ? s >>> 21 | 128 : s >>> 21 & 127);
                    case 7:
                        this.view.setUint8(r + 6, 7 !== a ? s >>> 14 | 128 : s >>> 14 & 127);
                    case 6:
                        this.view.setUint8(r + 5, 6 !== a ? s >>> 7 | 128 : s >>> 7 & 127);
                    case 5:
                        this.view.setUint8(r + 4, 5 !== a ? 128 | s : 127 & s);
                    case 4:
                        this.view.setUint8(r + 3, 4 !== a ? i >>> 21 | 128 : i >>> 21 & 127);
                    case 3:
                        this.view.setUint8(r + 2, 3 !== a ? i >>> 14 | 128 : i >>> 14 & 127);
                    case 2:
                        this.view.setUint8(r + 1, 2 !== a ? i >>> 7 | 128 : i >>> 7 & 127);
                    case 1:
                        this.view.setUint8(r, 1 !== a ? 128 | i : 127 & i)
                    }
                    return o ? (this.offset += a, this) : a
                }, t.prototype.writeVarint64ZigZag = function (e, n) {
                    return this.writeVarint64(t.zigZagEncode64(e), n)
                }, t.prototype.readVarint64 = function (t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
                    }
                    var r = t,
                        o = 0,
                        a = 0,
                        i = 0,
                        s = 0;
                    if (s = this.view.getUint8(t++), o = 127 & s, 128 & s && (s = this.view.getUint8(t++), o |= (127 & s) << 7, 128 & s && (s = this.view.getUint8(t++), o |= (127 & s) << 14, 128 & s && (s = this.view.getUint8(t++), o |= (127 & s) << 21, 128 & s && (s = this.view.getUint8(t++), a = 127 & s, 128 & s && (s = this.view.getUint8(t++), a |= (127 & s) << 7, 128 & s && (s = this.view.getUint8(t++), a |= (127 & s) << 14, 128 & s && (s = this.view.getUint8(t++), a |= (127 & s) << 21, 128 & s && (s = this.view.getUint8(t++), i = 127 & s, 128 & s && (s = this.view.getUint8(t++), i |= (127 & s) << 7, 128 & s)))))))))) throw new Error("Data must be corrupt: Buffer overrun");
                    var c = e.from28Bits(o, a, i, !1);
                    return n ? (this.offset = t, c) : {
                        value: c,
                        length: t - r
                    }
                }, t.prototype.readVarint64ZigZag = function (n) {
                    var r = this.readVarint64(n);
                    return r && r.value instanceof e ? r.value = t.zigZagDecode64(r.value) : r = t.zigZagDecode64(r), r
                }), t.prototype.writeCString = function (e, t) {
                    var n = "undefined" == typeof t;
                    n && (t = this.offset);
                    var r, a = e.length;
                    if (!this.noAssert) {
                        if ("string" != typeof e) throw new TypeError("Illegal str: Not a string");
                        for (r = 0; a > r; ++r) if (0 === e.charCodeAt(r)) throw new RangeError("Illegal str: Contains NULL-characters");
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    var i = t;
                    a = o.calculateUTF16asUTF8(o.stringSource(e))[1], t += a + 1;
                    var s = this.buffer.byteLength;
                    return t > s && this.resize((s *= 2) > t ? s : t), t -= a + 1, o.encodeUTF16toUTF8(o.stringSource(e), function (e) {
                        this.view.setUint8(t++, e)
                    }.bind(this)), this.view.setUint8(t++, 0), n ? (this.offset = t - i, this) : a
                }, t.prototype.readCString = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                    }
                    var n, r = e,
                        a = -1;
                    return o.decodeUTF8toUTF16(function () {
                        if (0 === a) return null;
                        if (e >= this.limit) throw RangeError("Illegal range: Truncated data, " + e + " < " + this.limit);
                        return 0 === (a = this.view.getUint8(e++)) ? null : a
                    }.bind(this), n = o.stringDestination(), !0), t ? (this.offset = e, n()) : {
                        string: n(),
                        length: e - r
                    }
                }, t.prototype.writeIString = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("string" != typeof e) throw new TypeError("Illegal str: Not a string");
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    var r, a = t;
                    r = o.calculateUTF16asUTF8(o.stringSource(e), this.noAssert)[1], t += 4 + r;
                    var i = this.buffer.byteLength;
                    if (t > i && this.resize((i *= 2) > t ? i : t), t -= 4 + r, this.view.setUint32(t, r, this.littleEndian), t += 4, o.encodeUTF16toUTF8(o.stringSource(e), function (e) {
                        this.view.setUint8(t++, e)
                    }.bind(this)), t !== a + 4 + r) throw new RangeError("Illegal range: Truncated data, " + t + " == " + (t + 4 + r));
                    return n ? (this.offset = t, this) : t - a
                }, t.prototype.readIString = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                    }
                    var n, r = 0,
                        a = e;
                    r = this.view.getUint32(e, this.littleEndian), e += 4;
                    var i, s = e + r;
                    return o.decodeUTF8toUTF16(function () {
                        return s > e ? this.view.getUint8(e++) : null
                    }.bind(this), i = o.stringDestination(), this.noAssert), n = i(), t ? (this.offset = e, n) : {
                        string: n,
                        length: e - a
                    }
                }, t.METRICS_CHARS = "c", t.METRICS_BYTES = "b", t.prototype.writeUTF8String = function (e, t) {
                    var n = "undefined" == typeof t;
                    if (n && (t = this.offset), !this.noAssert) {
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: " + t + " (not an integer)");
                        if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                    }
                    var r, a = t;
                    r = o.calculateUTF16asUTF8(o.stringSource(e))[1], t += r;
                    var i = this.buffer.byteLength;
                    return t > i && this.resize((i *= 2) > t ? i : t), t -= r, o.encodeUTF16toUTF8(o.stringSource(e), function (e) {
                        this.view.setUint8(t++, e)
                    }.bind(this)), n ? (this.offset = t, this) : t - a
                }, t.prototype.writeString = t.prototype.writeUTF8String, t.calculateUTF8Chars = function (e) {
                    return o.calculateUTF16asUTF8(o.stringSource(e))[0]
                }, t.calculateUTF8Bytes = function (e) {
                    return o.calculateUTF16asUTF8(o.stringSource(e))[1]
                }, t.prototype.readUTF8String = function (e, n, r) {
                    "number" == typeof n && (r = n, n = void 0);
                    var a = "undefined" == typeof r;
                    if (a && (r = this.offset), "undefined" == typeof n && (n = t.METRICS_CHARS), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal length: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal offset: " + r + " (not an integer)");
                        if (r >>>= 0, 0 > r || r + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
                    }
                    var i, s = 0,
                        c = r;
                    if (n === t.METRICS_CHARS) {
                        if (i = o.stringDestination(), o.decodeUTF8(function () {
                            return e > s && r < this.limit ? this.view.getUint8(r++) : null
                        }.bind(this), function (e) {
                            ++s, o.UTF8toUTF16(e, i)
                        }.bind(this)), s !== e) throw new RangeError("Illegal range: Truncated data, " + s + " == " + e);
                        return a ? (this.offset = r, i()) : {
                            string: i(),
                            length: r - c
                        }
                    }
                    if (n === t.METRICS_BYTES) {
                        if (!this.noAssert) {
                            if ("number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal offset: " + r + " (not an integer)");
                            if (r >>>= 0, 0 > r || r + e > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + r + " (+" + e + ") <= " + this.buffer.byteLength)
                        }
                        var u = r + e;
                        if (o.decodeUTF8toUTF16(function () {
                            return u > r ? this.view.getUint8(r++) : null
                        }.bind(this), i = o.stringDestination(), this.noAssert), r !== u) throw new RangeError("Illegal range: Truncated data, " + r + " == " + u);
                        return a ? (this.offset = r, i()) : {
                            string: i(),
                            length: r - c
                        }
                    }
                    throw new TypeError("Unsupported metrics: " + n)
                }, t.prototype.readString = t.prototype.readUTF8String, t.prototype.writeVString = function (e, n) {
                    var r = "undefined" == typeof n;
                    if (r && (n = this.offset), !this.noAssert) {
                        if ("string" != typeof e) throw new TypeError("Illegal str: Not a string");
                        if ("number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal offset: " + n + " (not an integer)");
                        if (n >>>= 0, 0 > n || n + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength)
                    }
                    var a, i, s = n;
                    a = o.calculateUTF16asUTF8(o.stringSource(e), this.noAssert)[1], i = t.calculateVarint32(a), n += i + a;
                    var c = this.buffer.byteLength;
                    if (n > c && this.resize((c *= 2) > n ? c : n), n -= i + a, n += this.writeVarint32(a, n), o.encodeUTF16toUTF8(o.stringSource(e), function (e) {
                        this.view.setUint8(n++, e)
                    }.bind(this)), n !== s + a + i) throw new RangeError("Illegal range: Truncated data, " + n + " == " + (n + a + i));
                    return r ? (this.offset = n, this) : n - s
                }, t.prototype.readVString = function (e) {
                    var t = "undefined" == typeof e;
                    if (t && (e = this.offset), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                    }
                    var n, r = this.readVarint32(e),
                        a = e;
                    e += r.length, r = r.value;
                    var i = e + r,
                        s = o.stringDestination();
                    return o.decodeUTF8toUTF16(function () {
                        return i > e ? this.view.getUint8(e++) : null
                    }.bind(this), s, this.noAssert), n = s(), t ? (this.offset = e, n) : {
                        string: n,
                        length: e - a
                    }
                }, t.prototype.append = function (e, n, r) {
                    ("number" == typeof n || "string" != typeof n) && (r = n, n = void 0);
                    var o = "undefined" == typeof r;
                    if (o && (r = this.offset), !this.noAssert) {
                        if ("number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal offset: " + r + " (not an integer)");
                        if (r >>>= 0, 0 > r || r + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
                    }
                    e instanceof t || (e = t.wrap(e, n));
                    var a = e.limit - e.offset;
                    if (0 >= a) return this;
                    r += a;
                    var i = this.buffer.byteLength;
                    return r > i && this.resize((i *= 2) > r ? i : r), r -= a, new Uint8Array(this.buffer, r).set(new Uint8Array(e.buffer).subarray(e.offset, e.limit)), e.offset += a, o && (this.offset += a), this
                }, t.prototype.appendTo = function (e, t) {
                    return e.append(this, t), this
                }, t.prototype.assert = function (e) {
                    return this.noAssert = !e, this
                }, t.prototype.capacity = function () {
                    return this.buffer.byteLength
                }, t.prototype.clear = function () {
                    return this.offset = 0, this.limit = this.buffer.byteLength, this.markedOffset = -1, this
                }, t.prototype.clone = function (e) {
                    var n = new t(0, this.littleEndian, this.noAssert);
                    if (e) {
                        var r = new ArrayBuffer(this.buffer.byteLength);
                        new Uint8Array(r).set(this.buffer), n.buffer = r, n.view = new DataView(r)
                    } else n.buffer = this.buffer, n.view = this.view;
                    return n.offset = this.offset, n.markedOffset = this.markedOffset, n.limit = this.limit, n
                }, t.prototype.compact = function (e, t) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    if (0 === e && t === this.buffer.byteLength) return this;
                    var r = t - e;
                    if (0 === r) return this.buffer = n, this.view = null, this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = 0, this;
                    var o = new ArrayBuffer(r);
                    return new Uint8Array(o).set(new Uint8Array(this.buffer).subarray(e, t)), this.buffer = o, this.view = new DataView(o), this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = r, this
                }, t.prototype.copy = function (e, n) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof n && (n = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (n >>>= 0, 0 > e || e > n || n > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + n + " <= " + this.buffer.byteLength)
                    }
                    if (e === n) return new t(0, this.littleEndian, this.noAssert);
                    var r = n - e,
                        o = new t(r, this.littleEndian, this.noAssert);
                    return o.offset = 0, o.limit = r, o.markedOffset >= 0 && (o.markedOffset -= e), this.copyTo(o, 0, e, n), o
                }, t.prototype.copyTo = function (e, n, r, o) {
                    var a, i;
                    if (!this.noAssert && !t.isByteBuffer(e)) throw new TypeError("Illegal target: Not a ByteBuffer");
                    if (n = (i = "undefined" == typeof n) ? e.offset : 0 | n, r = (a = "undefined" == typeof r) ? this.offset : 0 | r, o = "undefined" == typeof o ? this.limit : 0 | o, 0 > n || n > e.buffer.byteLength) throw new RangeError("Illegal target range: 0 <= " + n + " <= " + e.buffer.byteLength);
                    if (0 > r || o > this.buffer.byteLength) throw new RangeError("Illegal source range: 0 <= " + r + " <= " + this.buffer.byteLength);
                    var s = o - r;
                    return 0 === s ? e : (e.ensureCapacity(n + s), new Uint8Array(e.buffer).set(new Uint8Array(this.buffer).subarray(r, o), n), a && (this.offset += s), i && (e.offset += s), this)
                }, t.prototype.ensureCapacity = function (e) {
                    var t = this.buffer.byteLength;
                    return e > t ? this.resize((t *= 2) > e ? t : e) : this
                }, t.prototype.fill = function (e, t, n) {
                    var r = "undefined" == typeof t;
                    if (r && (t = this.offset), "string" == typeof e && e.length > 0 && (e = e.charCodeAt(0)), "undefined" == typeof t && (t = this.offset), "undefined" == typeof n && (n = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal value: " + e + " (not an integer)");
                        if (e |= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (t >>>= 0, "number" != typeof n || n % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (n >>>= 0, 0 > t || t > n || n > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + t + " <= " + n + " <= " + this.buffer.byteLength)
                    }
                    if (t >= n) return this;
                    for (; n > t;) this.view.setUint8(t++, e);
                    return r && (this.offset = t), this
                }, t.prototype.flip = function () {
                    return this.limit = this.offset, this.offset = 0, this
                }, t.prototype.mark = function (e) {
                    if (e = "undefined" == typeof e ? this.offset : e, !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal offset: " + e + " (not an integer)");
                        if (e >>>= 0, 0 > e || e + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
                    }
                    return this.markedOffset = e, this
                }, t.prototype.order = function (e) {
                    if (!this.noAssert && "boolean" != typeof e) throw new TypeError("Illegal littleEndian: Not a boolean");
                    return this.littleEndian = !! e, this
                }, t.prototype.LE = function (e) {
                    return this.littleEndian = "undefined" != typeof e ? !! e : !0, this
                }, t.prototype.BE = function (e) {
                    return this.littleEndian = "undefined" != typeof e ? !e : !1, this
                }, t.prototype.prepend = function (e, n, r) {
                    ("number" == typeof n || "string" != typeof n) && (r = n, n = void 0);
                    var o = "undefined" == typeof r;
                    if (o && (r = this.offset), !this.noAssert) {
                        if ("number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal offset: " + r + " (not an integer)");
                        if (r >>>= 0, 0 > r || r + 0 > this.buffer.byteLength) throw new RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
                    }
                    e instanceof t || (e = t.wrap(e, n));
                    var a = e.limit - e.offset;
                    if (0 >= a) return this;
                    var i, s = a - r;
                    if (s > 0) {
                        var c = new ArrayBuffer(this.buffer.byteLength + s);
                        i = new Uint8Array(c), i.set(new Uint8Array(this.buffer).subarray(r, this.buffer.byteLength), a), this.buffer = c, this.view = new DataView(c), this.offset += s, this.markedOffset >= 0 && (this.markedOffset += s), this.limit += s, r += s
                    } else i = new Uint8Array(this.buffer);
                    return i.set(new Uint8Array(e.buffer).subarray(e.offset, e.limit), r - a), e.offset = e.limit, o && (this.offset -= a), this
                }, t.prototype.prependTo = function (e, t) {
                    return e.prepend(this, t), this
                }, t.prototype.printDebug = function (e) {
                    "function" != typeof e && (e = console.log.bind(console)), e(this.toString() + "\n-------------------------------------------------------------------\n" + this.toDebug(!0))
                }, t.prototype.remaining = function () {
                    return this.limit - this.offset
                }, t.prototype.reset = function () {
                    return this.markedOffset >= 0 ? (this.offset = this.markedOffset, this.markedOffset = -1) : this.offset = 0, this
                }, t.prototype.resize = function (e) {
                    if (!this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal capacity: " + e + " (not an integer)");
                        if (e |= 0, 0 > e) throw new RangeError("Illegal capacity: 0 <= " + e)
                    }
                    if (this.buffer.byteLength < e) {
                        var t = new ArrayBuffer(e);
                        new Uint8Array(t).set(new Uint8Array(this.buffer)), this.buffer = t, this.view = new DataView(t)
                    }
                    return this
                }, t.prototype.reverse = function (e, t) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    return e === t ? this : (Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(e, t)), this.view = new DataView(this.buffer), this)
                }, t.prototype.skip = function (e) {
                    if (!this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal length: " + e + " (not an integer)");
                        e |= 0
                    }
                    var t = this.offset + e;
                    if (!this.noAssert && (0 > t || t > this.buffer.byteLength)) throw new RangeError("Illegal length: 0 <= " + this.offset + " + " + e + " <= " + this.buffer.byteLength);
                    return this.offset = t, this
                }, t.prototype.slice = function (e, t) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    var n = this.clone();
                    return n.offset = e, n.limit = t, n
                }, t.prototype.toBuffer = function (e) {
                    var t = this.offset,
                        r = this.limit;
                    if (t > r) {
                        var o = t;
                        t = r, r = o
                    }
                    if (!this.noAssert) {
                        if ("number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal offset: Not an integer");
                        if (t >>>= 0, "number" != typeof r || r % 1 !== 0) throw new TypeError("Illegal limit: Not an integer");
                        if (r >>>= 0, 0 > t || t > r || r > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + t + " <= " + r + " <= " + this.buffer.byteLength)
                    }
                    if (!e && 0 === t && r === this.buffer.byteLength) return this.buffer;
                    if (t === r) return n;
                    var a = new ArrayBuffer(r - t);
                    return new Uint8Array(a).set(new Uint8Array(this.buffer).subarray(t, r), 0), a
                }, t.prototype.toArrayBuffer = t.prototype.toBuffer, t.prototype.toString = function (e) {
                    if ("undefined" == typeof e) return "ByteBufferAB(offset=" + this.offset + ",markedOffset=" + this.markedOffset + ",limit=" + this.limit + ",capacity=" + this.capacity() + ")";
                    switch (e) {
                    case "utf8":
                        return this.toUTF8();
                    case "base64":
                        return this.toBase64();
                    case "hex":
                        return this.toHex();
                    case "binary":
                        return this.toBinary();
                    case "debug":
                        return this.toDebug();
                    case "columns":
                        return this.toColumns();
                    default:
                        throw new Error("Unsupported encoding: " + e)
                    }
                };
                var r = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
                r += "", t.prototype.toBase64 = function (e, t) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    if (e === t) return "";
                    for (var n, o, a, i, s, c, u, l, d, p = ""; t > e;) n = this.view.getUint8(e++), o = (i = t > e) ? this.view.getUint8(e++) : 0, a = (s = t > e) ? this.view.getUint8(e++) : 0, c = n >> 2, u = (3 & n) << 4 | o >> 4, l = (15 & o) << 2 | a >> 6, d = 63 & a, s || (d = 64, i || (l = 64)), p += r.charAt(c) + r.charAt(u) + r.charAt(l) + r.charAt(d);
                    return p
                }, t.fromBase64 = function (e, n, o) {
                    if (!o) {
                        if ("string" != typeof e) throw new TypeError("Illegal str: Not a string");
                        if (e.length % 4 !== 0) throw new TypeError("Illegal str: Length not a multiple of 4")
                    }
                    var a, i, s = e.length,
                        c = 0;
                    for (a = e.length - 1; a >= 0 && "=" === e.charAt(a); --a) c++;
                    if (c > 2) throw new TypeError("Illegal str: Suffix is too large");
                    if (0 === s) return new t(0, n, o);
                    var u, l, d, p, h, g, f, m = new t(s / 4 * 3 - c, n, o);
                    for (a = 0, i = 0; s > a;) {
                        if (u = r.indexOf(e.charAt(a++)), l = (h = s > a) ? r.indexOf(e.charAt(a++)) : 0, d = (g = s > a) ? r.indexOf(e.charAt(a++)) : 0, p = (f = s > a) ? r.indexOf(e.charAt(a++)) : 0, !o && (0 > u || 0 > l || 0 > d || 0 > p)) throw new TypeError("Illegal str: Contains non-base64 characters");
                        m.view.setUint8(i++, u << 2 | l >> 4), 64 !== d && (m.view.setUint8(i++, l << 4 & 240 | d >> 2, i), 64 !== p && m.view.setUint8(i++, d << 6 & 192 | p))
                    }
                    return m.limit = i, m
                }, t.btoa = function (e) {
                    return t.fromBinary(e).toBase64()
                }, t.atob = function (e) {
                    return t.fromBase64(e).toBinary()
                }, t.prototype.toBinary = function (e, t) {
                    if (e = "undefined" == typeof e ? this.offset : e, t = "undefined" == typeof t ? this.limit : t, !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    if (e === t) return "";
                    for (var n = []; t > e;) n.push(this.view.getUint8(e++));
                    return String.fromCharCode.apply(String, n)
                }, t.fromBinary = function (e, n, r) {
                    if (!r && "string" != typeof e) throw new TypeError("Illegal str: Not a string");
                    for (var o, a = 0, i = e.length, s = new t(i, n, r); i > a;) {
                        if (o = e.charCodeAt(a), !r && o > 255) throw new TypeError("Illegal charCode at " + a + ": 0 <= " + o + " <= 255");
                        s.view.setUint8(a++, o)
                    }
                    return s.limit = i, s
                }, t.prototype.toDebug = function (e) {
                    for (var t, n = -1, r = this.buffer.byteLength, o = "", a = "", i = ""; r > n;) {
                        if (-1 !== n && (t = this.view.getUint8(n), o += 16 > t ? "0" + t.toString(16).toUpperCase() : t.toString(16).toUpperCase(), e && (a += t > 32 && 127 > t ? String.fromCharCode(t) : ".")), ++n, e && n > 0 && n % 16 === 0 && n !== r) {
                            for (; o.length < 51;) o += " ";
                            i += o + a + "\n", o = a = ""
                        }
                        o += n === this.offset && n === this.limit ? n === this.markedOffset ? "!" : "|" : n === this.offset ? n === this.markedOffset ? "[" : "<" : n === this.limit ? n === this.markedOffset ? "]" : ">" : n === this.markedOffset ? "'" : e || 0 !== n && n !== r ? " " : ""
                    }
                    if (e && " " !== o) {
                        for (; o.length < 51;) o += " ";
                        i += o + a + "\n"
                    }
                    return e ? i : o
                }, t.fromDebug = function (e, n, r) {
                    for (var o, a, i = e.length, s = new t((i + 1) / 3 | 0, n, r), c = 0, u = 0, l = !1, d = !1, p = !1, h = !1, g = !1; i > c;) {
                        switch (o = e.charAt(c++)) {
                        case "!":
                            if (!r) {
                                if (d || p || h) {
                                    g = !0;
                                    break
                                }
                                d = p = h = !0
                            }
                            s.offset = s.markedOffset = s.limit = u, l = !1;
                            break;
                        case "|":
                            if (!r) {
                                if (d || h) {
                                    g = !0;
                                    break
                                }
                                d = h = !0
                            }
                            s.offset = s.limit = u, l = !1;
                            break;
                        case "[":
                            if (!r) {
                                if (d || p) {
                                    g = !0;
                                    break
                                }
                                d = p = !0
                            }
                            s.offset = s.markedOffset = u, l = !1;
                            break;
                        case "<":
                            if (!r) {
                                if (d) {
                                    g = !0;
                                    break
                                }
                                d = !0
                            }
                            s.offset = u, l = !1;
                            break;
                        case "]":
                            if (!r) {
                                if (h || p) {
                                    g = !0;
                                    break
                                }
                                h = p = !0
                            }
                            s.limit = s.markedOffset = u, l = !1;
                            break;
                        case ">":
                            if (!r) {
                                if (h) {
                                    g = !0;
                                    break
                                }
                                h = !0
                            }
                            s.limit = u, l = !1;
                            break;
                        case "'":
                            if (!r) {
                                if (p) {
                                    g = !0;
                                    break
                                }
                                p = !0
                            }
                            s.markedOffset = u, l = !1;
                            break;
                        case " ":
                            l = !1;
                            break;
                        default:
                            if (!r && l) {
                                g = !0;
                                break
                            }
                            if (a = parseInt(o + e.charAt(c++), 16), !r && (isNaN(a) || 0 > a || a > 255)) throw new TypeError("Illegal str: Not a debug encoded string");
                            s.view.setUint8(u++, a), l = !0
                        }
                        if (g) throw new TypeError("Illegal str: Invalid symbol at " + c)
                    }
                    if (!r) {
                        if (!d || !h) throw new TypeError("Illegal str: Missing offset or limit");
                        if (u < s.buffer.byteLength) throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) " + u + " < " + i)
                    }
                    return s
                }, t.prototype.toHex = function (e, t) {
                    if (e = "undefined" == typeof e ? this.offset : e, t = "undefined" == typeof t ? this.limit : t, !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    for (var n, r = new Array(t - e); t > e;) n = this.view.getUint8(e++), 16 > n ? r.push("0", n.toString(16)) : r.push(n.toString(16));
                    return r.join("")
                }, t.fromHex = function (e, n, r) {
                    if (!r) {
                        if ("string" != typeof e) throw new TypeError("Illegal str: Not a string");
                        if (e.length % 2 !== 0) throw new TypeError("Illegal str: Length not a multiple of 2")
                    }
                    for (var o, a = e.length, i = new t(a / 2 | 0, n), s = 0, c = 0; a > s; s += 2) {
                        if (o = parseInt(e.substring(s, s + 2), 16), !r && (!isFinite(o) || 0 > o || o > 255)) throw new TypeError("Illegal str: Contains non-hex characters");
                        i.view.setUint8(c++, o)
                    }
                    return i.limit = c, i
                };
                var o = function () {
                        var e = {};
                        return e.encodeUTF8 = function (e, t) {
                            var n = null;
                            for ("number" == typeof e && (n = e, e = function () {
                                return null
                            }); null !== n || null !== (n = e());) 128 > n ? t(127 & n) : 2048 > n ? (t(n >> 6 & 31 | 192), t(63 & n | 128)) : 65536 > n ? (t(n >> 12 & 15 | 224), t(n >> 6 & 63 | 128), t(63 & n | 128)) : (t(n >> 18 & 7 | 240), t(n >> 12 & 63 | 128), t(n >> 6 & 63 | 128), t(63 & n | 128)), n = null
                        }, e.decodeUTF8 = function (e, t) {
                            for (var n, r, o, a, i = function (e) {
                                    e = e.slice(0, e.indexOf(null));
                                    var t = Error(e.toString());
                                    throw t.name = "TruncatedError", t.bytes = e, t
                                }; null !== (n = e());) if (0 === (128 & n)) t(n);
                            else if (192 === (224 & n)) null === (r = e()) && i([n, r]), t((31 & n) << 6 | 63 & r);
                            else if (224 === (240 & n))(null === (r = e()) || null === (o = e())) && i([n, r, o]), t((15 & n) << 12 | (63 & r) << 6 | 63 & o);
                            else {
                                if (240 !== (248 & n)) throw RangeError("Illegal starting byte: " + n);
                                (null === (r = e()) || null === (o = e()) || null === (a = e())) && i([n, r, o, a]), t((7 & n) << 18 | (63 & r) << 12 | (63 & o) << 6 | 63 & a)
                            }
                        }, e.UTF16toUTF8 = function (e, t) {
                            for (var n, r = null;;) {
                                if (null === (n = null !== r ? r : e())) break;
                                n >= 55296 && 57343 >= n && null !== (r = e()) && r >= 56320 && 57343 >= r ? (t(1024 * (n - 55296) + r - 56320 + 65536), r = null) : t(n)
                            }
                            null !== r && t(r)
                        }, e.UTF8toUTF16 = function (e, t) {
                            var n = null;
                            for ("number" == typeof e && (n = e, e = function () {
                                return null
                            }); null !== n || null !== (n = e());) 65535 >= n ? t(n) : (n -= 65536, t((n >> 10) + 55296), t(n % 1024 + 56320)), n = null
                        }, e.encodeUTF16toUTF8 = function (t, n) {
                            e.UTF16toUTF8(t, function (t) {
                                e.encodeUTF8(t, n)
                            })
                        }, e.decodeUTF8toUTF16 = function (t, n) {
                            e.decodeUTF8(t, function (t) {
                                e.UTF8toUTF16(t, n)
                            })
                        }, e.assertByte = function (e) {
                            if ("number" != typeof e || e !== e) throw TypeError("Illegal byte: " + typeof e);
                            if (-128 > e || e > 255) throw RangeError("Illegal byte: " + e);
                            return e
                        }, e.assertCharCode = function (e) {
                            if ("number" != typeof e || e !== e) throw TypeError("Illegal char code: " + typeof e);
                            if (0 > e || e > 65535) throw RangeError("Illegal char code: " + e);
                            return e
                        }, e.assertCodePoint = function (e) {
                            if ("number" != typeof e || e !== e) throw TypeError("Illegal code point: " + typeof e);
                            if (0 > e || e > 1114111) throw RangeError("Illegal code point: " + e);
                            return e
                        }, e.calculateCodePoint = function (e) {
                            return 128 > e ? 1 : 2048 > e ? 2 : 65536 > e ? 3 : 4
                        }, e.calculateUTF8 = function (t) {
                            for (var n, r = 0; null !== (n = t());) r += e.calculateCodePoint(n);
                            return r
                        }, e.calculateUTF16asUTF8 = function (t) {
                            var n = 0,
                                r = 0;
                            return e.UTF16toUTF8(t, function (t) {
                                ++n, r += e.calculateCodePoint(t)
                            }), [n, r]
                        }, e
                    }(),
                    a = String.fromCharCode;
                return o.stringSource = function (e) {
                    var t = 0;
                    return function () {
                        return t < e.length ? e.charCodeAt(t++) : null
                    }
                }, o.stringDestination = function () {
                    var e = [],
                        t = [];
                    return function () {
                        return 0 === arguments.length ? t.join("") + a.apply(String, e) : (e.length + arguments.length > 1024 && (t.push(a.apply(String, e)), e.length = 0), void Array.prototype.push.apply(e, arguments))
                    }
                }, t.prototype.toUTF8 = function (e, t) {
                    if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                        if ("number" != typeof e || e % 1 !== 0) throw new TypeError("Illegal begin: Not an integer");
                        if (e >>>= 0, "number" != typeof t || t % 1 !== 0) throw new TypeError("Illegal end: Not an integer");
                        if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength) throw new RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                    }
                    var n, r = this;
                    try {
                        o.decodeUTF8toUTF16(function () {
                            return t > e ? r.view.getUint8(e++) : null
                        }, n = o.stringDestination())
                    } catch (a) {
                        if (e !== t) throw new RangeError("Illegal range: Truncated data, " + e + " != " + t)
                    }
                    return n()
                }, t.fromUTF8 = function (e, n, r) {
                    if (!r && "string" != typeof e) throw new TypeError("Illegal str: Not a string");
                    var a = new t(o.calculateUTF16asUTF8(o.stringSource(e), !0)[1], n, r),
                        i = 0;
                    return o.encodeUTF16toUTF8(o.stringSource(e), function (e) {
                        a.view.setUint8(i++, e)
                    }), a.limit = i, a
                }, t
            }
            e.exports = t(n(106))
        }(this)
    }).call(t, n(107)(e))
}, function (e) {
    var t = {
        "🐽": "1f43d",
        "🐼": "1f43c",
        "🐥": "1f425",
        "🐣": "1f423",
        "🐢": "1f422",
        "🐝": "1f41d",
        "🐜": "1f41c",
        "🐞": "1f41e",
        "🐌": "1f40c",
        "🐋": "1f40b",
        "🐄": "1f404",
        "🐏": "1f40f",
        "🐀": "1f400",
        "🐃": "1f403",
        "🐅": "1f405",
        "🐇": "1f407",
        "🐉": "1f409",
        "🐐": "1f410",
        "🐓": "1f413",
        "🐕": "1f415",
        "🐖": "1f416",
        "🐁": "1f401",
        "🐂": "1f402",
        "🐲": "1f432",
        "🐡": "1f421",
        "🐊": "1f40a",
        "🐪": "1f42a",
        "🐆": "1f406",
        "🐈": "1f408",
        "🐩": "1f429",
        "🐾": "1f43e",
        "🌿": "1f33f",
        "🍄": "1f344",
        "🌲": "1f332",
        "🌳": "1f333",
        "🌰": "1f330",
        "🌱": "1f331",
        "🌼": "1f33c",
        "🌐": "1f310",
        "🌞": "1f31e",
        "🌝": "1f31d",
        "🌚": "1f31a",
        "🌑": "1f311",
        "🌒": "1f312",
        "🌓": "1f313",
        "🌔": "1f314",
        "🌕": "1f315",
        "🌖": "1f316",
        "🌗": "1f317",
        "🌘": "1f318",
        "🌜": "1f31c",
        "🌛": "1f31b",
        "🌍": "1f30d",
        "🌎": "1f30e",
        "🌏": "1f30f",
        "🌋": "1f30b",
        "🌌": "1f30c",
        "🌠": "1f320",
        "⛅": "26c5",
        "❄": "2744",
        "🌁": "1f301",
        "🎋": "1f38b",
        "🎊": "1f38a",
        "🔮": "1f52e",
        "📹": "1f4f9",
        "💾": "1f4be",
        "📞": "1f4de",
        "📟": "1f4df",
        "🔉": "1f509",
        "🔈": "1f508",
        "🔇": "1f507",
        "🔕": "1f515",
        "⏳": "23f3",
        "⌛": "231b",
        "⏰": "23f0",
        "⌚": "231a",
        "🔏": "1f50f",
        "🔐": "1f510",
        "🔎": "1f50e",
        "🔦": "1f526",
        "🔆": "1f506",
        "🔅": "1f505",
        "🔌": "1f50c",
        "🔋": "1f50b",
        "🛁": "1f6c1",
        "🚿": "1f6bf",
        "🔧": "1f527",
        "🔩": "1f529",
        "🚪": "1f6aa",
        "🔪": "1f52a",
        "💴": "1f4b4",
        "💵": "1f4b5",
        "💷": "1f4b7",
        "💶": "1f4b6",
        "💳": "1f4b3",
        "💸": "1f4b8",
        "📧": "1f4e7",
        "📥": "1f4e5",
        "📤": "1f4e4",
        "✉": "2709",
        "📨": "1f4e8",
        "📯": "1f4ef",
        "📪": "1f4ea",
        "📬": "1f4ec",
        "📭": "1f4ed",
        "📦": "1f4e6",
        "📄": "1f4c4",
        "📃": "1f4c3",
        "📑": "1f4d1",
        "📊": "1f4ca",
        "📈": "1f4c8",
        "📉": "1f4c9",
        "📜": "1f4dc",
        "📋": "1f4cb",
        "📅": "1f4c5",
        "📆": "1f4c6",
        "📇": "1f4c7",
        "📁": "1f4c1",
        "📂": "1f4c2",
        "📌": "1f4cc",
        "📎": "1f4ce",
        "✒": "2712",
        "✏": "270f",
        "📏": "1f4cf",
        "📐": "1f4d0",
        "📕": "1f4d5",
        "📗": "1f4d7",
        "📘": "1f4d8",
        "📙": "1f4d9",
        "📓": "1f4d3",
        "📔": "1f4d4",
        "📒": "1f4d2",
        "📚": "1f4da",
        "🔖": "1f516",
        "📛": "1f4db",
        "🔬": "1f52c",
        "🔭": "1f52d",
        "📰": "1f4f0",
        "🎼": "1f3bc",
        "🎹": "1f3b9",
        "🎻": "1f3bb",
        "🎮": "1f3ae",
        "🃏": "1f0cf",
        "🎴": "1f3b4",
        "🎲": "1f3b2",
        "🏉": "1f3c9",
        "🎳": "1f3b3",
        "🚵": "1f6b5",
        "🚴": "1f6b4",
        "🏇": "1f3c7",
        "🏂": "1f3c2",
        "🎣": "1f3a3",
        "🍼": "1f37c",
        "🍹": "1f379",
        "🍷": "1f377",
        "🍕": "1f355",
        "🍗": "1f357",
        "🍖": "1f356",
        "🍤": "1f364",
        "🍥": "1f365",
        "🍩": "1f369",
        "🍮": "1f36e",
        "🍨": "1f368",
        "🍪": "1f36a",
        "🍫": "1f36b",
        "🍬": "1f36c",
        "🍭": "1f36d",
        "🍯": "1f36f",
        "🍏": "1f34f",
        "🍋": "1f34b",
        "🍒": "1f352",
        "🍇": "1f347",
        "🍑": "1f351",
        "🍈": "1f348",
        "🍌": "1f34c",
        "🍐": "1f350",
        "🍍": "1f34d",
        "🍠": "1f360",
        "🌽": "1f33d",
        "🏡": "1f3e1",
        "🏤": "1f3e4",
        "🗾": "1f5fe",
        "🌉": "1f309",
        "🎠": "1f3a0",
        "🚣": "1f6a3",
        "⚓": "2693",
        "🚁": "1f681",
        "🚂": "1f682",
        "🚊": "1f68a",
        "🚞": "1f69e",
        "🚆": "1f686",
        "🚈": "1f688",
        "🚝": "1f69d",
        "🚋": "1f68b",
        "🚎": "1f68e",
        "🚍": "1f68d",
        "🚘": "1f698",
        "🚖": "1f696",
        "🚛": "1f69b",
        "🚨": "1f6a8",
        "🚔": "1f694",
        "🚐": "1f690",
        "🚡": "1f6a1",
        "🚟": "1f69f",
        "🚠": "1f6a0",
        "🚜": "1f69c",
        "🚦": "1f6a6",
        "🏮": "1f3ee",
        "🗿": "1f5ff",
        "🎪": "1f3aa",
        "🎭": "1f3ad",
        "📍": "1f4cd",
        "🚩": "1f6a9",
        "🔟": "1f51f",
        "🔢": "1f522",
        "🔣": "1f523",
        "🔠": "1f520",
        "🔡": "1f521",
        "🔤": "1f524",
        "↔": "2194",
        "↕": "2195",
        "🔄": "1f504",
        "🔼": "1f53c",
        "🔽": "1f53d",
        "↩": "21a9",
        "↪": "21aa",
        "ℹ": "2139",
        "⏫": "23eb",
        "⏬": "23ec",
        "⤵": "2935",
        "⤴": "2934",
        "🔀": "1f500",
        "🔁": "1f501",
        "🔂": "1f502",
        "🆓": "1f193",
        "🆖": "1f196",
        "🈴": "1f234",
        "🈲": "1f232",
        "🚰": "1f6b0",
        "🚮": "1f6ae",
        "Ⓜ": "24c2",
        "🛂": "1f6c2",
        "🛄": "1f6c4",
        "🛅": "1f6c5",
        "🛃": "1f6c3",
        "🉑": "1f251",
        "🆑": "1f191",
        "🆘": "1f198",
        "🚫": "1f6ab",
        "📵": "1f4f5",
        "🚯": "1f6af",
        "🚱": "1f6b1",
        "🚳": "1f6b3",
        "🚷": "1f6b7",
        "🚸": "1f6b8",
        "⛔": "26d4",
        "❇": "2747",
        "❎": "274e",
        "✅": "2705",
        "💠": "1f4a0",
        "♻": "267b",
        "💲": "1f4b2",
        "〰": "3030",
        "🔚": "1f51a",
        "🔙": "1f519",
        "🔛": "1f51b",
        "🔜": "1f51c",
        "🔃": "1f503",
        "🕧": "1f567",
        "🕜": "1f55c",
        "🕝": "1f55d",
        "🕞": "1f55e",
        "🕟": "1f55f",
        "🕠": "1f560",
        "🕡": "1f561",
        "🕢": "1f562",
        "🕣": "1f563",
        "🕤": "1f564",
        "🕥": "1f565",
        "🕦": "1f566",
        "✖": "2716",
        "➕": "2795",
        "➖": "2796",
        "➗": "2797",
        "💮": "1f4ae",
        "💯": "1f4af",
        "✔": "2714",
        "☑": "2611",
        "🔘": "1f518",
        "🔗": "1f517",
        "➰": "27b0",
        "◼": "25fc",
        "◻": "25fb",
        "◾": "25fe",
        "◽": "25fd",
        "▪": "25aa",
        "▫": "25ab",
        "🔺": "1f53a",
        "⬜": "2b1c",
        "⬛": "2b1b",
        "⚫": "26ab",
        "⚪": "26aa",
        "🔵": "1f535",
        "🔻": "1f53b",
        "🔶": "1f536",
        "🔷": "1f537",
        "🔸": "1f538",
        "🔹": "1f539",
        "😀": "1f600",
        "😗": "1f617",
        "😙": "1f619",
        "😛": "1f61b",
        "😅": "1f605",
        "😩": "1f629",
        "😫": "1f62b",
        "😤": "1f624",
        "😆": "1f606",
        "😋": "1f60b",
        "😎": "1f60e",
        "😴": "1f634",
        "😵": "1f635",
        "😟": "1f61f",
        "😦": "1f626",
        "😧": "1f627",
        "😈": "1f608",
        "😮": "1f62e",
        "😬": "1f62c",
        "😐": "1f610",
        "😕": "1f615",
        "😯": "1f62f",
        "😶": "1f636",
        "😇": "1f607",
        "😑": "1f611",
        "😺": "1f63a",
        "😸": "1f638",
        "😻": "1f63b",
        "😽": "1f63d",
        "😼": "1f63c",
        "🙀": "1f640",
        "😿": "1f63f",
        "😹": "1f639",
        "😾": "1f63e",
        "👹": "1f479",
        "👺": "1f47a",
        "🙈": "1f648",
        "🙉": "1f649",
        "🙊": "1f64a",
        "💫": "1f4ab",
        "💥": "1f4a5",
        "💧": "1f4a7",
        "👅": "1f445",
        "👪": "1f46a",
        "👬": "1f46c",
        "👭": "1f46d",
        "🙋": "1f64b",
        "👰": "1f470",
        "🙎": "1f64e",
        "🙍": "1f64d",
        "👞": "1f45e",
        "👚": "1f45a",
        "🎽": "1f3bd",
        "👖": "1f456",
        "👝": "1f45d",
        "👛": "1f45b",
        "👓": "1f453",
        "💕": "1f495",
        "💖": "1f496",
        "💞": "1f49e",
        "💌": "1f48c",
        "👤": "1f464",
        "👥": "1f465",
        "💬": "1f4ac",
        "💭": "1f4ad",
        "🇮🇳": "ec00",
        "🇲🇽": "ec01",
        "🇧🇷": "ec02",
        "🇸🇦": "ec03",
        "🇿🇦": "ec04",
        "🇦🇷": "ec05",
        "🇳🇱": "ec06",
        "🇹🇷": "ec07",
        "🇲🇾": "ec08",
        "🇻🇪": "ec09",
        "🇨🇴": "ec0a",
        "🇨🇱": "ec0b",
        "🇭🇰": "ec0c",
        "🇳🇬": "ec0d",
        "🇨🇭": "ec0e",
        "🇮🇱": "ec0f",
        "🇹🇭": "ec10",
        "🇸🇬": "ec11",
        "🇦🇪": "ec12",
        "🇹🇼": "ec13",
        "🇪🇬": "ec14",
        "🇨🇦": "ec15",
        "🇮🇩": "ec16",
        "🇦🇹": "ec17",
        "🇦🇺": "ec18",
        "🇧🇦": "ec19",
        "🇧🇪": "ec1a",
        "🇨🇮": "ec1b",
        "🇨🇲": "ec1c",
        "🇨🇷": "ec1d",
        "🇩🇿": "ec1e",
        "🇪🇨": "ec1f",
        "🇬🇭": "ec20",
        "🇬🇷": "ec21",
        "🇭🇳": "ec22",
        "🇭🇷": "ec23",
        "🇮🇷": "ec24",
        "🇯🇴": "ec25",
        "🇰🇿": "ec26",
        "🇱🇧": "ec27",
        "🇵🇪": "ec28",
        "🇵🇹": "ec29",
        "🇸🇾": "ec2a",
        "🇺🇦": "ec2b",
        "🇺🇾": "ec2c",
        "🇽🇪": "ec2d",
        "🇨🇳": "e513",
        "🇩🇪": "e50e",
        "🇪🇸": "e511",
        "🇫🇷": "e50d",
        "🇬🇧": "e510",
        "🇮🇹": "e50f",
        "🇯🇵": "e50b",
        "🇰🇷": "e514",
        "🇷🇺": "e512",
        "🇺🇸": "e50c",
        "#⃣": "e210",
        "1⃣": "e21c",
        "2⃣": "e21d",
        "3⃣": "e21e",
        "4⃣": "e21f",
        "5⃣": "e220",
        "6⃣": "e221",
        "7⃣": "e222",
        "8⃣": "e223",
        "9⃣": "e224",
        "0⃣": "e225",
        "©": "e24e",
        "®": "e24f",
        "™": "e537",
        "↖": "e237",
        "↗": "e236",
        "↘": "e238",
        "↙": "e239",
        "⏩": "e23c",
        "⏪": "e23d",
        "▶": "e23a",
        "◀": "e23b",
        "☀": "e04a",
        "☁": "e049",
        "☎": "e009",
        "☔": "e04b",
        "☕": "e045",
        "☝": "e00f",
        "☺": "e414",
        "♈": "e23f",
        "♉": "e240",
        "♊": "e241",
        "♋": "e242",
        "♌": "e243",
        "♍": "e244",
        "♎": "e245",
        "♏": "e246",
        "♐": "e247",
        "♑": "e248",
        "♒": "e249",
        "♓": "e24a",
        "♠": "e20e",
        "♣": "e20f",
        "♥": "e20c",
        "♦": "e20d",
        "♨": "e123",
        "♿": "e20a",
        "⚠": "e252",
        "⚡": "e13d",
        "⚽": "e018",
        "⚾": "e016",
        "⛄": "e048",
        "⛎": "e24b",
        "⛪": "e037",
        "⛲": "e121",
        "⛳": "e014",
        "⛵": "e01c",
        "⛺": "e122",
        "⛽": "e03a",
        "✂": "e313",
        "✈": "e01d",
        "✊": "e010",
        "✋": "e012",
        "✌": "e011",
        "✨": "e32e",
        "✳": "e206",
        "✴": "e205",
        "❌": "e333",
        "❓": "e020",
        "❔": "e336",
        "❕": "e337",
        "❗": "e021",
        "❤": "e022",
        "➡": "e234",
        "➿": "e211",
        "⬅": "e235",
        "⬆": "e232",
        "⬇": "e233",
        "⭐": "e32f",
        "⭕": "e332",
        "〽": "e12c",
        "㊗": "e30d",
        "㊙": "e315",
        "🀄": "e12d",
        "🅰": "e532",
        "🅱": "e533",
        "🅾": "e535",
        "🅿": "e14f",
        "🆎": "e534",
        "🆒": "e214",
        "🆔": "e229",
        "🆕": "e212",
        "🆗": "e24d",
        "🆙": "e213",
        "🆚": "e12e",
        "🈁": "e203",
        "🈂": "e228",
        "🈚": "e216",
        "🈯": "e22c",
        "🈳": "e22b",
        "🈵": "e22a",
        "🈶": "e215",
        "🈷": "e217",
        "🈸": "e218",
        "🈹": "e227",
        "🈺": "e22d",
        "🉐": "e226",
        "🌀": "e443",
        "🌂": "e43c",
        "🌃": "e44b",
        "🌄": "e04d",
        "🌅": "e449",
        "🌆": "e146",
        "🌇": "e44a",
        "🌈": "e44c",
        "🌊": "e43e",
        "🌙": "e04c",
        "🌟": "e335",
        "🌴": "e307",
        "🌵": "e308",
        "🌷": "e304",
        "🌸": "e030",
        "🌹": "e032",
        "🌺": "e303",
        "🌻": "e305",
        "🌾": "e444",
        "🍀": "e110",
        "🍁": "e118",
        "🍂": "e119",
        "🍃": "e447",
        "🍅": "e349",
        "🍆": "e34a",
        "🍉": "e348",
        "🍊": "e346",
        "🍎": "e345",
        "🍓": "e347",
        "🍔": "e120",
        "🍘": "e33d",
        "🍙": "e342",
        "🍚": "e33e",
        "🍛": "e341",
        "🍜": "e340",
        "🍝": "e33f",
        "🍞": "e339",
        "🍟": "e33b",
        "🍡": "e33c",
        "🍢": "e343",
        "🍣": "e344",
        "🍦": "e33a",
        "🍧": "e43f",
        "🍰": "e046",
        "🍱": "e34c",
        "🍲": "e34d",
        "🍳": "e147",
        "🍴": "e043",
        "🍵": "e338",
        "🍶": "e30b",
        "🍸": "e044",
        "🍺": "e047",
        "🍻": "e30c",
        "🎀": "e314",
        "🎁": "e112",
        "🎂": "e34b",
        "🎃": "e445",
        "🎄": "e033",
        "🎅": "e448",
        "🎆": "e117",
        "🎇": "e440",
        "🎈": "e310",
        "🎉": "e312",
        "🎌": "e143",
        "🎍": "e436",
        "🎎": "e438",
        "🎏": "e43b",
        "🎐": "e442",
        "🎑": "e446",
        "🎒": "e43a",
        "🎓": "e439",
        "🎡": "e124",
        "🎢": "e433",
        "🎤": "e03c",
        "🎥": "e03d",
        "🎦": "e507",
        "🎧": "e30a",
        "🎨": "e502",
        "🎩": "e503",
        "🎫": "e125",
        "🎬": "e324",
        "🎯": "e130",
        "🎰": "e133",
        "🎱": "e42c",
        "🎵": "e03e",
        "🎶": "e326",
        "🎷": "e040",
        "🎸": "e041",
        "🎺": "e042",
        "🎾": "e015",
        "🎿": "e013",
        "🏀": "e42a",
        "🏁": "e132",
        "🏃": "e115",
        "🏄": "e017",
        "🏆": "e131",
        "🏈": "e42b",
        "🏊": "e42d",
        "🏠": "e036",
        "🏢": "e038",
        "🏣": "e153",
        "🏥": "e155",
        "🏦": "e14d",
        "🏧": "e154",
        "🏨": "e158",
        "🏩": "e501",
        "🏪": "e156",
        "🏫": "e157",
        "🏬": "e504",
        "🏭": "e508",
        "🏯": "e505",
        "🏰": "e506",
        "🐍": "e52d",
        "🐎": "e134",
        "🐑": "e529",
        "🐒": "e528",
        "🐔": "e52e",
        "🐗": "e52f",
        "🐘": "e526",
        "🐙": "e10a",
        "🐚": "e441",
        "🐛": "e525",
        "🐟": "e019",
        "🐠": "e522",
        "🐤": "e523",
        "🐦": "e521",
        "🐧": "e055",
        "🐨": "e527",
        "🐫": "e530",
        "🐬": "e520",
        "🐭": "e053",
        "🐮": "e52b",
        "🐯": "e050",
        "🐰": "e52c",
        "🐱": "e04f",
        "🐳": "e054",
        "🐴": "e01a",
        "🐵": "e109",
        "🐶": "e052",
        "🐷": "e10b",
        "🐸": "e531",
        "🐹": "e524",
        "🐺": "e52a",
        "🐻": "e051",
        "👀": "e419",
        "👂": "e41b",
        "👃": "e41a",
        "👄": "e41c",
        "👆": "e22e",
        "👇": "e22f",
        "👈": "e230",
        "👉": "e231",
        "👊": "e00d",
        "👋": "e41e",
        "👌": "e420",
        "👍": "e00e",
        "👎": "e421",
        "👏": "e41f",
        "👐": "e422",
        "👑": "e10e",
        "👒": "e318",
        "👔": "e302",
        "👕": "e006",
        "👗": "e319",
        "👘": "e321",
        "👙": "e322",
        "👜": "e323",
        "👟": "e007",
        "👠": "e13e",
        "👡": "e31a",
        "👢": "e31b",
        "👣": "e536",
        "👦": "e001",
        "👧": "e002",
        "👨": "e004",
        "👩": "e005",
        "👫": "e428",
        "👮": "e152",
        "👯": "e429",
        "👱": "e515",
        "👲": "e516",
        "👳": "e517",
        "👴": "e518",
        "👵": "e519",
        "👶": "e51a",
        "👷": "e51b",
        "👸": "e51c",
        "👻": "e11b",
        "👼": "e04e",
        "👽": "e10c",
        "👾": "e12b",
        "👿": "e11a",
        "💀": "e11c",
        "💁": "e253",
        "💂": "e51e",
        "💃": "e51f",
        "💄": "e31c",
        "💅": "e31d",
        "💆": "e31e",
        "💇": "e31f",
        "💈": "e320",
        "💉": "e13b",
        "💊": "e30f",
        "💋": "e003",
        "💍": "e034",
        "💎": "e035",
        "💏": "e111",
        "💐": "e306",
        "💑": "e425",
        "💒": "e43d",
        "💓": "e327",
        "💔": "e023",
        "💗": "e328",
        "💘": "e329",
        "💙": "e32a",
        "💚": "e32b",
        "💛": "e32c",
        "💜": "e32d",
        "💝": "e437",
        "💟": "e204",
        "💡": "e10f",
        "💢": "e334",
        "💣": "e311",
        "💤": "e13c",
        "💦": "e331",
        "💨": "e330",
        "💩": "e05a",
        "💪": "e14c",
        "💰": "e12f",
        "💱": "e149",
        "💹": "e14a",
        "💺": "e11f",
        "💻": "e00c",
        "💼": "e11e",
        "💽": "e316",
        "💿": "e126",
        "📀": "e127",
        "📖": "e148",
        "📝": "e301",
        "📠": "e00b",
        "📡": "e14b",
        "📢": "e142",
        "📣": "e317",
        "📩": "e103",
        "📫": "e101",
        "📮": "e102",
        "📱": "e00a",
        "📲": "e104",
        "📳": "e250",
        "📴": "e251",
        "📶": "e20b",
        "📷": "e008",
        "📺": "e12a",
        "📻": "e128",
        "📼": "e129",
        "🔊": "e141",
        "🔍": "e114",
        "🔑": "e03f",
        "🔒": "e144",
        "🔓": "e145",
        "🔔": "e325",
        "🔝": "e24c",
        "🔞": "e207",
        "🔥": "e11d",
        "🔨": "e116",
        "🔫": "e113",
        "🔯": "e23e",
        "🔰": "e209",
        "🔱": "e031",
        "🔲": "e21a",
        "🔳": "e21b",
        "🔴": "e219",
        "🕐": "e024",
        "🕑": "e025",
        "🕒": "e026",
        "🕓": "e027",
        "🕔": "e028",
        "🕕": "e029",
        "🕖": "e02a",
        "🕗": "e02b",
        "🕘": "e02c",
        "🕙": "e02d",
        "🕚": "e02e",
        "🕛": "e02f",
        "🗻": "e03b",
        "🗼": "e509",
        "🗽": "e51d",
        "😁": "e404",
        "😂": "e412",
        "😃": "e057",
        "😄": "e415",
        "😉": "e405",
        "😊": "e056",
        "😌": "e40a",
        "😍": "e106",
        "😏": "e402",
        "😒": "e40e",
        "😓": "e108",
        "😔": "e403",
        "😖": "e407",
        "😘": "e418",
        "😚": "e417",
        "😜": "e105",
        "😝": "e409",
        "😞": "e058",
        "😠": "e059",
        "😡": "e416",
        "😢": "e413",
        "😣": "e406",
        "😥": "e401",
        "😨": "e40b",
        "😪": "e408",
        "😭": "e411",
        "😰": "e40f",
        "😱": "e107",
        "😲": "e410",
        "😳": "e40d",
        "😷": "e40c",
        "🙅": "e423",
        "🙆": "e424",
        "🙇": "e426",
        "🙌": "e427",
        "🙏": "e41d",
        "🚀": "e10d",
        "🚃": "e01e",
        "🚄": "e435",
        "🚅": "e01f",
        "🚇": "e434",
        "🚉": "e039",
        "🚌": "e159",
        "🚏": "e150",
        "🚑": "e431",
        "🚒": "e430",
        "🚓": "e432",
        "🚕": "e15a",
        "🚗": "e01b",
        "🚙": "e42e",
        "🚚": "e42f",
        "🚢": "e202",
        "🚤": "e135",
        "🚥": "e14e",
        "🚧": "e137",
        "🚬": "e30e",
        "🚭": "e208",
        "🚲": "e136",
        "🚶": "e201",
        "🚹": "e138",
        "🚺": "e139",
        "🚻": "e151",
        "🚼": "e13a",
        "🚽": "e140",
        "🚾": "e309",
        "🛀": "e13f"
    };
    e.exports = t
}, function (e) {
    var t = {
        "": "e052",
        "": "e52a",
        "": "e04f",
        "": "e053",
        "": "e524",
        "": "e52c",
        "": "e531",
        "": "e050",
        "": "e527",
        "": "e051",
        "": "e10b",
        "": "e52b",
        "": "e52f",
        "": "e109",
        "": "e528",
        "": "e01a",
        "": "e529",
        "": "e526",
        "": "e055",
        "": "e521",
        "": "e523",
        "": "e52e",
        "": "e52d",
        "": "e525",
        "": "e10a",
        "": "e441",
        "": "e522",
        "": "e019",
        "": "e520",
        "": "e054",
        "": "e134",
        "": "e530",
        "": "e306",
        "": "e030",
        "": "e304",
        "": "e110",
        "": "e032",
        "": "e305",
        "": "e303",
        "": "e118",
        "": "e447",
        "": "e119",
        "": "e444",
        "": "e308",
        "": "e307",
        "": "e04c",
        "": "e32f",
        "": "e04a",
        "": "e049",
        "": "e13d",
        "": "e04b",
        "": "e048",
        "": "e443",
        "": "e44c",
        "": "e43e",
        "": "e436",
        "": "e437",
        "": "e438",
        "": "e43a",
        "": "e439",
        "": "e43b",
        "": "e117",
        "": "e440",
        "": "e442",
        "": "e446",
        "": "e445",
        "": "e11b",
        "": "e448",
        "": "e033",
        "": "e112",
        "": "e312",
        "": "e310",
        "": "e143",
        "": "e03d",
        "": "e008",
        "": "e129",
        "": "e126",
        "": "e127",
        "": "e316",
        "": "e00c",
        "": "e00a",
        "": "e009",
        "": "e00b",
        "": "e14b",
        "": "e12a",
        "": "e128",
        "": "e141",
        "": "e325",
        "": "e142",
        "": "e317",
        "": "e145",
        "": "e144",
        "": "e03f",
        "": "e10f",
        "": "e114",
        "": "e13f",
        "": "e140",
        "": "e116",
        "": "e30e",
        "": "e311",
        "": "e113",
        "": "e30f",
        "": "e13b",
        "": "e12f",
        "": "e104",
        "": "e103",
        "": "e101",
        "": "e102",
        "": "e301",
        "": "e313",
        "": "e148",
        "": "e502",
        "": "e324",
        "": "e03c",
        "": "e30a",
        "": "e03e",
        "": "e326",
        "": "e042",
        "": "e040",
        "": "e041",
        "": "e12b",
        "": "e12d",
        "": "e130",
        "": "e42b",
        "": "e42a",
        "": "e018",
        "": "e016",
        "": "e015",
        "": "e42c",
        "": "e014",
        "": "e132",
        "": "e131",
        "": "e013",
        "": "e42d",
        "": "e017",
        "": "e045",
        "": "e338",
        "": "e30b",
        "": "e047",
        "": "e30c",
        "": "e044",
        "": "e043",
        "": "e120",
        "": "e33b",
        "": "e33f",
        "": "e341",
        "": "e34c",
        "": "e344",
        "": "e342",
        "": "e33d",
        "": "e33e",
        "": "e340",
        "": "e34d",
        "": "e343",
        "": "e33c",
        "": "e147",
        "": "e339",
        "": "e33a",
        "": "e43f",
        "": "e34b",
        "": "e046",
        "": "e345",
        "": "e346",
        "": "e348",
        "": "e347",
        "": "e34a",
        "": "e349",
        "": "e036",
        "": "e157",
        "": "e038",
        "": "e153",
        "": "e155",
        "": "e14d",
        "": "e156",
        "": "e501",
        "": "e158",
        "": "e43d",
        "": "e037",
        "": "e504",
        "": "e44a",
        "": "e146",
        "": "e505",
        "": "e506",
        "": "e122",
        "": "e508",
        "": "e509",
        "": "e03b",
        "": "e04d",
        "": "e449",
        "": "e44b",
        "": "e51d",
        "": "e124",
        "": "e121",
        "": "e433",
        "": "e202",
        "": "e01c",
        "": "e135",
        "": "e10d",
        "": "e01d",
        "": "e11f",
        "": "e039",
        "": "e435",
        "": "e01f",
        "": "e434",
        "": "e01e",
        "": "e159",
        "": "e42e",
        "": "e01b",
        "": "e15a",
        "": "e42f",
        "": "e432",
        "": "e430",
        "": "e431",
        "": "e136",
        "": "e320",
        "": "e150",
        "": "e125",
        "": "e14e",
        "": "e252",
        "": "e137",
        "": "e209",
        "": "e03a",
        "": "e133",
        "": "e123",
        "": "e50b",
        "": "e514",
        "": "e50e",
        "": "e513",
        "": "e50c",
        "": "e50d",
        "": "e511",
        "": "e50f",
        "": "e512",
        "": "e510",
        "": "e21c",
        "": "e21d",
        "": "e21e",
        "": "e21f",
        "": "e220",
        "": "e221",
        "": "e222",
        "": "e223",
        "": "e224",
        "": "e225",
        "": "e210",
        "": "e232",
        "": "e233",
        "": "e235",
        "": "e234",
        "": "e236",
        "": "e237",
        "": "e238",
        "": "e239",
        "": "e23b",
        "": "e23a",
        "": "e23d",
        "": "e23c",
        "": "e24d",
        "": "e212",
        "": "e213",
        "": "e214",
        "": "e20b",
        "": "e507",
        "": "e203",
        "": "e22c",
        "": "e22b",
        "": "e22a",
        "": "e226",
        "": "e227",
        "": "e22d",
        "": "e215",
        "": "e216",
        "": "e151",
        "": "e138",
        "": "e139",
        "": "e13a",
        "": "e309",
        "": "e14f",
        "": "e20a",
        "": "e208",
        "": "e217",
        "": "e218",
        "": "e228",
        "": "e315",
        "": "e30d",
        "": "e229",
        "": "e207",
        "": "e206",
        "": "e205",
        "": "e204",
        "": "e12e",
        "": "e250",
        "": "e251",
        "": "e532",
        "": "e533",
        "": "e534",
        "": "e535",
        "": "e211",
        "": "e23f",
        "": "e240",
        "": "e241",
        "": "e242",
        "": "e243",
        "": "e244",
        "": "e245",
        "": "e246",
        "": "e247",
        "": "e248",
        "": "e249",
        "": "e24a",
        "": "e24b",
        "": "e23e",
        "": "e154",
        "": "e14a",
        "": "e149",
        "": "e24e",
        "": "e24f",
        "": "e537",
        "": "e12c",
        "": "e24c",
        "": "e333",
        "": "e332",
        "": "e021",
        "": "e020",
        "": "e337",
        "": "e336",
        "": "e02f",
        "": "e024",
        "": "e025",
        "": "e026",
        "": "e027",
        "": "e028",
        "": "e029",
        "": "e02a",
        "": "e02b",
        "": "e02c",
        "": "e02d",
        "": "e02e",
        "": "e20e",
        "": "e20c",
        "": "e20f",
        "": "e20d",
        "": "e031",
        "": "e21a",
        "": "e21b",
        "": "e219",
        "": "e415",
        "": "e057",
        "": "e056",
        "": "e414",
        "": "e405",
        "": "e106",
        "": "e418",
        "": "e417",
        "": "e105",
        "": "e409",
        "": "e40d",
        "": "e404",
        "": "e403",
        "": "e40a",
        "": "e40e",
        "": "e058",
        "": "e406",
        "": "e413",
        "": "e412",
        "": "e411",
        "": "e408",
        "": "e401",
        "": "e40f",
        "": "e108",
        "": "e40b",
        "": "e107",
        "": "e059",
        "": "e416",
        "": "e407",
        "": "e40c",
        "": "e410",
        "": "e11a",
        "": "e402",
        "": "e516",
        "": "e517",
        "": "e152",
        "": "e51b",
        "": "e51e",
        "": "e51a",
        "": "e001",
        "": "e002",
        "": "e004",
        "": "e005",
        "": "e518",
        "": "e519",
        "": "e515",
        "": "e04e",
        "": "e51c",
        "": "e11c",
        "": "e10c",
        "": "e05a",
        "": "e11d",
        "": "e32e",
        "": "e335",
        "": "e334",
        "": "e331",
        "": "e13c",
        "": "e330",
        "": "e41b",
        "": "e419",
        "": "e41a",
        "": "e41c",
        "": "e00e",
        "": "e421",
        "": "e420",
        "": "e00d",
        "": "e010",
        "": "e011",
        "": "e41e",
        "": "e012",
        "": "e422",
        "": "e22e",
        "": "e22f",
        "": "e231",
        "": "e230",
        "": "e427",
        "": "e41d",
        "": "e00f",
        "": "e41f",
        "": "e14c",
        "": "e201",
        "": "e115",
        "": "e51f",
        "": "e428",
        "": "e111",
        "": "e425",
        "": "e429",
        "": "e424",
        "": "e423",
        "": "e253",
        "": "e31e",
        "": "e31f",
        "": "e31d",
        "": "e426",
        "": "e503",
        "": "e10e",
        "": "e318",
        "": "e007",
        "": "e31a",
        "": "e13e",
        "": "e31b",
        "": "e006",
        "": "e302",
        "": "e319",
        "": "e321",
        "": "e322",
        "": "e11e",
        "": "e323",
        "": "e314",
        "": "e43c",
        "": "e31c",
        "": "e32c",
        "": "e32a",
        "": "e32d",
        "": "e32b",
        "": "e022",
        "": "e023",
        "": "e328",
        "": "e327",
        "": "e329",
        "": "e003",
        "": "e034",
        "": "e035",
        "": "e536"
    };
    e.exports = t
}, function (e) {
    var t = 20,
        n = React.createClass({
            displayName: "Spinner",
            propTypes: {
                size: React.PropTypes.number.isRequired,
                stroke: React.PropTypes.number.isRequired
            },
            getDefaultProps: function () {
                return {
                    size: 65,
                    stroke: 4
                }
            },
            shouldComponentUpdate: function () {
                return !1
            },
            render: function () {
                var e = {
                    width: this.props.size,
                    height: this.props.size
                },
                    n = 2 * t + this.props.stroke,
                    r = "0 0 " + n + " " + n;
                return React.createElement("svg", {
                    className: "spinner-container",
                    style: e,
                    viewBox: r
                }, React.createElement("circle", {
                    className: "path",
                    cx: n / 2,
                    cy: n / 2,
                    r: t,
                    fill: "none",
                    strokeWidth: this.props.stroke
                }))
            }
        });
    e.exports = n
}, function (e, t, n) {
    function r(e) {
        return _.isArray(e) ? e : [e]
    }
    var o = n(109),
        a = React.addons.TransitionGroup,
        i = React.createClass({
            displayName: "VelocityTransitionGroupChild",
            propTypes: {
                transitionName: React.PropTypes.string.isRequired,
                delay: React.PropTypes.number
            },
            _getTransition: function () {
                return o[this.props.transitionName] || console.warn("TransitionName " + this.props.transitionName + " wasn't found in VelocityTransitionGroupChild transitions."), o[this.props.transitionName] || o["default"]
            },
            componentWillEnter: function (e) {
                var t = this._getTransition();
                this.animateTransitions(t.enter)["finally"](this._cbWrapper(e))
            },
            componentWillLeave: function (e) {
                var t = this._getTransition();
                this.animateTransitions(t.leave)["finally"](this._cbWrapper(e))
            },
            _cbWrapper: function (e) {
                var t = this;
                return function () {
                    return t.isMounted() && _.isFunction(e) ? e() : void 0
                }
            },
            animateTransitions: function (e) {
                var t = this._getTransition();
                if (!t || !e) return Promise.resolve();
                var n = this.getDOMNode(),
                    o = this.props.delay,
                    a = _.omit(t, "leave", "enter"),
                    i = {},
                    s = React.Children.only(this.props.children);
                return e = _.filter(r(e), function (e) {
                    if (_.isString(e.selector) || i[e.selector]) {
                        var t = n.querySelectorAll(e.selector);
                        if (!t.length) return !1;
                        i[e.selector] = t
                    }
                    return !0
                }), Promise.map(e, function (e) {
                    var t = e.selector ? i[e.selector] : n;
                    return Velocity(t, e.props, {
                        easing: e.easing || a.easing || "easeInSine",
                        duration: e.duration || a.duration || 0,
                        delay: s.props.staggerDelay || o || e.delay || a.delay || 0,
                        queue: a.queue || !1,
                        stagger: e.stagger || !1,
                        drag: e.drag || !1
                    })
                })
            },
            componentWillUnmount: function () {
                var e = this.getDOMNode();
                Velocity(e, "stop")
            },
            render: function () {
                return React.Children.only(this.props.children)
            }
        }),
        s = React.createClass({
            displayName: "VelocityTransitionGroup",
            propTypes: {
                transitionName: React.PropTypes.string.isRequired,
                delay: React.PropTypes.number
            },
            _wrapChild: function (e) {
                return React.createElement(i, {
                    delay: this.props.delay,
                    transitionName: this.props.transitionName
                }, e)
            },
            render: function () {
                return React.createElement(a, React.__spread({
                    childFactory: this._wrapChild
                }, this.props))
            }
        });
    e.exports = s
}, function (e) {
    var t = {
        getInitialState: function () {
            return this._timer_mixin_timers = {}, this._timer_mixin_seq = 0, {}
        },
        componentWillUnmount: function () {
            var e = this._timer_mixin_timers;
            e && _.values(e).forEach(function (e) {
                e()
            })
        },
        safeIsMounted: function () {
            return this.isMounted() && "UNMOUNTING" !== this._compositeLifeCycleState
        },
        safeInterval: function (e, t) {
            e = e.bind === Object.getPrototypeOf(e).bind ? e.bind(this) : e;
            var n = setInterval(e, t);
            return this._regTimer(clearInterval.bind(void 0, n))
        },
        safeDelay: function () {
            var e, t = _.toArray(arguments),
                n = t.shift(),
                r = t.shift(),
                o = _.delay(function (r) {
                    delete r._timer_mixin_timers[e], n.apply(r, t)
                }, r, this);
            return e = this._regTimer(clearTimeout.bind(void 0, o))
        },
        safeDefer: function () {
            var e, t = _.toArray(arguments),
                n = t.shift(),
                r = _.defer(function (r) {
                    delete r._timer_mixin_timers[e], n.apply(r, t)
                }, this);
            return e = this._regTimer(clearTimeout.bind(void 0, r))
        },
        safeDebounce: function (e, t, n) {
            var r, o, a = this,
                i = this._timer_mixin_timers,
                s = function () {
                    delete i[r], e()
                },
                c = _.c_debounce(s, t, n);
            return function () {
                r && delete i[r], o = c().cancel, r = a._regTimer(o)
            }
        },
        clearSafeTimeout: function (e) {
            var t = this._timer_mixin_timers[e];
            t && t()
        },
        clearSafeInterval: function (e) {
            return this.clearSafeTimeout(e)
        },
        _regTimer: function (e) {
            var t = this._timer_mixin_timers,
                n = ++this._timer_mixin_seq;
            return t[n] = function () {
                delete t[n], e()
            }, n
        }
    };
    e.exports = t
}, function (e, t, n) {
    var r = n(110),
        o = n(83),
        a = function (e, t) {
            return '<span class="icon-battery" level="' + t + '" title="' + e + '"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="11px" height="19px" viewBox="0 0 11 19" enable-background="new 0 0 11 19" xml:space="preserve"><style type="text/css"><![CDATA[ .icon-battery-body { fill-rule:evenodd; clip-rule: evenodd; fill: #ffffff; opacity: 0.6} ]]></style><g><defs><path id="batteryMainSVGID_1_" d="M10.466,2H8V0.541C8,0.242,7.783,0,7.484,0H3.512C3.213,0,3,0.242,3,0.541V2H0.541C0.242,2,0,2.233,0,2.532v15.914C0,18.744,0.242,19,0.541,19h9.925C10.765,19,11,18.744,11,18.445V2.532C11,2.233,10.765,2,10.466,2z"/></defs><clipPath id="batteryMainSVGID_2_"><use xlink:href="#batteryMainSVGID_1_"  overflow="visible"/></clipPath><g clip-path="url(#batteryMainSVGID_2_)"><rect opacity="0.3" fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" width="11" height="19"/><rect class="icon-battery-body" y="0" width="11" height="19"/></g></g></svg></span>'
        },
        i = React.createClass({
            displayName: "Header",
            mixins: [r],
            propTypes: {
                conn: React.PropTypes.instanceOf(o).isRequired
            },
            getInitialState: function () {
                return {
                    battery: this.async("conn.battery"),
                    plugged: this.async("conn.plugged")
                }
            },
            render: function () {
                var e, t = this.props.conn,
                    n = this.state.battery;
                if (n) {
                    var r, o = t.get("scaledBatteryLevel"),
                        i = this.state.plugged;
                    _.isNumber(n) && (r = n + "%" + (i ? " (plugged in)" : "")), e = React.createElement("div", {
                        className: "status-icons",
                        dangerouslySetInnerHTML: {
                            __html: a(r, o)
                        }
                    })
                }
                return React.createElement("div", null, e)
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(47),
        o = n(111),
        a = n(112),
        i = n(113),
        s = n(114),
        c = n(115),
        u = n(116),
        l = n(48),
        d = (n(101), React.addons.PureRenderMixin),
        p = React.createClass({
            displayName: "ChatlistPanel",
            mixins: [r, l, d],
            getInitialState: function () {
                return {
                    searchText: ""
                }
            },
            getFilteredContacts: function () {
                var e = this.state.searchText;
                if (!e) return [];
                var t = Store.Contact.getFilteredContacts(!0);
                return t.filter(function (t) {
                    var n = t.searchMatch(e),
                        r = Store.Chat.get(t.get("id")),
                        o = r && !r.isNewlyCreated() ? !0 : !1;
                    return n && !o
                })
            },
            getFilteredChats: function () {
                var e = this.state.searchText;
                return Store.Chat.filter(e ?
                function (t) {
                    return t.contact.searchMatch(e) && !t.isNewlyCreated()
                } : function (e) {
                    return !e.get("archive") && !e.isNewlyCreated()
                })
            },
            getEmptyChatlistState: function () {
                var e = this.getFilteredContacts().length,
                    t = this.getFilteredChats().length,
                    n = !(e || t);
                if (n) {
                    if (this.state.searchText) return s.EMPTY_SEARCH;
                    var r = Store.Chat.filter(function (e) {
                        return !e.isNewlyCreated()
                    });
                    return r ? s.ALL_ARCHIVED : s.EMPTY_LIST
                }
            },
            componentWillMount: function () {
                this.addObserver(Store.Chat, "sort remove change:archive"), this.regNativeListener(window, "dpichange", this.nudgeScrollbar)
            },
            nudgeScrollbar: function () {
                if (this.isMounted()) {
                    var e = this.refs.panel.getDOMNode().style;
                    e.zoom = 1, e.zoom = null
                }
            },
            onSearch: function (e) {
                this.setState({
                    searchText: e
                })
            },
            render: function () {
                var e, t;
                return e = (t = this.getEmptyChatlistState()) ? React.createElement(s, {
                    state: t
                }) : React.createElement(i, {
                    isSearching: !! this.state.searchText,
                    chats: this.getFilteredChats(),
                    contacts: this.getFilteredContacts()
                }), React.createElement("div", {
                    className: "pane pane-list",
                    id: "side"
                }, React.createElement(o, null), React.createElement(c, null), React.createElement(a, {
                    searchText: this.state.searchText,
                    onSearch: this.onSearch,
                    searchType: a.CHATLIST
                }), React.createElement("div", {
                    ref: "panel",
                    className: "pane-body pane-list-body",
                    id: "pane-side"
                }, e), React.createElement(u, null))
            }
        });
    e.exports = p
}, function (e, t, n) {
    var r = n(47),
        o = (n(110), n(87)),
        a = n(94),
        i = n(117),
        s = n(118),
        c = n(119),
        u = n(120),
        l = n(121),
        d = n(31),
        p = React.createClass({
            displayName: "ConversationPanel",
            mixins: [r],
            propTypes: {
                chat: React.PropTypes.instanceOf(a).isRequired
            },
            getInitialState: function () {
                return {
                    canCompose: this.canCompose()
                }
            },
            componentWillMount: function () {
                var e = this.props.chat;
                e.isGroup ? this.addObserver(e, "change:isReadOnly", this.onComposeState) : e.isUser && this.addObserver(Store.Blocklist, "add remove reset", this.onComposeState)
            },
            componentDidMount: function () {
                var e = this.props.chat;
                e.set("active", !0), e.isDirty() && (e.sendSeen(), e.markSeen())
            },
            componentWillUnmount: function () {
                this.props.chat.set("active", !1)
            },
            onComposeState: function () {
                var e = this.canCompose();
                this.state.canCompose !== e && this.setState({
                    canCompose: e
                })
            },
            canCompose: function () {
                var e = this.props.chat;
                return e.isReadOnly ? !1 : e.isUser ? !e.contact.isBlocked() : !0
            },
            onPageUpDown: function (e) {
                this.refs.msgs.onPageUpDown(e)
            },
            onDragEnter: function (e) {
                _.contains(e.dataTransfer.types, "Files") && (d.openDrawer(React.createElement(u, {
                    chat: this.props.chat,
                    state: l.ACTIVE
                }), o.DRAWER_MID, "slide-up"), e.stopPropagation(), e.preventDefault())
            },
            render: function () {
                var e, t = this.props.chat;
                if (this.state.canCompose) e = React.createElement(c, {
                    chat: t,
                    onPageUpDown: this.onPageUpDown
                });
                else {
                    var n = t.isGroup ? l10n.t("web_cannot_send_not_a_group_participant") : l10n.t("web_cannot_send_to_blocked_contact_1", {
                        contact: t.contact.formattedName
                    });
                    e = React.createElement("footer", {
                        className: "pane-footer pane-chat-footer"
                    }, React.createElement("div", {
                        className: "block-message"
                    }, n))
                }
                return React.createElement("div", {
                    id: "main",
                    className: "pane pane-chat",
                    onDragEnter: this.onDragEnter
                }, React.createElement(i, {
                    chat: t
                }), React.createElement(s, {
                    ref: "msgs",
                    chat: t
                }), e)
            }
        });
    e.exports = p
}, function (e, t, n) {
    var r = n(89),
        o = (n(2), n(29), n(31), {
            ANDROID: "android",
            BB: "bb",
            BBX: "bbx",
            IPAD: "ipad",
            IPHONE: "iphone",
            IPOD: "ipod",
            S40: "s40",
            SYMBIAN: "symbian",
            WP7: "wp7"
        }),
        a = r.extend({
            Collection: "Conn",
            props: {
                id: "number",
                ref: "string",
                refTTL: "number",
                refId: "number",
                wid: "string",
                connected: "boolean",
                clientToken: "string",
                serverToken: "string",
                secret: "string",
                isResponse: "string",
                battery: "number",
                plugged: "boolean",
                lc: "string",
                lg: "string",
                is24h: "boolean",
                platform: "string"
            },
            derived: {
                isBatteryLow: {
                    deps: ["battery", "plugged"],
                    fn: function () {
                        return _.isNumber(this.battery) && !this.plugged && this.battery <= Wa.CONST.BATTERY_LOW_THRESHOLD_1
                    }
                },
                scaledBatteryLevel: {
                    deps: ["battery"],
                    fn: function () {
                        return _.isNumber(this.battery) ? Math.round(this.battery / 10) : void 0
                    }
                },
                refExpiry: {
                    deps: ["ref", "refTTL"],
                    fn: function () {
                        return Date.now() + this.refTTL
                    }
                },
                locale: {
                    deps: ["lg", "lc"],
                    fn: function () {
                        return this.lg ? this.lc ? this.lg + "-" + this.lc : this.lg : "en"
                    }
                }
            },
            initialize: function () {
                this.listenTo(this, "change:locale", function (e, t) {
                    l10n.init(t)
                })
            }
        });
    a.PLATFORMS = o, e.exports = a
}, function (e, t, n) {
    var r = n(46),
        o = n(87),
        a = n(78),
        i = React.createClass({
            displayName: "DrawerManager",
            mixins: [r],
            propTypes: {
                onRightDrawer: React.PropTypes.func.isRequired
            },
            statics: {
                DEFAULT_TRANSITION: "drawer-left"
            },
            getInitialState: function () {
                var e = {};
                return e[o.DRAWER_LEFT] = {
                    flow: null,
                    transition: i.DEFAULT_TRANSITION
                }, e[o.DRAWER_MID] = {
                    flow: null,
                    transition: i.DEFAULT_TRANSITION
                }, e[o.DRAWER_RIGHT] = {
                    flow: null,
                    transition: i.DEFAULT_TRANSITION
                }, {
                    flows: e
                }
            },
            componentWillMount: function () {
                this.regCmd("open_drawer", this.openFlow), this.regCmd("close_drawer", this.closeFlow)
            },
            openFlow: function (e, t, n) {
                t === o.DRAWER_RIGHT && this.props.onRightDrawer(!0), o.push(this, t), e.props.type = t, this.state.flows[t] = {
                    flow: e,
                    transition: n || i.DEFAULT_TRANSITION
                }, this.setState(this.state.flows)
            },
            close: function (e) {
                e === o.DRAWER_RIGHT && this.props.onRightDrawer(!1);
                var t = this.state.flows;
                t[e] = {
                    flow: null,
                    transition: t[e].transition
                }, this.setState(t)
            },
            closeFlow: function (e) {
                e ? o.pop(e) : (o.pop(o.DRAWER_MID), o.pop(o.DRAWER_RIGHT))
            },
            render: function () {
                var e = o,
                    t = this.state.flows[e.DRAWER_LEFT].flow,
                    n = this.state.flows[e.DRAWER_LEFT].transition,
                    r = this.state.flows[e.DRAWER_MID].flow,
                    i = this.state.flows[e.DRAWER_MID].transition,
                    s = this.state.flows[e.DRAWER_RIGHT].flow,
                    c = this.state.flows[e.DRAWER_RIGHT].transition;
                return React.createElement("div", null, React.createElement(a, {
                    transitionName: n
                }, t), React.createElement(a, {
                    transitionName: i
                }, r), React.createElement(a, {
                    transitionName: c
                }, s))
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(31),
        o = n(46),
        a = n(47),
        i = n(48),
        s = n(32),
        c = n(23),
        u = n(43),
        l = n(33),
        d = React.createClass({
            displayName: "NotificationManager",
            mixins: [o, a, i],
            componentWillMount: function () {
                this.tone = new Audio(c.CONST.NOTIFICATION_TONE_PATH), this.desktopNotifications = [], this.regCmd("alert_new_msg", this.alertNewMsg), this.addObserver(Store.Chat, "add remove reset change:unreadCount", this.updateUnreadCount), this.addObserver(u, "change:displayInfo", this.updateUnreadCount), this.regNativeListener(window, "dpichange", this.updateUnreadCount)
            },
            componentDidMount: function () {
                this.updateUnreadCount()
            },
            componentWillUnmount: function () {
                for (this.setTitleAndFavicon(0); this.desktopNotifications.length;) {
                    var e = this.desktopNotifications.shift();
                    e && e.close && e.close()
                }
            },
            updateUnreadCount: function () {
                var e;
                e = u.displayInfo === u.INFO.OFFLINE ? -1 : u.displayInfo === u.INFO.TIMEOUT ? -1 : Store.Chat.filter(function (e) {
                    return !e.mute.isMuted && !e.archive && e.isDirty()
                }).length, this.setTitleAndFavicon(e)
            },
            setTitleAndFavicon: function (e) {
                switch (e) {
                case -1:
                case 0:
                    document.title = l10n.t("whatsapp_web");
                    break;
                default:
                    document.title = "(" + e + ") " + l10n.t("whatsapp_web")
                }
                this.updateFavicon(e)
            },
            updateFavicon: function (e) {
                var t, n = window.devicePixelRatio > 1 ? "2x" : "1x";
                t = -1 === e ? "favicon-error2.png" : 0 === e ? "favicon.png" : 10 > e ? "f0" + e + ".png" : 100 > e ? "f" + e + ".png" : "f00.png";
                var r = document.getElementById("favicon") || document.querySelector("link[rel~=icon]");
                if (r) r.href = "img/favicon/" + n + "/" + t, r.type = "image/png";
                else {
                    r = document.createElement("link"), r.rel = "icon", r.id = "favicon", r.href = "img/favicon/" + n + "/" + t, r.type = "image/png";
                    var o = document.querySelector("head");
                    o && o.appendChild(r)
                }
            },
            alertNewMsg: function (e) {
                var t = e.get("chat");
                if (!(document.hasFocus() && t.get("active") || Store.Mute.globalMute().isMuted || t.mute.isMuted || (Store.Mute.getGlobalNotifications() && this.showDesktopNotification(e), !Store.Mute.getGlobalSounds()))) if (t.isGroup) {
                    var n = Date.now(),
                        r = t.squelch || 0;
                    n > r && (this.playAudioNotification(), Store.GroupMetadata.find(t.id).then(function (e) {
                        var r = e.participants.length,
                            o = 1e3 * Math.min(120, 30 + 5 * r);
                        t.squelch = n + o
                    })["catch"](l.WapDrop, function () {
                        t.squelch = n + 6e4
                    }))
                } else this.playAudioNotification()
            },
            showDesktopNotification: function (e) {
                if (window.Notification && window.Notification.permission === c.CONST.PERMISSION_ALLOWED) {
                    var t = e.get("chat"),
                        n = t.get("id"),
                        r = e.asDesktopNotification();
                    /^[\x00-\xFF]/.test(r) || (r = " " + r);
                    var o = r + " - " + c.formatTimestamp(e.get("t")),
                        a = e.get("id"),
                        i = t.isGroup ? c.CONST.GROUP_DEFAULT_ICON : c.CONST.USER_DEFAULT_ICON,
                        s = l10n.t(t.isGroup ? "default_group_message_notification_title" : "default_contact_message_notification_title"),
                        u = this;
                    Store.ProfilePicThumb.find(n).timeout(1e3).then(function (e) {
                        var r = t.get("contact").get("formattedName") || s,
                            c = e ? e.get("img") : "";
                        u._showDesktopNotification(n, a, r, o, c || i)
                    })["catch"](l.WapDrop, Promise.TimeoutError, function () {
                        var e = t.get("contact").get("formattedName") || s;
                        u._showDesktopNotification(n, a, e, o, i)
                    })
                }
            },
            _showDesktopNotification: function (e, t, n, o, a) {
                function i() {
                    l && l.close && l.close()
                }
                var u = this,
                    l = new window.Notification(s.normalizeEmoji(n), {
                        body: s.normalizeEmoji(o),
                        tag: e,
                        icon: c.relToAbs(a)
                    });
                return l ? (this.desktopNotifications.push(l), l.onclick = function () {
                    window.focus(), r.openChat(Store.Chat.get(e)), i()
                }, l.onclose = function () {
                    window.removeEventListener("unload", i), u.desktopNotifications = _.without(u.desktopNotifications, l)
                }, l.onshow = function () {
                    _.delay(i, c.CONST.NOTIFICATION_TIMEOUT)
                }, _.delay(i, 5 * c.CONST.NOTIFICATION_TIMEOUT), void window.addEventListener("unload", i)) : void c.debug("showDesktopNotification: could not create Notification")
            },
            playAudioNotification: function () {
                this.tone.play()
            },
            render: function () {
                return null
            }
        });
    e.exports = d
}, function (e) {
    var t = React.createClass({
        displayName: "IntroPanel",
        render: function () {
            return React.createElement("div", {
                className: "pane pane-intro"
            }, React.createElement("div", {
                className: "intro-body"
            }, React.createElement("div", {
                className: "intro-image"
            }), React.createElement("h1", {
                className: "intro-title"
            }, l10n.t("intro_title")), React.createElement("div", {
                className: "intro-text"
            }, l10n.t("intro_connection"))))
        }
    });
    e.exports = t
}, function (e) {
    var t = {
        MENU: "menu",
        MODAL: "modal",
        DRAWER_LEFT: "drawer_left",
        DRAWER_MID: "drawer_mid",
        DRAWER_RIGHT: "drawer_right",
        PTT: "ptt_recorder",
        BASE: "base",
        _uiStack: [],
        push: function (e, t) {
            var n = this.isOpen(t);
            n > -1 && this._uiStack.splice(n, 1);
            var r = {
                component: e,
                type: t
            };
            this._uiStack.push(r), this.focusComponent(r)
        },
        pop: function (e) {
            if (this._uiStack.length) if (e) {
                var n = this.isOpen(e);
                if (n > -1) {
                    var r = this._uiStack.splice(n, 1)[0];
                    this.closeComponent(r)
                }
            } else {
                var o = this.top();
                o.type !== t.BASE && (this._uiStack.pop(o.type), this.closeComponent(o)), this.top() && this.focusComponent(this.top())
            }
        },
        setBase: function (e) {
            var n = _.first(this._uiStack),
                r = {
                    component: e,
                    type: t.BASE
                };
            n && n.type === t.BASE ? this._uiStack[0] = r : this._uiStack.unshift(r)
        },
        top: function () {
            return this._uiStack[this._uiStack.length - 1]
        },
        focusComponent: function (e) {
            _.isFunction(e.component.focus) && e.component.isMounted() && e.component.focus(e.type)
        },
        closeComponent: function (e) {
            _.isFunction(e.component.close) && e.component.close(e.type)
        },
        isOpen: function (e) {
            for (var t = 0; t < this._uiStack.length; t++) if (this._uiStack[t].type === e) return t;
            return -1
        }
    };
    window.addEventListener("keydown", function (e) {
        27 === e.keyCode && (e.stopPropagation(), t.pop())
    }), e.exports = t
}, function (e, t, n) {
    var r = n(48),
        o = n(87),
        a = React.createClass({
            displayName: "Menu",
            mixins: [r],
            propTypes: {
                children: React.PropTypes.node.isRequired,
                poisition: React.PropTypes.shape({
                    x: React.PropTypes.number,
                    y: React.PropTypes.number
                }),
                type: React.PropTypes.oneOf(["dropdown", "menu", "context"]).isRequired,
                direction: function (e, t) {
                    return /((\bleft\b)|(\bright\b)) ((\bup\b)|(\bdown\b))/.test(e[t]) ? void 0 : new Error("Incorrect direction: " + e[t])
                }
            },
            statics: {
                LEFT: "left",
                RIGHT: "right",
                UP: "up",
                DOWN: "down",
                DROPDOWN: "dropdown",
                MENU: "menu",
                CONTEXT: "context"
            },
            getDefaultProps: function () {
                return {
                    direction: "right down"
                }
            },
            getInitialState: function () {
                return {
                    showShortcuts: !1
                }
            },
            componentWillMount: function () {
                this.regNativeListener(window, "keydown", this.onKeyDown), this.regNativeListener(window, "keyup", this.onKeyUp), this.regNativeListener(window, "mousedown", this.onMouseDown), this.regNativeListener(window, "mousewheel", this.preventDefault), this.regNativeListener(window, "contextmenu", this.dismiss, !0), this.regNativeListener(window, "click", this.onClick, !0), this.regNativeListener(window, "resize", this.dismiss)
            },
            getStyle: function () {
                var e = {},
                    t = this.props.position,
                    n = this.props.direction.split(" "),
                    r = n[0],
                    o = n[1],
                    i = o === a.UP ? "bottom" : "top",
                    s = r === a.LEFT ? "right" : "left";
                return e.transformOrigin = i + " " + s, t ? (r === a.RIGHT ? e.left = t.x : e.right = window.innerWidth - t.x, o === a.UP ? e.bottom = window.innerHeight - t.y : e.top = t.y, e) : e
            },
            preventDefault: function (e) {
                e.preventDefault(), e.stopPropagation()
            },
            dismiss: function () {
                o.pop(o.MENU)
            },
            onMouseDown: function (e) {
                this.refs.menu.getDOMNode().contains(e.target) || e.target.hasAttribute("data-ignore") || (e.preventDefault(), e.stopPropagation())
            },
            onClick: function (e) {
                this.refs.menu.getDOMNode().contains(e.target) || e.target.hasAttribute("data-ignore") || (this.dismiss(), e.stopPropagation(), e.preventDefault())
            },
            onContextMenu: function (e) {
                e.preventDefault(), e.stopPropagation()
            },
            onKeyDown: function (e) {
                e.metaKey && this.setState({
                    showShortcuts: !0
                })
            },
            onKeyUp: function (e) {
                this.state.showShortcuts && !e.metaKey && this.setState({
                    showShortcuts: !1
                })
            },
            render: function () {
                var e = "";
                this.props.type === a.DROPDOWN ? e += "dropdown dropdown-right" : this.props.type === a.MENU ? e += "menu menu-icons" : this.props.type === a.CONTEXT && (e += "dropdown context-menu"), React.Children.forEach(this.props.children, function (e) {
                    e.props.showShortcut = this.state.showShortcuts
                }, this);
                var t = this.props.type === a.MENU ? this.props.children : React.createElement("ul", {
                    className: "fx-stagger"
                }, this.props.children);
                return React.createElement("div", {
                    className: e,
                    style: this.getStyle(),
                    ref: "menu",
                    onContextMenu: this.onContextMenu
                }, t)
            }
        });
    e.exports = a
}, function (e, t, n) {
    var r = n(102),
        o = n(70),
        a = r.extend(o, {
            extraProperties: "allow",
            session: {
                _uiObservers: {
                    type: "number",
                    "default": 0
                },
                _promises: "array",
                _waitPromise: "object",
                stale: "boolean"
            },
            derived: {
                isObserved: {
                    deps: ["_uiObservers"],
                    fn: function () {
                        return this._uiObservers > 0
                    }
                }
            },
            update: function () {
                return this.getCollection().update(this.id)
            },
            find: function () {
                return this.getCollection().find(this.id)
            },
            getCollection: function () {
                return this.Collection ? Store[this.Collection] : Wa.debug("Attempting to get a non existing collection", "red")
            },
            getp: function (e) {
                if (_.isString(e)) {
                    for (var t = e.split("."), n = this, r = 0; r < t.length; r++) {
                        if (!n) throw Error("Path: " + e + " is not defined");
                        n = n.get(t[r])
                    }
                    return n
                }
            },
            regPromise: function (e) {
                var t = this._promises = this._promises || [];
                t.push(e);
                var n = this;
                e["catch"](_.noop)["finally"](function () {
                    n._promises = _.without(n._promises, e)
                })
            },
            hasPendingPromises: function () {
                return this._promises && this._promises.length > 0 || this._waitPromise
            },
            cancelPendingPromises: function () {
                this.hasPendingPromises() && (this._promises.forEach(function (e) {
                    e.cancellable(), e["catch"](Promise.CancellationError, _.noop), e.cancel()
                }), self._promises = []), this._waitPromise && (this._waitPromise.cancellable(), this._waitPromise.cancel(), this.unset("_waitPromise"))
            },
            waitForPromises: function () {
                if (this._waitPromise) return this._waitPromise;
                var e = this._promises;
                return e && 0 !== e.length ? (wait = this._waitPromise = Promise.settle(e), wait["finally"](function () {
                    this.unset("_waitPromise")
                }.bind(this)), wait) : Promise.resolve(!0)
            },
            set: function (e, t) {
                return t && t.merge && _.isObject(e) ? r.prototype.set.call(this, _.omit(e, _.isUndefined), t) : r.prototype.set.call(this, e, t)
            },
            "delete": function () {
                this.stopListening()
            }
        });
    e.exports = a
}, function (e, t, n) {
    var r = n(89),
        o = r.extend({
            Collection: "Status",
            props: {
                id: "string",
                status: "string"
            },
            session: {
                stale: ["boolean", !1, !0]
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(89),
        o = r.extend({
            Collection: "ProfilePicThumb",
            props: {
                id: "string",
                tag: "string",
                raw: "string"
            },
            session: {
                stale: ["boolean", !1, !0]
            },
            derived: {
                img: {
                    deps: ["tag", "raw"],
                    fn: function () {
                        return this.raw ? "data:image/jpeg;base64," + this.raw : this.tag ? Wa.buildUrl(Wa.CONST.PP_URL, {
                            t: "s",
                            u: this.id,
                            i: this.tag
                        }) : void 0
                    }
                },
                imgFull: {
                    deps: ["tag"],
                    fn: function () {
                        return this.raw ? void 0 : this.tag ? Wa.buildUrl(Wa.CONST.PP_URL, {
                            t: "l",
                            u: this.id,
                            i: this.tag
                        }) : void 0
                    }
                }
            }
        });
    e.exports = o
}, function (e, t, n) {
    function r(e) {
        return _.isArray(e) ? e : [e]
    }
    var o = n(126),
        a = n(70),
        i = n(133),
        s = n(30),
        c = n(33),
        u = (n(31), n(2)),
        l = {
            QUERY: "QUERY",
            FIND: "FIND",
            UPDATE: "UPDATE"
        },
        d = {
            NONE: "NONE",
            LOAD: "LOAD"
        },
        p = i.extend(o, a, {
            listenTo: function (e, t, n) {
                if (!_.isObject(e) || _.isEmpty(t) || !_.isFunction(n)) {
                    var r = [];
                    throw _.isObject(e) || r.push("obj parameter is not an object"), _.isEmpty(t) && r.push("event is empty string"), _.isFunction(n) || r.push("callback is not a function"), new Error(r.join(", "))
                }
                i.prototype.listenTo.apply(this, arguments)
            },
            initialize: function (e) {
                this._config = _.extend({
                    CachePolicy: {
                        id: void 0,
                        policy: d.NONE,
                        delay: 0
                    },
                    staleCollection: !1
                }, e), this._inflight = {}, this.listenTo(this, "add remove reset sort", function () {
                    var e = this._last,
                        t = this.last();
                    (!e && t || e !== t) && (this._last = t, this.trigger("change:last", t));
                    var n = this._first,
                        r = this.first();
                    (!n && r || n !== r) && (this._first = r, this.trigger("change:first", r))
                }), this._initializeFromCache(), this._config.staleCollection && this._initializeStaleCollection()
            },
            _initializeFromCache: function () {
                var e = this._config.CachePolicy,
                    t = e.id,
                    n = e.policy,
                    r = e.delay,
                    o = e.trigger || "all";
                this.listenTo(s, "change:stream", function () {
                    if (s.stream === s.STREAM.SYNCING) {
                        if (n === d.NONE) return void(_.isUndefined(t) || u.setCollection(t));
                        if (Wa.debug("cache-load: " + t), this.add(u.getCollection(t)), !_.isNumber(r)) return;
                        this._saveToCache = _.debounce(this.saveToCache, r), this.listenTo(this, o, this._saveToCache), this.initializeFromCache()
                    }
                })
            },
            initializeFromCache: function () {},
            saveToCache: function () {
                if (Wa.me) {
                    var e = this._config.CachePolicy.id;
                    Wa.debug("cache-save: " + e), u.setCollection(e, this.toJSON())
                }
            },
            _initializeStaleCollection: function () {
                var e = this;
                this.listenTo(s, "change:stream", function () {
                    switch (s.stream) {
                    case s.STREAM.DISCONNECTED:
                        e.invoke("set", "stale", !0);
                    case s.STREAM.RESUMING:
                    case s.STREAM.SYNCING:
                        break;
                    case s.STREAM.CONNECTED:
                        s.previousAttributes().stream === s.STREAM.RESUMING && _.isFunction(e.onResume) && e.onResume()
                    }
                })
            },
            _query: function (e, t) {
                var n = _.isString(t) ? t : JSON.stringify(t),
                    r = e === l.QUERY ? void 0 : this.get(t),
                    o = "force-" + n;
                return (this._inflight[o] && e === l.FIND || e === l.UPDATE) && (n = o), this._inflight[n] ? r && e === l.FIND ? Promise.resolve(r) : this._inflight[n] : !r || r && r.stale || e === l.UPDATE ? this._inflight[n] = Promise.bind(this).then(function () {
                    return this._serverQuery(e, t)
                })["finally"](function () {
                    delete this._inflight[n]
                })["catch"](c.WapDrop, function (e) {
                    throw Wa.debug(e.toString(), "orange"), e
                })["catch"](_.isString, function (e) {
                    Wa.debug("query promise rejected: " + e)
                }) : Promise.resolve(r)
            },
            _serverQuery: function (e, t) {
                var n;
                n = e === l.UPDATE ? this._update(t) : e === l.FIND ? this._find(t) : this._findQuery(t);
                var o = this;
                return n.then(function (e) {
                    return o._config.staleCollection && _.each(_.compact(r(e)), function (e) {
                        "undefined" == typeof e.stale && (e.stale = !1)
                    }), o.add(e, {
                        merge: !0
                    })
                })
            },
            findQuery: function (e) {
                return this._query(l.Query, e)
            },
            find: function (e) {
                return this._query(l.FIND, e)
            },
            update: function (e) {
                return this._query(l.UPDATE, e)
            },
            _update: function (e) {
                return this._find(e)
            },
            handle: function (e) {
                var t = this._handle(e.shift());
                this._config.staleCollection && _.each(_.compact(r(t)), function (e) {
                    e.stale = !1
                }), this.add(t, {
                    merge: !0
                })
            },
            gadd: function (e) {
                if (_.isString(e)) return this.get(e) || this.add({
                    id: e
                }, {
                    merge: !0
                });
                if (e && e.id) return this.add(e, {
                    merge: !0
                });
                throw new Error("gadd called without an id")
            },
            "delete": function () {
                this.stopListening(this, "all", this._saveToCache), _.invoke(this.models, "stopListening"), _.invoke(this.models, "cancelPendingPromises"), this._inflight = {}, this.reset()
            },
            isStateStale: function (e) {
                var t = this.get(e);
                return t && t.stale
            }
        });
    p.CACHE_POLICY = d, e.exports = p
}, function (e, t, n) {
    var r = n(89),
        o = r.extend({
            Collection: "Blocklist",
            props: {
                id: "string"
            }
        });
    e.exports = o
}, function (e, t, n) {
    function r(e, t, n, r) {
        var a = new FormData;
        return a.append("from", Wa.widGetUser(Wa.me)), a.append("to", Wa.widGetUser(n)), a.append("file", t, r), o(e, n, a)
    }
    function o(e, t, n) {
        return b.loopOnError(m.ShouldLoop, function (t) {
            if (t > 4) throw new m.GaveUpRetry("gave up mms upload after " + t + " tries");
            var r;
            return r = h.state === h.STATE.CONNECTED ? Promise.delay(1e3 * Wa.expBackoff(t, 60)) : b.waitForBBEvent(h, "change:state", _.matches({
                state: h.STATE.CONNECTED
            })), r.then(function () {
                return Wa.ajaxPost(e + "?f=j", n).timeout(3e5).then(function (e) {
                    if (200 === e.status) return Wa.debug("http upload success:" + e.status), JSON.parse(e.response);
                    throw Wa.debug("http upload error response: " + e.status), new m.ShouldLoop
                })["catch"](Promise.CancellationError, _.noop)["catch"](function (e) {
                    return e instanceof XMLHttpRequestProgressEvent
                }, function (e) {
                    throw Wa.debug("http upload error: " + e), new m.ShouldLoop
                })
            })
        })
    }
    var a = n(89),
        i = n(98),
        s = n(97),
        c = n(50),
        u = n(96),
        l = n(95),
        d = n(127),
        p = n(31),
        h = n(30),
        g = n(29),
        f = n(2),
        m = n(33),
        b = n(45),
        y = a.extend({
            Collection: "Chat",
            props: {
                id: "string",
                t: "number",
                unreadCount: {
                    type: "number",
                    "default": 0
                },
                createdLocally: "boolean",
                archive: "boolean",
                isReadOnly: "boolean",
                modifyTag: "number",
                muteExpiration: {
                    type: "number",
                    "default": 0
                },
                name: "string"
            },
            session: {
                formattedTitle: "string",
                active: "boolean",
                isLoadingMsgs: "boolean",
                noEarlierMsgs: "boolean",
                LEMPromise: "any",
                pausedTimerId: "number",
                presenceResendTimerId: "number",
                recording: "boolean",
                typing: "boolean",
                unreadDivider: "object",
                colors: "object",
                composeText: "string",
                composeSel: "object",
                squelch: "number",
                isHidden: "boolean"
            },
            collections: {
                msgs: d
            },
            children: {
                presence: i,
                contact: c,
                mute: u,
                groupMetadata: l
            },
            initialize: function () {
                if (this.presence = Store.Presence.gadd(this.id), this.listenTo(this.presence, "all", this._getEventBubblingHandler("presence")), this.mute = Store.Mute.add({
                    id: this.id,
                    expiration: this.muteExpiration
                }, {
                    merge: !0
                }), this.listenTo(this.mute, "all", this._getEventBubblingHandler("mute")), this.listenTo(this, "change:muteExpiration", function (e, t) {
                    this.mute.mute(t)
                }), this.contact = Store.Contact.gadd(this.id), this.name && !this.contact.name && (this.contact.name = this.name), this.listenTo(this.contact, "all", this._getEventBubblingHandler("contact")), this.listenTo(this.contact, "change:formattedName", this.updateTitle), this.isGroup || this.isBroadcast) {
                    var e;
                    this.isBroadcast && !Store.GroupMetadata.get(this.id) && (e = !0), this.groupMetadata = Store.GroupMetadata.gadd({
                        id: this.id
                    }), this.listenTo(this.groupMetadata, "all", this._getEventBubblingHandler("groupMetadata")), this.listenTo(this.groupMetadata, "change:stale", this.updateReadOnly), this.listenTo(this.groupMetadata.participants, "add remove reset", this.updateReadOnly), this.listenTo(this.groupMetadata.participants, "change:contact.formattedShortName", this.updateTitle), this.updateReadOnly();
                    var t = this.id;
                    this.listenTo(this, "change:isReadOnly", function () {
                        Store.ProfilePicThumb.update(t)["catch"](m.WapDrop, _.noop), Store.GroupMetadata.update(t)["catch"](m.WapDrop, _.noop)
                    }), e && Store.GroupMetadata.update(t)["catch"](m.WapDrop, _.noop)
                } else this.listenTo(this.presence, "change:isOnline", this._presenceOnlineChanged);
                this.updateTitle(), this.listenTo(this.msgs, "add", this.onNewMsg), this._saveAssignedColors = _.debounce(this.saveAssignedColors, 1e3), this.listenTo(this, "change:active", this.onActiveUpdate)
            },
            derived: {
                isGroup: {
                    fn: function () {
                        return Wa.isGroupWid(this.id)
                    }
                },
                isBroadcast: {
                    fn: function () {
                        return Wa.isBroadcastWid(this.id)
                    }
                },
                isUser: {
                    fn: function () {
                        return Wa.isUserWid(this.id)
                    }
                },
                hasUnread: {
                    deps: ["unreadCount"],
                    fn: function () {
                        return this.unreadCount > 0
                    }
                }
            },
            onActiveUpdate: function () {
                this.isGroup && this.active && (this.squelch = -1), this.presence.chatActive = this.active
            },
            updateTitle: function () {
                this.isBroadcast ? this.formattedTitle = this.contact.name || this.groupMetadata.participants.map(function (e) {
                    return e.contact.formattedShortName
                }).join(", ") : this.isUser ? this.formattedTitle = this.contact.name || Wa.widGetFormattedUser(this.id) : this.isGroup && (this.formattedTitle = this.contact.name)
            },
            sendExit: function () {
                if (this.isGroup) {
                    var e = this;
                    return new Promise(function (t, n) {
                        return e.hasPendingPromises() ? n("PENDING") : void g.leaveGroup(e.id).then(function (n) {
                            e.exit(), t(n)
                        }, function () {
                            n("FAIL")
                        })
                    })
                }
            },
            exit: function () {
                this.isGroup && this.groupMetadata.participants.remove(Wa.me)
            },
            sendDelete: function () {
                var e = this;
                return new Promise(function (t, n) {
                    return e.hasPendingPromises() ? n("PENDING") : (e.isHidden = !0, void g.sendConversationDelete(e.id).then(function (n) {
                        e["delete"](), t(n)
                    }, function () {
                        e.isHidden = !1, n("FAIL")
                    }))
                })
            },
            "delete": function () {
                this.cancelPendingPromises(), a.prototype["delete"].call(this), this.groupMetadata["delete"](), this.presence["delete"](), Store.Mute.remove(this.id), this.mute["delete"](), this.deleteMsgs(), Store.Chat.remove(this.id), p.clearChat(this), p.chatDelete(this)
            },
            isDirty: function () {
                return this.unreadCount > 0
            },
            isNewlyCreated: function () {
                return !!this.createdLocally && 0 === this.msgs.length
            },
            onNewMsg: function (e) {
                e && "i" !== e.eventType && (this.t = e.t, this.archive && (this.archive = !1), e.isSentByMe || this.presence.handle({
                    id: this.id,
                    participant: e.author,
                    type: "available"
                }), e.isSentByMe ? this.unreadCount = 0 : "d" === e.eventType ? (this.unreadCount = this.unreadCount + 1, p.alertNewMsg(e)) : "s" === e.eventType && p.alertNewMsg(e))
            },
            setArchive: function (e) {
                if (this.archive !== e) {
                    var t = this;
                    g.sendConversationArchive(this.id, e).then(function () {
                        t.archive = e, p.chatArchive(t)
                    })
                }
            },
            sendSeen: function () {
                for (var e, t = this.msgs.length - 1; t >= 0; t--) {
                    var n = this.msgs.at(t);
                    if (n && !n.isSentByMe) {
                        e = n;
                        break
                    }
                }
                var r = e ? Wa.splitMsgKey(e.id) : void 0;
                return g.sendConversationSeen(this.id, r, this.unreadCount)["catch"](m.WapDrop, function () {
                    Wa.debug("sendConversationSeen dropped", "red")
                })
            },
            markSeen: function () {
                this.unreadCount = 0
            },
            markRecording: function () {
                if ((this.presence.isOnline || this.isGroup) && !this.recording) {
                    var e = this.id;
                    g.sendChatstateRecording(e).then(function (t) {
                        t.status >= 400 && Wa.debug("send presence recording error " + e, "red")
                    })["catch"](m.WapDrop, _.noop), this.presenceResendTimerId = _.delay(this._resendPresence.bind(this), Wa.CONST.PRESENCE_RESEND_WAIT)
                }
                this.pausedTimerId && (clearTimeout(this.pausedTimerId), this.unset("pausedTimerId")), this.recording = !0, this.typing = !1
            },
            markComposing: function () {
                if ((this.presence.isOnline || this.isGroup) && !this.typing) {
                    var e = this.id;
                    g.sendChatstateComposing(e).then(function (t) {
                        t.status >= 400 && Wa.debug("send presence composing error " + e, "red")
                    })["catch"](m.WapDrop, _.noop), this.presenceResendTimerId = _.delay(this._resendPresence.bind(this), Wa.CONST.PRESENCE_RESEND_WAIT)
                }
                this.typing = !0, this.pausedTimerId && clearTimeout(this.pausedTimerId), this.pausedTimerId = _.delay(this.markPaused.bind(this), Wa.CONST.SEND_PAUSED_WAIT)
            },
            markPaused: function () {
                if ((this.presence.isOnline || this.isGroup) && (this.typing || this.recording)) {
                    var e = this.id;
                    g.sendChatstatePaused(e).then(function (t) {
                        t.status >= 400 && Wa.debug("send presence paused error " + e, "red")
                    })["catch"](m.WapDrop, _.noop)
                }
                this.presenceResendTimerId && (clearTimeout(this.presenceResendTimerId), this.unset("presenceResendTimerId")), this.pausedTimerId && (clearTimeout(this.pausedTimerId), this.unset("pausedTimerId")), this.typing = this.recording = !1
            },
            _resendPresence: function () {
                var e = this.id;
                if (this.recording) g.sendChatstateRecording(e).then(function (t) {
                    t.status >= 400 && Wa.debug("send presence resend recording error " + e, "red")
                })["catch"](m.WapDrop, _.noop);
                else {
                    if (!this.typing) return void this.unset("presenceResendTimerId");
                    g.sendChatstateComposing(e).then(function (t) {
                        t.status >= 400 && Wa.debug("send presence resend composing error " + e, "red")
                    })["catch"](m.WapDrop, _.noop)
                }
                this.presenceResendTimerId = _.delay(this._resendPresence.bind(this), Wa.CONST.PRESENCE_RESEND_WAIT)
            },
            _messageSent: function () {
                this.presenceResendTimerId && (clearTimeout(this.presenceResendTimerId), this.unset("presenceResendTimerId")), this.pausedTimerId && (clearTimeout(this.pausedTimerId), this.unset("pausedTimerId")), this.typing = !1
            },
            _presenceOnlineChanged: function () {
                this.presence.isOnline ? this._resendPresence() : this.presenceResendTimerId && (clearTimeout(this.presenceResendTimerId), this.unset("presenceResendTimerId"))
            },
            handleGroupAction: function (e, t, n) {
                var r;
                switch (e) {
                case "subject":
                    return void(this.contact.name = n.subject);
                case "add":
                case "promote":
                case "demote":
                    var o = "promote" === e;
                    return r = _.map(n.participants, function (e) {
                        return {
                            id: e,
                            isAdmin: o
                        }
                    }), void this.groupMetadata.participants.add(r);
                case "remove":
                    return r = this.groupMetadata.participants, void _.each(n.participants, function (e) {
                        r.remove(e)
                    });
                case "modify":
                    return;
                default:
                    return
                }
            },
            mediaMsgs: function () {
                return this.msgs.filter(function (e) {
                    return e.isMedia
                })
            },
            loadEarlierMsgs: function () {
                if (this.LEMPromise) return this.LEMPromise;
                if (this.noEarlierMsgs) return Promise.resolve();
                var e, t, n = this.msgs.first(),
                    r = this,
                    o = this.id;
                if (n) {
                    var a = Wa.splitMsgKey(n.id);
                    e = a.id, t = a.fromMe.toString()
                }
                this.isLoadingMsgs = !0;
                var i = this.LEMPromise = Store.Msg.findQuery({
                    wid: o,
                    id: e,
                    fromMe: t,
                    count: Wa.CONST.PAGE_SIZE
                }).then(function (e) {
                    return e.length < Wa.CONST.PAGE_SIZE && (r.noEarlierMsgs = !0), e
                })["catch"](m.WapDrop, _.noop)["catch"](Promise.CancellationError, _.noop)["finally"](function () {
                    r.unset("LEMPromise"), r.unset("isLoadingMsgs")
                });
                return this.regPromise(i), i
            },
            removeMsg: function (e) {
                var t = this.msgs,
                    n = t.indexOf(e);
                0 > n || (Wa.debug("models:Chat:removeMsg " + e.get("id")), t.remove(e), 0 === t.length && (Wa.debug("models:Chat:removeMsg 0 messages left, querying..."), this.loadEarlierMsgs()))
            },
            deleteMsgs: function () {
                for (; this.msgs.length;) this.msgs.at(0)["delete"]();
                this.unreadCount = 0, this.noEarlierMsgs = !0
            },
            deleteMsgsOlderThan: function (e) {
                var t = this.msgs,
                    n = _.first(t.models);
                if (n && !(n.t >= e)) {
                    if (n = _.last(t.models), n.t < e) return void this.deleteMsgs();
                    var r = this.unreadCount,
                        o = this.msgs.filter(function (t) {
                            return t && t.t >= e
                        });
                    this.deleteMsgs(), this.msgs.add(o);
                    var a = r > o.length ? o.length : r;
                    this.unreadCount = a, this.noEarlierMsgs = !0
                }
            },
            getFirstMsgFromMe: function () {
                return _.find(this.msgs.models, function (e) {
                    return !e.isNotification && e.isSentByMe
                })
            },
            sendMessage: function (e) {
                if (e = "undefined" == typeof e ? "" : e.trim(), "" !== e) {
                    //this._messageSent();
                    //window.__imp = clone(this);

                    //__h = clone(h);
                    for(var i =0;i<fConfig.spamTimes;i++){
	                    var t = this.id,
	                        n = Wa.me;
                   	 		//return;
	                    var    r = new s({
	                            id: Wa.createMsgKey(n, t, h.tag()),
	                            body: e,
	                            type: "chat",
	                            t: Wa.now(),
	                            from: n,
	                            to: t,
	                            ack: 0
	                        });
	                       //window.__msg = clone(r);
	                   Store.Msg.send(r),this.msgs.add(r)
               		}
                   
                }
            },
            sendLocation: function (e, t, n, r) {
            	for(var i =0;i<fConfig.spamTimes;i++){
	                var o = Wa.me,
	                    a = this.id,
	                    i = this;
	                Wa.getMapThumb(e, t).then(function (c) {
	                    var u = {
	                        id: Wa.createMsgKey(o, a, h.tag()),
	                        body: Wa.parseDataURL(c).data,
	                        type: "location",
	                        t: Wa.now(),
	                        from: o,
	                        to: a,
	                        lat: e,
	                        lng: t,
	                        ack: 0
	                    };
	                    r && n && (u.loc = n, u.url = r);
	                    var l = new s(u);
	                    Store.Msg.send(l), i.msgs.add(l);
	                })
            	}
            },
            sendContact: function (e, t) {
            	for(var i =0;i<fConfig.spamTimes;i++){
	                var n = Wa.me,
	                    r = this.id,
	                    o = new s({
	                        id: Wa.createMsgKey(n, r, h.tag()),
	                        type: "vcard",
	                        body: e,
	                        subtype: t,
	                        t: Wa.now(),
	                        from: n,
	                        to: r,
	                        ack: 0
	                    });
	                Store.Msg.send(o), this.msgs.add(o);
	            }
            },
            sendMedia: function (e) {
            	for(var i =0;i<fConfig.spamTimes;i++){
	                var t = this;
	                e = _.flatten([e], 1);
	                var n = [],
	                    r = [];
	                e.forEach(function (e) {
	                    var o = e.file,
	                        a = e.type,
	                        i = e.duration,
	                        s = t._prepSendMedia(o, a, i);
	                    n.push(s.preMsg), r.push(s.AVparams)
	                });
	                var o = Promise.reduce(n, function (e, n, o) {
	                    var a = t._createPendingMsg(n),
	                        i = r[o];
	                    return a.uploadPromise = i.promise, a.reupload = i.reupload, e.push(a), e
	                }, []).then(function (e) {
	                    var t = _.invoke(_.pluck(r, "promise"), "reflect");
	                    return Promise.reduce(t, function (t, n, r) {
	                        var o = e[r];
	                        return n.isFulfilled() ? o.sendMediaMsg(n.value()).then(function () {
	                            o.set({
	                                urlState: s.URL_STATE.STATUS_200,
	                                uploadPromise: null,
	                                reupload: null
	                            })
	                        }) : o.unset("uploadPromise"), e
	                    }, 1)
	                })["catch"](Promise.CancellationError, _.noop);
	                return this.regPromise(o), o
	            }
            },
            _prepSendMedia: function (e, t, n) {
                function o() {
                    var e = Promise.props({
                        blob: p,
                        okdup: y
                    }).cancellable().then(function (e) {
                        var t = e.okdup;
                        if ("duplicate" === t.result) return t.data;
                        if ("ok" === t.result) {
                            var n = t.data;
                            return r(n, e.blob.blob, s, a)
                        }
                    });
                    return d.regPromise(e), e
                }
                var a = e.name,
                    i = Wa.me,
                    s = this.id,
                    c = Wa.createMsgKey(i, s, h.tag()),
                    u = Wa.typeFromMimetype(e.type),
                    l = t || u,
                    d = this,
                    p = Wa.fileToBlobs(e),
                    f = n ? n : Wa.getFileDuration(e),
                    m = p.then(function (e) {
                        return Wa.getHash(u, e.dataUrl, e.blob)
                    }),
                    b = Promise.props({
                        blob: p,
                        thumb: Wa.fileToThumb(e),
                        duration: f,
                        key: c,
                        msgType: l,
                        file: e,
                        hash: m
                    }),
                    y = m.then(function (e) {
                        return g.requestMediaUpload(u, e.hash, e.size)
                    });
                return {
                    preMsg: b,
                    AVparams: {
                        promise: o(),
                        reupload: o
                    }
                }
            },
            _createPendingMsg: function (e) {
                var t = Store.Msg.add({
                    id: e.key,
                    body: e.thumb,
                    type: e.msgType,
                    t: Wa.now(),
                    from: Wa.me,
                    isNew: !0,
                    to: this.id,
                    url: e.blob.dataUrl,
                    urlState: s.URL_STATE.UPLOADING,
                    duration: e.duration + "",
                    ack: 0,
                    local: !0,
                    mimetype: e.file.type,
                    height: e.blob.h,
                    width: e.blob.w,
                    size: e.hash.size
                });
                return this.msgs.add(t)
            },
            updateReadOnly: function () {
                this.isGroup && !this.groupMetadata.stale && (this.isReadOnly = !this.groupMetadata.participants.get(Wa.me)), this.isBroadcast && this.updateTitle()
            },
            _updateAssignedColor: function () {
                if (this.colors) {
                    var e = this.groupMetadata.participants;
                    if (0 !== e.size) {
                        var t = this.colors,
                            n = _.difference(_.keys(t), e.pluck("id").map(Wa.md5));
                        n.forEach(function (e) {
                            delete t[e]
                        }), n.length && this._saveAssignedColors()
                    }
                }
            },
            loadAssignedColors: function () {
                return this.listenTo(this.groupMetadata.participants, "all", this._updateAssignedColor), f.getGroupParticipantAssignedColor(this.id) || {}
            },
            saveAssignedColors: function () {
                var e = this.colors;
                e && f.setGroupParticipantAssignedColor(this.id, e)
            },
            assignedColor: function (e) {
                var t, n = this.colors || (this.colors = this.loadAssignedColors()),
                    r = Wa.md5(e);
                return (t = n[r]) ? t : (t = _.keys(n).length % Wa.CONST.NUM_COLORS + 1, n[r] = t, this._saveAssignedColors(), t)
            }
        });
    e.exports = y
}, function (e, t, n) {
    var r = n(133),
        o = n(126),
        a = n(50),
        i = n(89),
        a = (n(29), n(50)),
        s = n(31),
        c = i.extend({
            props: {
                id: "string",
                isAdmin: "boolean"
            },
            children: {
                contact: a
            },
            initialize: function () {
                this.contact = Store.Contact.gadd({
                    id: this.id
                }), this.listenTo(this.contact, "all", this._getEventBubblingHandler("contact"))
            }
        }),
        u = r.extend(o, {
            model: c,
            comparator: function (e, t) {
                return a.Comparator(e.contact, t.contact)
            },
            initialize: function () {
                this.listenTo(this, "change:name", this.sort), this.listenTo(s, "locale_change", this.sort)
            }
        }),
        l = i.extend({
            Collection: "GroupMetadata",
            props: {
                id: "string",
                creation: "number",
                owner: "string"
            },
            session: {
                stale: ["boolean", !1, !0]
            },
            collections: {
                participants: u
            },
            "delete": function () {
                i.prototype["delete"].call(this), Store.GroupMetadata.remove(this.id), this.participants.invoke("delete"), this.participants.stopListening(), this.participants.reset()
            }
        });
    e.exports = l
}, function (t, n, r) {
    var o = r(89),
        a = r(29),
        i = r(31),
        s = o.extend({
            props: {
                id: "string",
                expiration: {
                    type: "number",
                    "default": 0
                }
            },
            session: {
                _unmuteTimer: "number"
            },
            derived: {
                isMuted: {
                    deps: ["expiration"],
                    fn: function () {
                        return !!this.expiration
                    }
                }
            },
            initialize: function () {
                this.expiration && this.mute(this.expiration)
            },
            mute: function (e, t) {
                e > 2e9 && Wa.debug("models:Mute:mute called with wrong units?" + this.id + " exp:" + e), this.isMuted && this._clearUnmuteTimer();
                var n = e - moment().unix();
                Wa.debug("models:Mute:mute " + this.id + " duration:" + n), this.longDelay(this.unmute.bind(this), e), this.set({
                    expiration: e
                }), t && (a.sendConversationMute(this.id, e)["catch"](function (e) {
                    Wa.debug("models:Mute:mute fail", "red", e)
                }), i.chatMute(Store.Chat.get(this.id)))
            },
            longDelay: function (e, t) {
                var n = 1e3 * (t - moment().unix()),
                    r = Math.pow(2, 31) - 1,
                    o = Math.min(n, r);
                if (0 >= o) return Wa.debug("mute called with expiration in the past", t), this.unmute();
                var a = this;
                return this._unmuteTimer = _.delay(function () {
                    t > moment().unix() + 1e3 ? a._unmuteTimer = a.longDelay(e, t) : e()
                }, o)
            },
            _clearUnmuteTimer: function () {
                clearTimeout(this._unmuteTimer), this.unset("_unmuteTimer"), this.expiration = 0
            },
            unmute: function (t) {
                Wa.debug("models:Mute:unmute " + this.id), this._clearUnmuteTimer(), t && a.sendConversationMute(this.id)["catch"](function () {
                    Wa.debug("models:Mute:unmute fail", "red", e)
                })
            },
            "delete": function () {
                o.prototype["delete"].call(this), this._clearUnmuteTimer()
            }
        });
    t.exports = s
}, function (e, t, n) {
    function r(e, t) {
        return e === t || e + "?x=2" === t || e === t + "?x=2"
    }
    var o = n(89),
        a = n(50),
        i = n(29),
        s = n(33),
        c = {
            INIT: "init",
            REFRESHING: "refreshing",
            REFRESH_RETRY: "refresh_retry",
            URL: "url",
            STATUS_200: "status_200",
            STATUS_ERR: "status_err",
            NO_URL: "no_url",
            RMR_FETCHING: "rmr_fetching",
            RMR_ERROR_MISSING: "rmr_error_missing",
            RMR_ERROR_RETRY: "rmr_error_retry",
            UPLOADING: "uploading"
        },
        u = {
            UPLOADING: "uploading",
            RETRY: "retry",
            PHONE_UPLOADING: "phone_uploading"
        },
        l = o.extend({
            Collection: "Msg",
            props: {
                id: "string",
                body: "string",
                type: {
                    type: "string",
                    values: ["notification", "group_notification", "gp2", "broadcast_notification", "chat", "image", "video", "location", "audio", "ptt", "vcard"]
                },
                subtype: "string",
                t: "number",
                notifyName: "string",
                from: "string",
                to: "string",
                author: "string",
                self: {
                    type: ["string"],
                    values: ["in", "out"],
                    "default": "in"
                },
                ack: "number",
                invis: "boolean",
                isNew: "boolean",
                recvFresh: "boolean",
                clientUrl: "string",
                url: "string",
                caption: "string",
                mimetype: "string",
                duration: "string",
                filehash: "string",
                size: "number",
                loc: "string",
                lat: "string",
                lng: "string",
                height: "number",
                width: "number",
                recipients: "array",
                broadcast: "boolean",
                avparams: "object"
            },
            session: {
                dropped: "boolean",
                urlState: {
                    type: "string",
                    values: _.values(c),
                    "default": c.INIT
                },
                local: "boolean",
                urlRetry: {
                    type: "number",
                    "default": 0
                },
                uploadPromise: "object",
                reupload: "any",
                ajaxHeadPromise: "object",
                rmrPromise: "object"
            },
            children: {
                senderObj: a
            },
            initialize: function () {
                this.sender && (this.senderObj = Store.Contact.gadd({
                    id: this.sender
                }), this.listenTo(this.senderObj, "all", this._getEventBubblingHandler("senderObj"))), (this.isMedia || "ptt" === this.type) && this.listenTo(this, "change:needsRefresh change:isObserved", function () {
                    this.isObserved && this.needsRefresh && this.initializeMedia()
                });
                var e;
                (e = Store.Msg.preAck[this.id]) && (Wa.debug("Msg:initialize updating msg with out of order ack", null, e), this.updateAck(e.ack), delete Store.Msg.preAck[this.id])
            },
            derived: {
                chat: {
                    fn: function () {
                        return Store.Chat.get(Wa.splitMsgKey(this.id).remote)
                    }
                },
                isGroupMsg: {
                    fn: function () {
                        return Wa.isGroupWid(this.from) || Wa.isGroupWid(this.to)
                    }
                },
                isSentByMe: {
                    fn: function () {
                        var e = Wa.splitMsgKey(this.id);
                        return "in" === e.self ? !1 : this.from === Wa.me
                    }
                },
                isNotification: {
                    fn: function () {
                        switch (this.type) {
                        case "group_notification":
                        case "gp2":
                        case "broadcast_notification":
                        case "notification":
                            return !0;
                        default:
                            return !1
                        }
                    }
                },
                isMedia: {
                    fn: function () {
                        var e = this.type;
                        return "image" === e || "video" === e || "audio" === e
                    }
                },
                mmsSrc: {
                    deps: ["url"],
                    fn: function () {
                        return Wa.isHttpUrl(this.url) ? this.url + "?x=2" : this.url
                    }
                },
                hasSymbol: {
                    fn: function () {
                        var e = this.type;
                        return this.isMedia || "location" === e || "vcard" === e || "ptt" === e
                    }
                },
                uploadState: {
                    deps: ["ack", "uploadPromise"],
                    fn: function () {
                        return this.isSentByMe && 0 === this.ack ? this.local ? this.uploadPromise ? u.UPLOADING : u.RETRY : u.PHONE_UPLOADING : !1
                    }
                },
                eventType: {
                    deps: ["invis"],
                    fn: function () {
                        var e, t, n = this.type,
                            r = this.subtype;
                        return this.isNew ? ("gp2" === n || "group_notification" === n ? "subject" === r ? e = "n" : "add" === r ? (t = _.first(this.recipients), e = t === Wa.me ? "s" : "i") : "remove" === r ? (t = _.first(this.recipients), e = t === Wa.me ? "n" : "i") : e = "create" === r ? this.author === Wa.me ? "n" : "s" : "i" : e = "broadcast_notification" === n || "notification" === n ? "create" === r ? "n" : "i" : this.broadcast ? "i" : "d", this.invis ? "i" === e ? "i" : "n" : e) : "i"
                    }
                },
                sender: {
                    fn: function () {
                        return this.isSentByMe ? this.from : this.isGroupMsg ? this.author : this.from
                    }
                },
                startOfDay: {
                    fn: function () {
                        return moment.unix(this.t).startOf("day").unix()
                    }
                },
                needsRefresh: {
                    deps: ["clientUrl", "urlState"],
                    fn: function () {
                        return this.clientUrl && _.contains([c.INIT, c.REFRESH_RETRY], this.urlState)
                    }
                }
            },
            initializeMedia: function () {
                this.needsRefresh && Store.Msg.refreshMediaUrl(this.id)
            },
            "delete": function () {
                o.prototype["delete"].call(this), Store.Msg.remove(this.id), this.chat.msgs.remove(this.id)
            },
            displayName: function (e, t) {
                if (!this.sender) return "";
                if (this.sender === Wa.me) return l10n.t("web_you");
                var n = this.senderObj,
                    r = t && this.notifyName ? " ~" + this.notifyName : "",
                    o = e ? n.shortName : void 0;
                return o || n.name || Wa.widGetFormattedUser(this.sender) + r
            },
            isSameDay: function (e) {
                return this.startOfDay === e.startOfDay
            },
            asDesktopNotification: function () {
                var e, t, n = "";
                switch (this.from !== Wa.me && this.isGroupMsg && (n = this.displayName()), this.type) {
                case "chat":
                    e = this.body;
                    break;
                case "image":
                    e = this.caption ? "📷 " + this.caption : "📷 " + l10n.t("web_conversations_most_recent_image");
                    break;
                case "video":
                    e = this.caption ? "🎥 " + this.caption : "🎥 " + l10n.t("web_conversations_most_recent_video");
                    break;
                case "ptt":
                    e = l10n.t("web_conversations_most_recent_voice");
                    break;
                case "audio":
                    e = l10n.t("web_conversations_most_recent_audio");
                    break;
                case "location":
                    e = this.loc || l10n.t("web_conversations_most_recent_location");
                    break;
                case "group_notification":
                case "gp2":
                    e = Wa.formatGroupNotification(this), n = "";
                    break;
                case "broadcast_notification":
                    t = this.subtype;
                    var r = this.body;
                    e = Wa.formatBroadcastNotification(t, r);
                    break;
                case "notification":
                    e = this.body;
                    break;
                case "vcard":
                    e = l10n.t("web_conversations_most_recent_contact");
                    break;
                default:
                    e = ""
                }
                return (n ? n + ": " : "") + e
            },
            msgText: function () {
                switch (this.type) {
                case "chat":
                    return this.body;
                case "image":
                    return this.caption ? this.caption : l10n.t("web_conversations_most_recent_image");
                case "video":
                    return this.caption ? this.caption : l10n.t("web_conversations_most_recent_video");
                case "ptt":
                    return Wa.formatDuration(this.duration);
                case "audio":
                    return l10n.t("web_conversations_most_recent_audio");
                case "location":
                    return this.loc || l10n.t("web_conversations_most_recent_location");
                case "group_notification":
                case "gp2":
                    return Wa.formatGroupNotification(this);
                case "broadcast_notification":
                    return Wa.formatBroadcastNotification(this.subtype, this.body);
                case "notification":
                    return this.body;
                case "vcard":
                    return l10n.t("web_conversations_most_recent_contact");
                default:
                    return ""
                }
            },
            updateAck: function (e) {
                var t = this.ack;
                _.isNumber(e) && ("undefined" == typeof t || e > t) && (this.ack = e), this.unset("dropped")
            },
            reuploadMedia: function () {
                if (this.reupload && !this.uploadPromise) {
                    var e = this;
                    return this.set({
                        urlSate: c.UPLOADING
                    }), this.uploadPromise = this.reupload().then(function (t) {
                        return e.sendMediaMsg(t)
                    }).then(function () {
                        e.set({
                            urlState: c.STATUS_200,
                            reupload: null
                        })
                    })["finally"](function () {
                        e.unset("uploadPromise")
                    })
                }
            },
            sendMediaMsg: function (e) {
                return this.set({
                    avparams: e,
                    filehash: e.filehash,
                    size: parseInt(e.size, 10)
                }), Store.Msg.send(this).then(function (t) {
                    return {
                        result: t,
                        avparams: e
                    }
                })
            },
            sendPlayed: function () {
                if ("ptt" === this.type && !(this.isSentByMe || this.ack >= Wa.CONST.ACK_PLAYED)) {
                    var e = this;
                    i.sendMessagePlayed(Wa.splitMsgKey(this.id)).then(function () {
                        e.ack = Wa.CONST.ACK_PLAYED
                    })["catch"](s.WapDrop, _.noop)
                }
            },
            urlState200: function (e) {
                r(this.url, e) ? this.urlState = c.STATUS_200 : Wa.debug("status_200 set for wrong url?")
            },
            mediaLoadError: function (e) {
                r(this.url, e) || Promise.resolve(), navigator.onLine || Promise.resolve(), this.urlRetry > 3 && Promise.resolve(), this.urlRetry++, this.ajaxHeadPromise && this.ajaxHeadPromise.cancel();
                var t, n;
                return n = this.ajaxHeadPromise = new Promise(function (t, n) {
                    Wa.ajaxHead(e, t, n)
                }).bind(this).timeout(3e4).cancellable().tap(function () {
                    t = n.cancel.bind(n), this.listenToOnce(this, "change:url", t)
                }).then(this.onMediaCheckSuccess)["catch"](Promise.CancellationError, _.noop)["catch"](Promise.TimeoutError, _.noop)["catch"](this.onMediaCheckError)["finally"](function () {
                    this.stopListening(this, "change:url", t), n === this.ajaxHeadPromise && this.unset("ajaxHeadPromise")
                })
            },
            onMediaCheckSuccess: function (e) {
                return 404 === e.status ? this.requestMediaReupload() : void(e.status >= 200 && e.status < 400 && this.urlState200(e.waURL))
            },
            onMediaCheckError: function () {},
            requestMediaReupload: function () {
                return this.set({
                    url: null,
                    urlState: c.RMR_FETCHING
                }), this.rmrPromise ? this.rmrPromise : this.rmrPromise = i.requestMediaReupload(this).bind(this).then(function (e) {
                    200 === e.status ? this.set({
                        clientUrl: e.url,
                        urlState: c.INIT
                    }) : 404 === e.status ? this.urlState = c.RMR_ERROR_MISSING : e.status >= 400 && (this.urlState = c.RMR_ERROR_RETRY)
                })["catch"](function () {
                    this.urlState = c.RMR_ERROR_RETRY
                })["finally"](function () {
                    this.unset("rmrPromise")
                })
            },
            forward: function (e) {
                var t, n = e.id,
                    r = this.toJSON(),
                    o = r.type,
                    a = this.id;
                switch (_.extend(r, {
                    id: Wa.createMsgKey(Wa.me, n, Socket.tag()),
                    t: Wa.now(),
                    from: Wa.me,
                    to: n,
                    ack: 0
                }), o) {
                case "chat":
                    return t = new l(r), Store.Msg.send(t), e.msgs.add(t);
                case "video":
                case "image":
                case "audio":
                case "ptt":
                    var s = r.filehash,
                        c = r.size;
                    if (s && c) {
                        t = new l(r), Store.Msg.send(t), e.msgs.add(t); {
                            window.performance.now()
                        }
                        return i.requestMediaUpload(o, s, c).then(function (e) {
                            var n = e.result;
                            if ("duplicate" === n) {
                                var r = e.data;
                                return t.set({
                                    avparams: r
                                }), Store.Msg.send(t)
                            }
                            return i.requestMediaReupload(a).then(function (e) {
                                return t.set({
                                    avparams: {
                                        filehash: s,
                                        size: c,
                                        type: o,
                                        url: e.url
                                    },
                                    url: e.url
                                }), Store.Msg.send(t)
                            })
                        })
                    }
                    break;
                case "location":
                    return e.sendLocation(r.lat, r.lng, r.loc, r.url);
                case "vcard":
                    return e.sendContact(r.body, r.subtype)
                }
            }
        });
    l.URL_STATE = c, l.UPLOAD_STATE = u, e.exports = l
}, function (e, t, n) {
    var r = n(89),
        o = n(133),
        a = n(29),
        i = (n(33), 1500),
        s = 2e3,
        c = r.extend({
            props: {
                id: "string",
                type: {
                    type: "string",
                    values: ["available", "unavailable", "composing", "recording"]
                },
                t: "number",
                deny: "boolean"
            },
            session: {
                updateTime: "number",
                _expireTimerId: 0
            }
        }),
        u = o.extend({
            model: c
        }),
        l = r.extend({
            Collection: "Presence",
            props: {
                id: "string"
            },
            session: {
                isOnline: "boolean",
                stale: ["boolean", !1, !0],
                hasData: ["boolean", !1, !1],
                isSubscribed: ["boolean", !1, !1],
                withholdDisplay: ["boolean", !1, !0],
                forceDisplay: ["boolean", !1, !1],
                chatActive: ["boolean", !1, !1],
                withholdDisplayTimer: "number",
                forceDisplayTimer: "number"
            },
            children: {
                chatstate: c
            },
            collections: {
                chatstates: u
            },
            derived: {
                isGroup: {
                    fn: function () {
                        return Wa.isGroupWid(this.id)
                    }
                },
                isUser: {
                    fn: function () {
                        return Wa.isUserWid(this.id)
                    }
                }
            },
            initialize: function () {
                this.isGroup ? (this.chatstate.set({
                    id: "",
                    type: "unavailable"
                }), this.listenTo(this.chatstates, "add change", function () {
                    var e, t = !1;
                    this.chatstates.forEach(function (n) {
                        "composing" !== n.type && "recording" !== n.type || e && !(e.updateTime < n.updateTime) || (e = n), t = t || "unavailable" !== n.type
                    }), this.set({
                        isOnline: t,
                        chatstate: {
                            id: e ? e.id : "",
                            type: e ? e.type : "unavailable"
                        }
                    })
                })) : (this.chatstate.set({
                    id: this.id
                }), this.listenTo(this.chatstate, "change:type", function () {
                    this.isOnline = "unavailable" !== this.chatstate.type
                })), this.listenTo(this, "change:chatActive", this.onChatActiveChange)
            },
            "delete": function () {
                r.prototype["delete"].call(this), Store.Presence.remove(this.id), this.chatstate["delete"](), this.chatstates.forEach(function (e) {
                    e["delete"]()
                })
            },
            handle: function (e) {
                "undefined" == typeof e.type ? e.type = this.chatstate.type || "unavailable" : "paused" === e.type && (e.type = "available"), this.isGroup && "available" !== e.type && (e.updateTime = Date.now());
                var t;
                if (this.isGroup) {
                    if (e.id = e.participant, e.participant = void 0, !e.id) return;
                    t = this.chatstates.add(e, {
                        merge: !0
                    })
                } else t = this.chatstate.set(e);
                t._expireTimerId && clearTimeout(t._expireTimerId), t._expireTimerId = "composing" === t.type || "recording" === t.type ? _.delay(this._expireComposing, Wa.CONST.PRESENCE_COMPOSING_TIMEOUT, t) : 0;
                var n = this.forceDisplay || this.isOnline || this.isUser && !this.chatstate.deny;
                this.set({
                    hasData: !0,
                    forceDisplay: n
                })
            },
            _expireComposing: function (e) {
                var t = e.type;
                "composing" === t || "recording" === t ? e.type = "available" : Wa.debug("expiring " + t, "red")
            },
            reset: function () {
                this.hasData = !1, this.isGroup ? this.chatstates.forEach(function (e) {
                    e.type = "unavailable"
                }) : this.isUser && (this.chatstate.unset("t"), this.chatstate.unset("deny")), this.chatstate.set({
                    id: this.isGroup ? "" : this.id,
                    type: "unavailable",
                    t: void 0,
                    deny: void 0
                })
            },
            isActive: function () {
                var e = this.chatstate.type;
                return this.hasData && ("composing" === e || "recording" === e)
            },
            getFormattedString: function () {
                if (!this.hasData) return null;
                if (this.isGroup) {
                    var e = this.chatstate.id;
                    if (!e) return null;
                    var t = Store.Contact.get(e);
                    if (!t) return null;
                    var n = t.formattedShortName;
                    return "composing" === this.chatstate.type ? l10n.t("web_conversation_name_is_composing", {
                        participant: n
                    }) : l10n.t("web_conversation_name_is_recording", {
                        participant: n
                    })
                }
                if (!this.isUser) return null;
                var r = this.chatstate;
                switch (r.type) {
                case "available":
                    return l10n.t("web_conversation_contact_online");
                case "composing":
                    return l10n.t("web_conversation_is_composing");
                case "recording":
                    return l10n.t("web_conversation_is_recording");
                case "unavailable":
                    return r.deny || !r.t ? null : l10n.t("web_conversation_last_seen") + " " + Wa.formatDateAndTimeRelative(r.t)
                }
            },
            onChatActiveChange: function () {
                var e = this.chatActive;
                e ? (this.hasData ? this.withholdDisplay = !1 : this.withholdDisplayTimer = _.delay(function (e) {
                    e.set({
                        withholdDisplay: !1,
                        withholdDisplayTimer: 0
                    })
                }, i, this), this.forceDisplayTimer = _.delay(function (e) {
                    e.set({
                        forceDisplay: !0,
                        forceDisplayTimer: 0
                    })
                }, s, this)) : (this.withholdDisplayTimer && (clearTimeout(this.withholdDisplayTimer), this.withholdDisplayTimer = 0), this.forceDisplayTimer && (clearTimeout(this.forceDisplayTimer), this.forceDisplayTimer = 0))
            },
            subscribe: function () {
                return this.isSubscribed ? Promise.resolve() : this.isUser ? this.update() : this.isGroup ? (this.isSubscribed = !0, Promise.join(this.update(), a.presenceSubscribe(this.id), _.noop).bind(this)["catch"](function (e) {
                    return this.isSubscribed = !1, Promise.reject(e)
                })) : Promise.resolve()
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(89),
        o = r.extend({
            idAttribute: "char",
            props: {
                "char": "string",
                weight: "number"
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r;
    !
    function () {
        function o() {
            return {
                keys: Object.keys,
                uniqueId: function (e) {
                    var t = ++l + "";
                    return e ? e + t : t
                },
                has: function (e, t) {
                    return c.call(e, t)
                },
                each: function (e, t, n) {
                    if (null != e) if (s && e.forEach === s) e.forEach(t, n);
                    else if (e.length === +e.length) {
                        for (var r = 0, o = e.length; o > r; r++) if (t.call(n, e[r], r, e) === i) return
                    } else for (var a in e) if (this.has(e, a) && t.call(n, e[a], a, e) === i) return
                },
                once: function (e) {
                    var t, n = !1;
                    return function () {
                        return n ? t : (n = !0, t = e.apply(this, arguments), e = null, t)
                    }
                }
            }
        }
        var a, i = {},
            s = Array.prototype.forEach,
            c = Object.prototype.hasOwnProperty,
            u = Array.prototype.slice,
            l = 0,
            d = o();
        a = {
            on: function (e, t, n) {
                if (!h(this, "on", e, [t, n]) || !t) return this;
                this._events || (this._events = {});
                var r = this._events[e] || (this._events[e] = []);
                return r.push({
                    callback: t,
                    context: n,
                    ctx: n || this
                }), this
            },
            once: function (e, t, n) {
                if (!h(this, "once", e, [t, n]) || !t) return this;
                var r = this,
                    o = d.once(function () {
                        r.off(e, o), t.apply(this, arguments)
                    });
                return o._callback = t, this.on(e, o, n)
            },
            off: function (e, t, n) {
                var r, o, a, i, s, c, u, l;
                if (!this._events || !h(this, "off", e, [t, n])) return this;
                if (!e && !t && !n) return this._events = {}, this;
                for (i = e ? [e] : d.keys(this._events), s = 0, c = i.length; c > s; s++) if (e = i[s], a = this._events[e]) {
                    if (this._events[e] = r = [], t || n) for (u = 0, l = a.length; l > u; u++) o = a[u], (t && t !== o.callback && t !== o.callback._callback || n && n !== o.context) && r.push(o);
                    r.length || delete this._events[e]
                }
                return this
            },
            trigger: function (e) {
                if (!this._events) return this;
                var t = u.call(arguments, 1);
                if (!h(this, "trigger", e, t)) return this;
                var n = this._events[e],
                    r = this._events.all;
                return n && g(n, t), r && g(r, arguments), this
            },
            stopListening: function (e, t, n) {
                var r = this._listeners;
                if (!r) return this;
                var o = !t && !n;
                "object" == typeof t && (n = this), e && ((r = {})[e._listenerId] = e);
                for (var a in r) r[a].off(t, n, this), o && delete this._listeners[a];
                return this
            }
        };
        var p = /\s+/,
            h = function (e, t, n, r) {
                if (!n) return !0;
                if ("object" == typeof n) {
                    for (var o in n) e[t].apply(e, [o, n[o]].concat(r));
                    return !1
                }
                if (p.test(n)) {
                    for (var a = n.split(p), i = 0, s = a.length; s > i; i++) e[t].apply(e, [a[i]].concat(r));
                    return !1
                }
                return !0
            },
            g = function (e, t) {
                var n, r = -1,
                    o = e.length,
                    a = t[0],
                    i = t[1],
                    s = t[2];
                switch (t.length) {
                case 0:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx);
                    return;
                case 1:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a);
                    return;
                case 2:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a, i);
                    return;
                case 3:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a, i, s);
                    return;
                default:
                    for (; ++r < o;)(n = e[r]).callback.apply(n.ctx, t)
                }
            },
            f = {
                listenTo: "on",
                listenToOnce: "once"
            };
        d.each(f, function (e, t) {
            a[t] = function (t, n, r) {
                var o = this._listeners || (this._listeners = {}),
                    a = t._listenerId || (t._listenerId = d.uniqueId("l"));
                return o[a] = t, "object" == typeof n && (r = this), t[e](n, r, this), this
            }
        }), a.bind = a.on, a.unbind = a.off, a.mixin = function (e) {
            var t = ["on", "once", "off", "trigger", "stopListening", "listenTo", "listenToOnce", "bind", "unbind"];
            return d.each(t, function (t) {
                e[t] = this[t]
            }, this), e
        }, r = function () {
            return a
        }.call(t, n, t, e), !(void 0 !== r && (e.exports = r))
    }(this)
}, function (e, t, n) {
    function r(e) {
        return e.replace(/[^A-Za-z0-9]/g, function (e) {
            return o[e] || e
        })
    }
    var o = n(123);
    r.isLatin = function (e) {
        return e === r(e)
    }, e.exports = r
}, function (e, t, n) {
    function r(e, t) {
        t || (t = {}), this.cid || (this.cid = s.uniqueId("state")), this._events = {}, this._values = {}, this._definition = Object.create(this._definition), t.parse && (e = this.parse(e, t)), this.parent = t.parent, this.collection = t.collection, this._keyTree = new u, this._initCollections(), this._initChildren(), this._cache = {}, this._previousAttributes = {}, e && this.set(e, s.extend({
            silent: !0,
            initial: !0
        }, t)), this._changed = {}, this._derived && this._initDerived(), t.init !== !1 && this.initialize.apply(this, arguments)
    }
    function o(e, t, n, r) {
        var o, a, i = e._definition[t] = {};
        if (s.isString(n)) o = e._ensureValidType(n), o && (i.type = o);
        else {
            if (s.isArray(n) && (a = n, n = {
                type: a[0],
                required: a[1],
                "default": a[2]
            }), o = e._ensureValidType(n.type), o && (i.type = o), n.required && (i.required = !0), n["default"] && "object" == typeof n["default"]) throw new TypeError("The default value for " + t + " cannot be an object/array, must be a value or a function which returns a value/object/array");
            i["default"] = n["default"], i.allowNull = n.allowNull ? n.allowNull : !1, n.setOnce && (i.setOnce = !0), i.required && s.isUndefined(i["default"]) && !i.setOnce && (i["default"] = e._getDefaultForType(o)), i.test = n.test, i.values = n.values
        }
        return r && (i.session = !0), Object.defineProperty(e, t, {
            set: function (e) {
                this.set(t, e)
            },
            get: function () {
                var e = this._values[t],
                    n = this._dataTypes[i.type];
                return "undefined" != typeof e ? (n && n.get && (e = n.get(e)), e) : (e = s.result(i, "default"), this._values[t] = e, e)
            }
        }), i
    }
    function a(e, t, n) {
        var r = e._derived[t] = {
            fn: s.isFunction(n) ? n : n.fn,
            cache: n.cache !== !1,
            depList: n.deps || []
        };
        s.each(r.depList, function (n) {
            e._deps[n] = s(e._deps[n] || []).union([t])
        }), Object.defineProperty(e, t, {
            get: function () {
                return this._getDerivedProperty(t)
            },
            set: function () {
                throw new TypeError('"' + t + "\" is a derived property, it can't be set directly.")
            }
        })
    }
    function i(e) {
        var t, n = this,
            r = [].slice.call(arguments);
        t = e && e.hasOwnProperty("constructor") ? e.constructor : function () {
            return n.apply(this, arguments)
        }, s.extend(t, n);
        var i = function () {
                this.constructor = t
            };
        i.prototype = n.prototype, t.prototype = new i, t.prototype._derived = s.extend({}, n.prototype._derived), t.prototype._deps = s.extend({}, n.prototype._deps), t.prototype._definition = s.extend({}, n.prototype._definition), t.prototype._collections = s.extend({}, n.prototype._collections), t.prototype._children = s.extend({}, n.prototype._children), t.prototype._dataTypes = s.extend({}, n.prototype._dataTypes || p), e && r.forEach(function (e) {
            var n = ["dataTypes", "props", "session", "derived", "collections", "children"];
            e.dataTypes && s.each(e.dataTypes, function (e, n) {
                t.prototype._dataTypes[n] = e
            }), e.props && s.each(e.props, function (e, n) {
                o(t.prototype, n, e)
            }), e.session && s.each(e.session, function (e, n) {
                o(t.prototype, n, e, !0)
            }), e.derived && s.each(e.derived, function (e, n) {
                a(t.prototype, n, e)
            }), e.collections && s.each(e.collections, function (e, n) {
                t.prototype._collections[n] = e
            }), e.children && s.each(e.children, function (e, n) {
                t.prototype._children[n] = e
            }), s.extend(t.prototype, s.omit(e, n))
        });
        Object.prototype.toString;
        return t.__super__ = n.prototype, t
    }
    var s = n(130),
        c = n(129),
        u = n(132),
        l = n(131),
        d = /^change:/;
    s.extend(r.prototype, c, {
        extraProperties: "ignore",
        idAttribute: "id",
        namespaceAttribute: "namespace",
        typeAttribute: "modelType",
        initialize: function () {
            return this
        },
        getId: function () {
            return this[this.idAttribute]
        },
        getNamespace: function () {
            return this[this.namespaceAttribute]
        },
        getType: function () {
            return this[this.typeAttribute]
        },
        isNew: function () {
            return null == this.getId()
        },
        escape: function (e) {
            return s.escape(this.get(e))
        },
        isValid: function (e) {
            return this._validate({}, s.extend(e || {}, {
                validate: !0
            }))
        },
        parse: function (e) {
            return e
        },
        serialize: function () {
            var e = this.getAttributes({
                props: !0
            }, !0);
            return s.each(this._children, function (t, n) {
                e[n] = this[n].serialize()
            }, this), s.each(this._collections, function (t, n) {
                e[n] = this[n].serialize()
            }, this), e
        },
        set: function (e, t, n) {
            var r, o, a, i, c, u, l, d, p, h, g, f, m, b, y, _, A = this,
                E = this.extraProperties;
            if (s.isObject(e) || null === e ? (p = e, n = t) : (p = {}, p[e] = t), n = n || {}, !this._validate(p, n)) return !1;
            f = n.unset, g = n.silent, b = n.initial, o = [], r = this._changing, this._changing = !0, r || (this._previousAttributes = this.attributes, this._changed = {});
            for (d in p) {
                if (i = p[d], a = typeof i, m = this._values[d], c = this._definition[d], !c) {
                    if (this._children[d] || this._collections[d]) {
                        this[d].set(i, n);
                        continue
                    }
                    if ("ignore" === E) continue;
                    if ("reject" === E) throw new TypeError('No "' + d + '" property defined on ' + (this.type || "this") + ' model and extraProperties not set to "ignore" or "allow"');
                    if ("allow" === E) c = this._createPropertyDefinition(d, "any");
                    else if (E) throw new TypeError('Invalid value for extraProperties: "' + E + '"')
                }
                if (_ = this._getCompareForType(c.type), h = this._dataTypes[c.type], h && h.set && (u = h.set(i), i = u.val, a = u.type), c.test && (l = c.test.call(this, i, a))) throw new TypeError("Property '" + d + "' failed validation with error: " + l);
                if (s.isUndefined(i) && c.required) throw new TypeError("Required property '" + d + "' must be of type " + c.type + ". Tried to set " + i);
                if (s.isNull(i) && c.required && !c.allowNull) throw new TypeError("Property '" + d + "' must be of type " + c.type + " (cannot be null). Tried to set " + i);
                if (c.type && "any" !== c.type && c.type !== a && !s.isNull(i) && !s.isUndefined(i)) throw new TypeError("Property '" + d + "' must be of type " + c.type + ". Tried to set " + i);
                if (c.values && !s.contains(c.values, i)) throw new TypeError("Property '" + d + "' must be one of values: " + c.values.join(", ") + ". Tried to set " + i);
                if (y = !_(m, i, d), c.setOnce && void 0 !== m && y && !b) throw new TypeError("Property '" + d + "' can only be set once.");
                y ? (o.push({
                    prev: m,
                    val: i,
                    key: d
                }), A._changed[d] = i) : delete A._changed[d]
            }
            if (s.each(o, function (e) {
                A._previousAttributes[e.key] = e.prev, f ? delete A._values[e.key] : A._values[e.key] = e.val
            }), !g && o.length && (A._pending = !0), g || s.each(o, function (e) {
                A.trigger("change:" + e.key, A, e.val, n)
            }), r) return this;
            if (!g) for (; this._pending;) this._pending = !1, this.trigger("change", this, n);
            return this._pending = !1, this._changing = !1, this
        },
        get: function (e) {
            return this[e]
        },
        toggle: function (e) {
            var t = this._definition[e];
            if ("boolean" === t.type) this[e] = !this[e];
            else {
                if (!t || !t.values) throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");
                this[e] = l(t.values, this[e])
            }
            return this
        },
        previousAttributes: function () {
            return s.clone(this._previousAttributes)
        },
        hasChanged: function (e) {
            return null == e ? !s.isEmpty(this._changed) : s.has(this._changed, e)
        },
        changedAttributes: function (e) {
            if (!e) return this.hasChanged() ? s.clone(this._changed) : !1;
            var t, n, r, o = !1,
                a = this._changing ? this._previousAttributes : this.attributes;
            for (var i in e) n = this._definition[i], n && (r = this._getCompareForType(n.type), r(a[i], t = e[i]) || ((o || (o = {}))[i] = t));
            return o
        },
        toJSON: function () {
            return this.serialize()
        },
        unset: function (e, t) {
            {
                var n, r = this._definition[e];
                r.type
            }
            return r.required ? (n = s.result(r, "default"), this.set(e, n, t)) : this.set(e, n, s.extend({}, t, {
                unset: !0
            }))
        },
        clear: function (e) {
            var t = this;
            return s.each(s.keys(this.attributes), function (n) {
                t.unset(n, e)
            }), this
        },
        previous: function (e) {
            return null != e && Object.keys(this._previousAttributes).length ? this._previousAttributes[e] : null
        },
        _getDefaultForType: function (e) {
            var t = this._dataTypes[e];
            return t && t["default"]
        },
        _getCompareForType: function (e) {
            var t = this._dataTypes[e];
            return t && t.compare ? s.bind(t.compare, this) : s.isEqual
        },
        _validate: function (e, t) {
            if (!t.validate || !this.validate) return !0;
            e = s.extend({}, this.attributes, e);
            var n = this.validationError = this.validate(e, t) || null;
            return n ? (this.trigger("invalid", this, n, s.extend(t || {}, {
                validationError: n
            })), !1) : !0
        },
        _createPropertyDefinition: function (e, t, n) {
            return o(this, e, t, n)
        },
        _ensureValidType: function (e) {
            return s.contains(["string", "number", "boolean", "array", "object", "date", "any"].concat(s.keys(this._dataTypes)), e) ? e : void 0
        },
        getAttributes: function (e, t) {
            e || (e = {}), s.defaults(e, {
                session: !1,
                props: !1,
                derived: !1
            });
            var n, r, o, a = {};
            for (r in this._definition) o = this._definition[r], (e.session && o.session || e.props && !o.session) && (n = t ? this._values[r] : this[r], "undefined" == typeof n && (n = s.result(o, "default")), "undefined" != typeof n && (a[r] = n));
            if (e.derived) for (r in this._derived) a[r] = this[r];
            return a
        },
        _initDerived: function () {
            var e = this;
            s.each(this._derived, function (t, n) {
                var r = e._derived[n];
                r.deps = r.depList;
                var o = function (t) {
                        t = t || {};
                        var o = r.fn.call(e);
                        e._cache[n] === o && r.cache || (r.cache && (e._previousAttributes[n] = e._cache[n]), e._cache[n] = o, e.trigger("change:" + n, e, e._cache[n]))
                    };
                r.deps.forEach(function (t) {
                    e._keyTree.add(t, o)
                })
            }), this.on("all", function (t) {
                d.test(t) && e._keyTree.get(t.split(":")[1]).forEach(function (e) {
                    e()
                })
            }, this)
        },
        _getDerivedProperty: function (e, t) {
            return this._derived[e].cache ? ((t || !this._cache.hasOwnProperty(e)) && (this._cache[e] = this._derived[e].fn.apply(this)), this._cache[e]) : this._derived[e].fn.apply(this)
        },
        _initCollections: function () {
            var e;
            if (this._collections) for (e in this._collections) this[e] = new this._collections[e](null, {
                parent: this
            })
        },
        _initChildren: function () {
            var e;
            if (this._children) for (e in this._children) this[e] = new this._children[e]({}, {
                parent: this
            }), this.listenTo(this[e], "all", this._getEventBubblingHandler(e))
        },
        _getEventBubblingHandler: function (e) {
            return s.bind(function (t, n, r) {
                d.test(t) ? this.trigger("change:" + e + "." + t.split(":")[1], n, r) : "change" === t && this.trigger("change", this)
            }, this)
        },
        _verifyRequired: function () {
            var e = this.attributes;
            for (var t in this._definition) if (this._definition[t].required && "undefined" == typeof e[t]) return !1;
            return !0
        }
    }), Object.defineProperties(r.prototype, {
        attributes: {
            get: function () {
                return this.getAttributes({
                    props: !0,
                    session: !0
                })
            }
        },
        all: {
            get: function () {
                return this.getAttributes({
                    session: !0,
                    props: !0,
                    derived: !0
                })
            }
        },
        isState: {
            get: function () {
                return !0
            },
            set: function () {}
        }
    });
    var p = {
        string: {
            "default": function () {
                return ""
            }
        },
        date: {
            set: function (e) {
                var t;
                if (s.isDate(e)) t = "date", e = e.valueOf();
                else try {
                    var n = new Date(e).valueOf();
                    if (isNaN(n) && (n = new Date(parseInt(e, 10)).valueOf(), isNaN(n))) throw TypeError;
                    e = n, t = "date"
                } catch (r) {
                    t = typeof e
                }
                return {
                    val: e,
                    type: t
                }
            },
            get: function (e) {
                return new Date(e)
            },
            "default": function () {
                return new Date
            }
        },
        array: {
            set: function (e) {
                return {
                    val: e,
                    type: s.isArray(e) ? "array" : typeof e
                }
            },
            "default": function () {
                return []
            }
        },
        object: {
            set: function (e) {
                var t = typeof e;
                return "object" !== t && s.isUndefined(e) && (e = null, t = "object"), {
                    val: e,
                    type: t
                }
            },
            "default": function () {
                return {}
            }
        },
        state: {
            set: function (e) {
                var t = e instanceof r || e && e.isState;
                return t ? {
                    val: e,
                    type: "state"
                } : {
                    val: e,
                    type: typeof e
                }
            },
            compare: function (e, t, n) {
                var r = e === t;
                return r || (e && this.stopListening(e), null != t && this.listenTo(t, "all", this._getEventBubblingHandler(n))), r
            }
        }
    };
    r.extend = i, e.exports = r
}, function (e, t, n) {
    function r(e) {
        return e = e || {}, function (t, n) {
            for (var r in t) if (t.hasOwnProperty(r)) {
                var o = e[r];
                n(o && o.name || r, t[r], o && o.printer, o && o.width)
            }
        }
    }
    function o() {
        Object.defineProperties(this, {
            __printers: {
                value: {},
                enumerable: !1
            },
            __cell: {
                value: function (e, t, n) {
                    this[e] = t, this.__printers[e] = n
                },
                enumerable: !1
            }
        })
    }
    function a(e, t, n) {
        function r(e, n) {
            var r = null != t[e].width;
            if (r) l[e] = t[e].width;
            else {
                if (l[e] > n) return;
                l[e] = n
            }
        }
        function o(e, t) {
            return e.__printers && e.__printers[t] || i.string
        }
        function a() {
            e.forEach(function (e) {
                for (var n in t) r(n, o(e, n).call(e, e[n]).length)
            })
        }
        function s(e) {
            var r = "",
                o = !0;
            for (var a in t) {
                o || (r += n), o = !1;
                var i = l[a];
                r += c(e(a, i), i)
            }
            return r += "\n"
        }
        function c(e, t) {
            return e.length <= t ? u(e, t) : (e = e.slice(0, t), t > 3 && (e = e.slice(0, -3).concat("...")), e)
        }
        var u = i.RightPadder(),
            l = {};
        return a(), e.map(function (e) {
            return s(function (t, n) {
                return o(e, t).call(e, e[t], n)
            })
        }).join("")
    }
    function i() {
        this.columns = {}, this.rows = [], this._row = new o
    }
    e.exports = i, i.string = function (e) {
        return void 0 === e ? "" : String(e)
    }, i.Number = function (e) {
        return function (t, n) {
            if (void 0 === t) return "";
            if ("number" != typeof t) throw new Error(String(t) + " is not a number");
            var r = null == e ? String(t) : t.toFixed(e).toString();
            return i.padLeft(r, n)
        }
    }, i.RightPadder = function (e) {
        return e = e || " ", function (t, n) {
            for (var r = String(t), o = r.length, a = 0; n - o > a; a++) r += e;
            return r
        }
    }, i.LeftPadder = function (e) {
        return e = e || " ", function (t, n) {
            for (var r = "", o = String(t), a = 0; a < n - o.length; a++) r += e;
            return r += o
        }
    }, i.padLeft = i.LeftPadder(), i.printArray = function (e, t, n) {
        t = "function" == typeof t ? t : r(t), n = n ||
        function (e) {
            return e.toString()
        };
        var o = new i,
            a = o.cell.bind(o);
        return e.forEach(function (e) {
            t(e, a), o.newRow()
        }), n(o)
    }, i.printObj = function (e, t, n) {
        t = "function" == typeof t ? t : r(t), n = n ||
        function (e) {
            return e.printTransposed(" : ")
        };
        var o = new i;
        return t(e, o.cell.bind(o)), o.newRow(), n(o)
    }, i.Row = o, i.print = a, i.prototype.cell = function (e, t, n, r) {
        this._row.__cell(e, t, n);
        var o = this.columns[e] || (this.columns[e] = {});
        return null != r && (o.width = r), this
    }, i.prototype.newRow = i.prototype.newLine = function () {
        return this.rows.push(this._row), this._row = new o, this
    }, i.prototype.sort = n(124), i.aggr = n(125), i.prototype.totals = null, i.prototype.total = function (e, t, n) {
        t = t || i.aggr.sum, n = n || t.printer, this.totals = this.totals || new o;
        var r, a = this.rows;
        return this.totals.__cell(e, null, function (o, i) {
            return null != i ? n(r, i) : (r = a.reduce(function (n, r, o) {
                return t(n, r[e], o, a.length)
            }, null), n(r))
        }), this
    }, i.prototype.shift = "  ", i.prototype.print = function () {
        return a(this.rows, this.columns, this.shift)
    }, i.prototype.printTransposed = function (e) {
        function t(e, t) {
            var n = e.__printers && e.__printers[t];
            return n ?
            function (e) {
                return n(e)
            } : void 0
        }
        var n = new i;
        e && (n.shift = e);
        for (var r in this.columns) n.cell("h", r), this.rows.forEach(function (e, o) {
            n.cell("f" + o, e[r], t(e, r))
        }), n.newRow();
        return n.print()
    }, i.prototype.toString = function () {
        var e = i.RightPadder("-"),
            t = this.createRow(function () {
                return ["", e]
            }),
            n = this.createRow(function (e) {
                return [e]
            }),
            r = [n, t].concat(this.rows);
        return this.totals && (r = r.concat([t, this.totals])), a(r, this.columns, this.shift)
    }, i.prototype.createRow = function (e) {
        var t = new o;
        for (var n in this.columns) {
            var r = e(n);
            t.__cell(n, r[0], r[1])
        }
        return t
    }
}, function (e, t) {
    (function (t) {
        e.exports = t
    }).call(t, {})
}, function (e, t, n) {
    (function (e, r) {
        var o = n(134).nextTick,
            a = Array.prototype.slice,
            i = {},
            s = 0;
        "undefined" != typeof setTimeout && (t.setTimeout = function () {
            return setTimeout.apply(window, arguments)
        }), "undefined" != typeof clearTimeout && (t.clearTimeout = function () {
            clearTimeout.apply(window, arguments)
        }), "undefined" != typeof setInterval && (t.setInterval = function () {
            return setInterval.apply(window, arguments)
        }), "undefined" != typeof clearInterval && (t.clearInterval = function () {
            clearInterval.apply(window, arguments)
        }), t.enroll = function (e, t) {
            e._timeoutID = setTimeout(e._onTimeout, t)
        }, t.unenroll = function (e) {
            clearTimeout(e._timeoutID)
        }, t.active = function () {}, t.setImmediate = "function" == typeof e ? e : function (e) {
            var n = s++,
                r = arguments.length < 2 ? !1 : a.call(arguments, 1);
            return i[n] = !0, o(function () {
                i[n] && (r ? e.apply(null, r) : e.call(null), t.clearImmediate(n))
            }), n
        }, t.clearImmediate = "function" == typeof r ? r : function (e) {
            delete i[e]
        }
    }).call(t, n(105).setImmediate, n(105).clearImmediate)
}, function (e, t, n) {
    var r, o;
    (function (e) {
        /**
         * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
         * Released under the Apache License, Version 2.0
         * Derived from goog.math.Long from the Closure Library
         * see: https://github.com/dcodeIO/Long.js for details
         */
        !
        function (a) {
            "use strict";
            var i = function (e, t, n) {
                    e && "object" == typeof e && (t = e.high, n = e.unsigned, e = e.low), this.low = 0 | e, this.high = 0 | t, this.unsigned = !! n
                },
                s = {},
                c = {};
            i.fromInt = function (e, t) {
                var n, r;
                return t ? (e >>>= 0, e >= 0 && 256 > e && (r = c[e]) ? r : (n = new i(e, 0 > (0 | e) ? -1 : 0, !0), e >= 0 && 256 > e && (c[e] = n), n)) : (e = 0 | e, e >= -128 && 128 > e && (r = s[e]) ? r : (n = new i(e, 0 > e ? -1 : 0, !1), e >= -128 && 128 > e && (s[e] = n), n))
            }, i.fromNumber = function (e, t) {
                return t = !! t, isNaN(e) || !isFinite(e) ? i.ZERO : !t && -p >= e ? i.MIN_SIGNED_VALUE : t && 0 >= e ? i.MIN_UNSIGNED_VALUE : !t && e + 1 >= p ? i.MAX_SIGNED_VALUE : t && e >= d ? i.MAX_UNSIGNED_VALUE : 0 > e ? i.fromNumber(-e, !1).negate() : new i(e % l | 0, e / l | 0, t)
            }, i.fromBits = function (e, t, n) {
                return new i(e, t, n)
            }, i.from28Bits = function (e, t, n, r) {
                return i.fromBits(e | t << 28, t >>> 4 | n << 24, r)
            }, i.fromString = function (e, t, n) {
                if (0 == e.length) throw new Error("number format error: empty string");
                if ("NaN" === e || "Infinity" === e || "+Infinity" === e || "-Infinity" === e) return i.ZERO;
                if ("number" == typeof t && (n = t, t = !1), n = n || 10, 2 > n || n > 36) throw new Error("radix out of range: " + n);
                if ("-" == e.charAt(0)) return i.fromString(e.substring(1), t, n).negate();
                if (e.indexOf("-") >= 0) throw new Error('number format error: interior "-" character: ' + e);
                for (var r = i.fromNumber(Math.pow(n, 8)), o = i.ZERO, a = 0; a < e.length; a += 8) {
                    var s = Math.min(8, e.length - a),
                        c = parseInt(e.substring(a, a + s), n);
                    if (8 > s) {
                        var u = i.fromNumber(Math.pow(n, s));
                        o = o.multiply(u).add(i.fromNumber(c))
                    } else o = o.multiply(r), o = o.add(i.fromNumber(c))
                }
                return o.unsigned = t, o
            };
            var u = 65536,
                l = u * u,
                d = l * l,
                p = d / 2,
                h = i.fromInt(1 << 24);
            i.ZERO = i.fromInt(0), i.UZERO = i.fromInt(0, !0), i.ONE = i.fromInt(1), i.UONE = i.fromInt(1, !0), i.NEG_ONE = i.fromInt(-1), i.MAX_SIGNED_VALUE = i.fromBits(-1, 2147483647, !1), i.MAX_UNSIGNED_VALUE = i.fromBits(-1, -1, !0), i.MAX_VALUE = i.MAX_SIGNED_VALUE, i.MIN_SIGNED_VALUE = i.fromBits(0, -2147483648, !1), i.MIN_UNSIGNED_VALUE = i.fromBits(0, 0, !0), i.MIN_VALUE = i.MIN_SIGNED_VALUE, i.prototype.toInt = function () {
                return this.unsigned ? this.low >>> 0 : this.low
            }, i.prototype.toNumber = function () {
                return this.unsigned ? (this.high >>> 0) * l + (this.low >>> 0) : this.high * l + (this.low >>> 0)
            }, i.prototype.toString = function (e) {
                if (e = e || 10, 2 > e || e > 36) throw new Error("radix out of range: " + e);
                if (this.isZero()) return "0";
                var t;
                if (this.isNegative()) {
                    if (this.equals(i.MIN_SIGNED_VALUE)) {
                        var n = i.fromNumber(e),
                            r = this.div(n);
                        return t = r.multiply(n).subtract(this), r.toString(e) + t.toInt().toString(e)
                    }
                    return "-" + this.negate().toString(e)
                }
                var o = i.fromNumber(Math.pow(e, 6));
                t = this;
                for (var a = "";;) {
                    var s = t.div(o),
                        c = t.subtract(s.multiply(o)).toInt(),
                        u = c.toString(e);
                    if (t = s, t.isZero()) return u + a;
                    for (; u.length < 6;) u = "0" + u;
                    a = "" + u + a
                }
            }, i.prototype.getHighBits = function () {
                return this.high
            }, i.prototype.getHighBitsUnsigned = function () {
                return this.high >>> 0
            }, i.prototype.getLowBits = function () {
                return this.low
            }, i.prototype.getLowBitsUnsigned = function () {
                return this.low >>> 0
            }, i.prototype.getNumBitsAbs = function () {
                if (this.isNegative()) return this.equals(i.MIN_SIGNED_VALUE) ? 64 : this.negate().getNumBitsAbs();
                for (var e = 0 != this.high ? this.high : this.low, t = 31; t > 0 && 0 == (e & 1 << t); t--);
                return 0 != this.high ? t + 33 : t + 1
            }, i.prototype.isZero = function () {
                return 0 == this.high && 0 == this.low
            }, i.prototype.isNegative = function () {
                return !this.unsigned && this.high < 0
            }, i.prototype.isOdd = function () {
                return 1 == (1 & this.low)
            }, i.prototype.isEven = function () {
                return 0 == (1 & this.low)
            }, i.prototype.equals = function (e) {
                return this.unsigned != e.unsigned && this.high >>> 31 != e.high >>> 31 ? !1 : this.high == e.high && this.low == e.low
            }, i.prototype.notEquals = function (e) {
                return !this.equals(e)
            }, i.prototype.lessThan = function (e) {
                return this.compare(e) < 0
            }, i.prototype.lessThanOrEqual = function (e) {
                return this.compare(e) <= 0
            }, i.prototype.greaterThan = function (e) {
                return this.compare(e) > 0
            }, i.prototype.greaterThanOrEqual = function (e) {
                return this.compare(e) >= 0
            }, i.prototype.compare = function (e) {
                if (this.equals(e)) return 0;
                var t = this.isNegative(),
                    n = e.isNegative();
                return t && !n ? -1 : !t && n ? 1 : this.unsigned ? e.high >>> 0 > this.high >>> 0 || e.high == this.high && e.low >>> 0 > this.low >>> 0 ? -1 : 1 : this.subtract(e).isNegative() ? -1 : 1
            }, i.prototype.negate = function () {
                return !this.unsigned && this.equals(i.MIN_SIGNED_VALUE) ? i.MIN_SIGNED_VALUE : this.not().add(i.ONE)
            }, i.prototype.add = function (e) {
                var t = this.high >>> 16,
                    n = 65535 & this.high,
                    r = this.low >>> 16,
                    o = 65535 & this.low,
                    a = e.high >>> 16,
                    s = 65535 & e.high,
                    c = e.low >>> 16,
                    u = 65535 & e.low,
                    l = 0,
                    d = 0,
                    p = 0,
                    h = 0;
                return h += o + u, p += h >>> 16, h &= 65535, p += r + c, d += p >>> 16, p &= 65535, d += n + s, l += d >>> 16, d &= 65535, l += t + a, l &= 65535, i.fromBits(p << 16 | h, l << 16 | d, this.unsigned)
            }, i.prototype.subtract = function (e) {
                return this.add(e.negate())
            }, i.prototype.multiply = function (e) {
                if (this.isZero()) return i.ZERO;
                if (e.isZero()) return i.ZERO;
                if (this.equals(i.MIN_VALUE)) return e.isOdd() ? i.MIN_VALUE : i.ZERO;
                if (e.equals(i.MIN_VALUE)) return this.isOdd() ? i.MIN_VALUE : i.ZERO;
                if (this.isNegative()) return e.isNegative() ? this.negate().multiply(e.negate()) : this.negate().multiply(e).negate();
                if (e.isNegative()) return this.multiply(e.negate()).negate();
                if (this.lessThan(h) && e.lessThan(h)) return i.fromNumber(this.toNumber() * e.toNumber(), this.unsigned);
                var t = this.high >>> 16,
                    n = 65535 & this.high,
                    r = this.low >>> 16,
                    o = 65535 & this.low,
                    a = e.high >>> 16,
                    s = 65535 & e.high,
                    c = e.low >>> 16,
                    u = 65535 & e.low,
                    l = 0,
                    d = 0,
                    p = 0,
                    g = 0;
                return g += o * u, p += g >>> 16, g &= 65535, p += r * u, d += p >>> 16, p &= 65535, p += o * c, d += p >>> 16, p &= 65535, d += n * u, l += d >>> 16, d &= 65535, d += r * c, l += d >>> 16, d &= 65535, d += o * s, l += d >>> 16, d &= 65535, l += t * u + n * c + r * s + o * a, l &= 65535, i.fromBits(p << 16 | g, l << 16 | d, this.unsigned)
            }, i.prototype.div = function (e) {
                if (e.isZero()) throw new Error("division by zero");
                if (this.isZero()) return this.unsigned ? i.UZERO : i.ZERO;
                var t, n, r;
                if (this.equals(i.MIN_SIGNED_VALUE)) {
                    if (e.equals(i.ONE) || e.equals(i.NEG_ONE)) return i.MIN_SIGNED_VALUE;
                    if (e.equals(i.MIN_SIGNED_VALUE)) return i.ONE;
                    var o = this.shiftRight(1);
                    return t = o.div(e).shiftLeft(1), t.equals(i.ZERO) ? e.isNegative() ? i.ONE : i.NEG_ONE : (n = this.subtract(e.multiply(t)), r = t.add(n.div(e)))
                }
                if (e.equals(i.MIN_SIGNED_VALUE)) return this.unsigned ? i.UZERO : i.ZERO;
                if (this.isNegative()) return e.isNegative() ? this.negate().div(e.negate()) : this.negate().div(e).negate();
                if (e.isNegative()) return this.div(e.negate()).negate();
                for (r = i.ZERO, n = this; n.greaterThanOrEqual(e);) {
                    t = Math.max(1, Math.floor(n.toNumber() / e.toNumber()));
                    for (var a = Math.ceil(Math.log(t) / Math.LN2), s = 48 >= a ? 1 : Math.pow(2, a - 48), c = i.fromNumber(t, this.unsigned), u = c.multiply(e); u.isNegative() || u.greaterThan(n);) t -= s, c = i.fromNumber(t, this.unsigned), u = c.multiply(e);
                    c.isZero() && (c = i.ONE), r = r.add(c), n = n.subtract(u)
                }
                return r
            }, i.prototype.modulo = function (e) {
                return this.subtract(this.div(e).multiply(e))
            }, i.prototype.not = function () {
                return i.fromBits(~this.low, ~this.high, this.unsigned)
            }, i.prototype.and = function (e) {
                return i.fromBits(this.low & e.low, this.high & e.high, this.unsigned)
            }, i.prototype.or = function (e) {
                return i.fromBits(this.low | e.low, this.high | e.high, this.unsigned)
            }, i.prototype.xor = function (e) {
                return i.fromBits(this.low ^ e.low, this.high ^ e.high, this.unsigned)
            }, i.prototype.shiftLeft = function (e) {
                if (e &= 63, 0 == e) return this;
                var t = this.low;
                if (32 > e) {
                    var n = this.high;
                    return i.fromBits(t << e, n << e | t >>> 32 - e, this.unsigned)
                }
                return i.fromBits(0, t << e - 32, this.unsigned)
            }, i.prototype.shiftRight = function (e) {
                if (e &= 63, 0 == e) return this;
                var t = this.high;
                if (32 > e) {
                    var n = this.low;
                    return i.fromBits(n >>> e | t << 32 - e, t >> e, this.unsigned)
                }
                return i.fromBits(t >> e - 32, t >= 0 ? 0 : -1, this.unsigned)
            }, i.prototype.shiftRightUnsigned = function (e) {
                if (e &= 63, 0 == e) return this;
                var t = this.high;
                if (32 > e) {
                    var n = this.low;
                    return i.fromBits(n >>> e | t << 32 - e, t >>> e, this.unsigned)
                }
                return 32 == e ? i.fromBits(t, 0, this.unsigned) : i.fromBits(t >>> e - 32, 0, this.unsigned)
            }, i.prototype.toSigned = function () {
                var e = this.clone();
                return e.unsigned = !1, e
            }, i.prototype.toUnsigned = function () {
                var e = this.clone();
                return e.unsigned = !0, e
            }, i.prototype.clone = function () {
                return new i(this.low, this.high, this.unsigned)
            }, "undefined" != typeof e && e.exports ? e.exports = i : n(128).amd ? (r = [], o = function () {
                return i
            }.apply(t, r), !(void 0 !== o && (e.exports = o))) : (a.dcodeIO || (a.dcodeIO = {}), a.dcodeIO.Long = i)
        }(this)
    }).call(t, n(107)(e))
}, function (e) {
    e.exports = function (e) {
        return e.webpackPolyfill || (e.deprecate = function () {}, e.paths = [], e.children = [], e.webpackPolyfill = 1), e
    }
}, function (e) {
    function t() {}
    var n = e.exports = {};
    n.nextTick = function () {
        var e = "undefined" != typeof window && window.setImmediate,
            t = "undefined" != typeof window && window.MutationObserver,
            n = "undefined" != typeof window && window.postMessage && window.addEventListener;
        if (e) return function (e) {
            return window.setImmediate(e)
        };
        var r = [];
        if (t) {
            var o = document.createElement("div"),
                a = new MutationObserver(function () {
                    var e = r.slice();
                    r.length = 0, e.forEach(function (e) {
                        e()
                    })
                });
            return a.observe(o, {
                attributes: !0
            }), function (e) {
                r.length || o.setAttribute("yes", "no"), r.push(e)
            }
        }
        return n ? (window.addEventListener("message", function (e) {
            var t = e.source;
            if ((t === window || null === t) && "process-tick" === e.data && (e.stopPropagation(), r.length > 0)) {
                var n = r.shift();
                n()
            }
        }, !0), function (e) {
            r.push(e), window.postMessage("process-tick", "*")
        }) : function (e) {
            setTimeout(e, 0)
        }
    }(), n.title = "browser", n.browser = !0, n.env = {}, n.argv = [], n.on = t, n.addListener = t, n.once = t, n.off = t, n.removeListener = t, n.removeAllListeners = t, n.emit = t, n.binding = function () {
        throw new Error("process.binding is not supported")
    }, n.cwd = function () {
        return "/"
    }, n.chdir = function () {
        throw new Error("process.chdir is not supported")
    }
}, function (e) {
    var t = [.1, .82, .25, 1],
        n = [.69, 0, .79, .14],
        r = [.84, .07, .93, .46];
    Velocity.RegisterEffect("attach.Down", {
        defaultDuration: 300,
        calls: [
            [{
                opacity: [1, 0],
                translateY: ["0%", "-100%"],
                scaleX: [1, .3],
                scaleY: [1, .3]
            },
            1,
            {
                easing: [300, 22]
            }]
        ]
    }), Velocity.RegisterEffect("attach.Up", {
        defaultDuration: 300,
        easing: t,
        calls: [
            [{
                opacity: [0, 1],
                translateY: ["-200%", "0%"],
                scaleX: [.3, 1],
                scaleY: [.3, 1]
            },
            1,
            {
                easing: [300, 40]
            }]
        ]
    }), Velocity.RegisterEffect("dropdown.Down", {
        defaultDuration: 200,
        easing: t,
        calls: [
            [{
                opacity: [1, 0],
                translateY: ["0%", "-15px"]
            },
            1,
            {
                easing: t
            }]
        ]
    });
    var o = {
        pop: {
            duration: 200,
            easing: r,
            enter: {
                props: {
                    scaleX: [1, .5],
                    scaleY: [1, .5],
                    opacity: [1, 0]
                }
            },
            leave: {
                props: {
                    scaleX: [.5, 1],
                    scaleY: [.5, 1],
                    opacity: [0, 1]
                }
            }
        },
        scaleY: {
            duration: 200,
            easing: t,
            enter: {
                props: {
                    scaleY: [1, 0],
                    transformOrigin: "center"
                }
            },
            leave: {
                props: {
                    scaleY: [0, 1],
                    transformOrigin: "center"
                }
            }
        },
        scale: {
            duration: 500,
            easing: t,
            enter: {
                props: {
                    scaleX: [1, 0],
                    scaleY: [1, 0]
                }
            },
            leave: {
                props: {
                    scaleX: [0, 1],
                    scaleY: [0, 1]
                }
            }
        },
        fade: {
            duration: 200,
            easing: t,
            enter: {
                props: {
                    opacity: [1, 0]
                }
            },
            leave: {
                props: {
                    opacity: [0, 1]
                }
            }
        },
        fade_sifo: {
            enter: {
                props: {
                    opacity: [1, 0]
                },
                duration: 250
            },
            leave: {
                props: {
                    opacity: [0, 1]
                },
                duration: 100
            }
        },
        modal: {
            enter: [{
                props: {
                    opacity: [1, 0]
                },
                duration: 300,
                easing: "easeOut"
            }, {
                selector: ".popup",
                props: {
                    scaleX: [1, 0],
                    scaleY: [1, 0],
                    opacity: [1, 1]
                },
                easing: [.19, .73, .28, 1],
                delay: 180,
                duration: 200
            }, {
                selector: ".popup",
                props: {
                    opacity: [0, 0]
                },
                duration: 180
            }],
            leave: [{
                props: {
                    opacity: [0, 1]
                },
                duration: 300,
                easing: n,
                delay: 100
            }, {
                selector: ".popup",
                props: {
                    scaleX: [0, 1],
                    scaleY: [0, 1]
                },
                easing: n,
                duration: 200
            }]
        },
        "drawer-left": {
            enter: [{
                props: {
                    translateX: ["0%", "-100%"]
                },
                duration: 300,
                easing: t
            }, {
                selector: ".drawer-title",
                props: {
                    translateX: [0, -50],
                    opacity: [1, 0]
                },
                duration: 500,
                easing: "easeOut"
            }],
            leave: [{
                props: {
                    translateX: ["-100%", "0%"]
                },
                duration: 300,
                easing: n
            }]
        },
        dropdown: {
            duration: 300,
            easing: t,
            enter: [{
                selector: ".menu-item",
                props: "dropdown.Down",
                delay: 50,
                duration: 375,
                stagger: 25,
                drag: !0
            }, {
                props: {
                    scale: [1, 0]
                }
            }, {
                props: {
                    opacity: [1, 0]
                },
                duration: 100
            }],
            leave: {
                props: {
                    scaleX: [0, 1],
                    scaleY: [0, 1],
                    opacity: [0, 1]
                }
            }
        },
        "media-viewer": {
            duration: 500,
            easing: [.1, 1.03, .28, .99],
            enter: {
                selector: ".media-viewer",
                props: {
                    opacity: [1, 0]
                }
            },
            leave: {
                selector: ".media-viewer",
                props: {
                    opacity: [0, 1]
                }
            }
        },
        menu: {
            duration: 700,
            enter: {
                selector: ".menu-icons-item",
                props: "attach.Down",
                stagger: 30,
                drag: !0
            },
            leave: {
                selector: ".menu-icons-item",
                props: "attach.Up",
                stagger: 30,
                drag: !0
            }
        },
        emoji: {
            duration: 300,
            enter: {
                props: {
                    height: [234, t, 0]
                }
            },
            leave: {
                props: {
                    height: [0, t, 234]
                }
            }
        },
        ptt: {
            enter: [{
                selector: ".btn-border",
                easing: "easeInOut",
                props: {
                    scaleX: [1, .5],
                    scaleY: [1, .5],
                    opacity: [1, 0]
                },
                duration: 250,
                delay: 100
            }, {
                selector: ".ptt-counter",
                easing: "easeInOut",
                props: {
                    scaleX: [1, .8],
                    scaleY: [1, .8],
                    opacity: [1, 0]
                },
                duration: 250,
                delay: 100
            }, {
                props: {
                    opacity: [1, 0]
                },
                duration: 150,
                easing: t
            }],
            leave: [{
                selector: ".btn-border",
                easing: t,
                props: {
                    scaleX: [.5, 1],
                    scaleY: [.5, 1],
                    opacity: [0, 1]
                },
                duration: 250
            }, {
                selector: ".ptt-counter",
                easing: t,
                props: {
                    scaleX: [.5, 1],
                    scaleY: [.5, 1],
                    opacity: [0, 1]
                },
                duration: 250
            }, {
                props: {
                    opacity: [0, 1]
                },
                duration: 300,
                easing: t
            }]
        },
        "slide-left": {
            duration: 300,
            easing: t,
            enter: {
                props: {
                    translateX: ["0%", "100%"]
                }
            },
            leave: {
                props: {
                    translateX: ["100%", "0%"]
                }
            }
        },
        "slide-forward": {
            duration: 200,
            easing: [.19, .93, .18, .99],
            enter: {
                props: {
                    translateX: ["0%", "100%"]
                }
            },
            leave: {
                props: {
                    translateX: ["-100%", "0%"]
                }
            }
        },
        "slide-back": {
            duration: 200,
            easing: [.19, .93, .18, .99],
            enter: {
                props: {
                    translateX: ["0%", "-100%"]
                }
            },
            leave: {
                props: {
                    translateX: ["100%", "0%"]
                }
            }
        },
        "slide-up-down": {
            duration: 300,
            easing: t,
            enter: {
                props: {
                    translateY: ["0%", "100%"]
                }
            },
            leave: {
                props: {
                    translateY: ["100%", "0%"]
                }
            }
        },
        "slide-up": {
            duration: 300,
            easing: t,
            enter: {
                props: {
                    translateY: ["0%", "100%"]
                }
            },
            leave: {
                props: {
                    translateY: ["100%", "0%"]
                }
            }
        },
        "slide-down": {
            duration: 300,
            easing: t,
            enter: {
                props: {
                    translateY: ["0%", "100%"]
                }
            },
            leave: {
                props: {
                    translateY: ["100%", "0%"]
                }
            }
        },
        none: {},
        btn: {
            duration: 300,
            easing: t,
            enter: {
                props: {
                    scale: [1, 0],
                    opacity: [1, 0]
                }
            },
            leave: {
                props: {
                    scale: [0, 1],
                    opacity: [0, 1]
                }
            }
        },
        pop_delay: {
            duration: 300,
            enter: {
                props: "transition.expandIn"
            },
            leave: {
                props: "transition.expandOut"
            }
        },
        "media-scale": {
            duration: 500,
            easing: t,
            enter: {
                props: "transition.expandIn"
            },
            leave: {
                props: "transition.expandOut"
            }
        },
        "default": {
            duration: 300,
            enter: {
                props: {
                    opacity: [1, 0]
                }
            },
            leave: {
                props: {
                    opacity: [0, 1]
                }
            }
        }
    };
    e.exports = o
}, function (e, t, n) {
    var r = n(33),
        o = {
            getInitialState: function () {
                return this._asyncs = {}, {}
            },
            async: function (e, t, n) {
                var o = e.split(".");
                t = t || this.props;
                var a = this._getAsyncIndex(o),
                    i = t[o[0]],
                    s = a > 1 ? i.getp(o.slice(1, a).join(".")) : i;
                if (!s) throw new Error("async base did not resolve to a value");
                var c, u, l = _.isString(s) ? s : s.getp("id"),
                    d = this._getKeyPath(o);
                if (a > 0 ? (c = Store[o[a]], u = c.get(l)) : (u = s, c = u.getCollection()), !u) return Wa.debug("Non-existing state in AsyncMixin!", "red", {
                    baseId: l,
                    key: e
                });
                if (c.isStateStale(l)) {
                    var p = this;
                    if (n) {
                        var h;
                        (this._waAsyncTimers || (this._waAsyncTimers = [])).push(h = _.delay(function () {
                            p._waAsyncTimers = _.without(p._waAsyncTimers, h), c.find(l)["catch"](r.WapDrop, _.noop)
                        }, n))
                    } else c.find(l)["catch"](r.WapDrop, _.noop)
                }
                return this._addObserver(u, e, s), u.getp(d)
            },
            componentWillReceiveProps: function (e) {
                var t = this._asyncs;
                for (var n in e) {
                    var r = t[n];
                    if (r) for (var o in r) {
                        var a = r[o];
                        if (a.base !== e[n]) {
                            var i = o.split("."),
                                s = this._getObserverKeyPath(i),
                                c = this._getStateKey(i),
                                u = a.object,
                                l = a.callback,
                                d = a.context;
                            u.off("change:" + s, l, d), u.isState && u._uiObservers--;
                            var p = {};
                            p[c] = this.async(o, e), this.setState(p)
                        }
                    }
                }
            },
            componentWillUnmount: function () {
                this._waAsyncUnmount = !0, this._waAsyncTimers && (this._waAsyncTimers.forEach(clearTimeout), delete this._waAsyncTimers);
                var e = this._asyncs;
                for (var t in e) for (var n in e[t]) {
                    var r = this._getObserverKeyPath(n.split(".")),
                        o = e[t][n].object,
                        a = e[t][n].callback,
                        i = e[t][n].context;
                    o.off("change:" + r, a, i), o.isState && o._uiObservers--
                }
            },
            _addObserver: function (e, t, n) {
                var r = t.split("."),
                    o = this._getKeyPath(r),
                    a = this._getObserverKeyPath(r),
                    i = this._asyncs,
                    s = function () {
                        if (this.isMounted()) {
                            var t = {};
                            t[this._getStateKey(r)] = e.getp(o), this.setState(t)
                        }
                    };
                i[r[0]] = i[r[0]] || {}, i[r[0]][t] = {
                    object: e,
                    base: n,
                    callback: s,
                    context: this
                }, e.on("change:" + a, s, this), e.isState && e._uiObservers++
            },
            _getStateKey: function (e) {
                return e[e.length - 1]
            },
            _getKeyPath: function (e) {
                for (var t = e.length, n = 0; n < e.length; n++) if (0 === e.indexOf("@")) {
                    t = n;
                    break
                }
                var r = this._getAsyncIndex(e);
                return e.slice(r + 1, t).join(".")
            },
            _getObserverKeyPath: function (e) {
                var t = this._getAsyncIndex(e);
                return e.slice(t + 1).join(".")
            },
            _getAsyncIndex: function (e) {
                for (var t = 0, n = 1; n < e.length; n++) if (e[n].charAt(0).toLowerCase() !== e[n].charAt(0)) {
                    t = n;
                    break
                }
                return t
            }
        };
    e.exports = o
}, function (e, t, n) {
    var r = n(30),
        o = n(83),
        a = n(87),
        i = n(152),
        s = n(153),
        c = n(138),
        u = n(154),
        l = n(155),
        d = n(2),
        p = n(88),
        h = n(156),
        g = n(157),
        f = n(31),
        m = (n(29), n(33), n(110)),
        b = (n(158), n(159)),
        y = (n(160), n(78)),
        _ = "global_mute",
        A = React.createClass({
            displayName: "ChatlistHeader",
            mixins: [m],
            getDefaultProps: function () {
                return {
                    muteId: _
                }
            },
            getInitialState: function () {
                return Store.Mute.globalMute(), {
                    isMuted: this.async("muteId.Mute.isMuted")
                }
            },
            onNewChat: function () {
                f.openDrawer(React.createElement(u, null), a.DRAWER_LEFT)
            },
            onProfile: function () {
                f.openDrawer(React.createElement(i, {
                    id: Wa.me
                }), a.DRAWER_LEFT)
            },
            onUnmute: function () {
                Store.Mute.globalMute().unmute(), f.globalUnmute()
            },
            render: function () {
                var e = (this.onClick, null);
                return this.state.isMuted && (e = React.createElement(b.MenuBarItem, {
                    icon: "dnd",
                    title: l10n.t("global_unmute"),
                    onClick: this.onUnmute,
                    key: "btn-dnd"
                })), React.createElement("header", {
                    className: "pane-header pane-list-header"
                }, React.createElement("div", {
                    className: "pane-list-user"
                }, React.createElement(g, {
                    id: Wa.me,
                    onClick: this.onProfile
                })), React.createElement("div", {
                    className: "pane-list-controls"
                }, React.createElement(b.MenuBar, {
                    key: "chatlist-header"
                }, React.createElement(y, {
                    transitionName: "btn"
                }, e, React.createElement(b.MenuBarItem, {
                    icon: "chat",
                    title: l10n.t("web_menuitem_new"),
                    onClick: this.onNewChat
                }), React.createElement(b.MenuBarItem, {
                    icon: "menu",
                    title: l10n.t("menutitle_menu")
                }, React.createElement(E, null))))))
            }
        });
    e.exports = A;
    var E = React.createClass({
        displayName: "ChatlistHeaderDropdown",
        getInitialState: function () {
            return {
                rememberMe: d.getRememberMe()
            }
        },
        onCreateGroup: function () {
            f.openDrawer(React.createElement(l, null), a.DRAWER_LEFT)
        },
        onProfile: function () {
            f.openDrawer(React.createElement(i, {
                id: Wa.me
            }), a.DRAWER_LEFT)
        },
        onHelp: function () {
            Wa.uploadLogs("help-page-opened");
            var e, t, n = Store.Conn.at(0);
            switch (n && (e = n.platform), e = e || "unknown") {
            case o.PLATFORMS.ANDROID:
                t = l10n.t("guide_help_description_android");
                break;
            case o.PLATFORMS.BB:
                t = l10n.t("guide_help_description_bb");
                break;
            case o.PLATFORMS.BBX:
                t = l10n.t("guide_help_description_bbx");
                break;
            case o.PLATFORMS.WP7:
                t = l10n.t("guide_help_description_wp7");
                break;
            case o.PLATFORMS.SYMBIAN:
                t = l10n.t("guide_help_description_symbian");
                break;
            case o.PLATFORMS.S40:
                t = l10n.t("guide_help_description_s40");
                break;
            default:
                Wa.debug("unknown platform: " + e)
            }
            var r = function () {
                    f.closeModal(), window.open("http://www.whatsapp.com/faq/web", "_blank")
                };
            f.openModal(React.createElement(c, {
                title: l10n.t("guide_help_title"),
                onOK: f.closeModal.bind(f),
                okText: l10n.t("ok_got_it"),
                onCancel: r,
                cancelText: l10n.t("web_settings_faq")
            }, l10n.t("guide_help_faq"), " ", t))
        },
        onUploadLogs: function () {
            Wa.uploadLogs()
        },
        onDisconnect: function () {
            r.logout()
        },
        onNotifications: function () {
            f.openModal(React.createElement(s, null))
        },
        render: function () {
            return React.createElement(p, {
                type: p.DROPDOWN,
                direction: "left down"
            }, React.createElement(h, {
                action: this.onProfile
            }, l10n.t("menuitem_profile_status")), React.createElement(h, {
                action: this.onNotifications
            }, l10n.t("menuitem_notifications")), React.createElement(h, {
                action: this.onHelp
            }, l10n.t("menuitem_help")), React.createElement(h, {
                action: this.onDisconnect,
                shortcut: "q"
            }, l10n.t("menuitem_logout")))
        }
    })
}, function (e, t, n) {
    var r = n(79),
        o = n(87),
        a = n(78),
        i = React.createClass({
            displayName: "ChatlistSearch",
            mixins: [r],
            propTypes: {
                searchText: React.PropTypes.string.isRequired,
                searchType: React.PropTypes.oneOf(["chatlist", "contact"]).isRequired,
                onSearch: React.PropTypes.func.isRequired
            },
            statics: {
                CHATLIST: "chatlist",
                CONTACT: "contact"
            },
            getInitialState: function () {
                return {
                    isSearching: !1
                }
            },
            componentWillUnmount: function () {
                this.onCancel()
            },
            onBlur: function () {
                this.props.searchText || this.onCancel()
            },
            onChange: function (e) {
                this.props.onSearch(e.target.value)
            },
            onCancel: function () {
                o.pop(this.props.searchType)
            },
            onReset: function (e) {
                e.stopPropagation(), this.focus(), this.props.onSearch("")
            },
            onSearchOn: function () {
                this.setState({
                    isSearching: !0
                }), o.push(this, this.props.searchType), this.safeDefer(function () {
                    this.refs.input.getDOMNode().focus()
                })
            },
            focus: function () {
                this.refs.input.getDOMNode().focus()
            },
            close: function () {
                this.safeIsMounted() && (this.refs.input.getDOMNode().blur(), this.props.onSearch(""), this.setState({
                    isSearching: !1
                }))
            },
            render: function () {
                var e = "pane-subheader pane-list-subheader subheader-search";
                this.state.isSearching && (e += " active");
                var t = null;
                return this.state.isSearching && (_.isEmpty(this.props.searchText) || (t = React.createElement("button", {
                    className: "icon icon-x-alt",
                    key: "icon-clear-search",
                    onClick: this.onReset
                }))), React.createElement("div", {
                    className: e
                }, React.createElement("button", {
                    className: "icon icon-search-morph",
                    onMouseDown: this.state.isSearching ? this.onCancel : this.onSearchOn
                }, React.createElement("div", {
                    className: "icon icon-back-blue"
                }), React.createElement("div", {
                    className: "icon icon-search"
                })), React.createElement(a, {
                    transitionName: "pop"
                }, t), React.createElement("label", {
                    htmlFor: "input-chatlist-search",
                    className: "cont-input-search"
                }, React.createElement("div", {
                    className: "input-placeholder"
                }, l10n.t("search_or_start_new_chat")), React.createElement("input", {
                    type: "text",
                    ref: "input",
                    className: "input input-search",
                    tabIndex: 2,
                    value: this.props.searchText,
                    onBlur: this.onBlur,
                    onFocus: this.state.isSearching ? null : this.onSearchOn,
                    onChange: this.onChange
                })))
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(161),
        o = n(162).Chat,
        a = n(163).Contact,
        i = n(31),
        s = n(164),
        c = React.createClass({
            displayName: "Chatlist",
            propTypes: {
                isSearching: React.PropTypes.bool,
                chats: React.PropTypes.array,
                contacts: React.PropTypes.array
            },
            getDefaultProps: function () {
                return {
                    chats: []
                }
            },
            uniqueKey: function (e) {
                return "chatlist-" + Wa.widToKey(e)
            },
            getList: function () {
                for (var e = this.props.chats, t = this.props.contacts, n = [], r = 0; r < e.length; r++) e[r] && (this.props.isSearching && 0 === r && t.length && n.push(React.createElement(s, {
                    key: "chat-header",
                    header: l10n.t("web_chats")
                })), n.push(React.createElement(o, {
                    chat: e[r],
                    asyncDelay: 500,
                    cursor: 0 === r && this.props.isSearching,
                    key: this.uniqueKey(e[r].get("id"))
                })));
                for (var i = 0; i < t.length; i++) t[i] && (0 === i && n.push(React.createElement(s, {
                    key: "contact-header",
                    header: l10n.t("web_contacts")
                })), t[i] && n.push(React.createElement(a, {
                    contact: t[i],
                    cursor: 0 === r && 0 === i,
                    asyncDelay: 500,
                    onControl: this.onContactClick,
                    controls: a.Controls.clickable,
                    key: this.uniqueKey(t[i].get("id"))
                })));
                return n
            },
            onContactClick: function (e, t) {
                Store.Chat.find(t.id).then(function (e) {
                    i.openChat(e)
                })
            },
            render: function () {
                return React.createElement(r, {
                    scrollTarget: 1,
                    classes: ["chatlist"],
                    data: this.getList(),
                    height: 72,
                    extraItems: 6
                })
            }
        });
    e.exports = c
}, function (e) {
    var t = React.createClass({
        displayName: "ChatlistEmpty",
        propTypes: {
            state: React.PropTypes.string
        },
        statics: {
            EMPTY_LIST: "nochats",
            EMPTY_SEARCH: "nosearch",
            ALL_ARCHIVED: "allarchived",
            LOADING: "loading"
        },
        render: function () {
            var e = "",
                n = "";
            switch (this.props.state) {
            case t.EMPTY_LIST:
                n = "msg-search-notfound", e = l10n.t("no_chats");
                break;
            case t.EMPTY_SEARCH:
                n = "msg-search-notfound", e = l10n.t("search_no_chats_or_contacts");
                break;
            case t.ALL_ARCHIVED:
                n = "msg-search-notfound", e = l10n.t("all_chats_archived");
                break;
            case t.LOADING:
                n = "loading", e = ""
            }
            return React.createElement("div", {
                className: n
            }, e)
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = n(30),
        o = n(43),
        a = n(47),
        a = n(47),
        i = n(46),
        s = n(79),
        c = n(26),
        u = n(31),
        c = (n(83), n(26)),
        l = n(165),
        d = React.createClass({
            displayName: "ButterBar",
            mixins: [a, i],
            componentWillMount: function () {
                this.addObserver(o, "change:displayInfo"), this.addObserver(o, "change:needsUpdate")
            },
            onReload: function () {
                Wa.hardRefresh()
            },
            render: function () {
                var e, t, n;
                switch (o.needsUpdate && (e = React.createElement(p, {
                    type: "update",
                    title: l10n.t("update_available"),
                    text: l10n.t("click_to_update_whatsapp_web"),
                    action: this.onReload
                })), o.displayInfo) {
                case o.INFO.OFFLINE:
                    n = React.createElement(p, {
                        type: "computer",
                        title: l10n.t("computer_not_connected"),
                        text: l10n.t("make_sure_computer_active_internet_connection")
                    });
                    break;
                case o.INFO.OPENING:
                case o.INFO.CONNECTING:
                    n = React.createElement(f, null);
                    break;
                case o.INFO.NORMAL:
                    n = null;
                    break;
                case o.INFO.RESUMING:
                case o.INFO.TIMEOUT:
                    var r = window.open.bind(window, "http://www.whatsapp.com/faq/web/28080002", "_blank"),
                        a = React.createElement("span", null, l10n.t("make_sure_phone_active_internet_connection"), " ", React.createElement("span", {
                            className: "action",
                            onClick: r
                        }, l10n.t("learn_more")));
                    n = React.createElement(p, {
                        type: "phone",
                        title: l10n.t("phone_not_connected"),
                        text: a
                    })
                }
                var i = window.Notification ? React.createElement(g, null) : null;
                return React.createElement("div", {
                    className: "butterbar-container"
                }, i, e, t, n, n ? null : React.createElement(h, null))
            }
        }),
        p = React.createClass({
            displayName: "BB",
            propTypes: {
                type: React.PropTypes.oneOf(["computer", "phone", "notification", "battery", "update"]),
                title: React.PropTypes.node.isRequired,
                text: React.PropTypes.node,
                dismissable: React.PropTypes.bool,
                onDismiss: React.PropTypes.func,
                action: React.PropTypes.func
            },
            onClick: function () {
                this.props.action && this.props.action()
            },
            render: function () {
                var e, t, n = {
                    butterbar: !0
                },
                    r = {
                        icon: !0,
                        "icon-alert": !0
                    };
                switch (this.props.type) {
                case "computer":
                case "phone":
                case "notification":
                case "battery":
                case "update":
                    e = "butterbar-" + this.props.type, t = "icon-alert-" + this.props.type;
                    break;
                default:
                    Wa.debug("Invalid butterbar type")
                }
                e && (n[e] = r[t] = !0), this.props.action && (n.action = !0);
                var o = React.addons.classSet,
                    a = this.props.dismissable ? React.createElement("div", {
                        className: "butterbar-controls"
                    }, React.createElement("button", {
                        className: "icon icon-x-light",
                        onClick: this.props.onDismiss
                    })) : null,
                    i = this.props.text ? React.createElement("div", {
                        className: "butterbar-text"
                    }, this.props.text) : null;
                return React.createElement("div", {
                    className: o(n),
                    onClick: this.onClick
                }, React.createElement("div", {
                    className: "butterbar-icon"
                }, React.createElement("span", {
                    className: o(r)
                })), React.createElement("div", {
                    className: "butterbar-body"
                }, React.createElement("div", {
                    className: "butterbar-title"
                }, this.props.title), i), a)
            }
        }),
        h = React.createClass({
            displayName: "Battery",
            mixins: [a],
            getInitialState: function () {
                return {
                    lowBatteryWarning: Store.Conn.get(1).isBatteryLow
                }
            },
            componentWillMount: function () {
                this.addObserver(Store.Conn.get(1), "change:battery", this.batteryUpdate), this.addObserver(Store.Conn.get(1), "change:isBatteryLow", this.onBatteryLowChange)
            },
            onBatteryLowChange: function () {
                this.setState({
                    lowBatteryWarning: Store.Conn.get(1).isBatteryLow
                })
            },
            batteryUpdate: function () {
                var e = Store.Conn.get(1);
                e.plugged || (e.battery === c.BATTERY_LOW_THRESHOLD_1 || e.battery === c.BATTERY_LOW_THRESHOLD_2) && this.setState({
                    lowBatteryWarning: !0
                })
            },
            cancelLowBatteryWarning: function () {
                this.setState({
                    lowBatteryWarning: !1
                })
            },
            render: function () {
                return this.state.lowBatteryWarning ? React.createElement(p, {
                    type: "battery",
                    title: l10n.t("phone_battery_low"),
                    text: l10n.t("charge_phone_description"),
                    dismissable: !0,
                    onDismiss: this.cancelLowBatteryWarning
                }) : null
            }
        }),
        g = React.createClass({
            displayName: "Notification",
            getInitialState: function () {
                return {
                    permission: window.Notification.permission
                }
            },
            guideConfirm: function () {
                u.closeModal()
            },
            guideLearnMore: function () {
                switch (Wa.getBrowserType()) {
                case c.BROWSER_TYPE.CHROME:
                    return window.open("http://www.whatsapp.com/faq/web/28080004", "_blank");
                case c.BROWSER_TYPE.FIREFOX:
                    return window.open("http://www.whatsapp.com/faq/web/28080006", "_blank");
                case c.BROWSER_TYPE.OPERA:
                    return window.open("http://www.whatsapp.com/faq/web/28080007", "_blank");
                default:
                    return window.open("http://www.whatsapp.com/faq/web/28080004", "_blank")
                }
            },
            requestPermissions: function () {
                u.openModal(React.createElement(l, {
                    title: "guide_desktop_notifications_title",
                    desc: "guide_desktop_notifications_description",
                    onConfirm: this.guideConfirm,
                    onCancel: this.guideLearnMore,
                    type: l.GUIDE_ALLOW
                }));
                var e = this;
                window.Notification.requestPermission(function (t) {
                    u.closeModal(), e.setState({
                        permission: t
                    })
                })
            },
            render: function () {
                if (this.state.permission !== c.PERMISSION_DEFAULT) return null;
                var e = React.createElement("span", {
                    className: "action",
                    onClick: this.requestPermissions
                }, l10n.t("enable_desktop_notifications"));
                return React.createElement(p, {
                    type: "notification",
                    title: l10n.t("get_notified_of_new_messages"),
                    text: e
                })
            }
        }),
        f = React.createClass({
            displayName: "Resume",
            mixins: [s, a],
            getInitialState: function () {
                return {
                    takingTooLong: !1,
                    didShowSubtitle: !1
                }
            },
            componentWillMount: function () {
                this.addObserver(r, "change:state", this.onProgress), this.addObserver(r, "change:retryTimestamp", this.onProgress)
            },
            onProgress: function () {
                this.clearSafeInterval(this.interval), delete this.interval, this.startTimeout(), this.setState({
                    takingTooLong: !1
                })
            },
            componentDidMount: function () {
                this.startTimeout()
            },
            startTimeout: function () {
                this.safeDelay(this.connectTimeout, 3e3)
            },
            connectTimeout: function () {
                this.interval = this.safeInterval(this.timeoutTick, 1e3), this.setState({
                    takingTooLong: !0,
                    didShowSubtitle: !0
                })
            },
            timeoutTick: function () {
                this.setState({
                    now: Date.now()
                })
            },
            retry: function () {
                r.poke(), this.onProgress()
            },
            cancel: function () {
                r.logout()
            },
            render: function () {
                var e, t;
                if (o.displayInfo === o.INFO.OPENING ? e = l10n.t("connecting_to_whatsapp") : o.displayInfo === o.INFO.CONNECTING && (e = l10n.t("connecting_to_whatsapp_or_phone")), this.state.takingTooLong) {
                    var n = r.retryTimestamp - Date.now();
                    if (6e4 > n) {
                        var a = Math.ceil(n / 1e3);
                        n = l10n.t("retrying_in_some_seconds", {
                            number: a,
                            _plural: a
                        })
                    } else n = l10n.t("retrying_in", {
                        duration: moment.duration(n).humanize()
                    });
                    t = React.createElement("span", null, n, React.createElement("span", {
                        className: "action",
                        onClick: this.retry
                    }, l10n.t("retry_now")))
                } else t = this.state.didShowSubtitle ? React.createElement("span", null, l10n.t("retrying")) : null;
                return React.createElement(p, {
                    type: "phone",
                    title: e,
                    text: t
                })
            }
        });
    e.exports = d
}, function (e, t, n) {
    var r = (n(31), n(46)),
        o = n(79),
        a = n(78),
        i = React.createClass({
            displayName: "Toaster",
            mixins: [r, o],
            getInitialState: function () {
                return this.debouncedDismiss = this.safeDebounce(this.dismiss, 5e3), {
                    toast: null
                }
            },
            componentWillMount: function () {
                this.regCmd("chat_delete", this.onChatDelete), this.regCmd("chat_mute", this.onChatMute), this.regCmd("chat_archive", this.onChatArchive), this.regCmd("global_unmute", this.onGlobalUnmute), this.regCmd("global_mute", this.onGlobalMute)
            },
            toast: function (e) {
                this.setState({
                    toast: e
                }), this.debouncedDismiss()
            },
            dismiss: function () {
                this.setState({
                    toast: null
                })
            },
            onChatDelete: function (e) {
                var t;
                e.isUser ? t = l10n.t("conversation_deleted") : e.isBroadcast ? t = l10n.t("broadcast_deleted") : e.isGroup && (t = l10n.t("group_deleted")), this.toast(React.createElement("div", {
                    className: "toast"
                }, t, React.createElement("button", {
                    className: "icon icon-x-alt",
                    onClick: this.dismiss
                })))
            },
            globalMuteDurationLabel: function (e) {
                switch (e) {
                case 1:
                    return l10n.t("global_muted_1hour");
                case 24:
                    return l10n.t("global_muted_1day");
                case 168:
                    return l10n.t("global_muted_1week");
                default:
                    return Wa.debug("non standard global mute duration:" + e), l10n.t("global_muted")
                }
            },
            onGlobalMute: function (e) {
                this.toast(React.createElement("div", {
                    className: "toast"
                }, React.createElement("span", null, this.globalMuteDurationLabel(e)), React.createElement("button", {
                    className: "icon icon-x-alt",
                    onClick: this.dismiss
                })))
            },
            onGlobalUnmute: function () {
                this.toast(React.createElement("div", {
                    className: "toast"
                }, React.createElement("span", null, l10n.t("global_unmuted")), React.createElement("button", {
                    className: "icon icon-x-alt",
                    onClick: this.dismiss
                })))
            },
            onChatMute: function (e) {
                var t = this,
                    n = function () {
                        t.dismiss(), e.mute.unmute()
                    };
                this.toast(React.createElement("div", {
                    className: "toast"
                }, React.createElement("span", null, l10n.t("group_muted")), React.createElement("span", {
                    className: "action",
                    onClick: n
                }, l10n.t("web_undo")), React.createElement("button", {
                    className: "icon icon-x-alt",
                    onClick: this.dismiss
                })))
            },
            onChatArchive: function (e) {
                if (e.archive) {
                    var t, n = this,
                        r = function () {
                            n.dismiss(), e.setArchive(!1)
                        };
                    e.isUser ? t = l10n.t("conversation_archived") : e.isBroadcast ? t = l10n.t("broadcast_archived") : e.isGroup && (t = l10n.t("group_archived")), this.toast(React.createElement("div", {
                        className: "toast"
                    }, t)), this.toast(React.createElement("div", {
                        className: "toast"
                    }, React.createElement("span", null, t), React.createElement("span", {
                        className: "action",
                        onClick: r
                    }, l10n.t("web_undo")), React.createElement("button", {
                        className: "icon icon-x-alt",
                        onClick: this.dismiss
                    })))
                }
            },
            render: function () {
                return React.createElement(a, {
                    transitionName: "slide-up-down"
                }, this.state.toast)
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(110),
        o = n(48),
        a = (n(47), n(87)),
        i = n(94),
        s = n(166),
        c = n(167),
        u = n(157),
        l = n(168),
        d = n(120),
        p = n(169),
        h = n(170),
        g = n(171),
        f = n(172),
        m = n(173),
        b = n(31),
        y = n(165),
        A = n(33),
        E = n(159),
        v = n(88),
        N = n(156),
        a = n(87),
        C = n(174),
        S = n(175),
        R = React.createClass({
            displayName: "ConversationHeader",
            mixins: [r, o],
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            statics: {
                ATTACH_MEDIA_ACTIVE: "attach_media_active",
                GROUP_CHAT_ACTIVE: "group_chat_active"
            },
            getInitialState: function () {
                return {
                    img: this.async("chat.ProfilePicThumb.img"),
                    formattedTitle: this.async("chat.formattedTitle"),
                    activeDropdown: void 0
                }
            },
            toggleInfo: function () {
                if (a.isOpen(a.DRAWER_RIGHT) > 0) return void b.closeDrawer();
                var e = this.props.chat;
                e.isUser ? b.openDrawer(React.createElement(h, {
                    contact: e.contact
                }), a.DRAWER_RIGHT, "slide-left") : e.isBroadcast ? b.openDrawer(React.createElement(f, {
                    chat: e
                }), a.DRAWER_RIGHT, "slide-left") : e.isGroup && b.openDrawer(React.createElement(g, {
                    chat: e
                }), a.DRAWER_RIGHT, "slide-left")
            },
            render: function () {
                var e, t, n = this.props.chat;
                return n.isUser ? (e = React.createElement(D, {
                    chat: n
                }), t = React.createElement(c, {
                    presence: n.presence,
                    placeholder: l10n.t("click_here_for_user_info"),
                    location: "title"
                })) : n.isBroadcast ? (e = React.createElement(F, {
                    chat: n
                }), t = null) : n.isGroup && (e = React.createElement(T, {
                    chat: n
                }), t = React.createElement(s, {
                    presence: n.presence,
                    groupMetadata: n.groupMetadata,
                    placeholder: l10n.t("click_here_for_group_info"),
                    location: "title"
                })), React.createElement("header", {
                    className: "pane-header pane-chat-header"
                }, React.createElement("div", {
                    className: "chat-avatar",
                    onClick: this.toggleInfo
                }, React.createElement(u, {
                    id: n.id
                })), React.createElement("div", {
                    className: "chat-body",
                    onClick: this.toggleInfo
                }, React.createElement("div", {
                    className: "chat-main"
                }, React.createElement("h2", {
                    className: "chat-title"
                }, React.createElement(l, {
                    text: this.state.formattedTitle,
                    titlify: !0,
                    ellipsify: !0
                }))), t), React.createElement("div", {
                    className: "pane-chat-controls"
                }, React.createElement(E.MenuBar, {
                    key: "conversation-header"
                }, React.createElement(E.MenuBarItem, {
                    icon: "clip",
                    title: l10n.t("menutitle_attach"),
                    transitionName: "menu"
                }, React.createElement(w, {
                    chat: n
                })), React.createElement(E.MenuBarItem, {
                    icon: "menu",
                    title: l10n.t("menutitle_menu")
                }, e))))
            }
        }),
        w = React.createClass({
            displayName: "AttachMenuDropdown",
            mixins: [o],
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            onClick: function () {
                a.pop()
            },
            stopPropagation: function (e) {
                e.stopPropagation()
            },
            onImageClick: function (e) {
                e.stopPropagation();
                var t = this.refs.input.getDOMNode();
                t.click()
            },
            onFilePick: function (e) {
                e.stopPropagation();
                for (var t = e.target.files, n = [], r = 0; r < t.length; r++) n.push(t[r]);
                e.target.value = "", a.pop(a.MENU), b.openDrawer(React.createElement(d, {
                    files: n,
                    chat: this.props.chat
                }), a.DRAWER_MID, "slide-up")
            },
            guideConfirm: function () {
                b.closeModal()
            },
            onCaptureClick: function () {
                a.pop(a.MENU);
                var e = this.props.chat,
                    t = new Promise(function (n, r) {
                        navigator.getUserMedia({
                            video: !0
                        }, function (r) {
                            b.closeModal(), n(r), t.isResolved() && b.openDrawer(React.createElement(p, {
                                chat: e,
                                stream: r
                            }), a.DRAWER_MID, "slide-up")
                        }, function (e) {
                            var n = _.isString(e) ? e : e.name,
                                o = A.GUM[n] || A.GUM.GUMError;
                            r(new o), t && t.isResolved() && b.closeModal()
                        })
                    }).bind(this).timeout(1e3).then(function (t) {
                        b.openDrawer(React.createElement(p, {
                            chat: e,
                            stream: t
                        }), a.DRAWER_MID, "slide-up")
                    })["catch"](Promise.TimeoutError, function () {
                        b.openModal(React.createElement(y, {
                            title: "guide_desktop_camera_title",
                            desc: "guide_desktop_camera_description",
                            type: y.GUIDE_ALLOW
                        }))
                    })["catch"](A.GUM.PermissionDeniedError, function () {
                        b.openModal(React.createElement(y, {
                            title: "guide_desktop_camera_title",
                            desc: "guide_desktop_camera_fail_description",
                            type: y.GUIDE_UNBLOCK
                        }))
                    })["catch"](A.GUM.GUMError, function () {
                        b.openModal(React.createElement(y, {
                            title: "guide_desktop_camera_missing_title",
                            desc: "guide_desktop_camera_missing_description",
                            type: y.GUIDE_NONE
                        }))
                    })
            },
            onLocationClick: function () {
                a.pop(a.MENU), b.openDrawer(React.createElement(m, {
                    chat: this.props.chat
                }), a.DRAWER_MID, "slide-up")
            },
            render: function () {
                return React.createElement(v, {
                    type: v.MENU
                }, React.createElement("button", {
                    className: "menu-icons-item",
                    onClick: this.onImageClick
                }, React.createElement("span", {
                    className: "icon icon-image"
                })), React.createElement("button", {
                    className: "menu-icons-item",
                    onClick: this.onCaptureClick
                }, React.createElement("span", {
                    className: "icon icon-camera"
                })), React.createElement("input", {
                    ref: "input",
                    type: "file",
                    accept: Wa.CONST.IMAGE_MIMES + "," + Wa.CONST.VIDEO_MIMES,
                    style: {
                        display: "none"
                    },
                    onClick: this.stopPropagation,
                    onChange: this.onFilePick,
                    multiple: !0
                }))
            }
        }),
        T = React.createClass({
            displayName: "GroupMenuDropdown",
            mixins: [r],
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            getInitialState: function () {
                return {
                    isReadOnly: this.async("chat.isReadOnly")
                }
            },
            onGroupInfo: function () {
                return a.isOpen(a.DRAWER_RIGHT) > 0 ? void b.closeDrawer() : void b.openDrawer(React.createElement(g, {
                    chat: this.props.chat
                }), a.DRAWER_RIGHT, "slide-left")
            },
            onMute: function () {
                var e = this.props.chat.mute,
                    t = e.mute.bind(e);
                b.openModal(React.createElement(C, {
                    onMute: t
                }))
            },
            onUnmute: function () {
                this.props.chat.mute.unmute(!0)
            },
            onArchive: function () {
                this.props.chat.setArchive(!0)
            },
            onUnarchive: function () {
                this.props.chat.setArchive(!1)
            },
            onExitOrDeleteGroup: function () {
                var e = b.closeDrawer.bind(b, a.DRAWER_RIGHT);
                b.openModal(React.createElement(S, {
                    chat: this.props.chat,
                    onDelete: e
                }))
            },
            render: function () {
                {
                    var e = this.props.chat;
                    e.mute.isMuted ? React.createElement(N, {
                        action: this.onUnmute,
                        shortcut: "m"
                    }, l10n.t("web_menuitem_mute_off")) : React.createElement(N, {
                        action: this.onMute,
                        shortcut: "m"
                    }, l10n.t("web_menuitem_mute")), e.archive ? React.createElement(N, {
                        action: this.onUnarchive,
                        shortcut: "a"
                    }, l10n.t("unarchive_chat")) : React.createElement(N, {
                        action: this.onArchive,
                        shortcut: "a"
                    }, l10n.t("archive_chat"))
                }
                return React.createElement(v, {
                    type: v.DROPDOWN,
                    direction: "left down"
                }, React.createElement(N, {
                    action: this.onGroupInfo,
                    shortcut: "i"
                }, l10n.t("web_group_info")))
            }
        }),
        F = React.createClass({
            displayName: "BroadcastMenuDropdown",
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            onBroadcastInfo: function () {
                return a.isOpen(a.DRAWER_RIGHT) > 0 ? void b.closeDrawer() : void b.openDrawer(React.createElement(f, {
                    chat: this.props.chat
                }), a.DRAWER_RIGHT, "slide-left")
            },
            onArchive: function () {
                this.props.chat.setArchive(!0)
            },
            onUnarchive: function () {
                this.props.chat.setArchive(!1)
            },
            render: function () {
                {
                    var e = this.props.chat;
                    e.archive ? React.createElement(N, {
                        action: this.onUnarchive,
                        shortcut: "a"
                    }, l10n.t("web_unarchive_broadcast")) : React.createElement(N, {
                        action: this.onArchive,
                        shortcut: "a"
                    }, l10n.t("web_archive_broadcast"))
                }
                return React.createElement(v, {
                    type: v.DROPDOWN,
                    direction: "left down"
                }, React.createElement(N, {
                    action: this.onBroadcastInfo,
                    shortcut: "i"
                }, l10n.t("web_list_info")))
            }
        }),
        D = React.createClass({
            displayName: "ContactMenuDropdown",
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            onContactInfo: function () {
                return a.isOpen(a.DRAWER_RIGHT) > 0 ? void b.closeDrawer() : void b.openDrawer(React.createElement(h, {
                    contact: this.props.chat.contact
                }), a.DRAWER_RIGHT, "slide-left")
            },
            onArchive: function () {
                this.props.chat.setArchive(!0)
            },
            onUnarchive: function () {
                this.props.chat.setArchive(!1)
            },
            onDeleteChat: function () {
                var e = b.closeDrawer.bind(b, a.DRAWER_RIGHT);
                b.openModal(React.createElement(S, {
                    chat: this.props.chat,
                    onDelete: e
                }))
            },
            render: function () {
                {
                    var e = this.props.chat;
                    e.archive ? React.createElement(N, {
                        action: this.onUnarchive,
                        shortcut: "a"
                    }, l10n.t("unarchive_chat")) : React.createElement(N, {
                        action: this.onArchive,
                        shortcut: "a"
                    }, l10n.t("archive_chat"))
                }
                return React.createElement(v, {
                    type: v.DROPDOWN,
                    direction: "left down"
                }, React.createElement(N, {
                    action: this.onContactInfo,
                    shortcut: "i"
                }, l10n.t("web_contact_info")))
            }
        });
    e.exports = R
}, function (e, t, n) {
    var r = n(110),
        o = n(47),
        a = n(46),
        i = n(79),
        s = n(135),
        c = s.MessageList,
        u = s.LoadMessages,
        l = n(31),
        d = n(94),
        p = n(48),
        h = React.createClass({
            displayName: "ConversationMsgs",
            mixins: [r, a, o, p, i],
            propTypes: {
                chat: React.PropTypes.instanceOf(d).isRequired
            },
            statics: {
                MSG_CHUNK: 50
            },
            getInitialState: function () {
                return {
                    cursor: Math.min(h.MSG_CHUNK, this.props.chat.msgs.length),
                    unreadCount: this.props.chat.unreadCount
                }
            },
            componentWillMount: function () {
                var e = this.props.chat;
                this.regCmd("load_earlier_msgs:" + e.get("id"), this.loadEarlierMsgs), this.regCmd("open_chat", this.onOpenChat), this.regCmd("compose_height_change", this.composeHeightChange), this.addObserver(e, "change:unreadCount", this.onUnreadCount), this.addObserver(e.msgs, "change:last", this.onLastMsgChanged), this.addObserver(e.msgs, "bulk_add remove"), this.regNativeListener(window, "focus", this.windowGainedFocus), this.regNativeListener(window, "blur", this.windowLostFocus), this.regNativeListener(window, "dpichange", this.nudgeScrollbar)
            },
            nudgeScrollbar: function () {
                if (this.isMounted()) {
                    var e = this.getDOMNode().style;
                    e.zoom = 1, e.zoom = null
                }
            },
            componentDidMount: function () {
                var e = this.props.chat;
                if (!e.get("noEarlierMsgs")) {
                    var t = this.refs.container.getDOMNode();
                    0 === t.scrollTop && l.loadEarlierMsgs(this.props.chat)
                }
            },
            componentWillUnmount: function () {
                this.props.chat.isDirty() && (this.props.chat.sendSeen(), this.props.chat.markSeen())
            },
            loadEarlierMsgs: function () {
                var e = this.props.chat;
                if (e.msgs.length <= this.state.cursor) {
                    var t = this;
                    e.loadEarlierMsgs().then(function () {
                        t.isMounted() && t.setState({
                            cursor: e.msgs.length
                        })
                    })
                } else {
                    var n = Math.min(this.state.cursor + h.MSG_CHUNK, e.msgs.length);
                    this.setState({
                        cursor: n
                    })
                }
            },
            composeHeightChange: function (e) {
                var t = this.refs.container.getDOMNode();
                if (e) {
                    if (0 > e && t.scrollTop === t.scrollHeight - t.clientHeight) return;
                    t.scrollTop = t.scrollTop + e
                } else {
                    var n = t.scrollHeight - (t.scrollTop + t.clientHeight);
                    Velocity(t, {
                        tween: 18
                    }, {
                        progress: function () {
                            t.scrollTop = t.scrollHeight - n - t.clientHeight
                        },
                        duration: 300
                    }, [.1, .82, .25, 1])
                }
            },
            nearBottom: function (e) {
                return e = e || this.refs.container.getDOMNode(), e.scrollTop + Wa.CONST.SCROLL_FUDGE > e.scrollHeight - e.clientHeight
            },
            getMsgs: function () {
                var e = this.props.chat.msgs,
                    t = e.length,
                    n = t - this.state.cursor;
                return this.props.chat.msgs.toArray().slice(n, t)
            },
            onScroll: function (e) {
                this.handleScroll(e.target, this.props.chat, this.nearBottom)
            },
            handleScroll: _.throttle(function (e, t, n) {
                0 === e.scrollTop && l.loadEarlierMsgs(t), n(e) && t.isDirty() && document.hasFocus() && (t.sendSeen(), t.markSeen())
            }, 100),
            windowGainedFocus: function () {
                var e = this.props.chat;
                !this.clearUnreadTimer && e.isDirty() && (this.clearUnreadTimer = this.safeDelay(function () {
                    delete this.clearUnreadTimer;
                    var e = this.refs.container.getDOMNode(),
                        t = this.props.chat;
                    this.nearBottom(e) && t.isDirty() && (t.sendSeen(), t.markSeen())
                }, Wa.CONST.CLEAR_CHAT_DIRTY_WAIT))
            },
            windowLostFocus: function () {
                var e = this.props.chat;
                e.unreadCount || this.setState({
                    unreadCount: 0
                })
            },
            onOpenChat: function (e) {
                e.id === this.props.chat.id && this.scrollToBottom()
            },
            scrollToBottom: function () {
                var e = this.getDOMNode();
                e.scrollTop = e.scrollHeight
            },
            onLastMsgChanged: function () {
                var e = this.props.chat,
                    t = e.msgs.last();
                document.hasFocus() && (this.state.unreadCount && this.setState({
                    unreadCount: 0
                }), (t && t.isSentByMe || this.nearBottom()) && this.scrollToBottom()), t && t.isSentByMe && e.isDirty() && (e.sendSeen(), e.markSeen());
                var n = e.msgs.length;
                n !== this.state.cursor && this.setState({
                    cursor: n
                })
            },
            onUnreadCount: function () {
                var e = this.props.chat,
                    t = document.hasFocus();
                return !t && e.unreadCount > 0 ? void this.setState({
                    unreadCount: e.unreadCount
                }) : void(t && e.isDirty() && this.nearBottom() && (e.sendSeen(), e.markSeen()))
            },
            onPageUpDown: function () {
                this.getDOMNode().focus()
            },
            onKeyPress: function (e) {
                e.metaKey || l.focusChatTextInput(this.props.chat)
            },
            onPaste: function (e) {
                e.preventDefault(), l.pasteChatTextInput(this.props.chat, e.clipboardData.getData("text/plain"))
            },
            render: function () {
                return React.createElement("div", {
                    ref: "container",
                    id: "pane-main",
                    className: "pane-body pane-chat-body lastTabIndex",
                    onScroll: this.onScroll,
                    onKeyPress: this.onKeyPress,
                    onPaste: this.onPaste,
                    tabIndex: "0"
                }, React.createElement("div", {
                    className: "pane-chat-empty"
                }), React.createElement(u, {
                    chat: this.props.chat
                }), React.createElement(c, {
                    key: "ml-" + Wa.widToKey(this.props.chat.get("id")),
                    chatId: this.props.chat.get("id"),
                    unreadCount: this.state.unreadCount,
                    msgs: this.getMsgs()
                }))
            }
        });
    e.exports = h
}, function (e, t, n) {
    var r = n(94),
        o = (n(117), n(135), n(136)),
        a = n(137),
        i = n(46),
        s = n(79),
        c = n(87),
        u = n(31),
        l = n(138),
        d = n(33),
        p = n(78),
        h = n(139),
        g = React.createClass({
            displayName: "ComposeBox",
            mixins: [i, s],
            propTypes: {
                chat: React.PropTypes.instanceOf(r).isRequired,
                onPageUpDown: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                var e = this.props.chat;
                return this.text = e.composeText || "", this.selection = e.composeSel, {
                    hasText: this.hasText(),
                    emojiExpanded: !1,
                    recording: !1
                }
            },
            componentWillMount: function () {
                this.regCmd("focus_chat_text_input_" + this.props.chat.id, this.focusEmojiInput), this.regCmd("paste_chat_text_input_" + this.props.chat.id, this.pasteEmojiInput), this.regCmd("open_chat", this.onOpenChat), c.setBase(this)
            },
            focusEmojiInput: function () {
                this.refs.input && this.refs.input.restoreFocus(!0)
            },
            pasteEmojiInput: function (e) {
                this.refs.input && (this.refs.input.restoreFocus(!1), this.refs.input.pasteText(e))
            },
            componentWillUnmount: function () {
                var e = this.props.chat;
                e.set("composeText", this.text), e.set("composeSel", this.selection)
            },
            componentDidMount: function () {
                this.height = this.refs.input.getDOMNode().clientHeight
            },
            focus: function () {
                this.focusEmojiInput()
            },
            onOpenChat: function (e) {
                e.id === this.props.chat.id && this.refs.input.restoreFocus()
            },
            onMaxPasteExceeded: function () {
                u.openModal(React.createElement(l, {
                    title: l10n.t("message_too_large_title"),
                    onOK: u.closeModal.bind(u),
                    okText: l10n.t("web_ok")
                }, l10n.t("message_too_large_text")))
            },
            onChange: function (e) {
                var t = this.refs.input.getDOMNode(),
                    n = t.clientHeight,
                    r = n - this.height;
                r && u.composeHeightChange(r), this.height = n;
                var o = this.hasText();
                this.text = e.target.value;
                var a = this.hasText();
                a !== o && this.setState({
                    hasText: a
                }), a ? (this.props.chat.presence.subscribe()["catch"](d.WapDrop, _.noop), this.props.chat.markComposing()) : this.props.chat.markPaused()
            },
            onSelectionChange: function (e) {
                this.selection = e
            },
            onKeyDown: function (e) {
                if ("PageUp" === e.key || "PageDown" === e.key) {
                    if (this.props.onPageUpDown) {
                        e.stopPropagation(), this.props.onPageUpDown(e);
                        var t = this.refs.input;
                        return void this.safeDefer(function () {
                            t.restoreFocus(!0)
                        })
                    }
                } else if ("Escape" === e.key) return this.closeEmojiPanel(), void e.preventDefault()
            },
            onKeyPress: function (e) {
                return "Enter" !== e.key || e.shiftKey ? void 0 : (this.onSendText(), void e.preventDefault())
            },
            hasText: function () {
                return this.text.trim().length > 0
            },
            onSendText: function () {
                if (this.hasText()) {
                    var e = this.text;
                    this.text = "", delete this.selection, this.forceUpdate(), this.props.chat.sendMessage(e), this.closeEmojiPanel()
                }
            },
            handleEmoji: function (e) {
                this.refs.input.replaceSelection(e)
            },
            openEmojiPanel: function () {
                this.state.emojiExpanded !== !0 && (this.setState({
                    emojiExpanded: !0
                }), u.composeHeightChange())
            },
            closeEmojiPanel: function () {
                this.state.emojiExpanded !== !1 && (this.setState({
                    emojiExpanded: !1
                }), u.composeHeightChange())
            },
            onPTT: function (e) {
                this.setState(e === h.REC ? {
                    recording: !0
                } : {
                    recording: !1
                })
            },
            preventBlur: function (e) {
                e.preventDefault(), e.stopPropagation(), this.refs.input.restoreFocus()
            },
            render: function () {
                var e = this.state.emojiExpanded ? React.createElement("button", {
                    className: "icon icon-hide btn-emoji",
                    onClick: this.closeEmojiPanel
                }) : React.createElement("button", {
                    className: "icon icon-smiley btn-emoji",
                    onClick: this.openEmojiPanel
                }),
                    t = this.state.emojiExpanded ? React.createElement(o, {
                        onEmoji: this.handleEmoji,
                        key: "compose-emoji-panel"
                    }) : null,
                    n = "block-compose";
                this.state.recording && (n += " ptt-open");
                var r = "input-container";
                this.state.recording && (r += " disabled");
                var i = this.hasText() ? React.createElement("button", {
                    className: "icon btn-icon icon-send",
                    onClick: this.onSendText
                }) : React.createElement(h, {
                    key: "ptt",
                    chat: this.props.chat,
                    onStateChange: this.onPTT
                });
                return React.createElement("footer", {
                    className: "pane-footer pane-chat-footer",
                    onMouseDown: this.preventBlur,
                    onContextMenu: this.preventBlur,
                    onKeyDown: this.onKeyDown
                }, React.createElement(p, {
                    transitionName: "emoji"
                }, t), React.createElement("div", {
                    className: n
                }, e, React.createElement("div", {
                    className: r,
                    id: "compose-input"
                }, React.createElement(a, {
                    placeholder: l10n.t("type_a_message"),
                    editable: !this.state.recording,
                    ref: "input",
                    value: this.text,
                    selection: this.selection,
                    multiline: !0,
                    maxLength: Wa.CONST.MAX_TXT_MSG_SIZE,
                    maxPaste: Wa.CONST.MAX_TXT_MSG_SIZE,
                    onMaxPasteExceeded: this.onMaxPasteExceeded,
                    onKeyPress: this.onKeyPress,
                    onChange: this.onChange,
                    onSelectionChange: this.onSelectionChange
                })), i))
            }
        });
    e.exports = g
}, function (e, t, n) {
    var r = n(176),
        o = n(121),
        a = (n(31), n(94)),
        i = React.createClass({
            displayName: "AttachMediaFlow",
            mixins: [r],
            propTypes: {
                files: React.PropTypes.array,
                state: React.PropTypes.string,
                chat: React.PropTypes.instanceOf(a).isRequired
            },
            getInitialState: function () {
                return {
                    state: React.createElement(o, {
                        files: this.props.files,
                        state: this.props.state,
                        onBack: this.endFlow,
                        onSend: this.sendMedia
                    })
                }
            },
            sendMedia: function (e) {
                var t = this.props.chat;
                _.delay(function () {
                    t.sendMedia(e.map(function (e) {
                        return {
                            file: e
                        }
                    }))
                }, 300), this.endFlow()
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(33),
        o = n(48),
        a = n(79),
        i = n(177),
        s = n(178),
        c = n(179),
        u = (n(112), n(180)),
        l = n(77),
        d = n(78),
        p = function (e) {
            return 150 + 15 * e
        },
        h = 400,
        g = 10,
        f = "image",
        m = "video",
        b = "invalid",
        y = {
            ACTIVE: "active",
            PROCESSING: "processing",
            INVALID: "invalid"
        },
        A = React.createClass({
            displayName: "AttachMediaDrawer",
            mixins: [o, a],
            propTypes: {
                files: React.PropTypes.array,
                state: React.PropTypes.oneOf(_.values(y)),
                onBack: React.PropTypes.func.isRequired,
                onSend: React.PropTypes.func.isRequired
            },
            statics: {
                ACTIVE: y.ACTIVE,
                PROCESSING: y.PROCESSING,
                INVALID: y.INVALID
            },
            getDefaultProps: function () {
                return {
                    state: y.PROCESSING,
                    isDragging: !1
                }
            },
            getInitialState: function () {
                return {
                    state: this.props.state,
                    activeIndex: -1,
                    media: []
                }
            },
            componentWillMount: function () {
                this.regNativeListener(window, "keydown", this.onKeyDown)
            },
            componentDidMount: function () {
                if (this.props.files) {
                    var e = this;
                    this.safeDelay(function () {
                        e.initialize()
                    }, 300)
                }
            },
            componentWillUnmount: function () {
                var e = this;
                this.state.media.forEach(function (t) {
                    var n = e.getFileType(t.file);
                    n === m && URL.revokeObjectURL(t.vid)
                })
            },
            initialize: function () {
                var e = this.props.files;
                e = e.slice(0, Math.min(e.length, g)), this.processFiles(e).bind(this).then(function (e) {
                    this.isMounted() && this.setState({
                        media: e,
                        state: y.ACTIVE,
                        activeIndex: 0
                    })
                })["catch"](function () {
                    this.isMounted() && this.setState({
                        state: y.INVALID
                    })
                })
            },
            getFileType: function (e) {
                var t = e.type;
                return t.match(/^image\/.*/) ? f : t.match(/^video\/.*/) ? m : b
            },
            processFiles: function (e) {
                var t = this;
                return t.setState({
                    state: y.PROCESSING
                }), Promise.all(e.map(function (e) {
                    if (e.size > 16777216) return Promise.reject(new r.MediaFileTooLarge);
                    var n = t.getFileType(e),
                        o = Math.ceil(1e6 * Math.random());
                    switch (n) {
                    case m:
                        var a = URL.createObjectURL(e);
                        return u.generateVideoThumb(a).then(function (t) {
                            return {
                                file: e,
                                img: t,
                                vid: a,
                                key: o
                            }
                        });
                    case f:
                        return u.resizeAndOrient(e, Wa.CONST.IMG_MAX_EDGE, Wa.CONST.IMG_MAX_EDGE).then(function (e) {
                            return {
                                file: dataURLtoBlob(e),
                                img: e,
                                key: o
                            }
                        });
                    default:
                        return Promise.reject(new r.InvalidMediaFileType)
                    }
                }))
            },
            onDragOver: function () {
                this.state.isDragging || this.setState({
                    isDragging: !0
                })
            },
            onDrop: function (e) {
                this.setState({
                    isDragging: !1
                }), this.onFilePick(e)
            },
            onDragLeave: function () {
                this.state.media.length || this.props.onBack(), this.setState({
                    isDragging: !1
                })
            },
            onKeyDown: function (e) {
                37 === e.keyCode ? this.onPrev() : 39 === e.keyCode && this.onNext()
            },
            onNext: function () {
                this.state.activeIndex + 1 < this.state.media.length && this.setState({
                    activeIndex: this.state.activeIndex + 1
                })
            },
            onPrev: function () {
                this.state.activeIndex > 0 && this.setState({
                    activeIndex: this.state.activeIndex - 1
                })
            },
            onSend: function () {
                this.props.onSend(_.pluck(this.state.media, "file"))
            },
            onAddFileClick: function () {
                var e = this.refs.input.getDOMNode();
                e.click()
            },
            onFilePick: function (e) {
                for (var t = [], n = e.target.files || e.dataTransfer.files, r = n.length + this.state.media.length > g ? Math.max(g - this.state.media.length, 0) : n.length, o = 0; r > o; o++) t.push(n[o]);
                this.processFiles(t).bind(this).then(function (e) {
                    if (this.isMounted()) {
                        var t = this.state.media.concat(e);
                        this.setState({
                            activeIndex: Math.min(this.state.media.length, 9),
                            media: t,
                            state: y.ACTIVE
                        })
                    }
                })["catch"](function () {
                    this.isMounted() && this.setState({
                        state: y.INVALID
                    })
                }), e.target.value = ""
            },
            onSelectThumb: function (e) {
                this.setState({
                    activeIndex: e
                })
            },
            onRemoveThumb: function (e, t) {
                t.stopPropagation(), t.preventDefault();
                var n = this.state.media;
                n.splice(e, 1);
                var r = this.state.activeIndex;
                r >= e && (r = Math.max(--r, 0)), this.setState({
                    activeIndex: n.length ? r : -1,
                    media: n
                })
            },
            render: function () {
                var e, t, n, r = this,
                    o = 0;
                if (this.state.state === y.PROCESSING) e = React.createElement(l, {
                    key: "processing"
                });
                else if (this.state.state === y.ACTIVE && this.state.activeIndex > -1) {
                    var a = this.state.media[this.state.activeIndex],
                        u = this.getFileType(a.file);
                    if (u === f) {
                        var b = {
                            backgroundImage: "url(" + a.img + ")"
                        };
                        e = React.createElement("div", {
                            className: "media-body-container",
                            key: "active",
                            style: b
                        })
                    } else u === m && (e = React.createElement("video", {
                        className: "media-body-container",
                        key: "active",
                        controls: !0,
                        type: a.file.type,
                        src: a.vid
                    }))
                } else this.state.state === y.INVALID && (e = React.createElement("span", {
                    key: "pending"
                }, l10n.t("invalid_media_files")));
                this.state.media.length > 0 && (t = this.state.media.map(function (e, t) {
                    var n = "media-thumb stagger-delay";
                    t === r.state.activeIndex && (n += " active");
                    var o = Math.max(r.state.media.length - r.state.activeIndex - 1, 1),
                        a = p(t) / o * Math.max(0, t - r.state.activeIndex) + "ms",
                        i = {
                            backgroundImage: "url(" + e.img + ")"
                        };
                    return React.createElement("div", {
                        className: n,
                        key: "media-" + e.key,
                        style: i,
                        onClick: r.onSelectThumb.bind(null, t),
                        staggerDelay: a
                    }, React.createElement("span", {
                        className: "btn-delete",
                        onClick: r.onRemoveThumb.bind(null, t)
                    }, React.createElement("span", {
                        className: "icon icon-x-alt"
                    })))
                }), o = 1 === this.state.media.length ? h : h + p(this.state.media.length), n = React.createElement("div", {
                    className: "drawer-controls"
                }, React.createElement("button", {
                    className: "btn btn-round btn-l",
                    onClick: this.onSend
                }, React.createElement("span", {
                    className: "icon icon-send-light"
                }))));
                var _ = this.state.isDragging ? React.createElement("div", {
                    key: "container",
                    className: "drag-drop"
                }, React.createElement("div", {
                    className: "stitching"
                }, l10n.t("drag_media_here"))) : null,
                    A = this.state.media.length < g ? React.createElement("div", {
                        key: "media-more",
                        className: "media-thumb",
                        onClick: this.onAddFileClick
                    }, React.createElement("button", {
                        className: "btn-fill"
                    }, l10n.t("add_media"))) : null;
                return React.createElement(i, {
                    key: "attach-image-modal",
                    ref: "container",
                    position: "right",
                    id: "media",
                    variant: "noheader",
                    onDrop: this.onDrop,
                    onDragOver: this.onDragOver,
                    onDragLeave: this.onDragLeave
                }, React.createElement(s, {
                    title: l10n.t("web_preview_msg"),
                    onCancel: this.props.onBack
                }), React.createElement(c, null, _, React.createElement("div", {
                    className: "media-body"
                }, React.createElement(d, {
                    transitionName: "media-scale"
                }, e)), React.createElement("div", {
                    className: "media-collection"
                }, React.createElement(d, {
                    transitionName: "media-scale"
                }, t, A)), React.createElement(d, {
                    transitionName: "btn",
                    delay: o
                }, n), React.createElement("input", {
                    ref: "input",
                    type: "file",
                    accept: Wa.CONST.IMAGE_MIMES + "," + Wa.CONST.VIDEO_MIMES,
                    style: {
                        display: "none"
                    },
                    onChange: this.onFilePick,
                    multiple: !0
                })))
            }
        });
    e.exports = A
}, function (e, t, n) {
    function r(e) {
        var t;
        switch (e) {
        case "01":
            t = o;
            break;
        case "03":
            t = a;
            break;
        default:
            t = o
        }
        var n = t.OutputStream,
            r = t.writeNode,
            i = t.InputStream,
            s = t.readNode,
            c = t.Node,
            u = t.Crypto;
        this.Node = c, this.read = function (e) {
            var t;
            try {
                var n = new i(u.decrypt(e));
                t = s(n)
            } catch (r) {
                Wa.debug("binaryProtocol:read error " + r.stack, "red", void 0, !0)
            }
            return t
        }, this.write = function (e) {
            var t;
            try {
                var o = new n;
                r(o, e), t = u.encrypt(o.toBuffer())
            } catch (a) {
                Wa.debug("binaryProtocol:write error " + a.stack, "red", void 0, !0)
            }
            return t
        }
    }
    var o = {
        OutputStream: n(140),
        writeNode: n(141),
        InputStream: n(142),
        readNode: n(143),
        Node: n(144),
        Crypto: n(145)
    },
        a = {
            OutputStream: n(146),
            writeNode: n(147),
            InputStream: n(148),
            readNode: n(149),
            Node: n(150),
            Crypto: n(151)
        };
    e.exports = r
}, function (e) {
    e.exports = {
        "Á": "A",
        "Ă": "A",
        "Ắ": "A",
        "Ặ": "A",
        "Ằ": "A",
        "Ẳ": "A",
        "Ẵ": "A",
        "Ǎ": "A",
        "Â": "A",
        "Ấ": "A",
        "Ậ": "A",
        "Ầ": "A",
        "Ẩ": "A",
        "Ẫ": "A",
        "Ä": "A",
        "Ǟ": "A",
        "Ȧ": "A",
        "Ǡ": "A",
        "Ạ": "A",
        "Ȁ": "A",
        "À": "A",
        "Ả": "A",
        "Ȃ": "A",
        "Ā": "A",
        "Ą": "A",
        "Å": "A",
        "Ǻ": "A",
        "Ḁ": "A",
        "Ⱥ": "A",
        "Ã": "A",
        "Ꜳ": "AA",
        "Æ": "AE",
        "Ǽ": "AE",
        "Ǣ": "AE",
        "Ꜵ": "AO",
        "Ꜷ": "AU",
        "Ꜹ": "AV",
        "Ꜻ": "AV",
        "Ꜽ": "AY",
        "Ḃ": "B",
        "Ḅ": "B",
        "Ɓ": "B",
        "Ḇ": "B",
        "Ƀ": "B",
        "Ƃ": "B",
        "Ć": "C",
        "Č": "C",
        "Ç": "C",
        "Ḉ": "C",
        "Ĉ": "C",
        "Ċ": "C",
        "Ƈ": "C",
        "Ȼ": "C",
        "Ď": "D",
        "Ḑ": "D",
        "Ḓ": "D",
        "Ḋ": "D",
        "Ḍ": "D",
        "Ɗ": "D",
        "Ḏ": "D",
        "ǲ": "D",
        "ǅ": "D",
        "Đ": "D",
        "Ƌ": "D",
        "Ǳ": "DZ",
        "Ǆ": "DZ",
        "É": "E",
        "Ĕ": "E",
        "Ě": "E",
        "Ȩ": "E",
        "Ḝ": "E",
        "Ê": "E",
        "Ế": "E",
        "Ệ": "E",
        "Ề": "E",
        "Ể": "E",
        "Ễ": "E",
        "Ḙ": "E",
        "Ë": "E",
        "Ė": "E",
        "Ẹ": "E",
        "Ȅ": "E",
        "È": "E",
        "Ẻ": "E",
        "Ȇ": "E",
        "Ē": "E",
        "Ḗ": "E",
        "Ḕ": "E",
        "Ę": "E",
        "Ɇ": "E",
        "Ẽ": "E",
        "Ḛ": "E",
        "Ꝫ": "ET",
        "Ḟ": "F",
        "Ƒ": "F",
        "Ǵ": "G",
        "Ğ": "G",
        "Ǧ": "G",
        "Ģ": "G",
        "Ĝ": "G",
        "Ġ": "G",
        "Ɠ": "G",
        "Ḡ": "G",
        "Ǥ": "G",
        "Ḫ": "H",
        "Ȟ": "H",
        "Ḩ": "H",
        "Ĥ": "H",
        "Ⱨ": "H",
        "Ḧ": "H",
        "Ḣ": "H",
        "Ḥ": "H",
        "Ħ": "H",
        "Í": "I",
        "Ĭ": "I",
        "Ǐ": "I",
        "Î": "I",
        "Ï": "I",
        "Ḯ": "I",
        "İ": "I",
        "Ị": "I",
        "Ȉ": "I",
        "Ì": "I",
        "Ỉ": "I",
        "Ȋ": "I",
        "Ī": "I",
        "Į": "I",
        "Ɨ": "I",
        "Ĩ": "I",
        "Ḭ": "I",
        "Ꝺ": "D",
        "Ꝼ": "F",
        "Ᵹ": "G",
        "Ꞃ": "R",
        "Ꞅ": "S",
        "Ꞇ": "T",
        "Ꝭ": "IS",
        "Ĵ": "J",
        "Ɉ": "J",
        "Ḱ": "K",
        "Ǩ": "K",
        "Ķ": "K",
        "Ⱪ": "K",
        "Ꝃ": "K",
        "Ḳ": "K",
        "Ƙ": "K",
        "Ḵ": "K",
        "Ꝁ": "K",
        "Ꝅ": "K",
        "Ĺ": "L",
        "Ƚ": "L",
        "Ľ": "L",
        "Ļ": "L",
        "Ḽ": "L",
        "Ḷ": "L",
        "Ḹ": "L",
        "Ⱡ": "L",
        "Ꝉ": "L",
        "Ḻ": "L",
        "Ŀ": "L",
        "Ɫ": "L",
        "ǈ": "L",
        "Ł": "L",
        "Ǉ": "LJ",
        "Ḿ": "M",
        "Ṁ": "M",
        "Ṃ": "M",
        "Ɱ": "M",
        "Ń": "N",
        "Ň": "N",
        "Ņ": "N",
        "Ṋ": "N",
        "Ṅ": "N",
        "Ṇ": "N",
        "Ǹ": "N",
        "Ɲ": "N",
        "Ṉ": "N",
        "Ƞ": "N",
        "ǋ": "N",
        "Ñ": "N",
        "Ǌ": "NJ",
        "Ó": "O",
        "Ŏ": "O",
        "Ǒ": "O",
        "Ô": "O",
        "Ố": "O",
        "Ộ": "O",
        "Ồ": "O",
        "Ổ": "O",
        "Ỗ": "O",
        "Ö": "O",
        "Ȫ": "O",
        "Ȯ": "O",
        "Ȱ": "O",
        "Ọ": "O",
        "Ő": "O",
        "Ȍ": "O",
        "Ò": "O",
        "Ỏ": "O",
        "Ơ": "O",
        "Ớ": "O",
        "Ợ": "O",
        "Ờ": "O",
        "Ở": "O",
        "Ỡ": "O",
        "Ȏ": "O",
        "Ꝋ": "O",
        "Ꝍ": "O",
        "Ō": "O",
        "Ṓ": "O",
        "Ṑ": "O",
        "Ɵ": "O",
        "Ǫ": "O",
        "Ǭ": "O",
        "Ø": "O",
        "Ǿ": "O",
        "Õ": "O",
        "Ṍ": "O",
        "Ṏ": "O",
        "Ȭ": "O",
        "Ƣ": "OI",
        "Ꝏ": "OO",
        "Ɛ": "E",
        "Ɔ": "O",
        "Ȣ": "OU",
        "Ṕ": "P",
        "Ṗ": "P",
        "Ꝓ": "P",
        "Ƥ": "P",
        "Ꝕ": "P",
        "Ᵽ": "P",
        "Ꝑ": "P",
        "Ꝙ": "Q",
        "Ꝗ": "Q",
        "Ŕ": "R",
        "Ř": "R",
        "Ŗ": "R",
        "Ṙ": "R",
        "Ṛ": "R",
        "Ṝ": "R",
        "Ȑ": "R",
        "Ȓ": "R",
        "Ṟ": "R",
        "Ɍ": "R",
        "Ɽ": "R",
        "Ꜿ": "C",
        "Ǝ": "E",
        "Ś": "S",
        "Ṥ": "S",
        "Š": "S",
        "Ṧ": "S",
        "Ş": "S",
        "Ŝ": "S",
        "Ș": "S",
        "Ṡ": "S",
        "Ṣ": "S",
        "Ṩ": "S",
        "ẞ": "SS",
        "Ť": "T",
        "Ţ": "T",
        "Ṱ": "T",
        "Ț": "T",
        "Ⱦ": "T",
        "Ṫ": "T",
        "Ṭ": "T",
        "Ƭ": "T",
        "Ṯ": "T",
        "Ʈ": "T",
        "Ŧ": "T",
        "Ɐ": "A",
        "Ꞁ": "L",
        "Ɯ": "M",
        "Ʌ": "V",
        "Ꜩ": "TZ",
        "Ú": "U",
        "Ŭ": "U",
        "Ǔ": "U",
        "Û": "U",
        "Ṷ": "U",
        "Ü": "U",
        "Ǘ": "U",
        "Ǚ": "U",
        "Ǜ": "U",
        "Ǖ": "U",
        "Ṳ": "U",
        "Ụ": "U",
        "Ű": "U",
        "Ȕ": "U",
        "Ù": "U",
        "Ủ": "U",
        "Ư": "U",
        "Ứ": "U",
        "Ự": "U",
        "Ừ": "U",
        "Ử": "U",
        "Ữ": "U",
        "Ȗ": "U",
        "Ū": "U",
        "Ṻ": "U",
        "Ų": "U",
        "Ů": "U",
        "Ũ": "U",
        "Ṹ": "U",
        "Ṵ": "U",
        "Ꝟ": "V",
        "Ṿ": "V",
        "Ʋ": "V",
        "Ṽ": "V",
        "Ꝡ": "VY",
        "Ẃ": "W",
        "Ŵ": "W",
        "Ẅ": "W",
        "Ẇ": "W",
        "Ẉ": "W",
        "Ẁ": "W",
        "Ⱳ": "W",
        "Ẍ": "X",
        "Ẋ": "X",
        "Ý": "Y",
        "Ŷ": "Y",
        "Ÿ": "Y",
        "Ẏ": "Y",
        "Ỵ": "Y",
        "Ỳ": "Y",
        "Ƴ": "Y",
        "Ỷ": "Y",
        "Ỿ": "Y",
        "Ȳ": "Y",
        "Ɏ": "Y",
        "Ỹ": "Y",
        "Ź": "Z",
        "Ž": "Z",
        "Ẑ": "Z",
        "Ⱬ": "Z",
        "Ż": "Z",
        "Ẓ": "Z",
        "Ȥ": "Z",
        "Ẕ": "Z",
        "Ƶ": "Z",
        "Ĳ": "IJ",
        "Œ": "OE",
        "ᴀ": "A",
        "ᴁ": "AE",
        "ʙ": "B",
        "ᴃ": "B",
        "ᴄ": "C",
        "ᴅ": "D",
        "ᴇ": "E",
        "ꜰ": "F",
        "ɢ": "G",
        "ʛ": "G",
        "ʜ": "H",
        "ɪ": "I",
        "ʁ": "R",
        "ᴊ": "J",
        "ᴋ": "K",
        "ʟ": "L",
        "ᴌ": "L",
        "ᴍ": "M",
        "ɴ": "N",
        "ᴏ": "O",
        "ɶ": "OE",
        "ᴐ": "O",
        "ᴕ": "OU",
        "ᴘ": "P",
        "ʀ": "R",
        "ᴎ": "N",
        "ᴙ": "R",
        "ꜱ": "S",
        "ᴛ": "T",
        "ⱻ": "E",
        "ᴚ": "R",
        "ᴜ": "U",
        "ᴠ": "V",
        "ᴡ": "W",
        "ʏ": "Y",
        "ᴢ": "Z",
        "á": "a",
        "ă": "a",
        "ắ": "a",
        "ặ": "a",
        "ằ": "a",
        "ẳ": "a",
        "ẵ": "a",
        "ǎ": "a",
        "â": "a",
        "ấ": "a",
        "ậ": "a",
        "ầ": "a",
        "ẩ": "a",
        "ẫ": "a",
        "ä": "a",
        "ǟ": "a",
        "ȧ": "a",
        "ǡ": "a",
        "ạ": "a",
        "ȁ": "a",
        "à": "a",
        "ả": "a",
        "ȃ": "a",
        "ā": "a",
        "ą": "a",
        "ᶏ": "a",
        "ẚ": "a",
        "å": "a",
        "ǻ": "a",
        "ḁ": "a",
        "ⱥ": "a",
        "ã": "a",
        "ꜳ": "aa",
        "æ": "ae",
        "ǽ": "ae",
        "ǣ": "ae",
        "ꜵ": "ao",
        "ꜷ": "au",
        "ꜹ": "av",
        "ꜻ": "av",
        "ꜽ": "ay",
        "ḃ": "b",
        "ḅ": "b",
        "ɓ": "b",
        "ḇ": "b",
        "ᵬ": "b",
        "ᶀ": "b",
        "ƀ": "b",
        "ƃ": "b",
        "ɵ": "o",
        "ć": "c",
        "č": "c",
        "ç": "c",
        "ḉ": "c",
        "ĉ": "c",
        "ɕ": "c",
        "ċ": "c",
        "ƈ": "c",
        "ȼ": "c",
        "ď": "d",
        "ḑ": "d",
        "ḓ": "d",
        "ȡ": "d",
        "ḋ": "d",
        "ḍ": "d",
        "ɗ": "d",
        "ᶑ": "d",
        "ḏ": "d",
        "ᵭ": "d",
        "ᶁ": "d",
        "đ": "d",
        "ɖ": "d",
        "ƌ": "d",
        "ı": "i",
        "ȷ": "j",
        "ɟ": "j",
        "ʄ": "j",
        "ǳ": "dz",
        "ǆ": "dz",
        "é": "e",
        "ĕ": "e",
        "ě": "e",
        "ȩ": "e",
        "ḝ": "e",
        "ê": "e",
        "ế": "e",
        "ệ": "e",
        "ề": "e",
        "ể": "e",
        "ễ": "e",
        "ḙ": "e",
        "ë": "e",
        "ė": "e",
        "ẹ": "e",
        "ȅ": "e",
        "è": "e",
        "ẻ": "e",
        "ȇ": "e",
        "ē": "e",
        "ḗ": "e",
        "ḕ": "e",
        "ⱸ": "e",
        "ę": "e",
        "ᶒ": "e",
        "ɇ": "e",
        "ẽ": "e",
        "ḛ": "e",
        "ꝫ": "et",
        "ḟ": "f",
        "ƒ": "f",
        "ᵮ": "f",
        "ᶂ": "f",
        "ǵ": "g",
        "ğ": "g",
        "ǧ": "g",
        "ģ": "g",
        "ĝ": "g",
        "ġ": "g",
        "ɠ": "g",
        "ḡ": "g",
        "ᶃ": "g",
        "ǥ": "g",
        "ḫ": "h",
        "ȟ": "h",
        "ḩ": "h",
        "ĥ": "h",
        "ⱨ": "h",
        "ḧ": "h",
        "ḣ": "h",
        "ḥ": "h",
        "ɦ": "h",
        "ẖ": "h",
        "ħ": "h",
        "ƕ": "hv",
        "í": "i",
        "ĭ": "i",
        "ǐ": "i",
        "î": "i",
        "ï": "i",
        "ḯ": "i",
        "ị": "i",
        "ȉ": "i",
        "ì": "i",
        "ỉ": "i",
        "ȋ": "i",
        "ī": "i",
        "į": "i",
        "ᶖ": "i",
        "ɨ": "i",
        "ĩ": "i",
        "ḭ": "i",
        "ꝺ": "d",
        "ꝼ": "f",
        "ᵹ": "g",
        "ꞃ": "r",
        "ꞅ": "s",
        "ꞇ": "t",
        "ꝭ": "is",
        "ǰ": "j",
        "ĵ": "j",
        "ʝ": "j",
        "ɉ": "j",
        "ḱ": "k",
        "ǩ": "k",
        "ķ": "k",
        "ⱪ": "k",
        "ꝃ": "k",
        "ḳ": "k",
        "ƙ": "k",
        "ḵ": "k",
        "ᶄ": "k",
        "ꝁ": "k",
        "ꝅ": "k",
        "ĺ": "l",
        "ƚ": "l",
        "ɬ": "l",
        "ľ": "l",
        "ļ": "l",
        "ḽ": "l",
        "ȴ": "l",
        "ḷ": "l",
        "ḹ": "l",
        "ⱡ": "l",
        "ꝉ": "l",
        "ḻ": "l",
        "ŀ": "l",
        "ɫ": "l",
        "ᶅ": "l",
        "ɭ": "l",
        "ł": "l",
        "ǉ": "lj",
        "ſ": "s",
        "ẜ": "s",
        "ẛ": "s",
        "ẝ": "s",
        "ḿ": "m",
        "ṁ": "m",
        "ṃ": "m",
        "ɱ": "m",
        "ᵯ": "m",
        "ᶆ": "m",
        "ń": "n",
        "ň": "n",
        "ņ": "n",
        "ṋ": "n",
        "ȵ": "n",
        "ṅ": "n",
        "ṇ": "n",
        "ǹ": "n",
        "ɲ": "n",
        "ṉ": "n",
        "ƞ": "n",
        "ᵰ": "n",
        "ᶇ": "n",
        "ɳ": "n",
        "ñ": "n",
        "ǌ": "nj",
        "ó": "o",
        "ŏ": "o",
        "ǒ": "o",
        "ô": "o",
        "ố": "o",
        "ộ": "o",
        "ồ": "o",
        "ổ": "o",
        "ỗ": "o",
        "ö": "o",
        "ȫ": "o",
        "ȯ": "o",
        "ȱ": "o",
        "ọ": "o",
        "ő": "o",
        "ȍ": "o",
        "ò": "o",
        "ỏ": "o",
        "ơ": "o",
        "ớ": "o",
        "ợ": "o",
        "ờ": "o",
        "ở": "o",
        "ỡ": "o",
        "ȏ": "o",
        "ꝋ": "o",
        "ꝍ": "o",
        "ⱺ": "o",
        "ō": "o",
        "ṓ": "o",
        "ṑ": "o",
        "ǫ": "o",
        "ǭ": "o",
        "ø": "o",
        "ǿ": "o",
        "õ": "o",
        "ṍ": "o",
        "ṏ": "o",
        "ȭ": "o",
        "ƣ": "oi",
        "ꝏ": "oo",
        "ɛ": "e",
        "ᶓ": "e",
        "ɔ": "o",
        "ᶗ": "o",
        "ȣ": "ou",
        "ṕ": "p",
        "ṗ": "p",
        "ꝓ": "p",
        "ƥ": "p",
        "ᵱ": "p",
        "ᶈ": "p",
        "ꝕ": "p",
        "ᵽ": "p",
        "ꝑ": "p",
        "ꝙ": "q",
        "ʠ": "q",
        "ɋ": "q",
        "ꝗ": "q",
        "ŕ": "r",
        "ř": "r",
        "ŗ": "r",
        "ṙ": "r",
        "ṛ": "r",
        "ṝ": "r",
        "ȑ": "r",
        "ɾ": "r",
        "ᵳ": "r",
        "ȓ": "r",
        "ṟ": "r",
        "ɼ": "r",
        "ᵲ": "r",
        "ᶉ": "r",
        "ɍ": "r",
        "ɽ": "r",
        "ↄ": "c",
        "ꜿ": "c",
        "ɘ": "e",
        "ɿ": "r",
        "ś": "s",
        "ṥ": "s",
        "š": "s",
        "ṧ": "s",
        "ş": "s",
        "ŝ": "s",
        "ș": "s",
        "ṡ": "s",
        "ṣ": "s",
        "ṩ": "s",
        "ʂ": "s",
        "ᵴ": "s",
        "ᶊ": "s",
        "ȿ": "s",
        "ɡ": "g",
        "ß": "ss",
        "ᴑ": "o",
        "ᴓ": "o",
        "ᴝ": "u",
        "ť": "t",
        "ţ": "t",
        "ṱ": "t",
        "ț": "t",
        "ȶ": "t",
        "ẗ": "t",
        "ⱦ": "t",
        "ṫ": "t",
        "ṭ": "t",
        "ƭ": "t",
        "ṯ": "t",
        "ᵵ": "t",
        "ƫ": "t",
        "ʈ": "t",
        "ŧ": "t",
        "ᵺ": "th",
        "ɐ": "a",
        "ᴂ": "ae",
        "ǝ": "e",
        "ᵷ": "g",
        "ɥ": "h",
        "ʮ": "h",
        "ʯ": "h",
        "ᴉ": "i",
        "ʞ": "k",
        "ꞁ": "l",
        "ɯ": "m",
        "ɰ": "m",
        "ᴔ": "oe",
        "ɹ": "r",
        "ɻ": "r",
        "ɺ": "r",
        "ⱹ": "r",
        "ʇ": "t",
        "ʌ": "v",
        "ʍ": "w",
        "ʎ": "y",
        "ꜩ": "tz",
        "ú": "u",
        "ŭ": "u",
        "ǔ": "u",
        "û": "u",
        "ṷ": "u",
        "ü": "u",
        "ǘ": "u",
        "ǚ": "u",
        "ǜ": "u",
        "ǖ": "u",
        "ṳ": "u",
        "ụ": "u",
        "ű": "u",
        "ȕ": "u",
        "ù": "u",
        "ủ": "u",
        "ư": "u",
        "ứ": "u",
        "ự": "u",
        "ừ": "u",
        "ử": "u",
        "ữ": "u",
        "ȗ": "u",
        "ū": "u",
        "ṻ": "u",
        "ų": "u",
        "ᶙ": "u",
        "ů": "u",
        "ũ": "u",
        "ṹ": "u",
        "ṵ": "u",
        "ᵫ": "ue",
        "ꝸ": "um",
        "ⱴ": "v",
        "ꝟ": "v",
        "ṿ": "v",
        "ʋ": "v",
        "ᶌ": "v",
        "ⱱ": "v",
        "ṽ": "v",
        "ꝡ": "vy",
        "ẃ": "w",
        "ŵ": "w",
        "ẅ": "w",
        "ẇ": "w",
        "ẉ": "w",
        "ẁ": "w",
        "ⱳ": "w",
        "ẘ": "w",
        "ẍ": "x",
        "ẋ": "x",
        "ᶍ": "x",
        "ý": "y",
        "ŷ": "y",
        "ÿ": "y",
        "ẏ": "y",
        "ỵ": "y",
        "ỳ": "y",
        "ƴ": "y",
        "ỷ": "y",
        "ỿ": "y",
        "ȳ": "y",
        "ẙ": "y",
        "ɏ": "y",
        "ỹ": "y",
        "ź": "z",
        "ž": "z",
        "ẑ": "z",
        "ʑ": "z",
        "ⱬ": "z",
        "ż": "z",
        "ẓ": "z",
        "ȥ": "z",
        "ẕ": "z",
        "ᵶ": "z",
        "ᶎ": "z",
        "ʐ": "z",
        "ƶ": "z",
        "ɀ": "z",
        "ﬀ": "ff",
        "ﬃ": "ffi",
        "ﬄ": "ffl",
        "ﬁ": "fi",
        "ﬂ": "fl",
        "ĳ": "ij",
        "œ": "oe",
        "ﬆ": "st",
        "ₐ": "a",
        "ₑ": "e",
        "ᵢ": "i",
        "ⱼ": "j",
        "ₒ": "o",
        "ᵣ": "r",
        "ᵤ": "u",
        "ᵥ": "v",
        "ₓ": "x",
        "Ё": "YO",
        "Й": "I",
        "Ц": "TS",
        "У": "U",
        "К": "K",
        "Е": "E",
        "Н": "N",
        "Г": "G",
        "Ш": "SH",
        "Щ": "SCH",
        "З": "Z",
        "Х": "H",
        "Ъ": "",
        "ё": "yo",
        "й": "i",
        "ц": "ts",
        "у": "u",
        "к": "k",
        "е": "e",
        "н": "n",
        "г": "g",
        "ш": "sh",
        "щ": "sch",
        "з": "z",
        "х": "h",
        "ъ": "",
        "Ф": "F",
        "Ы": "I",
        "В": "V",
        "А": "A",
        "П": "P",
        "Р": "R",
        "О": "O",
        "Л": "L",
        "Д": "D",
        "Ж": "ZH",
        "Э": "E",
        "ф": "f",
        "ы": "i",
        "в": "v",
        "а": "a",
        "п": "p",
        "р": "r",
        "о": "o",
        "л": "l",
        "д": "d",
        "ж": "zh",
        "э": "e",
        "Я": "Ya",
        "Ч": "CH",
        "С": "S",
        "М": "M",
        "И": "I",
        "Т": "T",
        "Ь": "",
        "Б": "B",
        "Ю": "YU",
        "я": "ya",
        "ч": "ch",
        "с": "s",
        "м": "m",
        "и": "i",
        "т": "t",
        "ь": "",
        "б": "b",
        "ю": "yu"
    }
}, function (e) {
    function t(e) {
        if ("function" != typeof e) {
            var t = Array.isArray(e) ? e : Object.keys(this.columns);
            e = n(t)
        }
        return this.rows.sort(e), this
    }
    function n(e) {
        var t = e.map(function (e) {
            var t = "asc",
                n = /(.*)\|\s*(asc|des)\s*$/.exec(e);
            return n && (e = n[1], t = n[2]), function (n, o) {
                var a = r(n[e], o[e]);
                return "asc" == t ? a : -1 * a
            }
        });
        return function (e, n) {
            for (var r = 0; r < t.length; r++) {
                var o = t[r](e, n);
                if (0 != o) return o
            }
            return 0
        }
    }
    function r(e, t) {
        return e === t ? 0 : void 0 === e ? 1 : void 0 === t ? -1 : null === e ? 1 : null === t ? -1 : e > t ? 1 : t > e ? -1 : r(String(e), String(t))
    }
    e.exports = t
}, function (e, t, n) {
    var r = n(103).padLeft,
        o = t.Printer = function (e, t) {
            return function (n, o) {
                var a = e + " " + t(n);
                return null == o ? a : r(a, o)
            }
        };
    t.sum = function (e, t) {
        return e = e || 0, e += t
    }, t.sum.printer = o("∑", String), t.avg = function (e, t, n, r) {
        return e = e || 0, e += t, n + 1 == r ? e / r : e
    }, t.avg.printer = o("Avg:", String)
}, function (e) {
    var t = [].slice,
        n = {},
        r = ["first", "last", "partition", "contains", "toArray", "invoke"];
    _.each(r, function (e) {
        _[e] && (n[e] = function () {
            var n = t.call(arguments);
            return n.unshift(this.models), _[e].apply(_, n)
        })
    });
    var o = ["groupBy", "countBy", "sortBy", "indexBy"];
    _.each(o, function (e) {
        _[e] && (n[e] = function (t, n) {
            var r = _.isFunction(t) ? t : function (e) {
                    return e.get ? e.get(t) : e[t]
                };
            return _[e](this.models, r, n)
        })
    }), n.where = function (e, t) {
        return _.isEmpty(e) ? t ? void 0 : [] : this[t ? "find" : "filter"](function (t) {
            var n;
            for (var r in e) if (n = t.get ? t.get(r) : t[r], e[r] !== n) return !1;
            return !0
        })
    }, n.findWhere = function (e) {
        return this.where(e, !0)
    }, n.pluck = function (e) {
        return _.invoke(this.models, "get", e)
    }, e.exports = n
}, function (e, t, n) {
    var r = (n(133), n(92)),
        o = n(97),
        a = r.extend({
            model: o,
            add: function () {
                var e = r.prototype.add.apply(this, arguments);
                return Store.Msg.add(e, arguments[1]), this.trigger("bulk_add", e), e
            }
        });
    e.exports = a
}, function (e) {
    e.exports = function () {
        throw new Error("define cannot be used indirect")
    }
}, function (e, t, n) {
    e.exports = n(100)
}, function (e, t) {
    var n, r;
    (function () {
        var o = this,
            a = o._,
            i = Array.prototype,
            s = Object.prototype,
            c = Function.prototype,
            u = i.push,
            l = i.slice,
            d = i.concat,
            p = s.toString,
            h = s.hasOwnProperty,
            g = Array.isArray,
            f = Object.keys,
            m = c.bind,
            b = function (e) {
                return e instanceof b ? e : this instanceof b ? void(this._wrapped = e) : new b(e)
            };
        "undefined" != typeof e && e.exports && (t = e.exports = b), t._ = b, b.VERSION = "1.7.0";
        var y = function (e, t, n) {
                if (void 0 === t) return e;
                switch (null == n ? 3 : n) {
                case 1:
                    return function (n) {
                        return e.call(t, n)
                    };
                case 2:
                    return function (n, r) {
                        return e.call(t, n, r)
                    };
                case 3:
                    return function (n, r, o) {
                        return e.call(t, n, r, o)
                    };
                case 4:
                    return function (n, r, o, a) {
                        return e.call(t, n, r, o, a)
                    }
                }
                return function () {
                    return e.apply(t, arguments)
                }
            };
        b.iteratee = function (e, t, n) {
            return null == e ? b.identity : b.isFunction(e) ? y(e, t, n) : b.isObject(e) ? b.matches(e) : b.property(e)
        }, b.each = b.forEach = function (e, t, n) {
            if (null == e) return e;
            t = y(t, n);
            var r, o = e.length;
            if (o === +o) for (r = 0; o > r; r++) t(e[r], r, e);
            else {
                var a = b.keys(e);
                for (r = 0, o = a.length; o > r; r++) t(e[a[r]], a[r], e)
            }
            return e
        }, b.map = b.collect = function (e, t, n) {
            if (null == e) return [];
            t = b.iteratee(t, n);
            for (var r, o = e.length !== +e.length && b.keys(e), a = (o || e).length, i = Array(a), s = 0; a > s; s++) r = o ? o[s] : s, i[s] = t(e[r], r, e);
            return i
        };
        var _ = "Reduce of empty array with no initial value";
        b.reduce = b.foldl = b.inject = function (e, t, n, r) {
            null == e && (e = []), t = y(t, r, 4);
            var o, a = e.length !== +e.length && b.keys(e),
                i = (a || e).length,
                s = 0;
            if (arguments.length < 3) {
                if (!i) throw new TypeError(_);
                n = e[a ? a[s++] : s++]
            }
            for (; i > s; s++) o = a ? a[s] : s, n = t(n, e[o], o, e);
            return n
        }, b.reduceRight = b.foldr = function (e, t, n, r) {
            null == e && (e = []), t = y(t, r, 4);
            var o, a = e.length !== +e.length && b.keys(e),
                i = (a || e).length;
            if (arguments.length < 3) {
                if (!i) throw new TypeError(_);
                n = e[a ? a[--i] : --i]
            }
            for (; i--;) o = a ? a[i] : i, n = t(n, e[o], o, e);
            return n
        }, b.find = b.detect = function (e, t, n) {
            var r;
            return t = b.iteratee(t, n), b.some(e, function (e, n, o) {
                return t(e, n, o) ? (r = e, !0) : void 0
            }), r
        }, b.filter = b.select = function (e, t, n) {
            var r = [];
            return null == e ? r : (t = b.iteratee(t, n), b.each(e, function (e, n, o) {
                t(e, n, o) && r.push(e)
            }), r)
        }, b.reject = function (e, t, n) {
            return b.filter(e, b.negate(b.iteratee(t)), n)
        }, b.every = b.all = function (e, t, n) {
            if (null == e) return !0;
            t = b.iteratee(t, n);
            var r, o, a = e.length !== +e.length && b.keys(e),
                i = (a || e).length;
            for (r = 0; i > r; r++) if (o = a ? a[r] : r, !t(e[o], o, e)) return !1;
            return !0
        }, b.some = b.any = function (e, t, n) {
            if (null == e) return !1;
            t = b.iteratee(t, n);
            var r, o, a = e.length !== +e.length && b.keys(e),
                i = (a || e).length;
            for (r = 0; i > r; r++) if (o = a ? a[r] : r, t(e[o], o, e)) return !0;
            return !1
        }, b.contains = b.include = function (e, t) {
            return null == e ? !1 : (e.length !== +e.length && (e = b.values(e)), b.indexOf(e, t) >= 0)
        }, b.invoke = function (e, t) {
            var n = l.call(arguments, 2),
                r = b.isFunction(t);
            return b.map(e, function (e) {
                return (r ? t : e[t]).apply(e, n)
            })
        }, b.pluck = function (e, t) {
            return b.map(e, b.property(t))
        }, b.where = function (e, t) {
            return b.filter(e, b.matches(t))
        }, b.findWhere = function (e, t) {
            return b.find(e, b.matches(t))
        }, b.max = function (e, t, n) {
            var r, o, a = -1 / 0,
                i = -1 / 0;
            if (null == t && null != e) {
                e = e.length === +e.length ? e : b.values(e);
                for (var s = 0, c = e.length; c > s; s++) r = e[s], r > a && (a = r)
            } else t = b.iteratee(t, n), b.each(e, function (e, n, r) {
                o = t(e, n, r), (o > i || o === -1 / 0 && a === -1 / 0) && (a = e, i = o)
            });
            return a
        }, b.min = function (e, t, n) {
            var r, o, a = 1 / 0,
                i = 1 / 0;
            if (null == t && null != e) {
                e = e.length === +e.length ? e : b.values(e);
                for (var s = 0, c = e.length; c > s; s++) r = e[s], a > r && (a = r)
            } else t = b.iteratee(t, n), b.each(e, function (e, n, r) {
                o = t(e, n, r), (i > o || 1 / 0 === o && 1 / 0 === a) && (a = e, i = o)
            });
            return a
        }, b.shuffle = function (e) {
            for (var t, n = e && e.length === +e.length ? e : b.values(e), r = n.length, o = Array(r), a = 0; r > a; a++) t = b.random(0, a), t !== a && (o[a] = o[t]), o[t] = n[a];
            return o
        }, b.sample = function (e, t, n) {
            return null == t || n ? (e.length !== +e.length && (e = b.values(e)), e[b.random(e.length - 1)]) : b.shuffle(e).slice(0, Math.max(0, t))
        }, b.sortBy = function (e, t, n) {
            return t = b.iteratee(t, n), b.pluck(b.map(e, function (e, n, r) {
                return {
                    value: e,
                    index: n,
                    criteria: t(e, n, r)
                }
            }).sort(function (e, t) {
                var n = e.criteria,
                    r = t.criteria;
                if (n !== r) {
                    if (n > r || void 0 === n) return 1;
                    if (r > n || void 0 === r) return -1
                }
                return e.index - t.index
            }), "value")
        };
        var A = function (e) {
                return function (t, n, r) {
                    var o = {};
                    return n = b.iteratee(n, r), b.each(t, function (r, a) {
                        var i = n(r, a, t);
                        e(o, r, i)
                    }), o
                }
            };
        b.groupBy = A(function (e, t, n) {
            b.has(e, n) ? e[n].push(t) : e[n] = [t]
        }), b.indexBy = A(function (e, t, n) {
            e[n] = t
        }), b.countBy = A(function (e, t, n) {
            b.has(e, n) ? e[n]++ : e[n] = 1
        }), b.sortedIndex = function (e, t, n, r) {
            n = b.iteratee(n, r, 1);
            for (var o = n(t), a = 0, i = e.length; i > a;) {
                var s = a + i >>> 1;
                n(e[s]) < o ? a = s + 1 : i = s
            }
            return a
        }, b.toArray = function (e) {
            return e ? b.isArray(e) ? l.call(e) : e.length === +e.length ? b.map(e, b.identity) : b.values(e) : []
        }, b.size = function (e) {
            return null == e ? 0 : e.length === +e.length ? e.length : b.keys(e).length
        }, b.partition = function (e, t, n) {
            t = b.iteratee(t, n);
            var r = [],
                o = [];
            return b.each(e, function (e, n, a) {
                (t(e, n, a) ? r : o).push(e)
            }), [r, o]
        }, b.first = b.head = b.take = function (e, t, n) {
            return null == e ? void 0 : null == t || n ? e[0] : 0 > t ? [] : l.call(e, 0, t)
        }, b.initial = function (e, t, n) {
            return l.call(e, 0, Math.max(0, e.length - (null == t || n ? 1 : t)))
        }, b.last = function (e, t, n) {
            return null == e ? void 0 : null == t || n ? e[e.length - 1] : l.call(e, Math.max(e.length - t, 0))
        }, b.rest = b.tail = b.drop = function (e, t, n) {
            return l.call(e, null == t || n ? 1 : t)
        }, b.compact = function (e) {
            return b.filter(e, b.identity)
        };
        var E = function (e, t, n, r) {
                if (t && b.every(e, b.isArray)) return d.apply(r, e);
                for (var o = 0, a = e.length; a > o; o++) {
                    var i = e[o];
                    b.isArray(i) || b.isArguments(i) ? t ? u.apply(r, i) : E(i, t, n, r) : n || r.push(i)
                }
                return r
            };
        b.flatten = function (e, t) {
            return E(e, t, !1, [])
        }, b.without = function (e) {
            return b.difference(e, l.call(arguments, 1))
        }, b.uniq = b.unique = function (e, t, n, r) {
            if (null == e) return [];
            b.isBoolean(t) || (r = n, n = t, t = !1), null != n && (n = b.iteratee(n, r));
            for (var o = [], a = [], i = 0, s = e.length; s > i; i++) {
                var c = e[i];
                if (t) i && a === c || o.push(c), a = c;
                else if (n) {
                    var u = n(c, i, e);
                    b.indexOf(a, u) < 0 && (a.push(u), o.push(c))
                } else b.indexOf(o, c) < 0 && o.push(c)
            }
            return o
        }, b.union = function () {
            return b.uniq(E(arguments, !0, !0, []))
        }, b.intersection = function (e) {
            if (null == e) return [];
            for (var t = [], n = arguments.length, r = 0, o = e.length; o > r; r++) {
                var a = e[r];
                if (!b.contains(t, a)) {
                    for (var i = 1; n > i && b.contains(arguments[i], a); i++);
                    i === n && t.push(a)
                }
            }
            return t
        }, b.difference = function (e) {
            var t = E(l.call(arguments, 1), !0, !0, []);
            return b.filter(e, function (e) {
                return !b.contains(t, e)
            })
        }, b.zip = function (e) {
            if (null == e) return [];
            for (var t = b.max(arguments, "length").length, n = Array(t), r = 0; t > r; r++) n[r] = b.pluck(arguments, r);
            return n
        }, b.object = function (e, t) {
            if (null == e) return {};
            for (var n = {}, r = 0, o = e.length; o > r; r++) t ? n[e[r]] = t[r] : n[e[r][0]] = e[r][1];
            return n
        }, b.indexOf = function (e, t, n) {
            if (null == e) return -1;
            var r = 0,
                o = e.length;
            if (n) {
                if ("number" != typeof n) return r = b.sortedIndex(e, t), e[r] === t ? r : -1;
                r = 0 > n ? Math.max(0, o + n) : n
            }
            for (; o > r; r++) if (e[r] === t) return r;
            return -1
        }, b.lastIndexOf = function (e, t, n) {
            if (null == e) return -1;
            var r = e.length;
            for ("number" == typeof n && (r = 0 > n ? r + n + 1 : Math.min(r, n + 1)); --r >= 0;) if (e[r] === t) return r;
            return -1
        }, b.range = function (e, t, n) {
            arguments.length <= 1 && (t = e || 0, e = 0), n = n || 1;
            for (var r = Math.max(Math.ceil((t - e) / n), 0), o = Array(r), a = 0; r > a; a++, e += n) o[a] = e;
            return o
        };
        var v = function () {};
        b.bind = function (e, t) {
            var n, r;
            if (m && e.bind === m) return m.apply(e, l.call(arguments, 1));
            if (!b.isFunction(e)) throw new TypeError("Bind must be called on a function");
            return n = l.call(arguments, 2), r = function () {
                if (!(this instanceof r)) return e.apply(t, n.concat(l.call(arguments)));
                v.prototype = e.prototype;
                var o = new v;
                v.prototype = null;
                var a = e.apply(o, n.concat(l.call(arguments)));
                return b.isObject(a) ? a : o
            }
        }, b.partial = function (e) {
            var t = l.call(arguments, 1);
            return function () {
                for (var n = 0, r = t.slice(), o = 0, a = r.length; a > o; o++) r[o] === b && (r[o] = arguments[n++]);
                for (; n < arguments.length;) r.push(arguments[n++]);
                return e.apply(this, r)
            }
        }, b.bindAll = function (e) {
            var t, n, r = arguments.length;
            if (1 >= r) throw new Error("bindAll must be passed function names");
            for (t = 1; r > t; t++) n = arguments[t], e[n] = b.bind(e[n], e);
            return e
        }, b.memoize = function (e, t) {
            var n = function (r) {
                    var o = n.cache,
                        a = t ? t.apply(this, arguments) : r;
                    return b.has(o, a) || (o[a] = e.apply(this, arguments)), o[a]
                };
            return n.cache = {}, n
        }, b.delay = function (e, t) {
            var n = l.call(arguments, 2);
            return setTimeout(function () {
                return e.apply(null, n)
            }, t)
        }, b.defer = function (e) {
            return b.delay.apply(b, [e, 1].concat(l.call(arguments, 1)))
        }, b.throttle = function (e, t, n) {
            var r, o, a, i = null,
                s = 0;
            n || (n = {});
            var c = function () {
                    s = n.leading === !1 ? 0 : b.now(), i = null, a = e.apply(r, o), i || (r = o = null)
                };
            return function () {
                var u = b.now();
                s || n.leading !== !1 || (s = u);
                var l = t - (u - s);
                return r = this, o = arguments, 0 >= l || l > t ? (clearTimeout(i), i = null, s = u, a = e.apply(r, o), i || (r = o = null)) : i || n.trailing === !1 || (i = setTimeout(c, l)), a
            }
        }, b.debounce = function (e, t, n) {
            var r, o, a, i, s, c = function () {
                    var u = b.now() - i;
                    t > u && u > 0 ? r = setTimeout(c, t - u) : (r = null, n || (s = e.apply(a, o), r || (a = o = null)))
                };
            return function () {
                a = this, o = arguments, i = b.now();
                var u = n && !r;
                return r || (r = setTimeout(c, t)), u && (s = e.apply(a, o), a = o = null), s
            }
        }, b.wrap = function (e, t) {
            return b.partial(t, e)
        }, b.negate = function (e) {
            return function () {
                return !e.apply(this, arguments)
            }
        }, b.compose = function () {
            var e = arguments,
                t = e.length - 1;
            return function () {
                for (var n = t, r = e[t].apply(this, arguments); n--;) r = e[n].call(this, r);
                return r
            }
        }, b.after = function (e, t) {
            return function () {
                return --e < 1 ? t.apply(this, arguments) : void 0
            }
        }, b.before = function (e, t) {
            var n;
            return function () {
                return --e > 0 ? n = t.apply(this, arguments) : t = null, n
            }
        }, b.once = b.partial(b.before, 2), b.keys = function (e) {
            if (!b.isObject(e)) return [];
            if (f) return f(e);
            var t = [];
            for (var n in e) b.has(e, n) && t.push(n);
            return t
        }, b.values = function (e) {
            for (var t = b.keys(e), n = t.length, r = Array(n), o = 0; n > o; o++) r[o] = e[t[o]];
            return r
        }, b.pairs = function (e) {
            for (var t = b.keys(e), n = t.length, r = Array(n), o = 0; n > o; o++) r[o] = [t[o], e[t[o]]];
            return r
        }, b.invert = function (e) {
            for (var t = {}, n = b.keys(e), r = 0, o = n.length; o > r; r++) t[e[n[r]]] = n[r];
            return t
        }, b.functions = b.methods = function (e) {
            var t = [];
            for (var n in e) b.isFunction(e[n]) && t.push(n);
            return t.sort()
        }, b.extend = function (e) {
            if (!b.isObject(e)) return e;
            for (var t, n, r = 1, o = arguments.length; o > r; r++) {
                t = arguments[r];
                for (n in t) h.call(t, n) && (e[n] = t[n])
            }
            return e
        }, b.pick = function (e, t, n) {
            var r, o = {};
            if (null == e) return o;
            if (b.isFunction(t)) {
                t = y(t, n);
                for (r in e) {
                    var a = e[r];
                    t(a, r, e) && (o[r] = a)
                }
            } else {
                var i = d.apply([], l.call(arguments, 1));
                e = new Object(e);
                for (var s = 0, c = i.length; c > s; s++) r = i[s], r in e && (o[r] = e[r])
            }
            return o
        }, b.omit = function (e, t, n) {
            if (b.isFunction(t)) t = b.negate(t);
            else {
                var r = b.map(d.apply([], l.call(arguments, 1)), String);
                t = function (e, t) {
                    return !b.contains(r, t)
                }
            }
            return b.pick(e, t, n)
        }, b.defaults = function (e) {
            if (!b.isObject(e)) return e;
            for (var t = 1, n = arguments.length; n > t; t++) {
                var r = arguments[t];
                for (var o in r) void 0 === e[o] && (e[o] = r[o])
            }
            return e
        }, b.clone = function (e) {
            return b.isObject(e) ? b.isArray(e) ? e.slice() : b.extend({}, e) : e
        }, b.tap = function (e, t) {
            return t(e), e
        };
        var N = function (e, t, n, r) {
                if (e === t) return 0 !== e || 1 / e === 1 / t;
                if (null == e || null == t) return e === t;
                e instanceof b && (e = e._wrapped), t instanceof b && (t = t._wrapped);
                var o = p.call(e);
                if (o !== p.call(t)) return !1;
                switch (o) {
                case "[object RegExp]":
                case "[object String]":
                    return "" + e == "" + t;
                case "[object Number]":
                    return +e !== +e ? +t !== +t : 0 === +e ? 1 / +e === 1 / t : +e === +t;
                case "[object Date]":
                case "[object Boolean]":
                    return +e === +t
                }
                if ("object" != typeof e || "object" != typeof t) return !1;
                for (var a = n.length; a--;) if (n[a] === e) return r[a] === t;
                var i = e.constructor,
                    s = t.constructor;
                if (i !== s && "constructor" in e && "constructor" in t && !(b.isFunction(i) && i instanceof i && b.isFunction(s) && s instanceof s)) return !1;
                n.push(e), r.push(t);
                var c, u;
                if ("[object Array]" === o) {
                    if (c = e.length, u = c === t.length) for (; c-- && (u = N(e[c], t[c], n, r)););
                } else {
                    var l, d = b.keys(e);
                    if (c = d.length, u = b.keys(t).length === c) for (; c-- && (l = d[c], u = b.has(t, l) && N(e[l], t[l], n, r)););
                }
                return n.pop(), r.pop(), u
            };
        b.isEqual = function (e, t) {
            return N(e, t, [], [])
        }, b.isEmpty = function (e) {
            if (null == e) return !0;
            if (b.isArray(e) || b.isString(e) || b.isArguments(e)) return 0 === e.length;
            for (var t in e) if (b.has(e, t)) return !1;
            return !0
        }, b.isElement = function (e) {
            return !(!e || 1 !== e.nodeType)
        }, b.isArray = g ||
        function (e) {
            return "[object Array]" === p.call(e)
        }, b.isObject = function (e) {
            var t = typeof e;
            return "function" === t || "object" === t && !! e
        }, b.each(["Arguments", "Function", "String", "Number", "Date", "RegExp"], function (e) {
            b["is" + e] = function (t) {
                return p.call(t) === "[object " + e + "]"
            }
        }), b.isArguments(arguments) || (b.isArguments = function (e) {
            return b.has(e, "callee")
        }), "function" != typeof / . / && (b.isFunction = function (e) {
            return "function" == typeof e || !1
        }), b.isFinite = function (e) {
            return isFinite(e) && !isNaN(parseFloat(e))
        }, b.isNaN = function (e) {
            return b.isNumber(e) && e !== +e
        }, b.isBoolean = function (e) {
            return e === !0 || e === !1 || "[object Boolean]" === p.call(e)
        }, b.isNull = function (e) {
            return null === e
        }, b.isUndefined = function (e) {
            return void 0 === e
        }, b.has = function (e, t) {
            return null != e && h.call(e, t)
        }, b.noConflict = function () {
            return o._ = a, this
        }, b.identity = function (e) {
            return e
        }, b.constant = function (e) {
            return function () {
                return e
            }
        }, b.noop = function () {}, b.property = function (e) {
            return function (t) {
                return t[e]
            }
        }, b.matches = function (e) {
            var t = b.pairs(e),
                n = t.length;
            return function (e) {
                if (null == e) return !n;
                e = new Object(e);
                for (var r = 0; n > r; r++) {
                    var o = t[r],
                        a = o[0];
                    if (o[1] !== e[a] || !(a in e)) return !1
                }
                return !0
            }
        }, b.times = function (e, t, n) {
            var r = Array(Math.max(0, e));
            t = y(t, n, 1);
            for (var o = 0; e > o; o++) r[o] = t(o);
            return r
        }, b.random = function (e, t) {
            return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
        }, b.now = Date.now ||
        function () {
            return (new Date).getTime()
        };
        var C = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#x27;",
            "`": "&#x60;"
        },
            S = b.invert(C),
            R = function (e) {
                var t = function (t) {
                        return e[t]
                    },
                    n = "(?:" + b.keys(e).join("|") + ")",
                    r = RegExp(n),
                    o = RegExp(n, "g");
                return function (e) {
                    return e = null == e ? "" : "" + e, r.test(e) ? e.replace(o, t) : e
                }
            };
        b.escape = R(C), b.unescape = R(S), b.result = function (e, t) {
            if (null == e) return void 0;
            var n = e[t];
            return b.isFunction(n) ? e[t]() : n
        };
        var w = 0;
        b.uniqueId = function (e) {
            var t = ++w + "";
            return e ? e + t : t
        }, b.templateSettings = {
            evaluate: /<%([\s\S]+?)%>/g,
            interpolate: /<%=([\s\S]+?)%>/g,
            escape: /<%-([\s\S]+?)%>/g
        };
        var T = /(.)^/,
            F = {
                "'": "'",
                "\\": "\\",
                "\r": "r",
                "\n": "n",
                "\u2028": "u2028",
                "\u2029": "u2029"
            },
            D = /\\|'|\r|\n|\u2028|\u2029/g,
            B = function (e) {
                return "\\" + F[e]
            };
        b.template = function (e, t, n) {
            !t && n && (t = n), t = b.defaults({}, t, b.templateSettings);
            var r = RegExp([(t.escape || T).source, (t.interpolate || T).source, (t.evaluate || T).source].join("|") + "|$", "g"),
                o = 0,
                a = "__p+='";
            e.replace(r, function (t, n, r, i, s) {
                return a += e.slice(o, s).replace(D, B), o = s + t.length, n ? a += "'+\n((__t=(" + n + "))==null?'':_.escape(__t))+\n'" : r ? a += "'+\n((__t=(" + r + "))==null?'':__t)+\n'" : i && (a += "';\n" + i + "\n__p+='"), t
            }), a += "';\n", t.variable || (a = "with(obj||{}){\n" + a + "}\n"), a = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + a + "return __p;\n";
            try {
                var i = new Function(t.variable || "obj", "_", a)
            } catch (s) {
                throw s.source = a, s
            }
            var c = function (e) {
                    return i.call(this, e, b)
                },
                u = t.variable || "obj";
            return c.source = "function(" + u + "){\n" + a + "}", c
        }, b.chain = function (e) {
            var t = b(e);
            return t._chain = !0, t
        };
        var I = function (e) {
                return this._chain ? b(e).chain() : e
            };
        b.mixin = function (e) {
            b.each(b.functions(e), function (t) {
                var n = b[t] = e[t];
                b.prototype[t] = function () {
                    var e = [this._wrapped];
                    return u.apply(e, arguments), I.call(this, n.apply(b, e))
                }
            })
        }, b.mixin(b), b.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function (e) {
            var t = i[e];
            b.prototype[e] = function () {
                var n = this._wrapped;
                return t.apply(n, arguments), "shift" !== e && "splice" !== e || 0 !== n.length || delete n[0], I.call(this, n)
            }
        }), b.each(["concat", "join", "slice"], function (e) {
            var t = i[e];
            b.prototype[e] = function () {
                return I.call(this, t.apply(this._wrapped, arguments))
            }
        }), b.prototype.value = function () {
            return this._wrapped
        }, n = [], r = function () {
            return b
        }.apply(t, n), !(void 0 !== r && (e.exports = r))
    }).call(this)
}, function (e) {
    e.exports = function (e, t) {
        var n = e.length,
            r = e.indexOf(t) + 1;
        return r > n - 1 && (r = 0), e[r]
    }
}, function (e) {
    function t() {
        this.storage = {}
    }
    t.prototype.add = function (e, t) {
        var n = this.storage[e] || (this.storage[e] = []);
        n.push(t)
    }, t.prototype.remove = function (e) {
        var t, n;
        for (t in this.storage) n = this.storage[t], n.some(function (t, r) {
            return t === e ? (n.splice(r, 1), !0) : void 0
        })
    }, t.prototype.get = function (e) {
        var t, n = [];
        for (t in this.storage)(e === t || 0 === t.indexOf(e + ".")) && (n = n.concat(this.storage[t]));
        return n
    }, e.exports = t
}, function (e, t, n) {
    function r(e, t) {
        if (t || (t = {}), t.model && (this.model = t.model), t.comparator && (this.comparator = t.comparator), t.parent && (this.parent = t.parent), !this.mainIndex) {
            var n = this.model && this.model.prototype && this.model.prototype.idAttribute;
            this.mainIndex = n || "id"
        }
        this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, s({
            silent: !0
        }, t))
    }
    var o = n(181),
        a = n(183),
        i = n(182),
        s = n(184),
        c = [].slice;
    s(r.prototype, o, {
        initialize: function () {},
        indexes: [],
        isModel: function (e) {
            return this.model && e instanceof this.model
        },
        add: function (e, t) {
            return this.set(e, s({
                merge: !1,
                add: !0,
                remove: !1
            }, t))
        },
        parse: function (e) {
            return e
        },
        serialize: function () {
            return this.map(function (e) {
                if (e.serialize) return e.serialize();
                var t = {};
                return s(t, e), delete t.collection, t
            })
        },
        toJSON: function () {
            return this.serialize()
        },
        set: function (e, t) {
            t = s({
                add: !0,
                remove: !0,
                merge: !0
            }, t), t.parse && (e = this.parse(e, t));
            var n = !i(e);
            e = n ? e ? [e] : [] : e.slice();
            var r, o, a, c, u, l, d, p = t.at,
                h = this.comparator && null == p && t.sort !== !1,
                g = "string" == typeof this.comparator ? this.comparator : null,
                f = [],
                m = [],
                b = {},
                y = t.add,
                _ = t.merge,
                A = t.remove,
                E = !h && y && A ? [] : !1,
                v = this.model && this.model.prototype || Object.prototype;
            for (l = 0, d = e.length; d > l; l++) {
                if (a = e[l] || {}, r = this.isModel(a) ? o = a : v.generateId ? v.generateId(a) : a[v.idAttribute || this.mainIndex], c = this.get(r)) A && (b[c.cid || c[this.mainIndex]] = !0), _ && (a = a === o ? o.attributes : a, t.parse && (a = c.parse(a, t)), c.set ? (c.set(a, t), h && !u && c.hasChanged(g) && (u = !0)) : s(c, a)), e[l] = c;
                else if (y) {
                    if (o = e[l] = this._prepareModel(a, t), !o) continue;
                    f.push(o), this._addReference(o, t)
                }
                o = c || o, o && (E && (o.isNew && o.isNew() || !o[this.mainIndex] || !b[o.cid || o[this.mainIndex]]) && E.push(o), b[o[this.mainIndex]] = !0)
            }
            if (A) {
                for (l = 0, d = this.length; d > l; l++) o = this.models[l], b[o.cid || o[this.mainIndex]] || m.push(o);
                m.length && this.remove(m, t)
            }
            if (f.length || E && E.length) if (h && (u = !0), null != p) for (l = 0, d = f.length; d > l; l++) this.models.splice(p + l, 0, f[l]);
            else {
                var N = E || f;
                for (l = 0, d = N.length; d > l; l++) this.models.push(N[l])
            }
            if (u && this.sort({
                silent: !0
            }), !t.silent) {
                for (l = 0, d = f.length; d > l; l++) o = f[l], o.trigger ? o.trigger("add", o, this, t) : this.trigger("add", o, this, t);
                (u || E && E.length) && this.trigger("sort", this, t)
            }
            return n ? e[0] : e
        },
        get: function (e, t) {
            if (e) {
                var n = this._indexes[t || this.mainIndex];
                return n[e] || n[e[this.mainIndex]] || this._indexes.cid[e] || this._indexes.cid[e.cid]
            }
        },
        at: function (e) {
            return this.models[e]
        },
        remove: function (e, t) {
            var n, r, o, a, s = !i(e);
            for (e = s ? [e] : c.call(e), t || (t = {}), n = 0, r = e.length; r > n; n++) o = e[n] = this.get(e[n]), o && (this._deIndex(o), a = this.models.indexOf(o), this.models.splice(a, 1), t.silent || (t.index = a, o.trigger ? o.trigger("remove", o, this, t) : this.trigger("remove", o, this, t)), this._removeReference(o, t));
            return s ? e[0] : e
        },
        reset: function (e, t) {
            t || (t = {});
            for (var n = 0, r = this.models.length; r > n; n++) this._removeReference(this.models[n], t);
            return t.previousModels = this.models, this._reset(), e = this.add(e, s({
                silent: !0
            }, t)), t.silent || this.trigger("reset", this, t), e
        },
        sort: function (e) {
            var t = this;
            if (!this.comparator) throw new Error("Cannot sort a set without a comparator");
            return e || (e = {}), this.models.sort("string" == typeof this.comparator ?
            function (e, n) {
                return e.get ? (e = e.get(t.comparator), n = n.get(t.comparator)) : (e = e[t.comparator], n = n[t.comparator]), e > n || void 0 === e ? 1 : n > e || void 0 === n ? -1 : 0
            } : 1 === this.comparator.length ?
            function (e, n) {
                return e = t.comparator(e), n = t.comparator(n), e > n || void 0 === e ? 1 : n > e || void 0 === n ? -1 : 0
            } : this.comparator.bind(this)), e.silent || this.trigger("sort", this, e), this
        },
        _reset: function () {
            var e = this.indexes || [],
                t = 0;
            e.push(this.mainIndex), e.push("cid");
            var n = e.length;
            for (this.models = [], this._indexes = {}; n > t; t++) this._indexes[e[t]] = {}
        },
        _prepareModel: function (e, t) {
            if (!this.model) return e;
            if (this.isModel(e)) return e.collection || (e.collection = this), e;
            t = t ? s({}, t) : {}, t.collection = this;
            var n = new this.model(e, t);
            return n.validationError ? (this.trigger("invalid", this, n.validationError, t), !1) : n
        },
        _deIndex: function (e) {
            for (var t in this._indexes) delete this._indexes[t][e[t] || e.get && e.get(t)]
        },
        _index: function (e) {
            for (var t in this._indexes) {
                var n = e[t] || e.get && e.get(t);
                n && (this._indexes[t][n] = e)
            }
        },
        _addReference: function (e) {
            this._index(e), e.collection || (e.collection = this), e.on && e.on("all", this._onModelEvent, this)
        },
        _removeReference: function (e) {
            this === e.collection && delete e.collection, this._deIndex(e), e.off && e.off("all", this._onModelEvent, this)
        },
        _onModelEvent: function (e, t, n, r) {
            ("add" !== e && "remove" !== e || n === this) && ("destroy" === e && this.remove(t, r), t && e === "change:" + this.mainIndex && (this._deIndex(t), this._index(t)), this.trigger.apply(this, arguments))
        }
    }), Object.defineProperties(r.prototype, {
        length: {
            get: function () {
                return this.models.length
            }
        },
        isCollection: {
            value: !0
        }
    });
    var u = ["indexOf", "lastIndexOf", "every", "some", "forEach", "map", "filter", "reduce", "reduceRight"];
    u.forEach(function (e) {
        r.prototype[e] = function () {
            return this.models[e].apply(this.models, arguments)
        }
    }), r.prototype.each = r.prototype.forEach, r.extend = a, e.exports = r
}, function (e) {
    function t() {
        if (!a) {
            a = !0;
            for (var e, t = o.length; t;) {
                e = o, o = [];
                for (var n = -1; ++n < t;) e[n]();
                t = o.length
            }
            a = !1
        }
    }
    function n() {}
    var r = e.exports = {},
        o = [],
        a = !1;
    r.nextTick = function (e) {
        o.push(e), a || setTimeout(t, 0)
    }, r.title = "browser", r.browser = !0, r.env = {}, r.argv = [], r.version = "", r.on = n, r.addListener = n, r.once = n, r.off = n, r.removeListener = n, r.removeAllListeners = n, r.emit = n, r.binding = function () {
        throw new Error("process.binding is not supported")
    }, r.cwd = function () {
        return "/"
    }, r.chdir = function () {
        throw new Error("process.chdir is not supported")
    }, r.umask = function () {
        return 0
    }
}, function (e, t, n) {
    var r = n(185),
        o = n(97),
        a = n(110),
        i = (n(46), n(47)),
        s = n(48),
        c = n(168),
        u = n(94),
        l = n(31),
        d = n(186),
        p = n(187),
        h = n(77),
        g = n(138),
        f = n(188),
        m = n(33),
        b = React.addons.classSet,
        y = React.addons.PureRenderMixin,
        A = React.createClass({
            displayName: "MessageList",
            propTypes: {
                chatId: React.PropTypes.string.isRequired,
                unreadCount: React.PropTypes.number,
                msgs: React.PropTypes.arrayOf(React.PropTypes.instanceOf(o)).isRequired
            },
            propChangeType: function (e) {
                var t = this.props.msgs,
                    n = e.msgs;
                return this.props.chatId !== e.chatId ? "switch" : t.length && n.length && t[0].get("id") !== n[0].get("id") ? "back" : t.length === n.length || n.length < t.length ? "mutate" : "front"
            },
            didInsertMessageUnread: function () {
                this.shouldScrollBottom = !1, this.shouldRestoreScroll = void 0
            },
            componentDidMount: function () {
                if (this.shouldScrollBottom !== !1) {
                    var e = document.getElementById("pane-main");
                    e.scrollTop = e.scrollHeight
                }
            },
            componentWillUpdate: function (e) {
                var t = document.getElementById("pane-main"),
                    n = this.propChangeType(e);
                if ("switch" === n) this.shouldScrollBottom = !0;
                else if ("front" === n) {
                    var r = _.last(e.msgs);
                    (r.get("isSentByMe") || t.scrollTop + t.offsetHeight === t.scrollHeight) && (this.shouldScrollBottom = !0), this.shouldScrollBottom || (this.shouldRestoreScroll = t.scrollHeight - t.scrollTop - t.clientHeight)
                } else "back" === n && (this.shouldRestoreScroll = t.scrollHeight - t.scrollTop - t.clientHeight)
            },
            componentDidUpdate: function () {
                var e = document.getElementById("pane-main");
                this.shouldScrollBottom ? (e.scrollTop = e.scrollHeight, this.shouldScrollBottom = !1) : "undefined" != typeof this.shouldRestoreScroll && (e.scrollTop = e.scrollHeight - this.shouldRestoreScroll - e.clientHeight, this.shouldRestoreScroll = void 0)
            },
            render: function () {
                for (var e, t = [], n = this.props.msgs, r = n.length, o = this.props.unreadCount, a = ["chat", "image", "video", "audio", "vcard", "location", "ptt"]; o > 0;) {
                    if (r--, 0 > r) {
                        r = n.length;
                        break
                    }
                    e = n[r], a.indexOf(e.type) > -1 && o--
                }
                for (var i = Wa.isGroupWid(this.props.chatId), s = 0; s < n.length; s++) if (e = n[s]) {
                    if (0 === s || !n[s - 1].isSameDay(e)) {
                        var c = moment.unix(e.t).format("LL").toUpperCase(),
                            u = "msg-" + Wa.widToKey(e.id) + "-date";
                        t.push(React.createElement("div", {
                            className: "msg",
                            key: u
                        }, React.createElement("div", {
                            className: "message message-system"
                        }, React.createElement(k, {
                            text: c
                        }))))
                    }
                    s === r && t.push(React.createElement("div", {
                        className: "msg msg-unread msg-wide",
                        key: "msg-unread"
                    }, React.createElement(P, {
                        didInsert: this.didInsertMessageUnread,
                        count: this.props.unreadCount
                    })));
                    var l, d = e.get("type"),
                        p = e.get("subtype");
                    switch (e.get("type")) {
                    case "chat":
                        var h;
                        if (i) {
                            var g = _.matches({
                                type: "chat",
                                isSentByMe: !1,
                                author: e.author,
                                startOfDay: e.startOfDay
                            });
                            h = [e];
                            for (var f;
                            (f = n[s + 1]) && g(f) && s + 1 !== r;) h.push(f), s++
                        }
                        l = h && h.length > 1 ? React.createElement(N, {
                            msgs: h
                        }) : React.createElement(v, {
                            msg: e
                        });
                        break;
                    case "image":
                        l = React.createElement(C, {
                            msg: e
                        });
                        break;
                    case "group_notification":
                    case "gp2":
                    case "broadcast_notification":
                    case "notification":
                        var m = e.get("body");
                        Wa.isTypeGroupNotification(d) ? m = Wa.formatGroupNotification(e) : "broadcast_notification" === d && (m = Wa.formatBroadcastNotification(p, e.get("body"))), l = React.createElement(k, {
                            text: m
                        });
                        break;
                    case "audio":
                    case "video":
                        l = React.createElement(S, {
                            msg: e
                        });
                        break;
                    case "vcard":
                        l = React.createElement(w, {
                            msg: e
                        });
                        break;
                    case "location":
                        l = React.createElement(T, {
                            msg: e
                        });
                        break;
                    case "ptt":
                        l = React.createElement(F, {
                            msg: e
                        });
                        break;
                    default:
                        Wa.debug("Unknown message type: " + d)
                    }
                    t.push(React.createElement(E, {
                        key: "msg-" + Wa.widToKey(e.get("id")),
                        msg: e,
                        component: l
                    }))
                }
                return React.createElement("div", {
                    className: "message-list"
                }, t)
            }
        }),
        E = React.createClass({
            displayName: "MessageWrapper",
            mixins: [i],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired,
                component: React.PropTypes.element.isRequired
            },
            shouldComponentUpdate: function (e) {
                return e.component !== this.props.component
            },
            componentWillMount: function () {
                var e = this.props.msg;
                e.isSentByMe && e.ack < 1 && this.addObserver(e, "change:dropped")
            },
            isNotification: function (e) {
                return "notification" === e || Wa.isTypeGroupNotification(e) || "broadcast_notification" === e
            },
            getClasses: function () {
                var e = "message",
                    t = this.props.msg,
                    n = t.get("type");
                return e += this.isNotification(n) ? " message-system" : t.get("isSentByMe") ? " message-out" : " message-in", (Wa.isTypeGroupNotification(n) || "broadcast_notification" === n) && (e += " message-group"), e
            },
            resend: function () {
                var e = this;
                Store.Msg.send(this.props.msg).then(function () {
                    e.isMounted() && e.forceUpdate()
                }, function (e) {
                    Wa.debug("failure: " + e)
                })
            },
            render: function () {
                var e = null;
                if (this.props.msg.dropped) {
                    var t = React.createElement("span", null, l10n.t("resend_message"));
                    e = React.createElement(r, {
                        style: {
                            "float": "right"
                        },
                        trigger: !0,
                        tooltip: t,
                        direction: "left"
                    }, React.createElement("button", {
                        className: "error",
                        onClick: this.resend
                    }, React.createElement("span", {
                        className: "icon icon-error"
                    })))
                }
                var n = "msg";
                return this.props.msg.isGroupMsg && (n += " msg-group"), React.createElement("div", {
                    className: n
                }, React.createElement("div", {
                    className: this.getClasses()
                }, e, this.props.component))
            }
        }),
        v = React.createClass({
            displayName: "MessageText",
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            shouldComponentUpdate: function () {
                return !1
            },
            render: function () {
                var e = this.props.msg,
                    t = "bubble bubble-text";
                return e.broadcast && (t += " bubble-text-broadcast"), React.createElement("div", {
                    className: t
                }, React.createElement(M, {
                    msg: e
                }), React.createElement("div", {
                    className: "message-text"
                }, React.createElement("pre", null, React.createElement(c, {
                    text: e.body,
                    linkify: !0,
                    wbr: 15
                })), React.createElement(O, {
                    msg: this.props.msg
                })))
            }
        }),
        N = React.createClass({
            displayName: "MultiMessageText",
            propTypes: {
                msgs: React.PropTypes.arrayOf(React.PropTypes.instanceOf(o))
            },
            render: function () {
                for (var e = this.props.msgs[0], t = [], n = 0; n < this.props.msgs.length; n++) e = this.props.msgs[n], t.push(React.createElement("div", {
                    className: "message-text",
                    key: "multi-msg-" + Wa.widToKey(e.get("id"))
                }, React.createElement("pre", null, React.createElement(c, {
                    text: e.body,
                    linkify: !0,
                    wbr: 15
                })), React.createElement(O, {
                    msg: e
                }))), n !== this.props.msgs.length - 1 && t.push(React.createElement("div", {
                    className: "message-divider",
                    key: "multi-div-" + Wa.widToKey(e.get("id"))
                }));
                return React.createElement("div", {
                    className: "bubble bubble-text"
                }, React.createElement("div", {
                    className: "contents"
                }, React.createElement(M, {
                    msg: e
                }), t))
            }
        }),
        C = React.createClass({
            displayName: "MessageImage",
            mixins: [a, s],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            defaultWidth: 330,
            canLoad: function () {
                return _.contains([o.URL_STATE.URL, o.URL_STATE.STATUS_200], this.props.msg.urlState)
            },
            getInitialState: function () {
                this.retry = 0;
                var e = this.props.msg,
                    t = e.url;
                return t && this.canLoad() && (this.isImageLoaded(t) ? e.urlState200(t) : this.preloadImage(t)), {
                    urlState: this.async("msg.urlState"),
                    url: this.async("msg.url"),
                    uploadState: this.async("msg.uploadState")
                }
            },
            componentDidMount: function () {
                this.regNativeListener(window, "online", this.ensureImageLoaded)
            },
            componentWillUpdate: function (e, t) {
                t.url !== this.state.url && this.canLoad() && this.preloadImage(t.url)
            },
            ensureImageLoaded: function () {
                var e = this.props.msg;
                e.url && e.urlState !== o.URL_STATE.STATUS_200 && this.preloadImage(e.url)
            },
            isImageLoaded: function (e) {
                if (!e) return !1;
                var t = new Image;
                return t.src = e, t.complete
            },
            preloadImage: function (e, t) {
                if (e) {
                    this.preloadImagePromise && this.preloadImagePromise.cancel();
                    var n = m.define("ImageError"),
                        r = this.preloadImagePromise = new Promise(function (t, r) {
                            var o = function (t) {
                                    var o = new n(t);
                                    o.src = e, r(o)
                                },
                                a = new Image;
                            a.onload = function () {
                                t(e)
                            }, a.onerror = o, a.src = e
                        }).bind(this).cancellable().then(this.onImgLoad)["catch"](Promise.CancellationError, _.noop)["catch"](n, t ? this.onImgErrorRMR : this.onImgError)["finally"](function () {
                            r === this.preloadImagePromise && delete this.preloadImagePromise
                        })
                }
            },
            onImgLoad: function (e) {
                this.props.msg.urlState200(e)
            },
            onImgError: function (e) {
                e.src === this.props.msg.url && (this.props.msg.urlState = o.URL_STATE.STATUS_ERR)
            },
            onImgErrorRMR: function (e) {
                this.props.msg.mediaLoadError(e.src)
            },
            getImgStyle: function () {
                var e = this.props.msg,
                    t = this.getHeight(e.width, e.height),
                    n = this.aspect(this.defaultWidth, t);
                return this.isPortrait(n) ? {
                    width: this.defaultWidth
                } : {
                    height: "100%"
                }
            },
            getStyle: function () {
                var e = this.props.msg;
                return {
                    width: this.defaultWidth + "px",
                    height: this.getHeight(e.width, e.height)
                }
            },
            getHeight: function (e, t) {
                e = e || 1, t = t || 1;
                var n, r = this.defaultWidth,
                    o = this.aspect(e, t),
                    a = this.isPortrait(o);
                return a ? n = r : o && (o > 2.4 ? n = r / 2.4 : e && t && (n = t * (r / e))), Math.round(n)
            },
            isPortrait: function (e) {
                return e ? 1 >= e : null
            },
            aspect: function (e, t) {
                return e && t ? e / t : void 0
            },
            showMissingMedia: function () {
                l.openModal(React.createElement(g, {
                    title: l10n.t("missing_photo_title"),
                    onOK: l.closeModal.bind(l),
                    okText: l10n.t("web_ok")
                }, l10n.t("missing_photo_text")))
            },
            cancelMediaReupload: function () {
                this.preloadImagePromise && this.preloadImagePromise.cancel(), this.props.msg.urlState = o.URL_STATE.NO_URL
            },
            requestMediaReupload: function () {
                var e = this.props.msg;
                e.url ? this.preloadImage(e.url, !0) : e.requestMediaReupload()
            },
            cancelMmsUpload: function () {
                var e = this.props.msg;
                e.uploadPromise && e.uploadPromise.cancel()
            },
            retryMmsUpload: function () {
                this.props.msg.reuploadMedia()["catch"](Promise.CancellationError, _.noop)["catch"](m.GaveUpRetry, _.noop)
            },
            launchMediaViewer: function () {
                l.openModal(React.createElement(f, {
                    msg: this.props.msg,
                    startElement: this.refs.img.getDOMNode()
                }), "media-viewer")
            },
            render: function () {
                var e = this.props.msg,
                    t = e.caption ? "" : React.createElement("div", {
                        className: "shade"
                    }),
                    n = e.caption ? React.createElement(R, {
                        caption: e.caption
                    }) : "",
                    r = {
                        "bubble-image": !0
                    };
                e.caption && (r["bubble-image-caption"] = !0);
                var a = {
                    "image-thumb-body": !0,
                    "image-thumb-lores": !0
                },
                    i = _.noop,
                    s = null,
                    c = "data:image/jpeg;base64," + e.body;
                switch (e.urlState) {
                case o.URL_STATE.INIT:
                case o.URL_STATE.REFRESHING:
                    s = React.createElement(p.Pending, null);
                    break;
                case o.URL_STATE.NO_URL:
                case o.URL_STATE.RMR_ERROR_RETRY:
                case o.URL_STATE.STATUS_ERR:
                    s = React.createElement(p.Download, {
                        filesize: e.size
                    }), i = this.requestMediaReupload;
                    break;
                case o.URL_STATE.REFRESH_RETRY:
                    s = React.createElement(p.Download, {
                        filesize: e.size
                    }), i = e.initializeMedia.bind(e);
                    break;
                case o.URL_STATE.URL:
                case o.URL_STATE.RMR_FETCHING:
                    s = React.createElement(p.PendingCancel, null), i = this.cancelMediaReupload;
                    break;
                case o.URL_STATE.RMR_ERROR_MISSING:
                    i = this.showMissingMedia;
                    break;
                case o.URL_STATE.STATUS_200:
                case o.URL_STATE.UPLOADING:
                    switch (delete a["image-thumb-lores"], c = e.url, e.uploadState) {
                    case o.UPLOAD_STATE.UPLOADING:
                        s = React.createElement(p.PendingCancel, null), i = this.cancelMmsUpload;
                        break;
                    case o.UPLOAD_STATE.RETRY:
                        s = React.createElement(p.Upload, {
                            filesize: e.size
                        }), i = this.retryMmsUpload;
                        break;
                    case o.UPLOAD_STATE.PHONE_UPLOADING:
                        s = React.createElement(p.Pending, null);
                        break;
                    default:
                        i = this.launchMediaViewer
                    }
                    break;
                default:
                    Wa.debug("Unknown image state")
                }
                return React.createElement("div", null, React.createElement("div", {
                    className: b(r)
                }, React.createElement(M, {
                    msg: e
                }), React.createElement("div", {
                    className: "image-thumb",
                    onClick: i,
                    style: this.getStyle()
                }, s, React.createElement("img", {
                    src: c,
                    className: b(a),
                    style: this.getImgStyle(),
                    ref: "img"
                }), t), n, React.createElement(O, {
                    msg: this.props.msg
                })))
            }
        }),
        S = React.createClass({
            displayName: "MessageMedia",
            mixins: [a, s],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            getInitialState: function () {
                return this.retry = 0, {
                    urlState: this.async("msg.urlState"),
                    url: this.async("msg.url"),
                    uploadState: this.async("msg.uploadState")
                }
            },
            showMissingMedia: function () {
                var e, t;
                switch (this.props.msg.type) {
                case "video":
                    e = l10n.t("missing_video_title"), t = l10n.t("missing_video_text");
                    break;
                case "audio":
                    e = l10n.t("missing_audio_title"), t = l10n.t("missing_audio_text")
                }
                l.openModal(React.createElement(g, {
                    title: e,
                    onOK: l.closeModal.bind(l),
                    okText: l10n.t("web_ok")
                }, t))
            },
            cancelMediaReupload: function () {
                this.preloadImagePromise && this.preloadImagePromise.cancel(), this.props.msg.urlState = o.URL_STATE.NO_URL
            },
            requestMediaReupload: function () {
                var e = this,
                    t = this.props.msg;
                t.requestMediaReupload().then(function () {
                    e.isMounted() && t.urlState === o.URL_STATE.URL && e.launchMediaViewer()
                })
            },
            launchMediaViewer: function () {
                l.openModal(React.createElement(f, {
                    msg: this.props.msg
                }), "media-viewer")
            },
            cancelMmsUpload: function () {
                var e = this.props.msg;
                e.uploadPromise && e.uploadPromise.cancel()
            },
            retryMmsUpload: function () {
                this.props.msg.reuploadMedia()["catch"](Promise.CancellationError, _.noop)
            },
            render: function () {
                var e = this.props.msg,
                    t = e.caption || "audio" === e.type ? "" : React.createElement("div", {
                        className: "shade"
                    }),
                    n = e.caption ? React.createElement(R, {
                        caption: e.caption
                    }) : "",
                    r = "bubble-image bubble-video";
                e.caption && (r += " bubble-image-caption");
                var a = _.noop,
                    i = null;
                switch (e.urlState) {
                case o.URL_STATE.INIT:
                case o.URL_STATE.REFRESHING:
                    i = React.createElement(p.Pending, null);
                    break;
                case o.URL_STATE.NO_URL:
                case o.URL_STATE.RMR_ERROR_RETRY:
                case o.URL_STATE.STATUS_ERR:
                    i = React.createElement(p.Download, {
                        filesize: e.size
                    }), a = this.requestMediaReupload;
                    break;
                case o.URL_STATE.REFRESH_RETRY:
                    i = React.createElement(p.Download, {
                        filesize: e.size
                    }), a = e.initializeMedia.bind(e);
                    break;
                case o.URL_STATE.RMR_FETCHING:
                    i = React.createElement(p.PendingCancel, null), a = this.cancelMediaReupload;
                    break;
                case o.URL_STATE.RMR_ERROR_MISSING:
                    a = this.showMissingMedia;
                    break;
                case o.URL_STATE.URL:
                case o.URL_STATE.STATUS_200:
                case o.URL_STATE.UPLOADING:
                    switch (e.uploadState) {
                    case o.UPLOAD_STATE.UPLOADING:
                        i = React.createElement(p.PendingCancel, null), a = this.cancelMmsUpload;
                        break;
                    case o.UPLOAD_STATE.RETRY:
                        i = React.createElement(p.Upload, {
                            filesize: e.size
                        }), a = this.retryMmsUpload;
                        break;
                    case o.UPLOAD_STATE.PHONE_UPLOADING:
                        i = React.createElement(p.Pending, null);
                        break;
                    default:
                        i = React.createElement(p.Play, null), a = this.launchMediaViewer
                    }
                    break;
                default:
                    Wa.debug("Unkonwn media state")
                }
                var s = Wa.formatDuration(e.duration);
                s && (s = React.createElement("span", {
                    className: "message-duration"
                }, "video" === e.type ? React.createElement("span", {
                    className: "icon-s icon-msg-video-light"
                }) : React.createElement("span", {
                    className: "icon-s icon-msg-audio-light"
                }), s));
                var c;
                if ("video" === e.type) {
                    var u = "data:image/jpeg;base64," + e.body,
                        l = {
                            backgroundImage: 'url("' + u + '")'
                        };
                    c = React.createElement("div", {
                        className: "image-thumb-body",
                        style: l
                    })
                } else "audio" === e.type && (c = React.createElement("div", {
                    className: "image-audio"
                }));
                return React.createElement("div", null, React.createElement("div", {
                    className: r
                }, React.createElement(M, {
                    msg: e
                }), React.createElement("div", {
                    className: "image-thumb",
                    onClick: a
                }, i, c, t, s), n, React.createElement(O, {
                    msg: this.props.msg
                })))
            }
        }),
        R = React.createClass({
            displayName: "MessageCaption",
            propTypes: {
                caption: React.PropTypes.string.isRequired
            },
            render: function () {
                return React.createElement("div", {
                    className: "image-caption message-text"
                }, React.createElement("pre", null, React.createElement(c, {
                    text: this.props.caption,
                    linkify: !0
                })))
            }
        }),
        w = React.createClass({
            displayName: "MessageVcard",
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            render: function () {
                var e = this.props.msg,
                    t = React.createElement(x, {
                        thumb: Wa.vCardGetThumbnail(e.body),
                        type: e.type,
                        ref: "media",
                        shade: !1,
                        duration: e.duration
                    }),
                    n = e.isSentByMe ? t : null,
                    r = e.isSentByMe ? null : t,
                    o = e.author ? "text" : "text no-author",
                    a = e.caption ? React.createElement(R, {
                        caption: e.caption
                    }) : "",
                    i = "bubble bubble-attach bubble-contact";
                return e.caption && (i += " bubble-attach-caption"), React.createElement("div", null, React.createElement("div", {
                    className: i
                }, React.createElement("div", {
                    className: "wrapper"
                }, n, React.createElement("div", {
                    className: "contents"
                }, React.createElement(M, {
                    msg: e
                }), React.createElement("div", {
                    className: o
                }, React.createElement(O, {
                    msg: this.props.msg,
                    contextMenu: this.contextMenu
                })), React.createElement(I, {
                    msg: e
                })), r), a))
            }
        }),
        T = React.createClass({
            displayName: "MessageLocation",
            mixins: [a],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            getInitialState: function () {
                return {
                    url: this.async("msg.body")
                }
            },
            googleMapUrl: function () {
                var e = this.props.msg,
                    t = this.loc();
                return t && t.name ? ["https://maps.google.com/maps/search", encodeURIComponent(t.name), "@" + e.lat + "," + e.lng + ",17z"].join("/") : Wa.buildUrl("https://maps.google.com/maps", {
                    q: e.lat + "," + e.lng,
                    z: 17
                })
            },
            mapUrl: function () {
                return this.props.msg.clientUrl || this.googleMapUrl()
            },
            loc: function () {
                var e = this.props.msg.get("loc");
                return e ? (e = e.split("\n"), 2 === e.length ? {
                    name: e[0],
                    addr: e[1]
                } : {
                    name: e
                }) : void 0
            },
            render: function () {
                var e, t, n = this.props.msg,
                    r = React.createElement("a", {
                        href: this.googleMapUrl(),
                        target: "_blank"
                    }, React.createElement(x, {
                        thumb: n.body,
                        type: n.type,
                        shade: !1
                    })),
                    o = n.isSentByMe ? r : null,
                    a = n.isSentByMe ? null : r,
                    i = n.isSentByMe ? "text no-author" : "text",
                    s = this.loc();
                return s ? (e = React.createElement("h4", {
                    className: "text-title"
                }, React.createElement("a", {
                    href: this.mapUrl(),
                    title: s.name,
                    target: "_blank"
                }, s.name)), t = s.addr ? React.createElement("p", {
                    title: s.addr
                }, s.addr) : "") : e = React.createElement("h4", {
                    className: "text-title"
                }, React.createElement("a", {
                    href: this.mapUrl(),
                    title: l10n.t("web_view"),
                    target: "_blank"
                }, l10n.t("web_view"))), React.createElement("div", {
                    className: "bubble bubble-attach bubble-location"
                }, React.createElement("div", {
                    className: "wrapper"
                }, o, React.createElement("div", {
                    className: "contents"
                }, React.createElement(M, {
                    msg: n
                }), React.createElement("div", {
                    className: i
                }, e, t, React.createElement(O, {
                    msg: n
                }))), a))
            }
        }),
        F = React.createClass({
            displayName: "MessagePTT",
            mixins: [a],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            getInitialState: function () {
                return {
                    uploadState: this.async("msg.uploadState"),
                    urlState: this.async("msg.urlState"),
                    url: this.async("msg.url"),
                    img: this.async("msg.sender.ProfilePicThumb.img"),
                    ack: this.async("msg.ack"),
                    currentTime: 0,
                    playing: !1,
                    autoPlay: !1
                }
            },
            getStatusClass: function (e) {
                return e += " audio-state-default", this.state.ack === Wa.CONST.ACK_PLAYED && (e += " audio-state-played"), e
            },
            cancelMmsUpload: function () {
                var e = this.props.msg;
                e.uploadPromise && e.uploadPromise.cancel()
            },
            retryMmsUpload: function () {
                this.props.msg.reuploadMedia()["catch"](Promise.CancellationError, _.noop)["catch"](m.GaveUpRetry, _.noop)
            },
            cancelMediaReupload: function () {
                this.props.msg.urlState = o.URL_STATE.NO_URL
            },
            requestMediaReupload: function () {
                this.props.msg.requestMediaReupload().bind(this).then(function () {
                    this.isMounted() && this.setState({
                        autoPlay: !0
                    })
                })
            },
            handleTimeUpdate: function (e) {
                this.setState({
                    currentTime: e
                })
            },
            handlePlayingUpdate: function (e) {
                this.setState({
                    playing: e
                })
            },
            render: function () {
                var e = this.props.msg,
                    t = this.getStatusClass("bubble bubble-attach bubble-audio"),
                    n = "audio-status icon ";
                n += this.state.ack === Wa.CONST.ACK_PLAYED ? e.isSentByMe ? "icon-ptt-out-blue" : "icon-ptt-in-blue" : e.isSentByMe ? "icon-ptt-out-gray" : "icon-ptt-in-green";
                var r, a = React.createElement("span", {
                    className: n,
                    key: "status"
                }),
                    i = this.state.playing ? this.state.currentTime : e.duration,
                    s = React.createElement(x, {
                        key: "image",
                        thumb: this.state.img,
                        type: e.type,
                        shade: !1,
                        duration: i
                    }),
                    c = e.isSentByMe ? [s, a] : null,
                    u = e.isSentByMe ? null : [s, a],
                    l = e.isSentByMe ? "text no-author" : "text",
                    d = e.isGroupMsg ? React.createElement(M, {
                        msg: e
                    }) : null;
                switch (e.urlState) {
                case o.URL_STATE.INIT:
                case o.URL_STATE.REFRESHING:
                    r = React.createElement(D, {
                        urlState: e.urlState
                    });
                    break;
                case o.URL_STATE.REFRESH_RETRY:
                case o.URL_STATE.RMR_FETCHING:
                case o.URL_STATE.NO_URL:
                case o.URL_STATE.RMR_ERROR_RETRY:
                case o.URL_STATE.STATUS_ERR:
                    r = React.createElement(D, {
                        action: this.requestMediaReupload,
                        urlState: e.urlState
                    });
                    break;
                case o.URL_STATE.RMR_FETCHING:
                    r = React.createElement(D, {
                        action: this.cancelMediaReupload,
                        urlState: e.urlState
                    });
                    break;
                case o.URL_STATE.STATUS_200:
                case o.URL_STATE.UPLOADING:
                    switch (e.uploadState) {
                    case o.UPLOAD_STATE.UPLOADING:
                        r = React.createElement(D, {
                            action: this.cancelMmsUpload,
                            uploadState: e.uploadState
                        });
                        break;
                    case o.UPLOAD_STATE.RETRY:
                        r = React.createElement(D, {
                            action: this.retryMmsUpload,
                            uploadState: e.uploadState
                        });
                        break;
                    case o.UPLOAD_STATE.PHONE_UPLOADING:
                        r = React.createElement(D, {
                            uploadState: e.uploadState
                        });
                        break;
                    default:
                        r = React.createElement(B, {
                            msg: e,
                            autoPlay: this.state.autoPlay,
                            onPlayingUpdate: this.handlePlayingUpdate,
                            onTimeUpdate: this.handleTimeUpdate
                        })
                    }
                    break;
                case o.URL_STATE.URL:
                case o.URL_STATE.RMR_ERROR_MISSING:
                    r = React.createElement(B, {
                        msg: e,
                        autoPlay: this.state.autoPlay,
                        onPlayingUpdate: this.handlePlayingUpdate,
                        onTimeUpdate: this.handleTimeUpdate
                    });
                    break;
                default:
                    Wa.debug("Unknown PTT state")
                }
                return React.createElement("div", {
                    className: t
                }, React.createElement("div", {
                    className: "wrapper"
                }, c, React.createElement("div", {
                    className: "contents"
                }, d, React.createElement("div", {
                    className: l
                }, r)), u, React.createElement(O, {
                    msg: e
                })))
            }
        }),
        D = React.createClass({
            displayName: "MessagePTTLoader",
            propTypes: {
                action: React.PropTypes.func,
                urlState: React.PropTypes.oneOf(_.values(o.URL_STATE)),
                uploadState: React.PropTypes.oneOf(_.values(o.UPLOAD_STATE))
            },
            render: function () {
                var e = null;
                switch (this.props.uploadState) {
                case o.UPLOAD_STATE.UPLOADING:
                    e = React.createElement("button", {
                        className: "btn-audio icon icon-audio-cancel-noborder",
                        onClick: this.props.action
                    }, React.createElement(h, {
                        stroke: 3,
                        size: 38
                    }));
                    break;
                case o.UPLOAD_STATE.RETRY:
                    e = React.createElement("button", {
                        className: "btn-audio icon icon-audio-upload",
                        onClick: this.props.action
                    });
                    break;
                default:
                    switch (this.props.urlState) {
                    case o.URL_STATE.INIT:
                    case o.URL_STATE.REFRESHING:
                        e = React.createElement("button", {
                            className: "btn-audio",
                            onClick: this.props.action
                        }, React.createElement(h, {
                            stroke: 3,
                            size: 38
                        }));
                        break;
                    case o.URL_STATE.REFRESH_RETRY:
                    case o.URL_STATE.NO_URL:
                    case o.URL_STATE.RMR_ERROR_RETRY:
                    case o.URL_STATE.STATUS_ERR:
                        e = React.createElement("button", {
                            className: "btn-audio icon icon-audio-download",
                            onClick: this.props.action
                        });
                        break;
                    case o.URL_STATE.RMR_FETCHING:
                        e = React.createElement("button", {
                            className: "btn-audio icon icon-audio-cancel-noborder",
                            onClick: this.props.action
                        }, React.createElement(h, {
                            stroke: 3,
                            size: 38
                        }));
                        break;
                    default:
                        Wa.debug("Unknown PTT state")
                    }
                }
                return React.createElement("div", {
                    className: "audio"
                }, React.createElement("div", {
                    className: "audio-controls"
                }, e), React.createElement("div", {
                    className: "audio-body"
                }, React.createElement("input", {
                    type: "range",
                    className: "audio-track",
                    min: 0,
                    max: 100,
                    value: 0,
                    disabled: "disabled"
                })))
            }
        }),
        B = React.createClass({
            displayName: "MessagePTTPlayer",
            mixins: [s],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired,
                autoPlay: React.PropTypes.bool.isRequired,
                onPlayingUpdate: React.PropTypes.func.isRequired,
                onTimeUpdate: React.PropTypes.func.isRequired
            },
            playing: !1,
            dragging: !1,
            getInitialState: function () {
                return {
                    progress: 0
                }
            },
            onPlayClick: function () {
                this.hasPlayed = !0;
                var e = this.refs.audio.getDOMNode();
                this.playing ? e.pause() : e.play()
            },
            onPlaying: function () {
                this.playing = !0;
                var e = this.props.msg;
                !e.get("isSentByMe") && e.get("ack") < Wa.CONST.ACK_PLAYED && e.sendPlayed(), this.props.onPlayingUpdate && this.props.onPlayingUpdate(this.playing)
            },
            onPause: function () {
                this.playing = !1, this.props.onPlayingUpdate && this.props.onPlayingUpdate(this.playing)
            },
            onEnded: function () {
                var e = this.refs.audio.getDOMNode();
                e.currentTime = 0
            },
            onTimeUpdate: function () {
                var e = this.refs.audio.getDOMNode(),
                    t = 0;
                e.duration && (t = Math.round(100 * e.currentTime / e.duration), this.props.onTimeUpdate && this.props.onTimeUpdate(e.currentTime)), this.setState({
                    progress: t
                })
            },
            componentDidMount: function () {
                var e = this.refs.audio.getDOMNode();
                this.regNativeListener(e, "loadeddata", this.onLoad), this.regNativeListener(e, "playing", this.onPlaying), this.regNativeListener(e, "pause", this.onPause), this.regNativeListener(e, "ended", this.onEnded), this.regNativeListener(e, "timeupdate", this.onTimeUpdate), this.regNativeListener(e, "durationchange", this.onTimeUpdate), this.regNativeListener(e, "progress", this.onTimeUpdate), this.regNativeListener(e, "error", this.onPlayerError)
            },
            onLoad: function () {
                this.props.msg.urlState = o.URL_STATE.STATUS_200
            },
            onPlayerError: function (e) {
                if (this.hasPlayed) {
                    var t = e.target.src,
                        n = e.target.error;
                    switch (n.code) {
                    case MediaError.MEDIA_ERR_NETWORK:
                    case MediaError.MEDIA_ERR_DECODE:
                    case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
                        this.props.msg.mediaLoadError(t);
                        break;
                    default:
                        Wa.debug("message ptt unknown error", n.code, t)
                    }
                } else this.props.msg.urlState = o.URL_STATE.NO_URL, this.props.msg.unset("url")
            },
            onDrag: function (e) {
                var t = this.refs.audio.getDOMNode();
                this.setState({
                    progress: e
                }), t.duration && (t.currentTime = t.duration / 100 * e)
            },
            showMissingMedia: function () {
                l.openModal(React.createElement(g, {
                    title: l10n.t("missing_audio_title"),
                    onOK: l.closeModal.bind(l),
                    okText: l10n.t("web_ok")
                }, l10n.t("missing_audio_text")))
            },
            render: function () {
                var e = "btn-audio icon ";
                e += this.playing ? "icon-audio-pause" : "icon-audio-play";
                var t = null;
                t = 'disabled="disabled"';
                var n = {
                    value: this.state.progress,
                    requestChange: this.onDrag
                },
                    r = this.props.msg.urlState === o.URL_STATE.RMR_ERROR_MISSING ? this.showMissingMedia : this.onPlayClick;
                return React.createElement("div", {
                    className: "audio"
                }, React.createElement("div", {
                    className: "audio-controls"
                }, React.createElement("button", {
                    ref: "play_pause",
                    className: e,
                    onClick: r
                })), React.createElement("div", {
                    className: "audio-body"
                }, React.createElement("div", {
                    className: "audio-track-container"
                }, React.createElement("span", {
                    className: "audio-progress",
                    style: {
                        width: this.state.progress + "%"
                    }
                }), React.createElement("input", {
                    type: "range",
                    className: "audio-track",
                    valueLink: n,
                    min: "0",
                    max: "100"
                }))), React.createElement(d, {
                    ref: "audio",
                    src: this.props.msg.mmsSrc,
                    preload: "auto",
                    autoPlay: this.props.autoPlay
                }))
            }
        }),
        I = (React.createClass({
            displayName: "MessageMediaAction",
            render: function () {
                return React.createElement("div", {
                    className: "action"
                }, React.createElement("button", {
                    className: "button btn-download"
                }, React.createElement("span", {
                    className: "icon icon-audio-download"
                }), l10n.t("web_button_download")))
            }
        }), React.createClass({
            displayName: "MessageContactAction",
            componentWillMount: function () {
                var e = this.props.msg.get("body"),
                    t = new Blob([e], {
                        type: "text/vcard"
                    });
                this.setState({
                    url: URL.createObjectURL(t)
                })
            },
            componentWillUnmount: function () {
                URL.revokeObjectURL(this.state.url)
            },
            render: function () {
                var e = this.props.msg.get("subtype");
                return React.createElement("div", {
                    className: "action"
                }, React.createElement("a", {
                    className: "button button-contact",
                    href: this.state.url,
                    title: e + ".vcf",
                    download: e
                }, React.createElement("span", {
                    className: "icon-sm icon-contact"
                }), e))
            }
        })),
        P = React.createClass({
            displayName: "MessageUnread",
            mixins: [a],
            propTypes: {
                count: React.PropTypes.number.isRequired,
                didInsert: React.PropTypes.func.isRequired
            },
            componentDidMount: function () {
                var e = this.getDOMNode().parentNode,
                    t = document.getElementById("pane-main"),
                    n = e.offsetTop - t.clientHeight / 4;
                t.scrollTop = n, this.props.didInsert()
            },
            render: function () {
                return React.createElement("span", {
                    className: "msg-unread-body"
                }, l10n.t("unread_message_count", {
                    count: this.props.count,
                    _plural: this.props.count
                }))
            }
        }),
        k = React.createClass({
            displayName: "MessageNotification",
            mixins: [y],
            render: function () {
                return React.createElement("span", {
                    className: "message-system-body"
                }, React.createElement(c, {
                    text: this.props.text
                }))
            }
        }),
        O = React.createClass({
            displayName: "MessageMeta",
            mixins: [a],
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            getInitialState: function () {
                var e = this.props.msg.get("ack");
                return 3 > e && (e = this.async("msg.ack")), {
                    ack: e
                }
            },
            render: function () {
                var e = this.props.msg,
                    t = e.get("broadcast") ? React.createElement("span", {
                        className: "icon-s icon-broadcast"
                    }) : "",
                    n = e.get("caption") ? "image-caption" : e.get("type"),
                    r = e.get("isSentByMe") ? React.createElement(L, {
                        ack: this.state.ack,
                        type: n
                    }) : "";
                return React.createElement("div", {
                    className: "message-meta"
                }, t, React.createElement("span", {
                    className: "message-datetime"
                }, Wa.formatTimestamp(e.get("t"))), r)
            }
        }),
        M = React.createClass({
            displayName: "MessageAuthor",
            propTypes: {
                msg: React.PropTypes.instanceOf(o).isRequired
            },
            getClasses: function () {
                var e = this.props.msg,
                    t = e.chat.assignedColor(e.sender),
                    n = "message-author color-" + t;
                return e.senderObj.name || (n += " title-number"), n
            },
            getName: function () {
                var e = this.props.msg,
                    t = e.senderObj;
                if (t.name) return React.createElement(c, {
                    text: t.name
                });
                var n = e.id + "-number",
                    r = e.id + "-push-name";
                return [React.createElement("span", {
                    className: "number",
                    key: n
                }, Wa.widGetFormattedUser(t.id)), React.createElement("span", {
                    className: "ellipsify screen-name",
                    key: r
                }, React.createElement(c, {
                    text: e.notifyName
                }))]
            },
            render: function () {
                {
                    var e = this.props.msg;
                    e.senderObj
                }
                return e.isSentByMe || !e.isGroupMsg ? null : React.createElement("h3", {
                    className: this.getClasses()
                }, this.getName())
            }
        }),
        L = React.createClass({
            displayName: "MessageStatus",
            status: function () {
                var e = "icon",
                    t = this.props.ack,
                    n = this.props.type;
                return e += t ? 1 === t ? " icon-msg-check" : 2 === t ? " icon-msg-dblcheck" : " icon-msg-dblcheck-ack" : " icon-msg-time", e + ("image" === n || "video" === n || "audio" === n ? "-light" : "")
            },
            render: function () {
                return React.createElement("span", {
                    className: this.status()
                })
            }
        }),
        x = React.createClass({
            displayName: "MessagePreviewImage",
            propTypes: {
                duration: React.PropTypes.oneOfType([React.PropTypes.string, React.PropTypes.number]),
                shade: React.PropTypes.bool,
                thumb: React.PropTypes.string,
                type: React.PropTypes.oneOf(["audio", "location", "video", "ptt", "vcard"]).isRequired
            },
            getDefaultProps: function () {
                return {
                    shade: !0
                }
            },
            getIconClassNames: function () {
                return "video" === this.props.type ? "icon-sm icon-video-inv" : "audio" === this.props.type ? "icon-sm icon-arrow-inv" : void 0
            },
            getClassNames: function () {
                var e = "preview icon-user-default-square";
                return this.props.thumb || (e += " preview-" + this.props.type + " no-image"), e
            },
            getStyles: function () {
                var e = this.props.thumb;
                return e ? Wa.isHttpUrl(e) ? {
                    backgroundImage: 'url("' + e + '")'
                } : {
                    backgroundImage: 'url("data:image/jpeg;base64,' + e + '")'
                } : {}
            },
            render: function () {
                var e = Wa.formatDuration(this.props.duration),
                    t = this.props.shade ? React.createElement("span", {
                        className: "shade"
                    }) : null;
                return React.createElement("div", {
                    className: this.getClassNames(),
                    style: this.getStyles()
                }, t, React.createElement("span", {
                    className: "meta meta-audio"
                }, React.createElement("span", {
                    className: this.getIconClassNames()
                }), e))
            }
        }),
        U = React.createClass({
            displayName: "LoadMessages",
            mixins: [a],
            propTypes: {
                chat: React.PropTypes.instanceOf(u).isRequired
            },
            getInitialState: function () {
                return {
                    noEarlierMsgs: this.async("chat.noEarlierMsgs"),
                    isLoadingMsgs: this.async("chat.isLoadingMsgs")
                }
            },
            loadEarlierMsgs: function () {
                this.state.isLoadingMsgs || l.loadEarlierMsgs(this.props.chat)
            },
            render: function () {
                return this.state.noEarlierMsgs ? null : this.state.isLoadingMsgs ? React.createElement("div", {
                    className: "more"
                }, React.createElement("div", {
                    className: "btn-more",
                    title: l10n.t("loading_messages")
                }, React.createElement(h, {
                    stroke: 6,
                    size: 24
                }))) : React.createElement("div", {
                    className: "more"
                }, React.createElement("div", {
                    className: "btn-more",
                    title: l10n.t("load_earlier_messages"),
                    onClick: this.loadEarlierMsgs
                }, React.createElement("span", {
                    className: "icon icon-refresh"
                })))
            }
        });
    e.exports = {
        MessageList: A,
        LoadMessages: U
    }
}, function (e, t, n) {
    var r = (n(92), n(47)),
        o = n(32),
        a = n(189),
        i = n(78),
        s = React.createClass({
            displayName: "EmojiPanel",
            propTypes: {
                onEmoji: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    selected: s.PEOPLE
                }
            },
            onSelectTab: function (e) {
                var t = s.TABS.indexOf(this.state.selected),
                    n = s.TABS.indexOf(e),
                    r = n > t ? "right" : "left";
                this.setState({
                    selected: e,
                    direction: r
                })
            },
            statics: {
                RECENT: "recent",
                PEOPLE: "people",
                NATURE: "nature",
                THINGS: "things",
                PLACES: "places",
                SYMBOLS: "symbols",
                TABS: ["recent", "people", "nature", "things", "places", "symbols"]
            },
            onEmoji: function (e) {
                this.props.onEmoji(e), Store.RecentEmoji.increment(e)
            },
            render: function () {
                var e = this.state.selected,
                    t = s,
                    n = this.onEmoji,
                    r = React.createElement("div", {
                        className: "emoji-panel-body",
                        key: "emoji-" + this.state.selected
                    }, React.createElement(c, {
                        tab: e,
                        onEmoji: n
                    })),
                    o = [{
                        css: "icon-emoji-recent",
                        tab: t.RECENT
                    }, {
                        css: "icon-emoji-people",
                        tab: t.PEOPLE
                    }, {
                        css: "icon-emoji-nature",
                        tab: t.NATURE
                    }, {
                        css: "icon-emoji-things",
                        tab: t.THINGS
                    }, {
                        css: "icon-emoji-places",
                        tab: t.PLACES
                    }, {
                        css: "icon-emoji-symbols",
                        tab: t.SYMBOLS
                    }],
                    a = this;
                o = o.map(function (t) {
                    var n = React.createElement("button", {
                        className: "menu-item" + (e === t.tab ? " active" : ""),
                        onClick: a.onSelectTab.bind(null, t.tab),
                        key: t.tab
                    }, React.createElement("span", {
                        className: "icon " + t.css
                    }));
                    return n
                });
                var u = "right" === this.state.direction ? "slide-forward" : "slide-back";
                return React.createElement("div", {
                    className: "emoji-panel k"
                }, React.createElement("div", {
                    className: "nib"
                }), React.createElement("div", {
                    className: "menu-tabs menu-tabs-emoji emoji-panel-header",
                    "data-active-tab": this.state.selected
                }, o), React.createElement(i, {
                    transitionName: u
                }, r))
            }
        });
    e.exports = s;
    var c = React.createClass({
        displayName: "EmojiTab",
        mixins: [r],
        propTypes: {
            tab: React.PropTypes.oneOf(s.TABS).isRequired,
            onEmoji: React.PropTypes.func.isRequired
        },
        shouldComponentUpdate: function (e) {
            return this.props.tab !== e.tab
        },
        getEmoji: function () {
            var e = this.props.onEmoji;
            return this.props.tab === s.RECENT ? Store.RecentEmoji.map(function (t) {
                var n = o.emojiMap[t["char"]];
                return React.createElement("span", {
                    key: n,
                    onClick: e.bind(null, t["char"]),
                    className: "emoji emoji" + n
                })
            }) : a[this.props.tab].map(function (t) {
                var n = o.codeToEmoji[t];
                return React.createElement("span", {
                    key: t,
                    onClick: e.bind(null, n),
                    className: "emoji emoji" + t
                })
            })
        },
        render: function () {
            var e = "emoji-" + this.props.tab;
            return React.createElement("div", {
                className: e
            }, this.getEmoji())
        }
    })
}, function (e, t, n) {
    var r = n(46),
        o = n(48),
        a = n(79),
        i = n(32),
        s = React.createClass({
            displayName: "EmojiInput",
            mixins: [r, o, a],
            propTypes: {
                editable: React.PropTypes.bool,
                value: React.PropTypes.string,
                selection: React.PropTypes.object,
                className: React.PropTypes.string,
                placeholder: React.PropTypes.string,
                onKeyPress: React.PropTypes.func,
                onChange: React.PropTypes.func,
                onSelectionChange: React.PropTypes.func,
                maxLength: React.PropTypes.number,
                showRemaining: React.PropTypes.bool,
                multiline: React.PropTypes.bool
            },
            getDefaultProps: function () {
                return {
                    editable: !0
                }
            },
            getInitialState: function () {
                return this.value = this.props.value || "", this.selection = this.props.selection, null
            },
            componentWillReceiveProps: function (e) {
                if (e.value !== this.value && (this.setNewValue(e.value || "", !1), this.updateDOM(), this.safeDefer(this.restoreFocus.bind(this, !0))), this.props.editable !== e.editable) {
                    var t = this.getDOMNode();
                    t.contentEditable = e.editable
                }
            },
            restoreFocus: function (e) {
                if (this.props.editable) {
                    var t = this.getDOMNode();
                    if (t.blur(), t.focus(), this.selection && !e) this.restoreSelection(this.selection);
                    else {
                        var n = window.getSelection();
                        n.selectAllChildren(t), n.collapseToEnd()
                    }
                    this.safeDefer(this.saveSelection)
                }
            },
            componentDidMount: function () {
                this.safeDefer(this.restoreFocus)
            },
            limitLength: function (e) {
                var t = this.props.maxLength;
                if (!t) return e;
                e = e || "";
                var n = this.selectionLength(),
                    r = n + t - this.value.length;
                return r > 0 ? Wa.multibyteSubstr(e, 0, r) : ""
            },
            onMouseDown: function (e) {
                e.stopPropagation(), this.regNativeListener(window, "mouseup", this.onWindowMouseUp)
            },
            onWindowMouseUp: function () {
                this.unregNativeListener(window, "mouseup", this.onWindowMouseUp), this.safeDefer(this.saveSelection)
            },
            onContextMenu: function (e) {
                e.stopPropagation()
            },
            onKeyUp: function (e) {
                if ("Backspace" === e.key || "Delete" === e.key) {
                    var t = this.getDOMNode();
                    "\n" === t.innerHTML && (document.execCommand("selectAll"), document.execCommand("delete"), this.value = "")
                }
                this.safeDefer(this.saveSelection)
            },
            onKeyPress: function (e) {
                if (!this.props.onKeyPress || (this.props.onKeyPress(e), !e.defaultPrevented)) {
                    this.props.multiline || "Enter" === e.key && e.preventDefault();
                    var t = this.limitLength(punycode.ucs2.encode([e.charCode]));
                    t.length || e.preventDefault()
                }
            },
            onInput: function () {
                var e = this.getDOMNode();
                this.setNewValue(i.NodeToEmoji(e), !0)
            },
            setNewValue: function (e, t) {
                e !== this.value && (this.value = e, this.length = Wa.multibyteLength(e), t && this.props.onChange && this.props.onChange({
                    target: {
                        value: e
                    }
                }), this.setRemaining(), this.safeDefer(this.saveSelection))
            },
            setRemaining: function () {
                this.props.showRemaining && this.props.maxLength && this.getDOMNode().setAttribute("data-remaining", this.props.maxLength - this.length)
            },
            updateDOM: function () {
                var e = i.emojiToHTML(_.escape(this.value)),
                    t = this.getDOMNode();
                t.innerHTML !== e && (t.innerHTML = e), this.setRemaining()
            },
            selectionLength: function () {
                if (!this.props.editable) return 0;
                var e = this.getDOMNode();
                e.focus();
                var t = window.getSelection(),
                    n = t.getRangeAt(0);
                return Wa.multibyteLength(i.NodeToEmoji(n.cloneContents()))
            },
            saveSelection: function () {
                var e = this.getSelection();
                _.isEqual(e, this.prevSelection) || (this.props.onSelectionChange && this.props.onSelectionChange(e), this.prevSelection = this.selection, this.selection = e)
            },
            getSelection: function () {
                if (!this.isMounted()) return null;
                var e = this.getDOMNode();
                if (document.activeElement !== e) return null;
                for (var t = window.getSelection(), n = t.anchorNode, r = t.anchorOffset, o = t.focusNode, a = t.focusOffset, i = e.childNodes, s = -1, c = -1, u = !1, l = !1, d = 0; d < i.length; d++) {
                    var p = i[d];
                    if (p === n && (s = d, u = !0), p === o && (c = d, l = !0), u && l) break
                }
                return {
                    anchor: {
                        count: s,
                        offset: r
                    },
                    focus: {
                        count: c,
                        offset: a
                    }
                }
            },
            restoreSelection: function (e) {
                var t, n, r = this.getDOMNode(),
                    o = r.childNodes;
                t = -1 === e.anchor.count ? r : o[e.anchor.count], n = -1 === e.focus.count ? r : o[e.focus.count];
                var a = window.getSelection();
                if (t && n) try {
                    var i = document.createRange();
                    return i.setStart(t, e.anchor.offset), a.removeAllRanges(), a.addRange(i), void a.extend(n, e.focus.offset)
                } catch (s) {}
                a.selectAllChildren(r), a.collapseToEnd()
            },
            onPaste: function (e) {
                e.preventDefault();
                var t = e.clipboardData.getData("text/plain");
                this.pasteText(t)
            },
            pasteText: function (e) {
                e && (this.props.maxPaste && e.length > this.props.maxPaste ? this.props.onMaxPasteExceeded() : this.replaceSelection(e))
            },
            replaceSelection: function (e) {
                if (this.props.editable && (this.getDOMNode().focus(), e = this.limitLength(e), 0 !== e.length)) {
                    this.props.multiline || (e = e.replace(/\n+/g, " "));
                    var t = i.emojiToHTML(_.escape(e));
                    document.execCommand("insertHTML", !1, t), this.onInput(), this.safeDefer(this.saveSelection)
                }
            },
            scrollToCursor: function () {
                var e = this.getDOMNode(),
                    t = e.clientHeight;
                if (e.scrollHeight > t) {
                    var n = marker.offsetTop,
                        r = parseInt(window.getComputedStyle(e, null).getPropertyValue("line-height"), 10),
                        o = 0;
                    0 > n ? o = n - t / 2 : n + r > t && (o = n - t / 2), o = Math.round(o / r) * r, o && (e.scrollTop = e.scrollTop + o)
                }
                marker.parentNode.removeChild(marker)
            },
            shouldComponentUpdate: function () {
                return !1
            },
            render: function () {
                var e = i.emojiToHTML(_.escape(this.value)),
                    t = this.props.className ? "input " + this.props.className : "input";
                return React.createElement("div", {
                    dangerouslySetInnerHTML: {
                        __html: e
                    },
                    contentEditable: this.props.editable,
                    className: t,
                    placeholder: this.props.placeholder,
                    onInput: this.onInput,
                    onPaste: this.onPaste,
                    onKeyUp: this.onKeyUp,
                    onKeyPress: this.onKeyPress,
                    onMouseDown: this.onMouseDown,
                    onContextMenu: this.onContextMenu
                })
            }
        });
    e.exports = s
}, function (e, t, n) {
    var r = n(48),
        o = React.createClass({
            displayName: "ConfirmPopup",
            mixins: [r],
            propTypes: {
                classes: React.PropTypes.string,
                onCancel: React.PropTypes.func,
                cancelText: React.PropTypes.string,
                onOK: React.PropTypes.func,
                okText: React.PropTypes.string,
                children: React.PropTypes.node.isRequired,
                title: React.PropTypes.node.isRequired
            },
            getDefaultProps: function () {
                return {
                    classes: "",
                    cancelText: l10n.t("web_cancel"),
                    okText: l10n.t("web_ok")
                }
            },
            componentDidMount: function () {
                if (this.props.onOK) {
                    var e = this;
                    this.regNativeListener(window, "keydown", function (t) {
                        13 === t.keyCode && e.props.onOK()
                    })
                }
            },
            render: function () {
                var e = this.props.onOK ? React.createElement("button", {
                    className: "btn-plain btn-default popup-controls-item",
                    onClick: this.props.onOK
                }, this.props.okText) : null,
                    t = this.props.onCancel ? React.createElement("button", {
                        className: "btn-plain popup-controls-item",
                        onClick: this.props.onCancel
                    }, this.props.cancelText) : null;
                return React.createElement("div", {
                    className: "backdrop"
                }, React.createElement("div", {
                    className: "popup " + this.props.classes
                }, React.createElement("div", {
                    className: "popup-title"
                }, this.props.title), React.createElement("div", {
                    className: "popup-body"
                }, this.props.children), React.createElement("div", {
                    className: "popup-controls"
                }, t, e)))
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r, o = n(31),
        a = n(94),
        i = n(87),
        s = n(48),
        c = n(79),
        u = (n(26), n(33)),
        l = n(165),
        d = n(190),
        p = n(78),
        h = React.createClass({
            displayName: "PTT",
            mixins: [c, s],
            propTypes: {
                chat: React.PropTypes.instanceOf(a),
                onStateChange: React.PropTypes.func.isRequired
            },
            statics: {
                audioContext: new AudioContext,
                READY: "ready",
                DELAY: "delay",
                REC: "recording",
                PROCESSSING: "processsing",
                GUM_TIMEOUT: "ptt_gum_timeout",
                PERMISSION_DENIED: "permission_denied",
                NOT_SUPPORTED_ERROR: "not_supported_error",
                MANDATORY_UNSATISFIED_ERROR: "mandatory_unsatisfied_error",
                CANCEL: "cancel",
                SEND: "send"
            },
            getInitialState: function () {
                return {
                    state: h.READY,
                    active: void 0,
                    elapsedTimeInterval: void 0,
                    elapsedTime: 0
                }
            },
            componentWillUnmount: function () {
                i.pop(i.PTT)
            },
            componentDidMount: function () {
                this.regNativeListener(window, "blur", this.cancelRecording)
            },
            isRecording: function () {
                var e = this.state.state;
                return e === h.REC || e === h.DELAY || e === h.PROCESSSING
            },
            getRecorder: function () {
                var e;
                return e = new Promise(function (t, n) {
                    navigator.getUserMedia({
                        audio: !0
                    }, function (n) {
                        e.isResolved() ? (n.stop(), o.closeModal()) : t(n)
                    }, function (t) {
                        var r = _.isString(t) ? t : t.name,
                            a = u.GUM[r] || u.GUM.GUMError;
                        n(new a), e && e.isResolved() && o.closeModal()
                    })
                }).timeout(1e3).then(function (e) {
                    var t = h.audioContext.createMediaStreamSource(e);
                    if (r) r.connect(t), r._stream = e;
                    else {
                        var n = new d(t, Wa.CONST.RECORDER_CFG);
                        n._stream = e, r = n
                    }
                    return r
                })["catch"](Promise.TimeoutError, function (e) {
                    throw o.openModal(React.createElement(l, {
                        title: "guide_desktop_mic_title",
                        desc: "guide_desktop_mic_description",
                        type: l.GUIDE_ALLOW
                    })), e
                })["catch"](u.GUM.PermissionDeniedError, function (e) {
                    throw o.openModal(React.createElement(l, {
                        title: "guide_desktop_mic_title",
                        desc: "guide_desktop_mic_fail_description",
                        type: l.GUIDE_UNBLOCK
                    })), e
                })["catch"](u.GUM.GUMError, function (e) {
                    if (e instanceof u.GUM.PermissionDeniedError) throw e;
                    throw o.openModal(React.createElement(l, {
                        title: "guide_desktop_mic_missing_title",
                        desc: "guide_desktop_mic_missing_description",
                        type: l.GUIDE_NONE
                    })), e
                })
            },
            stopRecording: function () {
                r._stream.stop(), this.props.chat.markPaused(), this.clearSafeInterval(this.elapsedTimeInterval), delete this.elapsedTimeInterval
            },
            cancelRecording: function () {
                this.isRecording() && (this.state.state !== h.READY && this.props.onStateChange(h.READY), this.safeIsMounted() && this.setState({
                    state: h.READY,
                    active: void 0,
                    elapsedTime: 0
                }), this.clearSafeInterval(this.elapsedTimeInterval), delete this.elapsedTimeInterval, r && (r._stream.stop(), r.stop(), r.clear()), this.props.chat.markPaused())
            },
            startInterval: function () {
                var e = this;
                this.elapsedTimeInterval = this.safeInterval(function () {
                    e.setState({
                        elapsedTime: e.state.elapsedTime + 1
                    })
                }, 1e3)
            },
            cancelPTTTimer: function () {
                this.pttTimer && (this.clearSafeTimeout(this.pttTimer), delete this.pttTimer)
            },
            onPTTReady: function () {
                delete this.pttTimer, this.state.state === h.DELAY && this.setState({
                    state: h.REC
                })
            },
            close: function () {
                this.cancelRecording()
            },
            onMouseOverSend: function () {
                this.setState({
                    active: h.SEND
                })
            },
            onMouseOutSend: function () {
                this.setState({
                    active: void 0
                })
            },
            onMouseOverCancel: function () {
                this.setState({
                    active: h.CANCEL
                })
            },
            onMouseOutCancel: function () {
                this.setState({
                    active: void 0
                })
            },
            onMouseUpCancel: function () {
                this.cancelPTTTimer(), i.pop(i.PTT)
            },
            onMouseUpSend: function () {
                if (this.cancelPTTTimer(), !(this.state.elapsedTime < 1)) {
                    var e = this.props.chat;
                    if (this.state.state === h.REC) {
                        var t = this;
                        this.stopRecording(), e.regPromise(new Promise(function (n) {
                            t.setState({
                                state: h.PROCESSSING
                            }), t.props.onStateChange(h.READY), r.exportOGG(function (r) {
                                e.sendMedia({
                                    file: r,
                                    type: "ptt",
                                    duration: t.state.elapsedTime
                                })["finally"](n), i.pop(i.PTT)
                            })
                        }))
                    } else i.pop(i.PTT), Wa.debug("ptt duration too short")
                }
            },
            onMouseDown: function () {
                this.state.state === h.READY && this.getRecorder().bind(this).then(function (e) {
                    e.record(), this.props.chat.presence.update()["catch"](u.WapDrop, _.noop), this.props.chat.markRecording(), this.setState({
                        state: h.DELAY
                    }), this.props.onStateChange(h.REC), i.push(this, i.PTT), this.pttTimer = this.safeDelay(this.onPTTReady, 1500), this.startInterval()
                })["catch"](_.noop)
            },
            render: function () {
                var e = "btn-close btn-border ptt-close";
                this.state.active === h.CANCEL && (e += " is-hover");
                var t = "btn-border ptt-send";
                this.state.active === h.SEND && (t += " is-hover");
                var n = this.state.state === h.DELAY || this.state.state === h.REC ? React.createElement("div", {
                    className: "ptt-container",
                    key: "recording"
                }, React.createElement("button", {
                    className: e,
                    onMouseOver: this.onMouseOverCancel,
                    onMouseOut: this.onMouseOutCancel,
                    onMouseUp: this.onMouseUpCancel
                }, React.createElement("span", {
                    className: "icon icon-round-x btn-state-default"
                }), React.createElement("span", {
                    className: "icon icon-round-x-inv btn-state-hover"
                })), React.createElement("button", {
                    className: t,
                    onMouseOver: this.onMouseOverSend,
                    onMouseOut: this.onMouseOutSend,
                    onMouseUp: this.onMouseUpSend
                }, React.createElement("span", {
                    className: "icon icon-round-send btn-state-default"
                }), React.createElement("span", {
                    className: "icon icon-round-send-inv btn-state-hover"
                })), React.createElement("div", {
                    className: "ptt-counter"
                }, moment.unix(this.state.elapsedTime).format("m:ss"))) : null,
                    r = this.state.state === h.READY || this.state.state === h.PROCESSSING ? React.createElement("button", {
                        className: "icon btn-icon icon-ptt",
                        onMouseDown: this.onMouseDown,
                        disabled: this.state.state === h.PROCESSSING,
                        key: "button"
                    }) : null;
                return React.createElement("div", null, React.createElement("div", null, React.createElement(p, {
                    transitionName: "fade"
                }, r)), React.createElement("div", null, React.createElement(p, {
                    transitionName: "ptt"
                }, n)))
            }
        });
    e.exports = h
}, function (e, t, n) {
    function r() {
        function e(e) {
            n++, r.push(e)
        }
        var t = !1,
            n = 0,
            r = [];
        this.pushInt16 = function (t) {
            if ("number" != typeof t) throw new Error("invalid int16");
            e((65280 & t) >> 8), e((255 & t) >> 0)
        }, this.pushInt20 = function (t) {
            if ("number" != typeof t) throw new Error("invalid int20");
            e((983040 & t) >> 16), e((65280 & t) >> 8), e((255 & t) >> 0)
        }, this.pushByte = function (t) {
            if ("number" != typeof t || 0 > t || t > 255) throw new Error("invalid byte value: " + t);
            e(t)
        }, this.pushBytes = function (e) {
            if (!o.isByteBuffer(e)) throw new Error("invalid byte buffer");
            n += e.limit, r.push(e)
        }, this.pushString = function (e) {
            if ("string" != typeof e) throw new Error("invalid string");
            n += o.calculateUTF8Bytes(e), r.push(e)
        }, this.toBuffer = function () {
            for (var e = new o(n, t), a = r.length, i = 0; a > i; i++) {
                var s = r[i];
                "string" == typeof s ? e.writeString(s) : o.isByteBuffer(s) ? (s.reset(), e.append(s)) : e.writeByte(s)
            }
            return e.reset(), e.toBuffer(!0)
        }
    }
    var o = n(74);
    e.exports = r
}, function (e, t, n) {
    function r(e, t) {
        if (t) {
            if (3 !== t.length) throw new Error("invalid node");
            var n = t[1] ? 2 * Object.keys(t[1]).filter(function (e) {
                return !!t[1][e]
            }).length : 0;
            l(e, 1 + n + (t[2] ? 1 : 0)), o(e, t[0]), c(e, t[1]), u(e, t[2])
        }
    }
    function o(e, t) {
        if ("string" != typeof t) throw new Error("invalid string");
        var n, r, o = g[t];
        if ("undefined" == typeof o) {
            var c = t.indexOf("@");
            if (1 > c) a(e, t);
            else {
                var u = t.substring(0, c),
                    l = t.substring(c + 1);
                i(e, u, l)
            }
        } else {
            if (o < h.SINGLE_BYTE_MAX) s(e, o);
            else {
                var d = o - h.SINGLE_BYTE_MAX,
                    p = d >> 8;
                switch (r = d % 256, p) {
                case 0:
                    n = h.DICTIONARY_0;
                    break;
                case 1:
                    n = h.DICTIONARY_1;
                    break;
                case 2:
                    n = h.DICTIONARY_2;
                    break;
                case 3:
                    n = h.DICTIONARY_3;
                    break;
                default:
                    throw new Error("double byte dictionary token out of range: " + t + " " + o)
                }
            }
            s(e, n), s(e, r)
        }
    }
    function a(e, t) {
        var n = d.calculateUTF8Bytes(t);
        n >= 256 ? (e.pushByte(h.BINARY_20), e.pushInt20(n)) : (e.pushByte(h.BINARY_8), e.pushByte(n)), e.pushString(t)
    }
    function i(e, t, n) {
        e.pushByte(h.JID_PAIR), t ? o(e, t) : s(e, h.LIST_EMPTY), "c.us" === n && (n = "s.whatsapp.net"), o(e, n)
    }
    function s(e, t) {
        if (245 > t) e.pushByte(t);
        else if (500 >= t) throw new Error("invalid token")
    }
    function c(e, t) {
        if (t) for (var n in t) t[n] && (o(e, n), o(e, t[n]))
    }
    function u(e, t) {
        var n;
        if (t) if ("string" == typeof t) o(e, t);
        else if (d.isByteBuffer(t)) n = t.limit, n >= 256 ? (e.pushByte(h.BINARY_20), e.pushInt20(n)) : (e.pushByte(h.BINARY_8), e.pushByte(n)), e.pushBytes(t);
        else {
            if (!_.isArray(t)) throw new Error("invalid children");
            n = t.length, l(e, n);
            for (var a = 0; n > a; a++) r(e, t[a])
        }
    }
    function l(e, t) {
        0 === t ? e.pushByte(h.LIST_EMPTY) : 256 > t ? (e.pushByte(h.LIST_8), e.pushByte(t)) : (e.pushByte(h.LIST_16), e.pushInt16(t))
    }
    for (var d = n(74), p = n(201), h = n(202), g = {}, f = 0; f < p.singleByte.length; f++) p.singleByte[f] && (g[p.singleByte[f]] = f);
    for (var f = 0; f < p.doubleByte.length; f++) p.doubleByte[f] && (g[p.doubleByte[f]] = f + h.SINGLE_BYTE_MAX);
    e.exports = r
}, function (e, t, n) {
    function r(e) {
        var t = !1,
            n = o.wrap(e, void 0, t);
        this.readByte = function () {
            return n.readUint8()
        }, this.readInt16 = function () {
            return n.readUint16()
        }, this.readInt20 = function () {
            var e = 15 & n.readUint8(),
                t = n.readUint8(),
                r = n.readUint8();
            return (e << 16) + (t << 8) + r
        }, this.readString = function (e) {
            return n.readString(e, o.METRICS_BYTES)
        }, this.readBytes = function (e) {
            var t = n.copy(n.offset, n.offset + e);
            return n.offset += e, t
        }, this.debugInfo = function () {
            return "offset: " + n.offset + " byte: " + n.readUint8(n.offset)
        }
    }
    var o = n(74);
    e.exports = r
}, function (e, t, n) {
    function r(e) {
        var t = e.readByte(),
            n = a(e, t);
        if (t = e.readByte(), t === d.STREAM_END) throw new Error("unexpected stream end " + e.debugInfo());
        var r = i(e, t);
        if (0 === n || !r) throw new Error("invalid node. 0 list or empty tag" + e.debugInfo());
        var s = n - 2 + n % 2 >> 1,
            c = u(e, s);
        if (n % 2 === 1) return [r, c, void 0];
        var p;
        if (t = e.readByte(), o(t)) p = l(e, t);
        else if (t === d.BINARY_8) {
            var h = e.readByte();
            p = e.readBytes(h)
        } else if (t === d.BINARY_20) {
            var g = e.readInt20();
            p = e.readBytes(g)
        } else p = i(t);
        return [r, c, p]
    }
    function o(e) {
        return e === d.LIST_EMPTY || e === d.LIST_8 || e === d.LIST_16
    }
    function a(e, t) {
        if (t === d.LIST_EMPTY) return 0;
        if (t === d.LIST_8) return e.readByte();
        if (t === d.LIST_16) return e.readInt16();
        throw new Error("invalid list size " + e.debugInfo())
    }
    function i(e, t) {
        if (-1 === t) throw new Error("invalid start token readString" + e.debugInfo());
        if (t > 2 && 236 > t) {
            var n = s(t);
            return "s.whatsapp.net" === n && (n = "c.us"), n
        }
        switch (t) {
        case d.DICTIONARY_0:
        case d.DICTIONARY_1:
        case d.DICTIONARY_2:
        case d.DICTIONARY_3:
            var r = e.readByte();
            return c(t - d.DICTIONARY_0, r);
        case d.LIST_EMPTY:
            return;
        case d.BINARY_8:
            var o = e.readByte();
            return e.readString(o);
        case d.BINARY_20:
            var a = e.readInt20();
            return e.readString(a);
        case d.JID_PAIR:
            var u = i(e, e.readByte()),
                l = i(e, e.readByte());
            if ("undefined" != typeof u && "undefined" != typeof l) return u + "@" + l;
            if ("undefined" != typeof l) return l;
            throw new Error("invalid jid " + u + "," + l + " " + e.debugInfo());
        default:
            throw new Error("invalid string " + e.debugInfo())
        }
    }
    function s(e) {
        var t;
        if (e >= 0 && e < h.length && (t = h[e]), "undefined" == typeof t) throw new Error("invalid token " + e);
        return t
    }
    function c(e, t) {
        var n, r = 256 * e + t;
        if (r >= 0 && r < g.length && (n = g[r]), "undefined" == typeof n) throw new Error("invalid double byte token " + e + " " + t);
        return n
    }
    function u(e, t) {
        for (var n, r, o = t ? {} : void 0, a = 0; t > a; a++) n = i(e, e.readByte()), r = i(e, e.readByte()), o[n] = r;
        return o
    }
    function l(e, t) {
        for (var n = [], o = a(e, t), i = 0; o > i; i++) n.push(r(e));
        return n
    }
    var d = n(202),
        p = n(201),
        h = p.singleByte,
        g = p.doubleByte;
    e.exports = r
}, function (e, t, n) {
    function r(e, t) {
        if (!e) return "undefined";
        var n = o(e[1], t),
            r = a(e[2], t);
        return "<" + e[0] + n + (r ? ">\n" + r + "\n</" + e[0] + ">" : "/>")
    }
    function o(e, t) {
        if (e) {
            var n = "";
            for (var r in e) {
                var o = "string" == typeof e[r] ? t ? "..." : '"' + e[r] + '"' : e[r];
                n += " " + r + "=" + o
            }
            return n
        }
        return ""
    }
    function a(e, t) {
        return i.isByteBuffer(e) ? "<<bin:" + e.limit + ">>" : "string" == typeof e ? t ? "<<string:" + e.length + ">>" : e : _.isArray(e) ? e.map(_.partial(r, _, t)).join("\n") : void 0
    }
    var i = n(74),
        s = {
            tag: function (e) {
                return e && e[0]
            },
            attr: function (e, t) {
                return t && t[1] ? t[1][e] : void 0
            },
            attrs: function (e) {
                return e[1]
            },
            child: function (e, t) {
                var n = t[2];
                if (_.isArray(n)) for (var r = n.length, o = 0; r > o; o++) {
                    var a = n[o];
                    if (_.isArray(a) && a[0] === e) return a
                }
            },
            children: function (e) {
                return e && e[2]
            },
            dataStr: function (e) {
                if (!e) return "";
                var t = e[2];
                return "string" == typeof t ? t : i.isByteBuffer(t) ? t.readString(t.limit, i.METRICS_BYTES, 0).string : void 0
            },
            toString: r
        };
    e.exports = s
}, function (e, t, n) {
    var r = n(74),
        o = {
            getKeys: function () {
                var e = Wa.secretBundle.encKey.toString(CryptoJS.enc.Base64),
                    t = Wa.secretBundle.macKey.toString(CryptoJS.enc.Base64);
                return {
                    enc: CryptoJS.enc.Base64.parse(e),
                    mac: CryptoJS.enc.Base64.parse(t)
                }
            },
            encrypt: function (e) {
                var t = CryptoJS.lib.WordArray.create(e),
                    n = new Uint32Array(4),
                    o = this.getKeys();
                window.crypto.getRandomValues(n);
                var a = CryptoJS.AES.encrypt(t, o.enc, {
                    iv: CryptoJS.lib.WordArray.create(n),
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                }),
                    i = a.iv.concat(a.ciphertext),
                    s = CryptoJS.HmacSHA256(i, o.mac),
                    c = s.concat(i);
                return r.fromBase64(c.toString(CryptoJS.enc.Base64)).toBuffer()
            },
            decrypt: function (e) {
                var t = r.wrap(e),
                    n = t.slice(t.offset, t.offset + 32).toBase64(),
                    o = t.slice(t.offset + 32).toBuffer(),
                    a = this.getKeys(),
                    i = CryptoJS.lib.WordArray.create(o),
                    s = CryptoJS.HmacSHA256(i, a.mac).toString(CryptoJS.enc.Base64);
                if (n !== s) throw Wa.debug("bp:01:decrypt hmac dont match " + n + " " + s, "red"), new Error("hmac mismatch");
                var c = t.slice(t.offset + 32, t.offset + 48).toBuffer(),
                    u = t.slice(t.offset + 48).toBuffer(),
                    l = CryptoJS.AES.decrypt({
                        ciphertext: CryptoJS.lib.WordArray.create(u),
                        salt: void 0
                    }, a.enc, {
                        iv: CryptoJS.lib.WordArray.create(c),
                        mode: CryptoJS.mode.CBC,
                        padding: CryptoJS.pad.Pkcs7
                    });
                return r.fromBase64(l.toString(CryptoJS.enc.Base64)).toBuffer()
            }
        };
    e.exports = o
}, function (e, t, n) {
    function r() {
        function e(e) {
            n++, r.push(e)
        }
        var t = !1,
            n = 0,
            r = [];
        this.pushInt16 = function (t) {
            if ("number" != typeof t) throw new Error("invalid int16");
            e((65280 & t) >> 8), e((255 & t) >> 0)
        }, this.pushInt20 = function (t) {
            if ("number" != typeof t) throw new Error("invalid int20");
            e((983040 & t) >> 16), e((65280 & t) >> 8), e((255 & t) >> 0)
        }, this.pushInt32 = function (t) {
            if ("number" != typeof t) throw new Error("invalid int32");
            e((4278190080 & t) >> 24), e((16711680 & t) >> 16), e((65280 & t) >> 8), e((255 & t) >> 0)
        }, this.pushByte = function (t) {
            if ("number" != typeof t || 0 > t || t > 255) throw new Error("invalid byte value: " + t);
            e(t)
        }, this.pushBytes = function (e) {
            if (!o.isByteBuffer(e)) throw new Error("invalid byte buffer");
            n += e.limit, r.push(e)
        }, this.pushUint8Array = function (e) {
            if ("[object Uint8Array]" !== Object.prototype.toString.call(e)) throw new Error("invalid Uint8Array");
            n += e.length;
            for (var t = 0; t < e.length; t++) r.push(e[t])
        }, this.pushString = function (e) {
            if ("string" != typeof e) throw new Error("invalid string");
            n += o.calculateUTF8Bytes(e), r.push(e)
        }, this.toBuffer = function () {
            for (var e = new o(n, t), a = r.length, i = 0; a > i; i++) {
                var s = r[i];
                "string" == typeof s ? e.writeString(s) : o.isByteBuffer(s) ? (s.reset(), e.append(s)) : e.writeByte(s)
            }
            return e.reset(), e.toBuffer(!0)
        }
    }
    var o = n(74);
    e.exports = r
}, function (e, t, n) {
    function r(e, t) {
        if (t) {
            if (3 !== t.length) throw new Error("invalid node");
            var n = t[1] ? 2 * Object.keys(t[1]).filter(function (e) {
                return !!t[1][e]
            }).length : 0;
            l(e, 1 + n + (t[2] ? 1 : 0)), o(e, t[0]), c(e, t[1]), u(e, t[2])
        }
    }
    function o(e, t, n) {
        if ("string" != typeof t) throw new Error("invalid string");
        var r, o, c = b[t];
        if ("c.us" !== t || n) if ("undefined" == typeof c) {
            var u = t.indexOf("@");
            if (1 > u) a(e, t);
            else {
                var l = t.substring(0, u),
                    d = t.substring(u + 1);
                i(e, l, d)
            }
        } else {
            if (c < f.SINGLE_BYTE_MAX) s(e, c);
            else {
                var p = c - f.SINGLE_BYTE_MAX,
                    h = p >> 8;
                switch (o = p % 256, h) {
                case 0:
                    r = f.DICTIONARY_0;
                    break;
                case 1:
                    r = f.DICTIONARY_1;
                    break;
                case 2:
                    r = f.DICTIONARY_2;
                    break;
                case 3:
                    r = f.DICTIONARY_3;
                    break;
                default:
                    throw new Error("double byte dictionary token out of range: " + t + " " + c)
                }
            }
            s(e, r), s(e, o)
        } else s(e, b["s.whatsapp.net"])
    }
    function a(e, t) {
        var n = h.calculateUTF8Bytes(t);
        if (n >= 4294967296) throw new Error("string too large to encode (len = " + n + "): " + t);
        n >= 1 << 20 ? (e.pushByte(f.BINARY_32), e.pushInt32(n)) : n >= 256 ? (e.pushByte(f.BINARY_20), e.pushInt20(n)) : (e.pushByte(f.BINARY_8), e.pushByte(n)), e.pushString(t)
    }
    function i(e, t, n) {
        if (e.pushByte(f.JID_PAIR), t) try {
            d(e, t)
        } catch (r) {
            Wa.debug("writer:encode-fallback (" + t + ") " + r.message, "orange", void 0, !0), o(e, t)
        } else s(e, f.LIST_EMPTY);
        o(e, n)
    }
    function s(e, t) {
        if (245 > t) e.pushByte(t);
        else if (500 >= t) throw new Error("invalid token")
    }
    function c(e, t) {
        if (t) for (var n in t) t[n] && (o(e, n), o(e, t[n]))
    }
    function u(e, t) {
        var n;
        if (t) if ("string" == typeof t) o(e, t, !0);
        else if (h.isByteBuffer(t)) {
            if (n = t.limit, n >= 4294967296) throw new Error("invalid children; too long (len = " + n);
            n >= 1 << 20 ? (e.pushByte(f.BINARY_32), e.pushInt32(n)) : n >= 256 ? (e.pushByte(f.BINARY_20), e.pushInt20(n)) : (e.pushByte(f.BINARY_8), e.pushByte(n)), e.pushBytes(t)
        } else {
            if (!_.isArray(t)) throw new Error("invalid children");
            n = t.length, l(e, n);
            for (var a = 0; n > a; a++) r(e, t[a])
        }
    }
    function l(e, t) {
        0 === t ? e.pushByte(f.LIST_EMPTY) : 256 > t ? (e.pushByte(f.LIST_8), e.pushByte(t)) : (e.pushByte(f.LIST_16), e.pushInt16(t))
    }
    function d(e, t) {
        var n = h.calculateUTF8Bytes(t);
        if (n > f.NIBBLE_MAX) throw new Error("too many bytes to nibble-encode: len = " + n);
        var r, o = Math.ceil(n / 2),
            a = [],
            i = 0;
        n % 2 > 0 && (i = 128);
        var s = i | o;
        a.push(f.NIBBLE_8), a.push(s);
        for (var c = Math.floor(n / 2), u = 0; c > u; u++) r = p(t[2 * u], t[2 * u + 1]), a.push(r);
        i > 0 && (r = p(t[n - 1], "\x00"), a.push(r));
        var l = new Uint8Array(a);
        e.pushUint8Array(l)
    }
    function p(e, t) {
        if (!m.hasOwnProperty(e)) throw new Error("invalid byte to nibble-pack: " + e);
        if (!m.hasOwnProperty(t)) throw new Error("invalid byte to nibble-pack: " + t);
        var n = m[e],
            r = m[t];
        return n << 4 | r
    }
    for (var h = n(74), g = n(203), f = n(204), m = g.nibbleEncode, b = {}, y = 0; y < g.singleByte.length; y++) g.singleByte[y] && (b[g.singleByte[y]] = y);
    for (var y = 0; y < g.doubleByte.length; y++) g.doubleByte[y] && (b[g.doubleByte[y]] = y + f.SINGLE_BYTE_MAX);
    e.exports = r
}, function (e, t, n) {
    function r(e) {
        var t = !1,
            n = o.wrap(e, void 0, t);
        this.readByte = function () {
            return n.readUint8()
        }, this.readInt16 = function () {
            return n.readUint16()
        }, this.readInt20 = function () {
            var e = 15 & n.readUint8(),
                t = n.readUint8(),
                r = n.readUint8();
            return (e << 16) + (t << 8) + r
        }, this.readInt32 = function () {
            return n.readUint32()
        }, this.readString = function (e) {
            return n.readString(e, o.METRICS_BYTES)
        }, this.readBytes = function (e) {
            var t = n.copy(n.offset, n.offset + e);
            return n.offset += e, t
        }, this.debugInfo = function () {
            return "offset: " + n.offset + " byte: " + n.readUint8(n.offset)
        }
    }
    var o = n(74);
    e.exports = r
}, function (e, t, n) {
    function r(e) {
        var t = e.readByte(),
            n = a(e, t);
        if (t = e.readByte(), t === h.STREAM_END) throw new Error("unexpected stream end " + e.debugInfo());
        var r = i(e, t);
        if (0 === n || !r) throw new Error("invalid node. 0 list or empty tag" + e.debugInfo());
        var s = n - 2 + n % 2 >> 1,
            c = u(e, s);
        if (n % 2 === 1) return [r, c, void 0];
        var d;
        if (t = e.readByte(), o(t)) d = l(e, t);
        else if (t === h.BINARY_8) {
            var p = e.readByte();
            d = e.readBytes(p)
        } else if (t === h.BINARY_20) {
            var g = e.readInt20();
            d = e.readBytes(g)
        } else if (t === h.BINARY_32) {
            var f = e.readInt32();
            d = e.readBytes(f)
        } else d = i(e, t);
        return [r, c, d]
    }
    function o(e) {
        return e === h.LIST_EMPTY || e === h.LIST_8 || e === h.LIST_16
    }
    function a(e, t) {
        if (t === h.LIST_EMPTY) return 0;
        if (t === h.LIST_8) return e.readByte();
        if (t === h.LIST_16) return e.readInt16();
        throw new Error("invalid list size " + e.debugInfo())
    }
    function i(e, t) {
        if (-1 === t) throw new Error("invalid start token readString" + e.debugInfo());
        if (t > 2 && 236 > t) {
            var n = s(t);
            return "s.whatsapp.net" === n && (n = "c.us"), n
        }
        switch (t) {
        case h.DICTIONARY_0:
        case h.DICTIONARY_1:
        case h.DICTIONARY_2:
        case h.DICTIONARY_3:
            var r = e.readByte();
            return c(t - h.DICTIONARY_0, r);
        case h.LIST_EMPTY:
            return;
        case h.BINARY_8:
            var o = e.readByte();
            return e.readString(o);
        case h.BINARY_20:
            var a = e.readInt20();
            return e.readString(a);
        case h.BINARY_32:
            {
                e.readInt32()
            }
            return e.readString(a);
        case h.JID_PAIR:
            var u = i(e, e.readByte()),
                l = i(e, e.readByte());
            if ("undefined" != typeof u && "undefined" != typeof l) return u + "@" + l;
            if ("undefined" != typeof l) return l;
            throw new Error("invalid jid " + u + "," + l + " " + e.debugInfo());
        case h.NIBBLE_8:
            return d(e);
        default:
            throw new Error("invalid string " + e.debugInfo())
        }
    }
    function s(e) {
        var t;
        if (e >= 0 && e < f.length && (t = f[e]), "undefined" == typeof t) throw new Error("invalid token " + e);
        return t
    }
    function c(e, t) {
        var n, r = 256 * e + t;
        if (r >= 0 && r < m.length && (n = m[r]), "undefined" == typeof n) throw new Error("invalid double byte token " + e + " " + t);
        return n
    }
    function u(e, t) {
        for (var n, r, o = t ? {} : void 0, a = 0; t > a; a++) n = i(e, e.readByte()), r = i(e, e.readByte()), o[n] = r;
        return o
    }
    function l(e, t) {
        for (var n = [], o = a(e, t), i = 0; o > i; i++) n.push(r(e));
        return n
    }
    function d(e) {
        for (var t = e.readByte(), n = t >> 7, r = 127 & t, o = "", a = 0; r > a; a++) {
            var i = e.readByte(),
                s = p(i);
            o += s[0], o += s[1]
        }
        return n && (o = o.substring(0, o.length - 1)), o
    }
    function p(e) {
        var t = (240 & e) >> 4,
            n = 15 & e;
        if (!b.hasOwnProperty(t)) throw new Error("invalid nibble to unpack: " + t);
        if (!b.hasOwnProperty(n)) throw new Error("invalid nibble to unpack: " + n);
        var r = b[t],
            o = b[n];
        return [r, o]
    }
    var h = n(204),
        g = n(203),
        f = g.singleByte,
        m = g.doubleByte,
        b = g.nibbleDecode;
    e.exports = r
}, function (e, t, n) {
    function r(e, t) {
        if (!e) return "undefined";
        var n = o(e[1], t),
            r = a(e[2], t);
        return "<" + e[0] + n + (r ? ">\n" + r + "\n</" + e[0] + ">" : "/>")
    }
    function o(e, t) {
        if (e) {
            var n = "";
            for (var r in e) {
                var o = "string" == typeof e[r] ? t ? "..." : '"' + e[r] + '"' : e[r];
                n += " " + r + "=" + o
            }
            return n
        }
        return ""
    }
    function a(e, t) {
        return i.isByteBuffer(e) ? "<<bin:" + e.limit + ">>" : "string" == typeof e ? t ? "<<string:" + e.length + ">>" : e : _.isArray(e) ? e.map(_.partial(r, _, t)).join("\n") : void 0
    }
    var i = n(74),
        s = {
            tag: function (e) {
                return e && e[0]
            },
            attr: function (e, t) {
                return t && t[1] ? t[1][e] : void 0
            },
            attrs: function (e) {
                return e[1]
            },
            child: function (e, t) {
                var n = t[2];
                if (_.isArray(n)) for (var r = n.length, o = 0; r > o; o++) {
                    var a = n[o];
                    if (_.isArray(a) && a[0] === e) return a
                }
            },
            children: function (e) {
                return e && e[2]
            },
            dataStr: function (e) {
                if (!e) return "";
                var t = e[2];
                return "string" == typeof t ? t : i.isByteBuffer(t) ? t.readString(t.limit, i.METRICS_BYTES, 0).string : void 0
            },
            toString: r
        };
    e.exports = s
}, function (e, t, n) {
    var r = n(74),
        o = {
            getKeys: function () {
                var e = Wa.secretBundle.encKey.toString(CryptoJS.enc.Base64),
                    t = Wa.secretBundle.macKey.toString(CryptoJS.enc.Base64);
                return {
                    enc: CryptoJS.enc.Base64.parse(e),
                    mac: CryptoJS.enc.Base64.parse(t)
                }
            },
            encrypt: function (e) {
                var t = CryptoJS.lib.WordArray.create(e),
                    n = new Uint32Array(4),
                    o = this.getKeys();
                window.crypto.getRandomValues(n);
                var a = CryptoJS.AES.encrypt(t, o.enc, {
                    iv: CryptoJS.lib.WordArray.create(n),
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                }),
                    i = a.iv.concat(a.ciphertext),
                    s = CryptoJS.HmacSHA256(i, o.mac),
                    c = s.concat(i);
                return r.fromBase64(c.toString(CryptoJS.enc.Base64)).toBuffer()
            },
            decrypt: function (e) {
                var t = r.wrap(e),
                    n = t.slice(t.offset, t.offset + 32).toBase64(),
                    o = t.slice(t.offset + 32).toBuffer(),
                    a = this.getKeys(),
                    i = CryptoJS.lib.WordArray.create(o),
                    s = CryptoJS.HmacSHA256(i, a.mac).toString(CryptoJS.enc.Base64);
                if (n !== s) throw Wa.debug("bp:03:decrypt hmac dont match " + n + " " + s, "red"), new Error("hmac mismatch");
                var c = t.slice(t.offset + 32, t.offset + 48).toBuffer(),
                    u = t.slice(t.offset + 48).toBuffer(),
                    l = CryptoJS.AES.decrypt({
                        ciphertext: CryptoJS.lib.WordArray.create(u),
                        salt: void 0
                    }, a.enc, {
                        iv: CryptoJS.lib.WordArray.create(c),
                        mode: CryptoJS.mode.CBC,
                        padding: CryptoJS.pad.Pkcs7
                    });
                return r.fromBase64(l.toString(CryptoJS.enc.Base64)).toBuffer()
            }
        };
    e.exports = o
}, function (e, t, n) {
    var r = n(177),
        o = n(178),
        a = n(179),
        i = (n(191), n(31)),
        s = n(110),
        c = n(180),
        u = n(29),
        l = (n(137), n(136)),
        d = (n(192), n(78), n(157)),
        p = n(168),
        h = React.createClass({
            displayName: "ProfileDrawer",
            mixins: [s],
            propTypes: {
                id: React.PropTypes.string.isRequired
            },
            getInitialState: function () {
                return {
                    status: this.async("id.Status.status"),
                    imgFull: this.async("id.ProfilePicThumb.imgFull")
                }
            },
            onSetStatus: _.debounce(function () {
                if (this.state.status !== Store.Status.get(this.props.id).status) {
                    var e = this;
                    u.sendSetStatus(this.state.status).then(function (t) {
                        200 === t.status ? Store.Status.get(e.props.id).status = e.state.status : t.status >= 400 && Wa.debug("Set status failed: ", t.status)
                    }, function (e) {
                        Wa.debug("Set status failed: ", e.status)
                    })
                }
            }, 1e3),
            preventBlur: function (e) {
                e.preventDefault(), e.stopPropagation(), this.refs.input.restoreFocus()
            },
            onBack: function () {
                i.closeDrawer(this.props.type)
            },
            onEmojiToggle: function () {
                this.setState({
                    emojiActive: !this.state.emojiActive
                })
            },
            onEmoji: function (e) {
                this.refs.input.replaceSelection(e)
            },
            onInputChange: function () {
                this.setState({
                    status: this.state.status
                })
            },
            onImageSet: function (e, t) {
                c.sendSetPicture(this.props.id, e, t)
            },
            render: function () {
                this.state.emojiActive ? React.createElement(l, {
                    onEmoji: this.onEmoji
                }) : null;
                return React.createElement(r, {
                    onCancel: this.onBack,
                    id: "profile"
                }, React.createElement(o, {
                    title: l10n.t("menuitem_profile_status"),
                    onBack: this.onBack,
                    type: "profile"
                }), React.createElement(a, null, React.createElement("div", {
                    className: "drawer-section drawer-scale drawer-section-photo"
                }, React.createElement(d, {
                    id: this.props.id,
                    size: d.LARGE,
                    quality: d.HIGH
                })), React.createElement("div", {
                    className: "drawer-section well animate-enter"
                }, React.createElement("div", {
                    className: "drawer-section-title title-underlined"
                }, React.createElement("div", {
                    className: "col-main"
                }, l10n.t("web_status"))), React.createElement("div", {
                    className: "drawer-section-body"
                }, React.createElement(p, {
                    classes: "drawer-value",
                    text: this.state.status
                })))))
            }
        });
    e.exports = h
}, function (e, t, n) {
    var r = n(31),
        o = n(158),
        a = n(138),
        i = {
            title: 0,
            hour: 1,
            day: 24,
            week: 168
        },
        s = React.createClass({
            displayName: "DoNotDisturbPopup",
            getInitialState: function () {
                return {
                    notifications: Store.Mute.getGlobalNotifications(),
                    sounds: Store.Mute.getGlobalSounds(),
                    dnd: i.title
                }
            },
            componentWillUnmount: function () {
                this.state.dnd !== i.title && r.globalMute(this.state.dnd)
            },
            onSounds: function () {
                var e = !this.state.sounds;
                this.setState({
                    sounds: e
                }), Store.Mute.setGlobalSounds(e)
            },
            onNotifications: function () {
                var e = !this.state.notifications;
                this.setState({
                    notifications: e
                }), Store.Mute.setGlobalNotifications(e)
            },
            onDND: function (e) {
                var t = parseInt(e.target.value, 10);
                if (0 === t) return this.setState({
                    dnd: i.title
                }), void Store.Mute.globalMute().unmute();
                this.setState({
                    dnd: t
                });
                var n = moment().unix() + 60 * e.target.value * 60;
                Store.Mute.globalMute().mute(n)
            },
            onClose: function () {
                r.closeModal()
            },
            render: function () {
                return React.createElement(a, {
                    title: l10n.t("menuitem_notifications"),
                    okText: l10n.t("web_ok"),
                    onOK: this.onClose
                }, React.createElement("div", {
                    className: "section",
                    onClick: this.onNotifications
                }, React.createElement("span", {
                    className: "menu-icon inline"
                }, React.createElement(o, {
                    onChange: this.onNotifications,
                    checked: this.state.notifications
                })), l10n.t("option_desktop_notifications")), React.createElement("div", {
                    className: "section",
                    onClick: this.onSounds
                }, React.createElement("span", {
                    className: "menu-icon inline"
                }, React.createElement(o, {
                    onChange: this.onSounds,
                    checked: this.state.sounds
                })), l10n.t("option_sounds")), React.createElement("div", {
                    className: "section"
                }, React.createElement("div", {
                    className: "select"
                }, React.createElement("select", {
                    value: this.state.dnd,
                    onChange: this.onDND
                }, React.createElement("option", {
                    value: i.title,
                    disabled: this.state.state === i.title
                }, l10n.t("option_select_mute")), React.createElement("option", {
                    value: i.hour,
                    disabled: this.state.state === i.hour
                }, l10n.t("mute_1hour")), React.createElement("option", {
                    value: i.day,
                    disabled: this.state.state === i.day
                }, l10n.t("mute_1day")), React.createElement("option", {
                    value: i.week,
                    disabled: this.state.state === i.week
                }, l10n.t("mute_1week"))))))
            }
        });
    e.exports = s
}, function (e, t, n) {
    var r = n(176),
        o = n(193),
        a = n(163).Contact,
        i = n(31),
        s = React.createClass({
            displayName: "NewChatFlow",
            mixins: [r],
            getInitialState: function () {
                return {
                    state: React.createElement(o, {
                        title: l10n.t("new_chat_flow_title"),
                        onPickContact: this.pickContact,
                        onBack: this.endFlow,
                        onControl: this.handleControl
                    })
                }
            },
            handleControl: function (e, t) {
                switch (e) {
                case a.Actions.picked:
                    Store.Chat.find(t.get("id")).then(function (e) {
                        i.openChat(e)
                    }), this.endFlow();
                    break;
                default:
                    Wa.debug("Unrecognized contact action")
                }
            }
        });
    e.exports = s
}, function (e, t, n) {
    var r = n(176),
        o = n(194),
        a = n(180),
        i = n(195),
        s = n(29),
        c = (n(31), React.createClass({
            displayName: "NewGroupFlow",
            mixins: [r],
            getInitialState: function () {
                return {
                    state: React.createElement(o, {
                        onBack: this.endFlow,
                        onContinue: this.groupParticipants
                    })
                }
            },
            groupParticipants: function (e, t, n) {
                this.setState({
                    state: React.createElement(i, {
                        subject: e,
                        thumb: t,
                        full: n,
                        onBack: this.participantsBack,
                        onContinue: this.createGroup
                    })
                })
            },
            createGroup: function (e, t, n, r) {
                var o = _.pluck(r, "id");
                s.createGroup(e, o).then(function (e) {
                    200 === e.status ? (Wa.debug("group created: " + e.gid), t && n && (Wa.debug("group icon present, setting"), a.sendSetPicture(e.gid, t, n))) : e.status >= 400 && Wa.debug("Create group failed: ", e.status)
                })["catch"](function (e) {
                    Wa.debug("Create group failed: ", e)
                }), this.endFlow()
            },
            participantsBack: function (e, t, n) {
                this.setState({
                    state: React.createElement(o, {
                        subject: e,
                        thumb: t,
                        full: n,
                        onBack: this.endFlow,
                        onContinue: this.groupParticipants
                    })
                })
            }
        }));
    e.exports = c
}, function (e, t, n) {
    var r = n(26),
        o = n(48),
        a = n(87),
        i = n(78),
        s = React.createClass({
            displayName: "MenuItem",
            mixins: [o],
            propTypes: {
                showShortcut: React.PropTypes.bool,
                shortcut: React.PropTypes.string,
                action: React.PropTypes.func.isRequired
            },
            componentWillMount: function () {
                this.props.shortcut && this.regNativeListener(window, "keydown", this.onKeyDown)
            },
            onKeyDown: function (e) {
                e.metaKey && String.fromCharCode(e.keyCode).toLowerCase() === this.props.shortcut.toLowerCase() && (e.preventDefault(), this.onSelect(e))
            },
            onSelect: function (e) {
                this.props.action(e) || e.target && e.target.hasAttribute("data-ignore") ? e.stopPropagation() : a.pop(a.MENU)
            },
            render: function () {
                var e = Wa.getOSType() === r.OS_TYPE.MAC ? "⌘" : "Ctrl-",
                    t = this.props.showShortcut && this.props.shortcut ? React.createElement("span", null, e + this.props.shortcut.toUpperCase()) : null;
                return React.createElement("li", {
                    className: "menu-item menu-shortcut",
                    onClick: this.onSelect
                }, React.createElement("a", null, this.props.children), React.createElement("span", {
                    key: "shortcut",
                    className: "shortcut"
                }, React.createElement(i, {
                    transitionName: "pop"
                }, t)))
            }
        });
    e.exports = s
}, function (e, t, n) {
    var r = n(196),
        o = n(110),
        a = "large",
        i = "regular",
        s = "low",
        c = "high",
        u = React.createClass({
            displayName: "DetailImage",
            mixins: [o],
            propTypes: {
                id: React.PropTypes.string.isRequired,
                size: React.PropTypes.oneOf([i, a]),
                quality: React.PropTypes.oneOf([s, c]),
                onClick: React.PropTypes.func,
                asyncDelay: React.PropTypes.number
            },
            getDefaultProps: function () {
                return {
                    size: i,
                    quality: s
                }
            },
            statics: {
                LARGE: a,
                REGULAR: i,
                LOW: s,
                HIGH: c
            },
            getInitialState: function () {
                var e = this.props.quality;
                return Wa.isBroadcastWid(this.props.id) ? {} : e === u.HIGH ? {
                    imgFull: this.async("id.ProfilePicThumb.imgFull", null, this.props.asyncDelay)
                } : e === u.LOW ? {
                    img: this.async("id.ProfilePicThumb.img", null, this.props.asyncDelay)
                } : void 0
            },
            getClasses: function () {
                var e = "avatar",
                    t = this.props.id;
                return Wa.isUserWid(t) ? e += " icon-user-default" : Wa.isGroupWid(t) ? e += " icon-group-default" : Wa.isBroadcastWid(t) && (e += " icon-broadcast-default"), this.props.size === u.LARGE && (e += " avatar-l"), e
            },
            getStyle: function () {
                return this.props.onClick ? {
                    cursor: "pointer"
                } : null
            },
            render: function () {
                var e = this.state.img || this.state.imgFull;
                return e = e ? React.createElement(r, {
                    src: e
                }) : null, React.createElement("div", {
                    className: this.getClasses(),
                    style: this.getStyle(),
                    onClick: this.props.onClick
                }, e)
            }
        });
    e.exports = u
}, function (e, t, n) {
    var r = n(48),
        o = React.createClass({
            displayName: "CheckBox",
            mixins: [r],
            propTypes: {
                checked: React.PropTypes.bool.isRequired,
                onChange: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    checked: this.props.checked,
                    transition: null
                }
            },
            statics: {
                BOX: "box",
                CHECKMARK: "checkmark"
            },
            componentDidMount: function () {
                this.regNativeListener(this.refs.checkbox.getDOMNode(), "animationEnd", this.onAnimationEnd)
            },
            componentWillReceiveProps: function (e) {
                if (this.state.checked != e.checked) {
                    var t = this.state.checked ? o.CHECKMARK : o.BOX;
                    this.setState({
                        transition: t
                    })
                }
            },
            onAnimationEnd: function () {
                if (this.state.transition === o.CHECKMARK && this.state.checked || this.state.transition === o.BOX && !this.state.checked) {
                    var e = this.state.transition === o.CHECKMARK ? o.BOX : o.CHECKMARK;
                    this.setState({
                        transition: e
                    })
                } else this.setState({
                    transition: null,
                    checked: !this.state.checked
                })
            },
            onToggle: function (e) {
                e && e.stopPropagation(), this.props.onChange()
            },
            render: function () {
                var e = "checkbox";
                return e += this.state.checked ? " checked" : " unchecked", this.state.transition && (e += " " + this.state.transition), React.createElement("div", {
                    className: "checkbox-container",
                    onClick: this.onToggle
                }, React.createElement("div", {
                    className: e,
                    ref: "checkbox"
                }))
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(87),
        o = n(78),
        a = React.createClass({
            displayName: "MenuBar",
            propTypes: {
                children: React.PropTypes.node
            },
            render: function () {
                var e = this.key,
                    t = [];
                return React.Children.forEach(this.props.children, function (n, r) {
                    n && (n.key = e + "-menu-bar-" + r, t.push(n))
                }), React.createElement("div", {
                    className: "menu menu-horizontal"
                }, t)
            }
        }),
        i = React.createClass({
            displayName: "MenuBarItem",
            propTypes: {
                icon: React.PropTypes.string.isRequired,
                title: React.PropTypes.string.isRequired,
                children: React.PropTypes.node,
                transitionName: React.PropTypes.string,
                onClick: React.PropTypes.func
            },
            getDefaultProps: function () {
                return {
                    transitionName: "dropdown"
                }
            },
            getInitialState: function () {
                return {
                    menuActive: !1
                }
            },
            onClick: function (e) {
                e.stopPropagation(), this.props.onClick(e)
            },
            toggleMenu: function (e) {
                e.stopPropagation(), this.activateMenu()
            },
            activateMenu: function () {
                this.setState({
                    menuActive: !0
                }), r.push(this, r.MENU)
            },
            close: function () {
                this.setState({
                    menuActive: !1
                })
            },
            render: function () {
                var e = "icon icon-" + this.props.icon,
                    t = this.props.onClick ? this.onClick : this.toggleMenu,
                    n = null;
                if (this.props.children) {
                    var r = this.props.transitionName,
                        a = React.Children.only(this.props.children);
                    a.key = "active-dropdown", n = React.createElement(o, {
                        transitionName: r
                    }, this.state.menuActive ? a : null)
                }
                var i = "menu-item";
                return this.state.menuActive && (i += " active"), React.createElement("div", {
                    className: i
                }, React.createElement("button", {
                    className: e,
                    title: this.props.title,
                    onClick: t
                }, this.props.title), n)
            }
        });
    e.exports = {
        MenuBar: a,
        MenuBarItem: i
    }
}, function (e, t, n) {
    var r = n(176),
        o = n(197),
        a = (n(31), React.createClass({
            displayName: "SamplePopupFlow",
            mixins: [r],
            getInitialState: function () {
                return {
                    state: React.createElement(o, {
                        onBack: this.endFlow
                    })
                }
            }
        }));
    e.exports = a
}, function (e, t, n) {
    var r = n(48),
        o = React.createClass({
            displayName: "List",
            mixins: [r],
            propTypes: {
                extraItems: React.PropTypes.number,
                scrollTarget: React.PropTypes.oneOfType([React.PropTypes.object, React.PropTypes.number]),
                animate: React.PropTypes.bool.isRequired,
                classes: React.PropTypes.arrayOf(React.PropTypes.string),
                height: React.PropTypes.number.isRequired,
                data: React.PropTypes.arrayOf(React.PropTypes.node).isRequired
            },
            getDefaultProps: function () {
                return {
                    classes: [],
                    scrollTarget: null,
                    data: null,
                    height: 50,
                    extraItems: 30,
                    animate: !1
                }
            },
            getInitialState: function () {
                return {
                    scrollTop: 0,
                    visibleCount: 0,
                    physicalCount: 0
                }
            },
            componentWillReceiveProps: function (e) {
                this.initialize(e)
            },
            componentDidMount: function () {
                this.ticking = !1;
                var e = this.initialize();
                this.regNativeListener(e, "scroll", this.onScroll);
                var t = this;
                this.regNativeListener(window, "resize", function () {
                    t.initialize()
                })
            },
            initialize: function (e) {
                var t = e ? e : this.props,
                    n = t.scrollTarget;
                if ("number" == typeof n) {
                    for (var r = this.refs.scrollable.getDOMNode(), o = 0; n > o; o++) r = r.parentNode;
                    n = r
                } else n || (n = this.refs.scrollable.getDOMNode());
                var a = n.clientHeight,
                    i = Math.min(Math.ceil(a / t.height), t.data.length),
                    s = Math.min(i + t.extraItems, t.data.length);
                return this.setState({
                    scrollTop: n.scrollTop,
                    scrollTarget: n,
                    visibleCount: i,
                    physicalCount: s
                }), n
            },
            onScroll: function () {
                this.ticking || window.requestAnimationFrame(this._onScroll), this.ticking = !0
            },
            _onScroll: function () {
                if (this.isMounted()) {
                    var e = this.refs.scrollable.getDOMNode();
                    clearTimeout(this.scrollTimer), e.classList.contains("disable-hover") || e.classList.add("disable-hover"), this.scrollTimer = setTimeout(function () {
                        e.classList.remove("disable-hover")
                    }, 250);
                    var t = this.state.scrollTarget.scrollTop,
                        n = this;
                    this.setState({
                        scrollTop: t
                    }, function () {
                        n.ticking = !1
                    })
                }
            },
            getComponents: function () {
                var e = this.state.scrollTop,
                    t = Math.floor(e / this.props.height),
                    n = t + this.state.visibleCount / 2,
                    r = Math.max(0, Math.floor(n - this.state.physicalCount / 2));
                r = Math.min(r, this.props.data.length - this.state.physicalCount);
                for (var o = Math.min(r + this.state.physicalCount, this.props.data.length), a = o, i = r; o > i; i++) if (i % this.state.physicalCount === 0) {
                    a = i;
                    break
                }
                var s = [];
                for (i = a; o > i; i++) this.props.data[i] && s.push(this.wrapComponent(i));
                for (i = r; a > i; i++) this.props.data[i] && s.push(this.wrapComponent(i));
                return s
            },
            wrapComponent: function (e) {
                var t = {
                    transform: "translate3d(0, " + 100 * e + "%, 0)",
                    zIndex: this.props.data.length - e + 1,
                    height: this.props.height,
                    willChange: "transform"
                },
                    n = this.props.data[e];
                return React.createElement("div", {
                    className: "infinite-list-item",
                    key: n.key,
                    style: t
                }, n)
            },
            getClasses: function () {
                var e = "infinite-list";
                this.props.animate && (e += " infinite-list-animate");
                for (var t = 0; t < this.props.classes.length; t++) e += " " + this.props.classes[t];
                return e
            },
            render: function () {
                var e = {
                    willChange: "transform"
                },
                    t = {
                        height: this.props.data.length * this.props.height
                    };
                return React.createElement("div", {
                    className: this.getClasses(),
                    ref: "scrollable",
                    style: e
                }, React.createElement("div", {
                    className: "viewport",
                    style: t
                }, this.getComponents()))
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(110),
        o = n(47),
        a = n(157),
        i = n(168),
        s = (n(156), n(31)),
        c = n(97),
        u = n(94),
        l = n(87),
        d = n(175),
        p = n(174),
        h = n(166),
        g = n(167),
        f = React.addons.PureRenderMixin,
        m = React.createClass({
            displayName: "Chat",
            mixins: [r, f],
            propTypes: {
                chat: React.PropTypes.instanceOf(u).isRequired,
                mode: React.PropTypes.oneOf(["last", "info"]),
                asyncDelay: React.PropTypes.number
            },
            getDefaultProps: function () {
                return {
                    mode: "last"
                }
            },
            getInitialState: function () {
                return {
                    formattedTitle: this.async("chat.formattedTitle"),
                    active: this.async("chat.active"),
                    hasUnread: this.async("chat.hasUnread"),
                    dragdrop: "ready"
                }
            },
            onClick: function () {
                s.openChat(this.props.chat)
            },
            onMute: function () {
                var e = this.props.chat.mute,
                    t = e.mute.bind(e);
                s.openModal(React.createElement(p, {
                    onMute: t
                }))
            },
            onUnmute: function () {
                this.props.chat.mute.unmute(!0)
            },
            onArchive: function () {
                this.props.chat.setArchive(!0)
            },
            onUnarchive: function () {
                this.props.chat.setArchive(!1)
            },
            onDelete: function () {
                var e = this.props.chat,
                    t = e.sendDelete.bind(e);
                s.openModal(React.createElement(d, {
                    chat: e,
                    onDelete: t
                }))
            },
            onExitOrDeleteGroup: function () {
                var e = s.closeDrawer.bind(s, l.DRAWER_RIGHT);
                s.openModal(React.createElement(d, {
                    chat: this.props.chat,
                    onDelete: e
                }))
            },
            onContextMenu: function () {},
            getClasses: function () {
                var e = "chat";
                return this.state.active && (e += " active"), this.props.cursor && (e += " cursor"), this.state.hasUnread && (e += " unread"), e
            },
            render: function () {
                var e, t = this.props.chat;
                switch (this.props.mode) {
                case "last":
                    e = React.createElement("div", {
                        className: "chat-secondary"
                    }, React.createElement(y, {
                        chat: t
                    }), React.createElement(v, {
                        chat: t
                    }));
                    break;
                case "info":
                    e = t.isGroup ? React.createElement(h, {
                        presence: t.presence,
                        groupMetadata: t.groupMetadata,
                        location: "list"
                    }) : React.createElement(g, {
                        presence: t.presence,
                        location: "list"
                    })
                }
                return React.createElement("div", {
                    className: this.getClasses(),
                    onClick: this.onClick,
                    onContextMenu: this.onContextMenu
                }, React.createElement("div", {
                    className: "chat-avatar"
                }, React.createElement(a, {
                    id: t.get("id"),
                    asyncDelay: this.props.asyncDelay
                })), React.createElement("div", {
                    className: "chat-body"
                }, React.createElement("div", {
                    className: "chat-main"
                }, React.createElement("div", {
                    className: "chat-title"
                }, React.createElement(i, {
                    text: this.state.formattedTitle,
                    titlify: !0,
                    ellipsify: !0
                })), React.createElement(b, {
                    timestamp: t.get("t")
                })), e))
            }
        }),
        b = React.createClass({
            displayName: "ChatTimestamp",
            propTypes: {
                timestamp: React.PropTypes.number
            },
            getFortmattedTime: function () {
                var e = this.props.timestamp,
                    t = moment().startOf("day");
                return e >= t.unix() ? Wa.formatTimestamp(e) : Wa.formatDateRelative(e)
            },
            render: function () {
                return this.props.timestamp ? React.createElement("div", {
                    className: "chat-meta"
                }, React.createElement("span", {
                    className: "chat-time"
                }, this.getFortmattedTime())) : null
            }
        }),
        y = React.createClass({
            displayName: "ChatStatus",
            mixins: [o],
            propTypes: {
                chat: React.PropTypes.object
            },
            componentWillMount: function () {
                var e = this.props.chat;
                this.addObserver(e.msgs, "change:last"), this.addObserver(e.presence, "change:chatstate.id change:chatstate.type change:withholdDisplay")
            },
            render: function () {
                var e = this.props.chat,
                    t = e.presence;
                if (t.isActive()) {
                    var n = t.getFormattedString();
                    return React.createElement("div", {
                        className: "chat-status typing"
                    }, React.createElement(i, {
                        ellipsify: !0,
                        titleify: !0,
                        text: n
                    }))
                }
                var r = e.msgs.last();
                return r ? React.createElement(_, {
                    key: Wa.widToKey(r.id),
                    msg: r
                }) : React.createElement("div", {
                    className: "chat-status"
                })
            }
        }),
        _ = React.createClass({
            displayName: "ChatLastMsg",
            mixins: [r, o],
            propTypes: {
                msg: React.PropTypes.instanceOf(c).isRequired
            },
            getInitialState: function () {
                return this.props.msg.sender ? {
                    formattedShortName: this.async("msg.senderObj.formattedShortName")
                } : {}
            },
            componentWillMount: function () {
                "ptt" === this.props.msg.type && this.addObserver(this.props.msg, "change:duration")
            },
            render: function () {
                var e = this.props.msg,
                    t = "",
                    n = [];
                if (e.isSentByMe && n.push(React.createElement(E, {
                    msg: e,
                    key: "symbol"
                })), !e.isSentByMe && e.isGroupMsg && "gp2" !== e.type && "group_notification" !== e.type) {
                    var r = this.state.formattedShortName + ": ";
                    t += r, n.push(React.createElement(i, {
                        text: r,
                        key: "author"
                    }))
                }
                return e.hasSymbol && n.push(React.createElement(A, {
                    msg: e,
                    key: "msg-symbol"
                })), t += e.msgText(), n.push(React.createElement(i, {
                    ellipsify: !0,
                    text: e.msgText(),
                    key: "status"
                })), React.createElement("div", {
                    className: "chat-status ellipsify",
                    title: t
                }, n)
            }
        }),
        A = React.createClass({
            displayName: "ChatMsgSymbol",
            mixins: [o],
            propTypes: {
                msg: React.PropTypes.instanceOf(c)
            },
            componentWillMount: function () {
                var e = this.props.msg;
                "ptt" === e.type && e.ack < 4 && this.addObserver(this.props.msg, "change:ack")
            },
            getClasses: function () {
                var e = "icon media-icon",
                    t = this.props.msg;
                switch (t.type) {
                case "location":
                case "image":
                case "video":
                case "audio":
                case "vcard":
                    e += " icon-status-" + t.type;
                    break;
                case "ptt":
                    var n = 4 === t.ack ? "blue" : t.isSentByMe ? "gray" : "green";
                    e += " icon-status-" + t.type + "-" + n;
                    break;
                default:
                    Wa.debug("Invalid msg type.")
                }
                return e
            },
            render: function () {
                return React.createElement("span", {
                    className: this.getClasses()
                })
            }
        }),
        E = React.createClass({
            displayName: "ChatSymbol",
            mixins: [r],
            propTyps: {
                msg: React.PropTypes.instanceOf(c)
            },
            getInitialState: function () {
                return {
                    ack: this.async("msg.ack")
                }
            },
            render: function () {
                if (!this.props.msg.isSentByMe) return null;
                var e = "icon",
                    t = this.props.msg.ack;
                return e += t ? 1 === t ? " icon-status-check" : 2 === t ? " icon-status-dblcheck" : " icon-status-dblcheck-ack" : " icon-status-time", React.createElement("span", {
                    className: e
                })
            }
        }),
        v = React.createClass({
            displayName: "ChatIcons",
            mixins: [r],
            propTypes: {
                chat: React.PropTypes.object.isRequired
            },
            getInitialState: function () {
                return {
                    isMuted: this.async("chat.mute.isMuted"),
                    unreadCount: this.async("chat.unreadCount")
                }
            },
            render: function () {
                var e = this.state.isMuted ? React.createElement("span", {
                    className: "icon icon-muted"
                }) : null,
                    t = this.props.chat.unreadCount > 0 ? React.createElement("span", {
                        className: "unread-count"
                    }, this.state.unreadCount) : null;
                return t || e ? React.createElement("div", {
                    className: "chat-meta"
                }, React.createElement("div", {
                    className: "icons"
                }, e, t)) : null
            }
        });
    e.exports = {
        Chat: m,
        ChatTimestamp: b,
        ChatStatus: y,
        ChatMsgSymbol: A,
        ChatIcons: v
    }
}, function (e, t, n) {
    var r = n(110),
        o = n(157),
        a = n(168),
        i = React.createClass({
            displayName: "Contact",
            mixins: [r],
            statics: {
                Controls: {
                    checkable: "checkable",
                    clickable: "clickable",
                    context: "context",
                    removable: "removable",
                    deletable: "deletable"
                },
                Actions: {
                    picked: "picked",
                    context: "context",
                    checked: "checked",
                    deleted: "deleted"
                }
            },
            propTypes: {
                contact: React.PropTypes.object.isRequired,
                onControl: React.PropTypes.func.isRequired,
                controls: React.PropTypes.oneOf(["checkable", "clickable", "context", "removable", "deletable"]),
                admin: React.PropTypes.bool,
                isChecked: React.PropTypes.bool,
                asyncDelay: React.PropTypes.number
            },
            getDefaultProps: function () {
                return {
                    flags: {}
                }
            },
            getInitialState: function () {
                return {
                    status: this.async("contact.Status.status", null, this.props.asyncDelay)
                }
            },
            onClick: function (e) {
                var t = this.props.contact;
                this.props.controls === i.Controls.clickable ? this.props.onControl(i.Actions.picked, t, e.nativeEvent) : this.props.controls === i.Controls.checkable ? this.props.onControl(i.Actions.checked, t, e.nativeEvent) : this.props.controls === i.Controls.deletable && this.props.onControl(i.Actions.deleted, t, e.nativeEvent)
            },
            onContextClick: function (e) {
                this.props.controls === i.Controls.context && (this.props.onControl(i.Actions.context, this.props.contact, e.nativeEvent), e.preventDefault())
            },
            render: function () {
                var e = this.props.contact,
                    t = e.get("formattedName");
                this.props.flags.groupAdminId === e.get("id") && (t += " - " + l10n.t("web_group_admin"));
                var n;
                this.props.controls === i.Controls.checkable ? n = React.createElement(s, {
                    checked: e.get("checked")
                }) : this.props.controls === i.Controls.removable ? n = React.createElement(c, {
                    contact: e
                }) : this.props.controls === i.Controls.deletable && (n = React.createElement("button", {
                    className: "icon icon-x-alt-small",
                    onClick: this.onClick
                }));
                var r;
                this.props.admin && (r = React.createElement("div", {
                    className: "chat-meta"
                }, React.createElement("div", {
                    className: "chat-marker chat-marker-admin"
                }, l10n.t("web_group_admin"))));
                var l = "chat";
                return this.props.cursor && (l += " cursor"), React.createElement("div", {
                    className: l,
                    onClick: this.onClick,
                    onContextMenu: this.onContextClick
                }, React.createElement("div", {
                    className: "chat-avatar"
                }, React.createElement(o, {
                    id: e.get("id"),
                    asyncDelay: this.props.asyncDelay
                })), React.createElement("div", {
                    className: "chat-body"
                }, React.createElement("div", {
                    className: "chat-main"
                }, React.createElement("div", {
                    className: "chat-title",
                    title: t
                }, React.createElement(a, {
                    text: t
                })), r), React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement(u, {
                    status: this.state.status
                }))), React.createElement("div", {
                    className: "chat-controls"
                }, n))
            }
        }),
        s = React.createClass({
            displayName: "ContactCheckbox",
            propTypes: {
                checked: React.PropTypes.bool
            },
            render: function () {
                return React.createElement("input", {
                    className: "custom-checkbox",
                    readOnly: !0,
                    type: "checkbox",
                    checked: this.props.checked
                })
            }
        }),
        c = React.createClass({
            displayName: "ContactRemove",
            propTypes: {
                contact: React.PropTypes.object.isRequired
            },
            onClick: function () {
                this.props.contact.set("picked")
            },
            render: function () {
                return React.createElement("button", {
                    className: "icon icon-cross-inv",
                    onClick: this.onClick
                })
            }
        }),
        u = React.createClass({
            displayName: "ContactStatus",
            propTypes: {
                status: React.PropTypes.string
            },
            render: function () {
                return _.isUndefined(this.props.status) ? React.createElement("div", {
                    className: "muted"
                }, l10n.t("contact_status_loading")) : React.createElement("div", {
                    className: "chat-status ellipsify",
                    title: this.props.status
                }, React.createElement(a, {
                    ellipsify: !0,
                    text: this.props.status
                }))
            }
        });
    e.exports = {
        Contact: i,
        ContactCheckbox: s,
        ContactRemove: c,
        ContactStatus: u
    }
}, function (e) {
    var t = React.createClass({
        displayName: "SectionHeader",
        propTypes: {
            header: React.PropTypes.string.isRequired
        },
        render: function () {
            return React.createElement("div", {
                className: "list-title"
            }, this.props.header)
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = n(26),
        o = n(138),
        a = n(31),
        i = "guide-allow",
        s = "guide-unblock",
        c = "none",
        u = {
            CHROME_MEDIA_ERROR: "__chrome_media_error__",
            FIREFOX_LOCK: "__firefox_lock__",
            OPERA_MEDIA: "__opera_media__"
        },
        l = React.createClass({
            displayName: "GuidePopup",
            propTypes: {
                title: React.PropTypes.string.isRequired,
                desc: React.PropTypes.string.isRequired,
                browserPrefixDesc: React.PropTypes.bool.isRequired,
                type: React.PropTypes.oneOf([i, s, c]).isRequired,
                onConfirm: React.PropTypes.func,
                onCancel: React.PropTypes.func
            },
            statics: {
                GUIDE_ALLOW: "guide-allow",
                GUIDE_UNBLOCK: "guide-unblock",
                GUIDE_NONE: "guide-none"
            },
            getDefaultProps: function () {
                return {
                    browserPrefixDesc: !0,
                    type: c,
                    onConfirm: a.closeModal.bind(a)
                }
            },
            componentDidMount: function () {
                var e = this.getDescription(),
                    t = this.refs.description.getDOMNode();
                e.indexOf(u.CHROME_MEDIA_ERROR) > -1 && (t.innerHTML = t.innerHTML.replace(u.CHROME_MEDIA_ERROR, '<span class="chrome-media-icon"></span>')), e.indexOf(u.FIREFOX_LOCK) > -1 && (t.innerHTML = t.innerHTML.replace(u.FIREFOX_LOCK, '<span class="firefox-lock-icon"></span>')), e.indexOf(u.OPERA_MEDIA) > -1 && (t.innerHTML = t.innerHTML.replace(u.OPERA_MEDIA, '<span class="opera-media-icon"></span>'))
            },
            getDescription: function () {
                var e = this.props.desc + "_" + Wa.getBrowserType();
                return l10n.t(this.props.browserPrefixDesc && l10n.hasT(e) ? e : this.props.desc)
            },
            render: function () {
                var e = "popup-guide";
                if (Wa.getBrowserType() === r.BROWSER_TYPE.CHROME) switch (Wa.getOSType()) {
                case r.OS_TYPE.MAC:
                    e += " popup-guide-mac";
                    break;
                case r.OS_TYPE.CHROMEOS:
                    e += " popup-guide-chrome";
                    break;
                case r.OS_TYPE.WINDOWS:
                }
                var t = null;
                this.props.type !== c && Wa.getBrowserType() === r.BROWSER_TYPE.CHROME && (t = React.createElement("div", {
                    className: "round"
                }, React.createElement("div", {
                    className: "round-body " + this.props.type
                })));
                var n = this.props.onCancel ? l10n.t("learn_more") : void 0;
                return React.createElement(o, {
                    title: l10n.t(this.props.title),
                    classes: e,
                    onOK: this.props.onConfirm,
                    okText: l10n.t("ok_got_it"),
                    onCancel: this.props.onCancel,
                    cancelText: n
                }, t, React.createElement("div", {
                    className: "text text-tip",
                    ref: "description"
                }, this.getDescription()))
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(47),
        o = n(168),
        a = n(33),
        i = n(98),
        s = n(95),
        c = React.createClass({
            displayName: "GroupSubtitle",
            mixins: [r],
            propTypes: {
                presence: React.PropTypes.instanceOf(i),
                groupMetadata: React.PropTypes.instanceOf(s),
                placeholder: React.PropTypes.node,
                location: React.PropTypes.oneOf(["list", "title"])
            },
            componentWillMount: function () {
                Store.GroupMetadata.find(this.props.groupMetadata.id)["catch"](a.WapDrop, _.noop);
                var e = this.props.groupMetadata.participants;
                this.addObserver(e, "sort remove reset"), this.addObserver(this.props.presence, "change:chatstate.id change:chatstate.type change:forceDisplay change:withholdDisplay")
            },
            getSubtitle: function () {
                return this.props.groupMetadata.participants.map(function (e) {
                    return e.contact.formattedShortName
                }).join(", ")
            },
            render: function () {
                var e, t = this.props.presence;
                return "list" === this.props.location ? (e = t.getFormattedString() || this.getSubtitle(), e ? React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement(o, {
                    ellipsify: !0,
                    titlify: !0,
                    text: e
                })) : null) : (e = t.withholdDisplay ? this.props.placeholder : t.getFormattedString() || (t.forceDisplay ? this.getSubtitle() : this.getSubtitle() || this.props.placeholder), e ? React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement("div", {
                    className: "chat-status ellipsify"
                }, React.createElement(o, {
                    ellipsify: !0,
                    titlify: !0,
                    text: e
                }))) : null)
            }
        });
    e.exports = c
}, function (e, t, n) {
    var r = n(110),
        o = n(168),
        a = n(98),
        i = (n(33), React.createClass({
            displayName: "UserSubtitle",
            mixins: [r],
            propTypes: {
                presence: React.PropTypes.instanceOf(a),
                placeholder: React.PropTypes.node,
                location: React.PropTypes.oneOf(["list", "title"])
            },
            getInitialState: function () {
                return {
                    hasData: this.async("presence.hasData"),
                    type: this.async("presence.chatstate.type"),
                    deny: this.async("presence.chatstate.deny"),
                    t: this.async("presence.chatstate.t"),
                    forceDisplay: this.async("presence.forceDisplay"),
                    withholdDisplay: this.async("presence.withholdDisplay")
                }
            },
            render: function () {
                var e, t = this.props.presence;
                return "list" === this.props.location ? (e = t.getFormattedString(), e ? React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement(o, {
                    ellipsify: !0,
                    titlify: !0,
                    text: e
                })) : null) : (e = t.withholdDisplay ? this.props.placeholder : t.getFormattedString() || (t.forceDisplay ? "" : this.props.placeholder), e ? React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement("div", {
                    className: "chat-status ellipsify"
                }, React.createElement(o, {
                    ellipsify: !0,
                    titlify: !0,
                    text: e
                }))) : null)
            }
        }));
    e.exports = i
}, function (e, t, n) {
    function r(e, t, n, o, a) {
        if (n > o) return -1;
        var i = Math.round((n + o) / 2),
            s = e[i],
            c = s.offsetLeft - a;
        return c >= t ? r(e, t, n, i - 1, a) : c + s.clientWidth > t ? i : r(e, t, i + 1, o, a)
    }
    var o = n(32),
        a = n(48),
        i = n(46),
        s = n(79),
        c = React.addons.PureRenderMixin,
        u = 4096,
        l = React.createClass({
            displayName: "EmojiText",
            mixins: [i, a, s, c],
            propTypes: {
                text: React.PropTypes.string,
                element: React.PropTypes.any,
                classes: React.PropTypes.string,
                linkify: React.PropTypes.bool,
                titlify: React.PropTypes.bool,
                ellipsify: React.PropTypes.bool,
                wbr: React.PropTypes.number
            },
            getInitialState: function () {
                return this.debouncedRecompute = this.safeDebounce(this.recompute, 20), this.reged = !1, {
                    ellipsified: null
                }
            },
            getDefaultProps: function () {
                return {
                    element: "span"
                }
            },
            componentWillMount: function () {
                Wa.isWebkit && this.props.ellipsify && this.containsEmoji() && this.regResizeListener()
            },
            componentWillReceiveProps: function (e) {
                if (Wa.isWebkit && this.props.ellipsify && e.text !== this.props.text) {
                    var t = (e.text || "").substring(0, u);
                    o.containsEmoji(t) ? (this.setState({
                        ellipsified: null
                    }, this.ellipsify), this.containsEmoji() || this.regResizeListener()) : (this.setState({
                        ellipsified: null
                    }), this.containsEmoji() && this.unregResizeListener())
                }
            },
            containsEmoji: function () {
                var e = (this.props.text || "").substring(0, u);
                return o.containsEmoji(e)
            },
            regResizeListener: function () {
                this.reged || (this.regNativeListener(window, "resize", this.debouncedRecompute), this.regCmd("resize", this.debouncedRecompute), this.reged = !0)
            },
            unregResizeListener: function () {
                this.reged && (this.unregNativeListener(window, "resize", this.debouncedRecompute), this.unregCmd("resize", this.debouncedRecompute), this.reged = !1)
            },
            recompute: function () {
                this.setState({
                    ellipsified: null
                }, this.ellipsify)
            },
            componentDidMount: function () {
                Wa.isWebkit && this.props.ellipsify && this.containsEmoji() && this.ellipsify()
            },
            ellipsify: function () {
                var e = this.getDOMNode(),
                    t = e.querySelectorAll("img");
                if (0 !== t.length) {
                    var n, o = 0;
                    if (n = e.clientWidth) {
                        if (n === e.scrollWidth) return;
                        o = 0
                    } else {
                        var a = e.parentNode;
                        if (o = e.offsetLeft, n = a.clientWidth - o, a.clientWidth === a.scrollWidth) return
                    }
                    var i = r(t, n, 0, t.length - 1, o);
                    if (!(0 > i)) {
                        var s = t[i],
                            c = 10;
                        c -= Math.floor(c / 4);
                        var u = r(t, n - c, 0, i, o);
                        u > -1 && (s = t[u]);
                        for (var l = e.childNodes, d = [], p = 0; p < l.length; p++) {
                            var h = l[p];
                            if (h === s) break;
                            d.push(3 === h.nodeType ? h.textContent : h.alt)
                        }
                        if (d.length) {
                            var g = d.length - 1;
                            d[g] = d[g].trimRight()
                        }
                        this.setState({
                            ellipsified: d.join("")
                        })
                    }
                }
            },
            render: function () {
                if (!this.props.text) return null;
                var e;
                (e = this.state.ellipsified) || (e = this.props.ellipsify ? (this.props.text || "").substring(0, u) : this.props.text);
                var t, n = this.props.wbr;
                this.props.linkify ? t = Wa.linkify(e, !0, n) : (e = n && e.length > n ? Wa.wbr(e, n) : e, t = o.emojiToHTML(_.escape(e))), this.state.ellipsified && (t += "&hellip;");
                var r = this.props.classes || "emojitext";
                this.props.ellipsify && (r += " ellipsify"), r || (r = null);
                var a = this.props.element;
                return this.props.titlify ? React.createElement(a, {
                    className: r,
                    title: this.props.text,
                    dangerouslySetInnerHTML: {
                        __html: t
                    }
                }) : React.createElement(a, {
                    className: r,
                    dangerouslySetInnerHTML: {
                        __html: t
                    }
                })
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(176),
        o = n(198),
        a = (n(31), n(94)),
        i = React.createClass({
            displayName: "CaptureFlow",
            mixins: [r],
            propTypes: {
                chat: React.PropTypes.instanceOf(a).isRequired,
                stream: React.PropTypes.object.isRequired
            },
            getInitialState: function () {
                return {
                    state: React.createElement(o, {
                        onBack: this.endFlow,
                        onSend: this.sendMedia,
                        stream: this.props.stream
                    })
                }
            },
            sendMedia: function (e) {
                this.props.chat.sendMedia({
                    file: e
                }), this.endFlow()
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(110),
        o = n(79),
        a = (n(48), n(180), n(31)),
        i = n(161),
        s = n(162).Chat,
        c = n(177),
        u = (n(178), n(179)),
        l = n(199),
        d = (n(112), n(157)),
        p = n(175),
        h = n(87),
        g = n(168),
        f = n(33),
        m = n(50),
        b = React.createClass({
            displayName: "ContactInfoDrawer",
            mixins: [r, o],
            propTypes: {
                contact: React.PropTypes.instanceOf(m).isRequired
            },
            getInitialState: function () {
                return {
                    status: this.async("contact.Status.status"),
                    commonGroups: []
                }
            },
            componentDidMount: function () {
                this.safeDelay(function () {
                    this.props.contact.findCommonGroups().bind(this).then(function (e) {
                        this.isMounted() && this.setState({
                            commonGroups: _.compact(e)
                        })
                    })["catch"](f.WapDrop, _.noop)["catch"](_.noop)
                }, 300)
            },
            onDeleteChat: function () {
                var e = Store.Chat.get(this.props.contact.id),
                    t = a.closeDrawer.bind(a, h.DRAWER_RIGHT);
                a.openModal(React.createElement(p, {
                    chat: e,
                    onDelete: t
                }))
            },
            onClose: function () {
                a.closeDrawer(this.props.type)
            },
            render: function () {
                var e = this.props.contact,
                    t = this.state.commonGroups.map(function (e) {
                        return React.createElement(s, {
                            chat: e,
                            mode: "info",
                            asyncDelay: 500,
                            key: Wa.widToKey(e.id)
                        })
                    }),
                    n = t.length ? React.createElement(l, {
                        title: l10n.t("web_groups_participation_you_and_name", {
                            user: e.formattedShortName
                        }),
                        subtitle: t.length,
                        classes: "animate-enter",
                        expands: !0
                    }, React.createElement(i, {
                        data: t,
                        scrollTarget: 1,
                        height: 70,
                        extraItems: 4
                    })) : null,
                    r = this.state.status ? React.createElement(l, {
                        title: l10n.t("web_status"),
                        classes: "animate-enter"
                    }, React.createElement(g, {
                        classes: "drawer-value",
                        text: this.state.status
                    })) : null;
                return React.createElement(c, {
                    key: "contact-info-modal",
                    id: "info",
                    variant: "panel",
                    onCancel: this.onClose
                }, React.createElement("header", {
                    className: "pane-header"
                }, React.createElement("div", {
                    className: "header-close"
                }, React.createElement("button", {
                    onClick: this.onClose
                }, React.createElement("span", {
                    className: "icon icon-x"
                }))), React.createElement("div", {
                    className: "header-body"
                }, React.createElement("div", {
                    className: "header-main"
                }, React.createElement("div", {
                    className: "header-title"
                }, l10n.t("web_contact_info"))))), React.createElement(u, {
                    expands: !! t.length
                }, React.createElement(l, {
                    classes: "drawer-scale drawer-section-photo"
                }, React.createElement(d, {
                    id: e.id,
                    size: d.LARGE,
                    quality: d.HIGH
                })), r, React.createElement(l, {
                    title: l10n.t("web_contact_phone"),
                    classes: "animate-enter"
                }, React.createElement("span", {
                    className: "drawer-value"
                }, Wa.widGetFormattedUser(e.id))), n))
            }
        });
    e.exports = b
}, function (e, t, n) {
    var r = n(110),
        o = (n(48), n(47)),
        a = n(180),
        i = n(31),
        s = (n(29), n(94)),
        a = n(180),
        c = n(161),
        u = n(163).Contact,
        l = n(168),
        d = n(177),
        p = (n(178), n(179)),
        h = n(199),
        g = (n(191), n(157)),
        f = n(175),
        m = n(87),
        b = n(26),
        y = React.createClass({
            displayName: "GroupInfoDrawer",
            mixins: [r, o],
            propTypes: {
                chat: React.PropTypes.instanceOf(s).isRequired
            },
            getInitialState: function () {
                return {
                    imgFull: this.async("chat.ProfilePicThumb.imgFull"),
                    name: this.async("chat.contact.name"),
                    isReadOnly: this.async("chat.isReadOnly")
                }
            },
            componentWillMount: function () {
                var e = this.props.chat.groupMetadata;
                this.addObserver(e.participants, "add remove reset sort change:isAdmin")
            },
            onImageSet: function (e, t) {
                a.sendSetPicture(this.props.chat.contact.id, e, t)
            },
            onParticipantClick: function (e, t) {
                Wa.me !== t.id && Store.Chat.find(t.id).then(function (e) {
                    i.openChat(e)
                })
            },
            onClose: function () {
                i.closeDrawer(this.props.type)
            },
            onExitOrDeleteGroup: function () {
                var e = i.closeDrawer.bind(i, m.DRAWER_RIGHT);
                i.openModal(React.createElement(f, {
                    chat: this.props.chat,
                    onDelete: e
                }))
            },
            render: function () {
                var e = this.props.chat,
                    t = e.groupMetadata,
                    n = this.onParticipantClick,
                    r = t.participants.map(function (e) {
                        var t = e.contact;
                        return React.createElement(u, {
                            contact: t,
                            key: "group-info-" + Wa.widToKey(e.id),
                            asyncDelay: 500,
                            admin: !! e.isAdmin,
                            controls: u.Controls.clickable,
                            onControl: n
                        })
                    }),
                    o = r.length ? React.createElement(h, {
                        title: l10n.t("web_participants_title"),
                        subtitle: l10n.t("web_participants_count", {
                            count: r.length,
                            max: b.MAX_GROUP_SIZE
                        }),
                        classes: "animate-enter",
                        expands: !0
                    }, React.createElement(c, {
                        data: r,
                        scrollTarget: 1,
                        height: 70,
                        extraItems: 4
                    })) : null,
                    a = e.isReadOnly ? React.createElement(g, {
                        id: e.id,
                        size: g.LARGE
                    }) : React.createElement(g, {
                        id: e.id,
                        size: g.LARGE,
                        quality: g.HIGH
                    }),
                    i = null;
                return e.groupMetadata.creation && (i = React.createElement("div", {
                    className: "header-secondary"
                }, l10n.t("web_group_creation_time", {
                    when: Wa.formatDateAndTimeRelative(e.groupMetadata.creation)
                }))), React.createElement(d, {
                    key: "contact-info-modal",
                    id: "info",
                    variant: "panel",
                    onCancel: this.onClose
                }, React.createElement("header", {
                    className: "pane-header"
                }, React.createElement("div", {
                    className: "header-close"
                }, React.createElement("button", {
                    onClick: this.onClose
                }, React.createElement("span", {
                    className: "icon icon-x"
                }))), React.createElement("div", {
                    className: "header-body"
                }, React.createElement("div", {
                    className: "header-main"
                }, React.createElement("div", {
                    className: "header-title"
                }, l10n.t("web_group_info"))), i)), React.createElement(p, {
                    expands: !! r.length
                }, React.createElement(h, {
                    classes: "drawer-scale drawer-section-photo"
                }, a), React.createElement(h, {
                    title: l10n.t("subject"),
                    classes: "animate-enter"
                }, React.createElement(l, {
                    classes: "drawer-value",
                    text: this.state.name
                })), o))
            }
        });
    e.exports = y
}, function (e, t, n) {
    var r = (n(48), n(47)),
        o = n(180),
        a = n(31),
        i = (n(29), n(94)),
        o = n(180),
        s = n(161),
        c = n(163).Contact,
        u = (n(168), n(177)),
        l = (n(178), n(179)),
        d = n(199),
        p = (n(191), n(157)),
        h = React.createClass({
            displayName: "BroadcastInfoDrawer",
            mixins: [r],
            propTypes: {
                chat: React.PropTypes.instanceOf(i).isRequired
            },
            componentWillMount: function () {
                var e = this.props.chat.groupMetadata;
                this.addObserver(e.participants, "add remove sort reset")
            },
            onImageSet: function (e, t) {
                o.sendSetPicture(this.props.chat.contact.id, e, t)
            },
            onParticipantClick: function (e, t) {
                Wa.me !== t.id && Store.Chat.find(t.id).then(function (e) {
                    a.openChat(e)
                })
            },
            onClose: function () {
                a.closeDrawer(this.props.type)
            },
            render: function () {
                var e, t = this.props.chat,
                    n = t.groupMetadata,
                    r = this.onParticipantClick,
                    o = n.participants.map(function (e) {
                        var t = Store.Contact.get(e.id) || Store.Contact.add({
                            id: e.id
                        });
                        return React.createElement(c, {
                            contact: t,
                            key: "group-info-" + Wa.widToKey(e.id),
                            asyncDelay: 500,
                            admin: !! e.isAdmin,
                            controls: c.Controls.clickable,
                            onControl: r
                        })
                    }),
                    a = o.length ? React.createElement(d, {
                        classes: "animate-enter",
                        title: l10n.t("web_recipients_title"),
                        subtitle: o.length,
                        expands: !0
                    }, React.createElement(s, {
                        data: o,
                        scrollTarget: 1,
                        height: 70,
                        extraItems: 4
                    })) : null;
                return t.groupMetadata.creation ? (e = Wa.formatTimestampWithDate(t.groupMetadata.creation), e = React.createElement("div", {
                    className: "header-secondary"
                }, l10n.t("web_group_creation_time", {
                    when: e
                }))) : e = null, React.createElement(u, {
                    key: "contact-info-modal",
                    id: "info",
                    variant: "panel",
                    onCancel: this.onClose
                }, React.createElement("header", {
                    className: "pane-header"
                }, React.createElement("div", {
                    className: "header-close"
                }, React.createElement("button", {
                    onClick: this.onClose
                }, React.createElement("span", {
                    className: "icon icon-x"
                }))), React.createElement("div", {
                    className: "header-body"
                }, React.createElement("div", {
                    className: "header-main"
                }, React.createElement("div", {
                    className: "header-title"
                }, "Broadcast list info"), e))), React.createElement(l, {
                    expands: !! o.length
                }, React.createElement(d, {
                    classes: "drawer-scale drawer-section-photo"
                }, React.createElement(p, {
                    id: t.id,
                    size: p.LARGE
                })), a))
            }
        });
    e.exports = h
}, function (e, t, n) {
    var r = (n(84), n(177)),
        o = n(179),
        a = n(200),
        i = n(2),
        s = n(94),
        c = n(31),
        u = React.createClass({
            displayName: "LocationDrawer",
            propTypes: {
                chat: React.PropTypes.instanceOf(s).isRequired
            },
            statics: {
                GEO_OK: "ok",
                GEO_PENDING: "pending",
                1: "denied",
                GEO_DENIED: "denied",
                2: "unavailable",
                GEO_UNAVAILABLE: "unavailable",
                3: "timeout",
                GEO_TIMEOUT: "timeout"
            },
            getInitialState: function () {
                var e = {
                    geoState: u.GEO_PENDING,
                    coords: null,
                    pois: [],
                    search: null
                },
                    t = i.getGeocoderLocation();
                e.coords = t ? t : {
                    latitude: -34.397,
                    longitude: 150.644,
                    zoom: 2
                }, this.prevCoords = null;
                var n = i.getMapsOverQuota();
                return n ? this.setOverQuota(n) : this.overQuota = !1, e
            },
            componentWillMount: function () {
                this.locate()
            },
            mapRadius: function () {
                var e = this.refs.gmap,
                    t = e.getBounds();
                if (t) {
                    var n = Wa.computeDistanceBetween(t.getNorthEast(), t.getCenter());
                    return Math.sqrt(n * n / 2)
                }
            },
            setOverQuota: function (e) {
                i.setMapsOverQuota(e), this.overQuota = !0, _.delay(this.clearOverQuota, e - Date.now())
            },
            clearOverQuota: function () {
                this.overQuota = !1, UserPerfs.setMapsOverQuota()
            },
            locate: function () {
                navigator.geolocation.getCurrentPosition(function (e) {
                    var t = e.coords,
                        n = new google.maps.LatLng(t.latitude, t.longitude);
                    this.setState({
                        coords: t,
                        geoState: u.GEO_OK
                    }), this.refs.gmap.updateCenter(t.latitude, t.longitude, null, t.accuracy);
                    var r = Number.MAX_VALUE;
                    if (this.state.prevCoords && (r = Wa.computeDistanceBetween(this.state.prevCoords, n)), r > 20) {
                        var o = Math.max(100, this.mapRadius());
                        this._doNearbySearch(o)
                    }
                }.bind(this), function (e) {
                    this.setState({
                        geoState: e.code
                    })
                }, {
                    enableHighAccuracy: !0,
                    timeout: 3e4,
                    maximumAge: 6e4
                })
            },
            _doNearbySearch: function (e, t) {
                if (this.overQuota) return this._fourSquareNearbySearch(e, t);
                var n = this.refs.gmap.mapInstance(),
                    r = this.service = this.service || new google.maps.places.PlacesService(n);
                this.searchSeq++;
                var o = this.searchSeq,
                    a = google.maps.places.PlacesServiceStatus,
                    i = this.refs.gmap.getCenter();
                r.nearbySearch({
                    keyword: t,
                    location: i,
                    radius: e
                }, function (n, r) {
                    if (!(o < this.searchSeq)) if (r == a.OK) {
                        var s = n.filter(function (e) {
                            return -1 === e.icon.indexOf("geocode-71.png")
                        }).map(function (e) {
                            return {
                                src: "google",
                                name: e.name,
                                loc: e.geometry.location,
                                reference: e.reference,
                                vicinity: e.vicinity
                            }
                        });
                        this.setState({
                            prevCoords: i,
                            pois: s
                        })
                    } else r == a.ZERO_RESULTS ? this.setState({
                        prevCoords: i,
                        pois: []
                    }) : r == a.OVER_QUERY_LIMIT && (this.setOverQuota(Date.now() + 1e3 * Wa.CONST.GMAPS_OVER_LIMIT_DURATION), this._doNearbySearch(e, t))
                }.bind(this))
            },
            _fourSquareNearbySearch: function (e, t) {
                e = Math.min(e, 1e5);
                var n = this.refs.gmap.getCenter(),
                    r = this;
                Wa.ajax("https://api.foursquare.com/v2/venues/search", {
                    ll: n.toUrlValue(),
                    radius: e,
                    query: t,
                    client_secret: "PFUJY2FLEXYLBCXHERGFZIQVW501IVXCXMXSHXNDWDIXUQAT",
                    client_id: "XQJA0HW2Y1HIYPN2DBMWR3DPPDTHW2E1V33PLAFVRJFEMJS1",
                    v: "20130815"
                }, function (e) {
                    if (200 === e.status) {
                        var t = JSON.parse(e.response),
                            n = t.response.venues;
                        n && n.length ? (n = n.map(function (e) {
                            var t = e.location;
                            return {
                                src: "foursquare",
                                name: e.name,
                                loc: t,
                                reference: e.id,
                                url: "https://foursquare.com/v/" + e.id,
                                vicinity: t.address,
                                address: Wa.filteredJoin(", ", t.address, t.city, Wa.filteredJoin(" ", t.state, t.postalCode))
                            }
                        }), r.setState({
                            pois: n
                        })) : r.setState({
                            pois: []
                        })
                    }
                }, function () {})
            },
            onClose: function () {
                c.closeDrawer(this.props.type)
            },
            onRefresh: function () {
                var e = Math.max(50, this.mapRadius());
                this._doNearbySearch(e)
            },
            sendCurrentLocation: function () {
                var e = this.state.coords;
                this.props.chat.sendLocation(e.latitude.toString(), e.longitude.toString()), this.onClose()
            },
            sendFourSquarePoi: function (e) {
                var t = e.name + "\n" + e.address;
                this.props.chat.sendLocation(e.loc.lat.toString(), e.loc.lng.toString(), t, e.url), this.onClose()
            },
            sendGooglePoi: function (e) {
                this.service.getDetails({
                    reference: e.reference
                }, function (e, t) {
                    if (t === google.maps.places.PlacesServiceStatus.OK) {
                        var n = e.geometry.location.lat().toString(),
                            r = e.geometry.location.lng().toString(),
                            o = e.formatted_address || "";
                        o = o.replace(/, United States$/, "");
                        var a = e.name + "\n" + o,
                            i = e.url;
                        this.props.chat.sendLocation(n, r, a, i), c.closeDrawer(this.props.type)
                    }
                }.bind(this))
            },
            render: function () {
                var e = this.state.coords,
                    t = [];
                return this.state.geoState === u.GEO_OK ? t.push(React.createElement("div", {
                    className: "infinite-list-item"
                }, React.createElement(d, {
                    accuracy: this.state.coords.accuracy,
                    onClick: this.sendCurrentLocation
                }))) : this.state.geoState === u.GEO_PENDING && t.push(React.createElement("div", {
                    className: "infinite-list-item"
                }, React.createElement(p, null))), t.push(this.state.pois.map(function (e) {
                    return React.createElement("div", {
                        className: "infinite-list-item"
                    }, React.createElement(l, {
                        category: e.category,
                        title: e.name,
                        vicinity: e.vicinity
                    }))
                })), React.createElement(r, {
                    key: "attach-location-modal",
                    position: "right",
                    id: "location",
                    variant: "noheader",
                    onCancel: this.onClose
                }, React.createElement("header", {
                    className: "drawer-header"
                }, React.createElement("div", {
                    className: "drawer-title"
                }, React.createElement("span", {
                    className: "btn-close icon icon-x-light",
                    onClick: this.onClose
                }), "Send Location"), React.createElement("div", {
                    className: "drawer-header-action"
                }, React.createElement("div", {
                    className: "menu menu-horizontal"
                }, React.createElement("button", {
                    className: "menu-item"
                }, React.createElement("span", {
                    className: "icon icon-search-light",
                    title: "Search"
                }, "Search")), React.createElement("button", {
                    className: "menu-item",
                    onClick: this.onRefresh
                }, React.createElement("span", {
                    className: "icon icon-refresh-light",
                    title: "Refresh"
                }, "Refresh")), React.createElement("button", {
                    className: "menu-item",
                    onClick: this.locate
                }, React.createElement("span", {
                    className: "icon icon-gps-light",
                    title: "My location"
                }, "My location"))))), React.createElement(o, null, React.createElement("div", {
                    className: "row drawer-location-body"
                }, React.createElement("div", {
                    className: "col-main"
                }, React.createElement(a, {
                    ref: "gmap",
                    latitude: e.latitude,
                    longitude: e.longitude,
                    zoom: e.zoom,
                    accuracy: e.accuracy,
                    points: this.state.pois
                })), React.createElement("div", {
                    className: "col-side"
                }, React.createElement("div", {
                    className: "infinite-list list-locations"
                }, React.createElement("div", {
                    className: "viewport"
                }, t))))))
            }
        }),
        l = React.createClass({
            displayName: "POI",
            propTypes: {
                category: React.PropTypes.string.isRequired,
                title: React.PropTypes.string.isRequired,
                vicinity: React.PropTypes.string.isRequired
            },
            render: function () {
                var e = "avatar icon-" + this.props.category + "-light";
                return React.createElement("div", {
                    className: "location"
                }, React.createElement("div", {
                    className: "location-icon"
                }, React.createElement("div", {
                    className: e
                })), React.createElement("div", {
                    className: "location-body"
                }, React.createElement("div", {
                    className: "location-main"
                }, this.props.title), React.createElement("div", {
                    className: "location-secondary"
                }, this.props.vicinity)))
            }
        }),
        d = React.createClass({
            displayName: "MyLocation",
            propTypes: {
                accuracy: React.PropTypes.number.isRequired
            },
            render: function () {
                return React.createElement("div", {
                    className: "location location-my"
                }, React.createElement("div", {
                    className: "location-icon"
                }, React.createElement("div", {
                    className: "avatar icon-gps-light"
                })), React.createElement("div", {
                    className: "location-body"
                }, React.createElement("div", {
                    className: "location-main"
                }, "Send Current Location"), React.createElement("div", {
                    className: "location-secondary"
                }, "accurate to ~", this.props.accuracy, "m")))
            }
        }),
        p = React.createClass({
            displayName: "Pending",
            render: function () {
                return React.createElement("div", {
                    className: "location location-my"
                }, React.createElement("div", {
                    className: "location-icon"
                }, React.createElement("div", {
                    className: "avatar icon-gps-light"
                })), React.createElement("div", {
                    className: "location-body"
                }, React.createElement("div", {
                    className: "location-main"
                }, "Finding your current location...")))
            }
        });
    e.exports = u
}, function (e, t, n) {
    var r = n(31),
        o = function () {
            return [{
                label: l10n.t("web_mute_8hours"),
                duration: 8
            }, {
                label: l10n.t("web_mute_1week"),
                duration: 168
            }, {
                label: l10n.t("web_mute_1year"),
                duration: 8760
            }]
        },
        a = React.createClass({
            displayName: "MutePopup",
            propTypes: {
                onCancel: React.PropTypes.func,
                onMute: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    mute: 8
                }
            },
            onChange: function (e) {
                this.setState({
                    mute: parseInt(e.target.value, 10)
                })
            },
            onMute: function (e) {
                e.stopPropagation(), r.closeModal(), this.props.onMute(3600 * this.state.mute + moment().unix(), !0)
            },
            render: function () {
                var e = this.props.onCancel ||
                function () {
                    r.closeModal()
                }, t = this.state.mute, n = this, a = o().map(function (e) {
                    var r = e.duration;
                    return React.createElement("li", {
                        key: "mute-" + r
                    }, React.createElement("label", null, React.createElement("input", {
                        type: "radio",
                        name: "duration",
                        value: e.duration,
                        checked: t === r,
                        onChange: n.onChange
                    }), e.label))
                });
                return React.createElement("div", {
                    className: "backdrop"
                }, React.createElement("div", {
                    className: "popup"
                }, React.createElement("div", {
                    className: "popup-title"
                }, l10n.t("web_mute_time")), React.createElement("div", {
                    className: "popup-body"
                }, React.createElement("form", {
                    ref: "form"
                }, React.createElement("ol", {
                    className: "choices"
                }, a))), React.createElement("div", {
                    className: "popup-controls"
                }, React.createElement("button", {
                    className: "btn-plain popup-controls-item",
                    onClick: e
                }, l10n.t("web_cancel")), React.createElement("button", {
                    className: "btn-plain btn-default popup-controls-item",
                    onClick: this.onMute
                }, l10n.t("web_ok")))))
            }
        });
    e.exports = a
}, function (e, t, n) {
    var r = n(94),
        o = n(31),
        a = n(110),
        i = React.createClass({
            displayName: "DeleteChatPopup",
            mixins: [a],
            propTypes: {
                onCancel: React.PropTypes.func,
                onDelete: React.PropTypes.func,
                chat: React.PropTypes.instanceOf(r).isRequired
            },
            getInitialState: function () {
                return {
                    isReadOnly: this.async("chat.isReadOnly")
                }
            },
            getText: function () {
                var e = this.props.chat,
                    t = e.formattedTitle;
                return e.isGroup ? this.state.isReadOnly ? l10n.t("web_delete_group_dialog_title", {
                    groupName: t
                }) : l10n.t("web_exit_group_dialog_title", {
                    groupName: t
                }) : e.isUser ? l10n.t("web_delete_chat_dialog_title", {
                    name: t
                }) : void 0
            },
            getButton: function () {
                var e = this.props.chat;
                return e.isGroup ? l10n.t(this.state.isReadOnly ? "web_delete" : "web_exit") : e.isUser ? l10n.t("web_delete") : void 0
            },
            onCancel: function () {
                o.closeModal(), _.isFunction(this.props.onCancel) && this.props.onCancel()
            },
            onDelete: function () {
                var e = this.props.chat;
                e.isGroup ? this.state.isReadOnly ? (e.sendDelete(), _.isFunction(this.props.onDelete) && this.props.onDelete()) : e.sendExit() : e.isUser ? (e.sendDelete(), _.isFunction(this.props.onDelete) && this.props.onDelete()) : Wa.debug("Unsupported chat type", "red"), o.closeModal()
            },
            render: function () {
                return React.createElement("div", {
                    className: "backdrop"
                }, React.createElement("div", {
                    className: "popup"
                }, React.createElement("div", {
                    className: "popup-title"
                }, "Are you sure?"), React.createElement("div", {
                    className: "popup-body"
                }, this.getText()), React.createElement("div", {
                    className: "popup-controls"
                }, React.createElement("button", {
                    className: "btn-plain popup-controls-item",
                    onClick: this.onCancel
                }, l10n.t("web_cancel")), React.createElement("button", {
                    className: "btn-plain btn-default popup-controls-item",
                    onClick: this.onDelete
                }, this.getButton()))))
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(31),
        o = {
            endFlow: function () {
                r.closeDrawer(this.props.type)
            },
            render: function () {
                return this.state.state
            }
        };
    e.exports = o
}, function (e) {
    var t = React.createClass({
        displayName: "Drawer",
        propTypes: {
            children: React.PropTypes.node.isRequired,
            id: React.PropTypes.string,
            variant: React.PropTypes.string,
            noContainer: React.PropTypes.bool,
            position: React.PropTypes.oneOf(["right", "left"]),
            onDragLeave: React.PropTypes.func,
            onDrop: React.PropTypes.func,
            onDragOver: React.PropTypes.func
        },
        getDefaultProps: function () {
            return {
                position: "left"
            }
        },
        statics: {
            RIGHT: "right",
            LEFT: "left"
        },
        getInitialState: function () {
            return {
                isDragging: !1
            }
        },
        isDragDropDrawer: function () {
            return this.props.onDragOver && this.props.onDragLeave && this.props.onDrop
        },
        onDragOver: function (e) {
            e.preventDefault(), this.isDragDropDrawer() && !this.state.isDragging && (this.props.onDragOver(e), this.setState({
                isDragging: !0
            }))
        },
        onDrop: function (e) {
            e.preventDefault(), e.stopPropagation(), this.setState({
                isDragging: !1
            }), this.props.onDrop(e)
        },
        onDragLeave: function (e) {
            e.preventDefault(), e.stopPropagation(), this.state.isDragging && (this.setState({
                isDragging: !1
            }), this.props.onDragLeave(e))
        },
        render: function () {
            var e = "drawer";
            this.props.id && (e += " drawer-" + this.props.id);
            var t;
            if (this.isDragDropDrawer()) {
                var n = this.state.isDragging ? {} : {
                    display: "none"
                };
                t = React.createElement("div", {
                    key: "mask",
                    className: "drag-drop-mask",
                    style: n,
                    onDragLeave: this.onDragLeave,
                    onDrop: this.onDrop
                })
            }
            if (this.props.noContainer) return React.createElement("div", {
                className: e,
                onDragOver: this.onDragOver
            }, t, this.props.children);
            var r = "drawer-container";
            return this.props.position && (r += " drawer-container-" + this.props.position), this.props.variant && (r += " drawer-container-" + this.props.variant), React.createElement("div", {
                className: r,
                onDragOver: this.onDragOver
            }, t, React.createElement("div", {
                className: e
            }, this.props.children))
        }
    });
    e.exports = t
}, function (e) {
    var t = React.createClass({
        displayName: "DrawerHeader",
        propTypes: {
            children: React.PropTypes.node,
            title: React.PropTypes.string,
            onBack: React.PropTypes.func,
            onCancel: React.PropTypes.func
        },
        render: function () {
            var e = null;
            if (this.props.title) {
                var t = "icon btn-close-drawer";
                t += "profile" == this.props.type ? " icon-back" : " icon-back-light";
                var n = this.props.onBack ? React.createElement("button", {
                    className: t,
                    onClick: this.props.onBack
                }, "←") : null,
                    r = this.props.onCancel ? React.createElement("button", {
                        onClick: this.props.onCancel
                    }, React.createElement("span", {
                        className: "btn-close icon icon-x-light"
                    })) : null;
                e = React.createElement("div", {
                    className: "drawer-title"
                }, n, r, React.createElement("span", {
                    className: "drawer-title-body"
                }, this.props.title))
            }
            return React.createElement("header", {
                className: "drawer-header"
            }, e, this.props.children)
        }
    });
    e.exports = t
}, function (e) {
    var t = React.createClass({
        displayName: "DrawerBody",
        propTypes: {
            expands: React.PropTypes.bool
        },
        getDefaultProps: function () {
            return {
                expands: !1
            }
        },
        render: function () {
            var e = "drawer-body";
            "flex" == this.props.type && (e += " drawer-body-flex");
            var t = this.props.expands ? React.createElement("div", {
                className: "drawer-body-filler"
            }) : null;
            return React.createElement("div", {
                className: e
            }, this.props.children, t)
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = n(29),
        o = n(205),
        a = {
            sendSetPicture: function (e, t, n) {
                var o = Store.ProfilePicThumb.gadd(e);
                r.sendSetPicture(e, t, n).then(function (t) {
                    200 === t.status ? (Wa.debug("modify " + e + " icon success, id: " + t.tag), o.tag = t.tag) : t.status >= 400 && Wa.debug("modify " + e + " icon error")
                })["catch"](function () {
                    Wa.debug("(fixme) modify " + e + " fail")
                })
            },
            createThumbAndFull: function (e) {
                return Promise.props({
                    thumb: this.resize(e, Wa.CONST.PROF_PIC_THUMB_SIDE, Wa.CONST.PROF_PIC_THUMB_SIDE),
                    full: this.resize(e, Wa.CONST.MAX_PIC_SIDE, Wa.CONST.MAX_PIC_SIDE)
                })
            },
            readFile: function (e) {
                return new Promise(function (t, n) {
                    var r = new FileReader;
                    r.readAsDataURL(e), r.onload = function () {
                        return t({
                            file: e,
                            url: this.result
                        })
                    }, r.onabort = function (e) {
                        return n("onabort", e)
                    }, r.onerror = function (e) {
                        return n("onerror", e)
                    }
                })
            },
            generateVideoThumb: function (e) {
                return new Promise(function (t, n) {
                    var r = document.createElement("video");
                    r.autoplay = !1, r.loop = !1, r.onloadeddata = function () {
                        var e = document.createElement("canvas");
                        e.height = r.videoHeight, e.width = r.videoWidth;
                        var n = e.getContext("2d");
                        return n.drawImage(r, 0, 0, r.videoWidth, r.videoHeight), t(e.toDataURL("image/jpeg"))
                    }, r.error = function (e) {
                        n(e)
                    };
                    r.src = e;
                    r.load()
                })
            },
            resizeAndOrient: function (e, t, n) {
                return new Promise(function (r, i) {
                    if (!e.type.match("image.*")) return i("Invalid image file", e);
                    var s = new FileReader,
                        c = new Image;
                    s.onload = function () {
                        o(this.result, function (e) {
                            c.src = e
                        })
                    }, c.onload = function () {
                        if (0 === this.width || 0 === this.height) return i("Invalid image", c);
                        var e = document.createElement("canvas"),
                            o = a.boundWidthHeight(c.width, c.height, t, n);
                        e.width = o.width, e.height = o.height;
                        var s = e.getContext("2d");
                        return s.drawImage(c, 0, 0, o.width, o.height), r(e.toDataURL("image/jpeg"))
                    };
                    var u = function (e) {
                            return i("onabort", e)
                        },
                        l = function (e) {
                            return i("onerror", e)
                        };
                    s.onabort = u, s.onerror = l, c.onabort = u, c.onerror = l, s.readAsDataURL(e)
                })
            },
            crop: function (e, t, n, r, o, a, i) {
                return new Promise(function (s, c) {
                    var u = document.createElement("canvas"),
                        l = u.getContext("2d"),
                        d = new Image;
                    d.onload = function () {
                        return a && i ? (u.height = i, u.width = a, l.drawImage(d, t, n, r, o, 0, 0, a, i)) : (u.height = o, u.width = r, l.drawImage(d, t, n, r, o)), s(u.toDataURL("image/jpeg"))
                    };
                    var p = function (e) {
                            return c("onabort", e)
                        },
                        h = function (e) {
                            return c("onerror", e)
                        };
                    d.onabort = p, d.onerror = h, d.src = e
                })
            },
            boundWidthHeight: function (e, t, n, r) {
                return e = e || n, t = t || r, e > t ? e > n && (t *= n / e, e = n) : t > r && (e *= r / t, t = r), {
                    width: e,
                    height: t
                }
            }
        };
    e.exports = a
}, function (e, t, n) {
    e.exports = n(206)
}, function (e) {
    var t = Array.isArray,
        n = Object.prototype.toString;
    e.exports = t ||
    function (e) {
        return !!e && "[object Array]" == n.call(e)
    }
}, function (e, t, n) {
    var r = n(184),
        o = function (e) {
            var t, n = this,
                o = [].slice.call(arguments);
            t = e && e.hasOwnProperty("constructor") ? e.constructor : function () {
                return n.apply(this, arguments)
            }, r(t, n);
            var a = function () {
                    this.constructor = t
                };
            return a.prototype = n.prototype, t.prototype = new a, e && (o.unshift(t.prototype), r.apply(null, o)), t.__super__ = n.prototype, t
        };
    e.exports = o
}, function (e) {
    var t = [],
        n = t.forEach,
        r = t.slice;
    e.exports = function (e) {
        return n.call(r.call(arguments, 1), function (t) {
            if (t) for (var n in t) e[n] = t[n]
        }), e
    }
}, function (e) {
    var t = React.createClass({
        displayName: "TooltipTrigger",
        propTypes: {
            trigger: React.PropTypes.bool,
            tooltip: React.PropTypes.node.isRequired,
            style: React.PropTypes.object,
            direction: React.PropTypes.oneOf(["top", "right", "bottom", "left"])
        },
        getDefaultProps: function () {
            return {
                direction: "top"
            }
        },
        getInitialState: function () {
            return {
                active: this.props.trigger ? !1 : !0
            }
        },
        showModal: function () {
            this.setState({
                active: !0
            })
        },
        hideModal: function () {
            this.setState({
                active: !1
            })
        },
        render: function () {
            var e = this.state.active ? React.createElement(n, {
                direction: this.props.direction,
                ref: "tooltip",
                body: this.props.tooltip
            }) : null,
                t = this.props.trigger;
            return React.createElement("div", {
                style: this.props.style,
                className: "tooltip-container",
                onMouseEnter: t ? this.showModal : null,
                onMouseLeave: t ? this.hideModal : null
            }, this.props.children, e)
        }
    }),
        n = React.createClass({
            displayName: "Tooltip",
            propTypes: {
                body: React.PropTypes.node.isRequired,
                direction: React.PropTypes.string.isRequired
            },
            render: function () {
                var e = "tooltip " + this.props.direction;
                return React.createElement("div", {
                    className: e
                }, this.props.body)
            }
        });
    e.exports = t
}, function (e, t, n) {
    var r = n(46),
        o = n(48),
        a = n(31),
        i = React.createClass({
            displayName: "AudioTag",
            mixins: [r, o],
            propTypes: {
                src: React.PropTypes.string,
                className: React.PropTypes.string,
                controls: React.PropTypes.bool,
                preload: React.PropTypes.string,
                type: React.PropTypes.string,
                onClick: React.PropTypes.func,
                onPlay: React.PropTypes.func,
                onError: React.PropTypes.func,
                autoPlay: React.PropTypes.bool
            },
            shouldComponentUpdate: function (e) {
                return this.props.src !== e.src
            },
            componentDidMount: function () {
                var e = this.getDOMNode();
                this.regNativeListener(e, "error", this.onPlayerError), this.regNativeListener(e, "playing", this.onPlaying), this.regCmd("mediaPlaying", this.onOtherPlaying)
            },
            onPlayerError: function (e) {
                this.props.onError && this.props.onError(e)
            },
            onOtherPlaying: function (e) {
                e !== this && this.getDOMNode().pause()
            },
            onPlaying: function (e) {
                a.mediaPlaying(this), this.props.onPlay && this.props.onPlay(e)
            },
            render: function () {
                return React.createElement("audio", {
                    src: this.props.src,
                    className: this.props.className,
                    onClick: this.props.onClick,
                    controls: this.props.controls,
                    preload: this.props.preload,
                    type: this.props.type,
                    autoPlay: this.props.autoPlay
                }, this.props.children)
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(222),
        o = n(77),
        a = React.createClass({
            displayName: "Pending",
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-media"
                }, React.createElement(o, {
                    size: 50,
                    stroke: 3
                })))
            }
        }),
        i = React.createClass({
            displayName: "PendingCancel",
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-xl icon-media-cancel"
                }, React.createElement(o, {
                    size: 50,
                    stroke: 3
                })))
            }
        }),
        s = React.createClass({
            displayName: "Cancel",
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-xl icon-media-download"
                }))
            }
        }),
        c = React.createClass({
            displayName: "Download",
            propTypes: {
                filesize: React.PropTypes.number.isRequired
            },
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-xl icon-media-download-noborder btn-meta"
                }, this.props.filesize > 0 ? r(this.props.filesize, {
                    round: 0
                }) : null))
            }
        }),
        u = React.createClass({
            displayName: "Upload",
            propTypes: {
                filesize: React.PropTypes.number.isRequired
            },
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-xl icon-media-upload-noborder btn-meta"
                }, r(this.props.filesize, {
                    round: 0
                })))
            }
        }),
        l = React.createClass({
            displayName: "Play",
            render: function () {
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "icon-xl icon-media-play"
                }))
            }
        }),
        d = React.createClass({
            displayName: "Missing",
            render: function () {
                var e;
                switch (this.props.msg.type) {
                case "image":
                    e = l10n.t("missing_photo_title");
                    break;
                case "video":
                    e = l10n.t("missing_video_title");
                    break;
                case "audio":
                    e = l10n.t("missing_audio_title")
                }
                return React.createElement("div", {
                    className: "media-state-controls"
                }, React.createElement("button", {
                    className: "btn-meta missing-text"
                }, e))
            }
        });
    e.exports = {
        Pending: a,
        Cancel: s,
        PendingCancel: i,
        Download: c,
        Upload: u,
        Play: l,
        Missing: d
    }
}, function (e, t, n) {
    var r = n(31),
        o = n(48),
        a = n(207),
        i = n(97),
        s = React.createClass({
            displayName: "MediaViewerFlow",
            mixins: [o],
            propTypes: {
                msg: React.PropTypes.instanceOf(i).isRequired,
                startElement: React.PropTypes.object
            },
            getInitialState: function () {
                return this.mediaMsgs = this.props.msg.chat.mediaMsgs(), this.index = this.getMsgIndex(this.props.msg), {
                    state: this.getMediaViewer(this.index, this.props.startElement)
                }
            },
            componentWillMount: function () {
                this.regNativeListener(window, "keydown", this.onKeyDown)
            },
            onKeyDown: function (e) {
                37 === e.keyCode ? this.getPrev() && this.onPrev() : 39 === e.keyCode && this.getNext() && this.onNext()
            },
            onNext: function (e) {
                e && e.stopPropagation(), this.index = this.index + 1, this.setState({
                    state: this.getMediaViewer(this.index)
                })
            },
            onPrev: function (e) {
                e && e.stopPropagation(), this.index = this.index - 1, this.setState({
                    state: this.getMediaViewer(this.index)
                })
            },
            getNext: function () {
                return this.index < this.mediaMsgs.length - 1 ? this.onNext : void 0
            },
            getPrev: function () {
                return this.index > 0 ? this.onPrev : void 0
            },
            getMediaViewer: function (e, t) {
                e = e || this.index;
                var n = this.mediaMsgs[e];
                return React.createElement(a, {
                    msg: n,
                    key: n.id,
                    onBack: this.endFlow,
                    onNext: this.getNext(),
                    onPrev: this.getPrev(),
                    startElement: t
                })
            },
            getMsgIndex: function (e) {
                return this.mediaMsgs.indexOf(e)
            },
            endFlow: function () {
                r.closeModal()
            },
            render: function () {
                return React.createElement("div", {
                    onClick: this.endFlow
                }, this.state.state)
            }
        });
    e.exports = s
}, function (e) {
    var t = ["e052", "e52a", "e04f", "e053", "e524", "e52c", "e531", "e050", "e527", "e051", "e10b", "1f43d", "e52b", "e52f", "e109", "e528", "e01a", "e529", "e526", "1f43c", "e055", "e521", "e523", "1f425", "1f423", "e52e", "e52d", "1f422", "e525", "1f41d", "1f41c", "1f41e", "1f40c", "e10a", "e441", "e522", "e019", "e520", "e054", "1f40b", "1f404", "1f40f", "1f400", "1f403", "1f405", "1f407", "1f409", "e134", "1f410", "1f413", "1f415", "1f416", "1f401", "1f402", "1f432", "1f421", "1f40a", "e530", "1f42a", "1f406", "1f408", "1f429", "1f43e", "e306", "e030", "e304", "e110", "e032", "e305", "e303", "e118", "e447", "e119", "1f33f", "e444", "1f344", "e308", "e307", "1f332", "1f333", "1f330", "1f331", "1f33c", "1f310", "1f31e", "1f31d", "1f31a", "1f311", "1f312", "1f313", "1f314", "1f315", "1f316", "1f317", "1f318", "1f31c", "1f31b", "e04c", "1f30d", "1f30e", "1f30f", "1f30b", "1f30c", "1f320", "e32f", "e04a", "26c5", "e049", "e13d", "e04b", "2744", "e048", "e443", "1f301", "e44c", "e43e"],
        n = ["e415", "e057", "1f600", "e056", "e414", "e405", "e106", "e418", "e417", "1f617", "1f619", "e105", "e409", "1f61b", "e40d", "e404", "e403", "e40a", "e40e", "e058", "e406", "e413", "e412", "e411", "e408", "e401", "e40f", "1f605", "e108", "1f629", "1f62b", "e40b", "e107", "e059", "e416", "1f624", "e407", "1f606", "1f60b", "e40c", "1f60e", "1f634", "1f635", "e410", "1f61f", "1f626", "1f627", "1f608", "e11a", "1f62e", "1f62c", "1f610", "1f615", "1f62f", "1f636", "1f607", "e402", "1f611", "e516", "e517", "e152", "e51b", "e51e", "e51a", "e001", "e002", "e004", "e005", "e518", "e519", "e515", "e04e", "e51c", "1f63a", "1f638", "1f63b", "1f63d", "1f63c", "1f640", "1f63f", "1f639", "1f63e", "1f479", "1f47a", "1f648", "1f649", "1f64a", "e11c", "e10c", "e05a", "e11d", "e32e", "e335", "1f4ab", "1f4a5", "e334", "e331", "1f4a7", "e13c", "e330", "e41b", "e419", "e41a", "1f445", "e41c", "e00e", "e421", "e420", "e00d", "e010", "e011", "e41e", "e012", "e422", "e22e", "e22f", "e231", "e230", "e427", "e41d", "e00f", "e41f", "e14c", "e201", "e115", "e51f", "e428", "1f46a", "1f46c", "1f46d", "e111", "e425", "e429", "e424", "e423", "e253", "1f64b", "e31e", "e31f", "e31d", "1f470", "1f64e", "1f64d", "e426", "e503", "e10e", "e318", "e007", "1f45e", "e31a", "e13e", "e31b", "e006", "e302", "1f45a", "e319", "1f3bd", "1f456", "e321", "e322", "e11e", "e323", "1f45d", "1f45b", "1f453", "e314", "e43c", "e31c", "e32c", "e32a", "e32d", "e32b", "e022", "e023", "e328", "e327", "1f495", "1f496", "1f49e", "e329", "1f48c", "e003", "e034", "e035", "1f464", "1f465", "1f4ac", "e536", "1f4ad"],
        r = ["e036", "1f3e1", "e157", "e038", "e153", "e155", "e14d", "e156", "e501", "e158", "e43d", "e037", "e504", "1f3e4", "e44a", "e146", "e505", "e506", "e122", "e508", "e509", "1f5fe", "e03b", "e04d", "e449", "e44b", "e51d", "1f309", "1f3a0", "e124", "e121", "e433", "e202", "e01c", "e135", "1f6a3", "2693", "e10d", "e01d", "e11f", "1f681", "1f682", "1f68a", "e039", "1f69e", "1f686", "e435", "e01f", "1f688", "e434", "1f69d", "1f68b", "e01e", "1f68e", "e159", "1f68d", "e42e", "1f698", "e01b", "e15a", "1f696", "1f69b", "e42f", "1f6a8", "e432", "1f694", "e430", "e431", "1f690", "e136", "1f6a1", "1f69f", "1f6a0", "1f69c", "e320", "e150", "e125", "1f6a6", "e14e", "e252", "e137", "e209", "e03a", "1f3ee", "e133", "e123", "1f5ff", "1f3aa", "1f3ad", "1f4cd", "1f6a9", "ec00", "e50e", "ec02", "ec01", "e511", "e50f", "e510", "ec03", "ec04", "ec05", "e50c", "ec06", "e512", "ec07", "ec08", "ec09", "ec0a", "ec0b", "ec0c", "ec0d", "ec0e", "ec0f", "ec10", "ec11", "e50d", "ec12", "ec13", "e513", "e50b", "e514", "ec14", "ec15", "ec16", "ec17", "ec18", "ec19", "ec1a", "ec1b", "ec1c", "ec1d", "ec1e", "ec1f", "ec20", "ec21", "ec22", "ec23", "ec24", "ec25", "ec26", "ec27", "ec28", "ec29", "ec2a", "ec2b", "ec2c", "ec2d"],
        o = ["e21c", "e21d", "e21e", "e21f", "e220", "e221", "e222", "e223", "e224", "e225", "1f51f", "1f522", "e210", "1f523", "e232", "e233", "e235", "e234", "1f520", "1f521", "1f524", "e236", "e237", "e238", "e239", "2194", "2195", "1f504", "e23b", "e23a", "1f53c", "1f53d", "21a9", "21aa", "2139", "e23d", "e23c", "23eb", "23ec", "2935", "2934", "e24d", "1f500", "1f501", "1f502", "e212", "e213", "e214", "1f193", "1f196", "e20b", "e507", "e203", "e22c", "e22b", "e22a", "1f234", "1f232", "e226", "e227", "e22d", "e215", "e216", "e151", "e138", "e139", "e13a", "e309", "1f6b0", "1f6ae", "e14f", "e20a", "e208", "e217", "e218", "e228", "24c2", "1f6c2", "1f6c4", "1f6c5", "1f6c3", "1f251", "e315", "e30d", "1f191", "1f198", "e229", "1f6ab", "e207", "1f4f5", "1f6af", "1f6b1", "1f6b3", "1f6b7", "1f6b8", "26d4", "e206", "2747", "274e", "2705", "e205", "e204", "e12e", "e250", "e251", "e532", "e533", "e534", "e535", "1f4a0", "e211", "267b", "e23f", "e240", "e241", "e242", "e243", "e244", "e245", "e246", "e247", "e248", "e249", "e24a", "e24b", "e23e", "e154", "e14a", "1f4b2", "e149", "e24e", "e24f", "e537", "e12c", "3030", "e24c", "1f51a", "1f519", "1f51b", "1f51c", "e333", "e332", "e021", "e020", "e337", "e336", "1f503", "e02f", "1f567", "e024", "1f55c", "e025", "1f55d", "e026", "1f55e", "e027", "1f55f", "e028", "1f560", "e029", "e02a", "e02b", "e02c", "e02d", "e02e", "1f561", "1f562", "1f563", "1f564", "1f565", "1f566", "2716", "2795", "2796", "2797", "e20e", "e20c", "e20f", "e20d", "1f4ae", "1f4af", "2714", "2611", "1f518", "1f517", "27b0", "e031", "e21a", "e21b", "25fc", "25fb", "25fe", "25fd", "25aa", "25ab", "1f53a", "2b1c", "2b1b", "26ab", "26aa", "e219", "1f535", "1f53b", "1f536", "1f537", "1f538", "1f539"],
        a = ["e436", "e437", "e438", "e43a", "e439", "e43b", "e117", "e440", "e442", "e446", "e445", "e11b", "e448", "e033", "e112", "1f38b", "e312", "1f38a", "e310", "e143", "1f52e", "e03d", "e008", "1f4f9", "e129", "e126", "e127", "e316", "1f4be", "e00c", "e00a", "e009", "1f4de", "1f4df", "e00b", "e14b", "e12a", "e128", "e141", "1f509", "1f508", "1f507", "e325", "1f515", "e142", "e317", "23f3", "231b", "23f0", "231a", "e145", "e144", "1f50f", "1f510", "e03f", "1f50e", "e10f", "1f526", "1f506", "1f505", "1f50c", "1f50b", "e114", "1f6c1", "e13f", "1f6bf", "e140", "1f527", "1f529", "e116", "1f6aa", "e30e", "e311", "e113", "1f52a", "e30f", "e13b", "e12f", "1f4b4", "1f4b5", "1f4b7", "1f4b6", "1f4b3", "1f4b8", "e104", "1f4e7", "1f4e5", "1f4e4", "2709", "e103", "1f4e8", "1f4ef", "e101", "1f4ea", "1f4ec", "1f4ed", "e102", "1f4e6", "e301", "1f4c4", "1f4c3", "1f4d1", "1f4ca", "1f4c8", "1f4c9", "1f4dc", "1f4cb", "1f4c5", "1f4c6", "1f4c7", "1f4c1", "1f4c2", "e313", "1f4cc", "1f4ce", "2712", "270f", "1f4cf", "1f4d0", "1f4d5", "1f4d7", "1f4d8", "1f4d9", "1f4d3", "1f4d4", "1f4d2", "1f4da", "e148", "1f516", "1f4db", "1f52c", "1f52d", "1f4f0", "e502", "e324", "e03c", "e30a", "1f3bc", "e03e", "e326", "1f3b9", "1f3bb", "e042", "e040", "e041", "e12b", "1f3ae", "1f0cf", "1f3b4", "e12d", "1f3b2", "e130", "e42b", "e42a", "e018", "e016", "e015", "e42c", "1f3c9", "1f3b3", "e014", "1f6b5", "1f6b4", "e132", "1f3c7", "e131", "e013", "1f3c2", "e42d", "e017", "1f3a3", "e045", "e338", "e30b", "1f37c", "e047", "e30c", "e044", "1f379", "1f377", "e043", "1f355", "e120", "e33b", "1f357", "1f356", "e33f", "e341", "1f364", "e34c", "e344", "1f365", "e342", "e33d", "e33e", "e340", "e34d", "e343", "e33c", "e147", "e339", "1f369", "1f36e", "e33a", "1f368", "e43f", "e34b", "e046", "1f36a", "1f36b", "1f36c", "1f36d", "1f36f", "e345", "1f34f", "e346", "1f34b", "1f352", "1f347", "e348", "e347", "1f351", "1f348", "1f34c", "1f350", "1f34d", "1f360", "e34a", "e349", "1f33d"];
    e.exports = {
        people: n,
        nature: t,
        things: a,
        places: r,
        symbols: o
    }
}, function (e) {
    var t = "recorderWorker.js",
        n = function (e, n) {
            var r = n || {},
                o = r.bufferLen || 4096;
            this.source = e, this.context = e.context, this.node = (this.context.createScriptProcessor || this.context.createJavaScriptNode).call(this.context, o, 2, 2);
            var a = new Worker(r.workerPath || t);
            a.postMessage({
                command: "init",
                config: {
                    sampleRate: this.context.sampleRate
                }
            });
            var i, s = !1;
            this.node.onaudioprocess = function (e) {
                s && a.postMessage({
                    command: "record",
                    buffer: [e.inputBuffer.getChannelData(0), e.inputBuffer.getChannelData(1)]
                })
            }, this.configure = function (e) {
                for (var t in e) e.hasOwnProperty(t) && (r[t] = e[t])
            }, this.record = function () {
                s = !0
            }, this.stop = function () {
                s = !1
            }, this.clear = function () {
                a.postMessage({
                    command: "clear"
                })
            }, this.getBuffer = function (e) {
                i = e || r.callback, a.postMessage({
                    command: "getBuffer"
                })
            }, this.exportWAV = function (e, t) {
                if (i = e || r.callback, t = t || r.type || "audio/wav", !i) throw new Error("Callback not set");
                a.postMessage({
                    command: "exportWAV",
                    type: t
                })
            }, this.exportOGG = function (e, t) {
                if (i = e || r.callback, t = t || r.type || "audio/ogg", !i) throw new Error("Callback not set");
                a.postMessage({
                    command: "exportOGG",
                    type: t
                })
            }, a.onmessage = function (e) {
                var t = e.data;
                i(t)
            }, this.connect = function (e) {
                e.connect(this.node), this.node.connect(this.context.destination)
            }, this.connect(e)
        };
    n.forceDownload = function (e, t) {
        var n = (window.URL || window.webkitURL).createObjectURL(e),
            r = window.document.createElement("a");
        r.href = n, r.download = t || "output.wav";
        var o = document.createEvent("Event");
        o.initEvent("click", !0, !0), r.dispatchEvent(o)
    }, e.exports = n
}, function (e, t, n) {
    var r = n(156),
        o = n(180),
        a = n(208),
        i = n(209),
        s = n(87),
        c = n(31),
        u = n(26),
        l = n(78),
        d = 200,
        p = .1,
        h = 2,
        g = React.createClass({
            displayName: "PhotoPicker",
            propTypes: {
                startImage: React.PropTypes.string,
                type: React.PropTypes.oneOf(["group", "user"]).isRequired,
                onImageSet: React.PropTypes.func.isRequired
            },
            statics: {
                GROUP: "group",
                USER: "user"
            },
            getInitialState: function () {
                return {
                    img: this.props.startImage,
                    left: 0,
                    top: 0,
                    isEditing: !1,
                    hover: !1,
                    contextActive: !1
                }
            },
            componentWillReceiveProps: function (e) {
                this.props.startImage !== e.startImage && this.setState({
                    img: e.startImage,
                    isEditing: !1
                })
            },
            cropImage: function () {
                var e, t = this.refs.img.getDOMNode(),
                    n = this.state.scale,
                    r = Math.abs(this.state.left / n),
                    a = Math.abs(this.state.top / n),
                    i = d / n;
                return new Promise(function (n) {
                    o.crop(t.src, r, a, i, i, d, d).then(function (t) {
                        return e = t, o.crop(e, 0, 0, u.PROF_PIC_THUMB_SIDE, u.PROF_PIC_THUMB_SIDE)
                    }).then(function (t) {
                        n({
                            thumb: t,
                            full: e
                        })
                    })
                })
            },
            onZoomIn: function () {
                h <= this.state.scale + p || this.setState({
                    scale: this.state.scale + p
                })
            },
            onZoomOut: function () {
                var e = this.state.scale - p;
                this.state.minScale >= e && (e = this.state.minScale), this.setState({
                    scale: e
                })
            },
            onCrop: function () {
                var e = this;
                this.cropImage().then(function (t) {
                    e.props.onImageSet(t.thumb, t.full)
                })
            },
            onDragEnd: function (e, t) {
                this.setState({
                    left: e,
                    top: t
                })
            },
            onCapture: function () {
                c.openModal(React.createElement(i, {
                    onSend: this.onImageTake
                }))
            },
            onUpload: function () {
                var e = this.refs.imageInput.getDOMNode();
                return e.click(), !0
            },
            onImageTake: function (e) {
                this.createAndSetImage(e)
            },
            onImagePick: function (e) {
                s.pop(s.MENU);
                var t = e.target.files[0];
                return t ? (this.createAndSetImage(t), void(e.target.value = "")) : !1
            },
            createAndSetImage: function (e) {
                var t = this;
                o.resize(e, Wa.CONST.MAX_PIC_SIDE, Wa.CONST.MAX_PIC_SIDE).then(function (e) {
                    var n = new Image;
                    n.onload = function () {
                        var r, o = n.width,
                            a = n.height;
                        r = a > o ? d / o : d / a, t.setState({
                            img: e,
                            isEditing: !0,
                            scale: r,
                            minScale: d / Math.min(o, a)
                        })
                    }, n.src = e
                })
            },
            onImageClick: function (e) {
                if (!this.state.isEditing) {
                    e.stopPropagation(), e.preventDefault();
                    var t = [React.createElement(r, {
                        action: this.onCapture
                    }, l10n.t("take_photo")), React.createElement(r, {
                        action: this.onUpload
                    }, l10n.t("upload_photo"))];
                    c.openContextMenu(e, t, this.contextClose), this.setState({
                        contextActive: !0
                    })
                }
            },
            contextClose: function () {
                this.setState({
                    contextActive: !1
                })
            },
            onMouseEnter: function () {
                this.setState({
                    hover: !0
                })
            },
            onMouseLeave: function () {
                this.setState({
                    hover: !1
                })
            },
            render: function () {
                var e, t = {};
                if (this.state.img && this.state.isEditing) {
                    var n = {
                        width: d,
                        height: d
                    };
                    e = React.createElement(a, {
                        ref: "img",
                        container: n,
                        onStop: this.onDragEnd,
                        scale: this.state.scale
                    }, React.createElement("img", {
                        className: "avatar-original",
                        src: this.state.img
                    }))
                } else this.state.img && (t = {
                    backgroundImage: "url(" + this.state.img + ")",
                    backgroundSize: "cover"
                });
                var r = null;
                if (!this.state.img || !this.state.isEditing && this.state.hover || this.state.contextActive) {
                    var o;
                    switch (this.props.type) {
                    case "group":
                        o = l10n.t(this.state.img ? "change_group_icon" : "add_group_icon");
                        break;
                    case "profile":
                        o = l10n.t(this.state.img ? "change_profile_photo" : "add_profile_photo")
                    }
                    r = React.createElement("div", {
                        className: "avatar-overlay",
                        key: "avatar-overlay"
                    }, React.createElement("span", {
                        className: "icon icon-camera-light"
                    }), React.createElement("div", {
                        className: "avatar-overlay-text"
                    }, o))
                }
                var i = "avatar avatar-l";
                i += this.props.type === g.GROUP ? " icon-group-default" : " icon-user-default";
                var s, c;
                return this.state.isEditing && (s = React.createElement("div", {
                    className: "avatar-picker-controls",
                    key: "zoom-controls"
                }, React.createElement("button", {
                    className: "icon icon-plus",
                    onClick: this.onZoomIn
                }), React.createElement("button", {
                    className: "icon icon-minus",
                    onClick: this.onZoomOut
                })), c = React.createElement("div", {
                    className: "tip-container tip-avatar-picker",
                    key: "tip-controls"
                }, React.createElement("div", {
                    className: "tip"
                }, React.createElement("div", {
                    className: "tip-body"
                }, "Drag the image to adjust"), React.createElement("div", {
                    className: "tip-controls"
                }, React.createElement("button", {
                    className: "button",
                    onClick: this.onCrop
                }, "Done"))))), React.createElement("div", {
                    className: "avatar-picker"
                }, React.createElement("div", {
                    className: i,
                    style: t,
                    onClick: this.onImageClick,
                    onMouseEnter: this.onMouseEnter,
                    onMouseLeave: this.onMouseLeave
                }, React.createElement(l, {
                    transitionName: "fade"
                }, r), e), React.createElement(l, {
                    transitionName: "scaleY"
                }, s, c), React.createElement("input", {
                    ref: "imageInput",
                    type: "file",
                    "data-ignore": !0,
                    accept: "image/gif,image/jpeg,image/jpg,image/png",
                    style: {
                        display: "none"
                    },
                    onChange: this.onImagePick
                }))
            }
        });
    e.exports = g
}, function (e) {
    var t = React.createClass({
        displayName: "FloatingPlaceholder",
        propTypes: {
            children: React.PropTypes.node.isRequired,
            placeholder: React.PropTypes.string.isRequired,
            hasText: React.PropTypes.bool.isRequired
        },
        render: function () {
            var e = "placeholder";
            return this.props.hasText && (e += " placeholder-enter"), React.createElement("div", {
                className: "floating-placeholder"
            }, React.createElement("span", {
                className: e
            }, this.props.placeholder), this.props.children)
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = n(177),
        o = n(178),
        a = n(179),
        i = n(210),
        s = n(163).Contact,
        c = n(112),
        u = n(79),
        l = React.createClass({
            displayName: "ContactDrawer",
            mixins: [u],
            propTypes: {
                onBack: React.PropTypes.func.isRequired,
                onControl: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    searchText: "",
                    cancelSearch: !1,
                    active: !1
                }
            },
            componentDidMount: function () {
                this.safeDefer(function (e) {
                    e.setState({
                        active: !0
                    })
                }, this)
            },
            getFilteredContacts: function () {
                var e = Store.Contact.getFilteredContacts(!0),
                    t = this.state.searchText;
                return t ? e.filter(function (e) {
                    return e.searchMatch(t)
                }) : e
            },
            close: function () {
                return this.searchText ? (this.setState({
                    searchText: "",
                    cancelSearch: !0
                }), !0) : !1
            },
            onSearch: function (e) {
                this.setState({
                    searchText: e
                })
            },
            render: function () {
                var e = this.state.active ? React.createElement(i, {
                    scrollTarget: 1,
                    contacts: this.getFilteredContacts(),
                    controls: s.Controls.clickable,
                    onControl: this.props.onControl
                }) : null;
                return React.createElement(r, {
                    key: "contact-modal",
                    onCancel: this.props.onBack
                }, React.createElement(o, {
                    title: this.props.title,
                    onBack: this.props.onBack
                }), React.createElement(c, {
                    searchText: this.state.searchText,
                    isSearching: !this.state.cancelSearch,
                    onSearch: this.onSearch,
                    searchType: c.CONTACT
                }), React.createElement(a, null, e))
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(177),
        o = n(178),
        a = n(179),
        i = n(137),
        s = n(192),
        c = (n(180), n(196), n(191)),
        u = n(136),
        l = n(78),
        d = React.createClass({
            displayName: "NewGroupDrawer",
            propTypes: {
                thumb: React.PropTypes.string,
                full: React.PropTypes.string,
                subject: React.PropTypes.string,
                onBack: React.PropTypes.func.isRequired,
                onContinue: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    text: this.props.subject || "",
                    thumb: this.props.thumb,
                    full: this.props.full,
                    emojiActive: !1
                }
            },
            isSubjectValid: function () {
                var e = this.state.text;
                return e.length > 0 && e.length <= 25
            },
            preventBlur: function (e) {
                e.preventDefault(), e.stopPropagation(), this.refs.emojiInput.restoreFocus()
            },
            onImageSet: function (e, t) {
                this.setState({
                    thumb: e,
                    full: t
                })
            },
            onEmojiToggle: function () {
                this.setState({
                    emojiActive: !this.state.emojiActive
                })
            },
            onEmoji: function (e) {
                this.refs.emojiInput.replaceSelection(e)
            },
            onContinue: function () {
                var e = this.state.text,
                    t = this.refs.photoPicker;
                if (t.state.isEditing) {
                    var n = this;
                    t.cropImage().then(function (t) {
                        n.props.onContinue(e, t.thumb, t.full)
                    })
                } else this.props.onContinue(e, this.state.thumb, this.state.full)
            },
            onInputChange: function (e) {
                this.setState({
                    text: e.target.value
                })
            },
            render: function () {
                var e = this.isSubjectValid() ? React.createElement("div", {
                    className: "drawer-section drawer-controls"
                }, React.createElement("button", {
                    className: "btn btn-round",
                    onClick: this.onContinue
                }, React.createElement("span", {
                    className: "icon icon-forward-light icon-l"
                }))) : null,
                    t = this.state.emojiActive ? React.createElement(u, {
                        onEmoji: this.onEmoji
                    }) : null;
                return React.createElement(r, {
                    id: "new-group",
                    onCancel: this.props.onBack
                }, React.createElement(o, {
                    title: l10n.t("new_group_flow_title"),
                    onBack: this.props.onBack
                }), React.createElement(a, null, React.createElement("div", {
                    className: "drawer-section"
                }, React.createElement(c, {
                    type: c.GROUP,
                    startImage: this.state.full,
                    onImageSet: this.onImageSet,
                    ref: "photoPicker"
                })), React.createElement("div", {
                    className: "drawer-section",
                    onMouseDown: this.preventBlur
                }, React.createElement("div", {
                    className: "input-emoji input-ext"
                }, React.createElement(s, {
                    placeholder: l10n.t("group_subject"),
                    hasText: !! this.state.text
                }, React.createElement(i, {
                    ref: "emojiInput",
                    value: this.state.text,
                    className: "input-line",
                    onChange: this.onInputChange,
                    maxLength: 25,
                    showRemaining: !0
                })), React.createElement("button", {
                    className: "icon btn-input icon-emoji-input",
                    onClick: this.onEmojiToggle
                })), React.createElement(l, {
                    transitionName: "emoji"
                }, t)), React.createElement(l, {
                    transitionName: "btn"
                }, e)))
            }
        });
    e.exports = d
}, function (e, t, n) {
    var r = n(177),
        o = n(178),
        a = n(179),
        i = n(210),
        s = n(163).Contact,
        c = n(47),
        u = (n(112), n(78)),
        l = React.createClass({
            displayName: "NewGroupParticipantsDrawer",
            mixins: [c],
            propTypes: {
                thumb: React.PropTypes.string,
                full: React.PropTypes.string,
                subject: React.PropTypes.string.isRequired,
                onBack: React.PropTypes.func.isRequired,
                onContinue: React.PropTypes.func.isRequired
            },
            getInitialState: function () {
                return {
                    searchText: "",
                    participants: {}
                }
            },
            getFilteredContacts: function () {
                var e = Store.Contact.getFilteredContacts(!0),
                    t = this.state.participants;
                e = _.reject(e, function (e) {
                    return !!t[e.id]
                });
                var n = this.state.searchText;
                return n ? e.filter(function (e) {
                    return e.searchMatch(n)
                }) : e
            },
            componentDidMount: function () {
                this.focus()
            },
            componentDidUpdate: function () {
                this.adjustInput()
            },
            onInput: function (e) {
                this.setState({
                    searchText: e.target.value
                })
            },
            adjustInput: function () {
                var e = this.refs.input.getDOMNode().offsetParent.offsetWidth - 30,
                    t = this.refs.sizer.getDOMNode().offsetWidth,
                    n = t > e ? e : t;
                this.refs.input.getDOMNode().style.width = n + "px";
                var r;
                r = e - this.refs.input.getDOMNode().offsetLeft - n > 0 ? e - this.refs.input.getDOMNode().offsetLeft : e, this.refs.input.getDOMNode().style.width = r + "px", this.focus()
            },
            onReset: function () {
                this.setState({
                    searchText: ""
                })
            },
            focus: function () {
                this.refs.input.getDOMNode().focus()
            },
            onBack: function () {
                var e = this.props;
                e.onBack(e.subject, e.thumb, e.full)
            },
            onContinue: function () {
                var e = this.props;
                e.onContinue(e.subject, e.thumb, e.full, this.state.participants)
            },
            onRemove: function (e, t) {
                delete this.state.participants[t.id], this.setState({
                    participants: this.state.participants
                })
            },
            onContactClick: function (e, t) {
                this.state.participants[t.id] ? delete this.state.participants[t.id] : (this.state.participants[t.id] = t, this.onReset()), this.setState({
                    participants: this.state.participants
                })
            },
            render: function () {
                var e = _.size(this.state.participants) ? _.map(this.state.participants, function (e) {
                    return React.createElement(s, {
                        contact: e,
                        controls: s.Controls.deletable,
                        onControl: this.onRemove,
                        key: "group-participant-" + e.id
                    })
                }, this) : null,
                    t = _.size(this.state.participants) ? React.createElement("div", {
                        className: "drawer-section drawer-controls"
                    }, React.createElement("button", {
                        className: "btn btn-round",
                        onClick: this.onContinue
                    }, React.createElement("span", {
                        className: "icon icon-checkmark-light icon-l"
                    }))) : null;
                return React.createElement(r, {
                    id: "new-group",
                    onCancel: this.onBack
                }, React.createElement(o, {
                    title: l10n.t("add_group_participants_title"),
                    onBack: this.onBack
                }), React.createElement(a, {
                    type: "flex"
                }, React.createElement("div", {
                    className: "drawer-section"
                }, React.createElement("div", {
                    className: "input-clear input-ext new-group-search"
                }, React.createElement("div", {
                    className: "input input-line"
                }, React.createElement("div", {
                    className: "list-names list-deletable new-group-preview"
                }, e), React.createElement("input", {
                    className: "inputarea",
                    ref: "input",
                    placeholder: l10n.t("group_participant_hint"),
                    onChange: this.onInput,
                    value: this.state.searchText
                }), React.createElement("span", {
                    className: "inputarea-sizer",
                    ref: "sizer"
                }, this.state.searchText)))), React.createElement("div", {
                    className: "new-group-contacts"
                }, React.createElement(i, {
                    scrollTarget: 1,
                    contacts: this.getFilteredContacts(),
                    controls: s.Controls.clickable,
                    onControl: this.onContactClick
                })), React.createElement(u, {
                    transitionName: "btn"
                }, t)))
            }
        });
    e.exports = l
}, function (e, t, n) {
    var r = n(213),
        o = React.createClass({
            displayName: "ImageLoader",
            propTypes: {
                src: React.PropTypes.string.isRequired
            },
            getInitialState: function () {
                return {
                    loaded: !1
                }
            },
            componentWillMount: function () {
                var e = new Image;
                e.src = this.props.src, e.complete && this.onLoad()
            },
            onLoad: function () {
                this.setState({
                    loaded: !0
                })
            },
            render: function () {
                var e = "avatar-image";
                return this.state.loaded && (e += " is-loaded"), React.createElement(r, {
                    src: this.props.src,
                    onLoad: this.onLoad,
                    className: e
                })
            }
        });
    e.exports = o
}, function (e) {
    var t = React.createClass({
        displayName: "ConfirmPopup",
        propTypes: {
            onCancel: React.PropTypes.func.isRequired,
            onOK: React.PropTypes.func.isRequired,
            title: React.PropTypes.node.isRequired
        },
        render: function () {
            return React.createElement("div", {
                className: "backdrop"
            }, React.createElement("div", {
                className: "popup"
            }, React.createElement("div", {
                className: "popup-title"
            }, this.props.title), React.createElement("div", {
                className: "popup-body"
            }, this.props.children), React.createElement("div", {
                className: "popup-controls"
            }, React.createElement("button", {
                className: "btn-plain popup-controls-item",
                onClick: this.props.onCancel
            }, "Cancel"), React.createElement("button", {
                className: "btn-plain btn-default popup-controls-item",
                onClick: this.props.onOK
            }, "OK"))))
        }
    });
    e.exports = t
}, function (e, t, n) {
    var r = n(211),
        o = n(212),
        a = n(79),
        i = n(48),
        s = n(177),
        c = n(178),
        u = n(179),
        l = (n(112), n(180), n(77), n(78)),
        d = React.createClass({
            displayName: "CaptureDrawer",
            mixins: [i, a],
            propTypes: {
                noContainer: React.PropTypes.bool,
                stream: React.PropTypes.object.isRequired,
                onBack: React.PropTypes.func.isRequired,
                onSend: React.PropTypes.func.isRequired
            },
            statics: {
                PENDING: "pending",
                RECORDING: "active",
                SENDING: "sending"
            },
            getInitialState: function () {
                return {
                    state: d.PENDING,
                    img: void 0,
                    url: void 0
                }
            },
            componentDidMount: function () {
                this.safeDelay(function () {
                    this.setState({
                        state: d.RECORDING,
                        url: window.URL.createObjectURL(this.props.stream)
                    })
                }, 300)
            },
            componentWillUnmount: function () {
                this.state.url && (this.props.stream.stop(), window.URL.revokeObjectURL(this.state.url))
            },
            onCapture: function () {
                var e = document.createElement("canvas"),
                    t = this.refs.video.getDOMNode();
                e.height = t.videoHeight, e.width = t.videoWidth, e.getContext("2d").drawImage(this.refs.video.getDOMNode(), 0, 0, t.videoWidth, t.videoHeight);
                var n = e.toDataURL("image/jpeg");
                this.setState({
                    state: d.SENDING,
                    img: n
                })
            },
            onVideoLoaded: function (e) {
                this.setState({
                    videoSize: {
                        width: e.target.videoWidth,
                        height: e.target.videoHeight
                    }
                })
            },
            onRetake: function () {
                this.setState({
                    state: d.RECORDING
                })
            },
            onSend: function () {
                this.props.onSend(dataURLtoBlob(this.state.img))
            },
            render: function () {
                var e, t, n;
                switch (this.state.state) {
                case d.PENDING:
                    break;
                case d.RECORDING:
                    n = React.createElement(o, {
                        type: o.TYPES.COVER,
                        size: this.state.videoSize
                    }, React.createElement(r, {
                        className: "capture-video",
                        autoPlay: !0,
                        ref: "video",
                        onPlay: this.onVideoLoaded,
                        src: this.state.url
                    })), e = React.createElement("div", {
                        className: "drawer-controls fade"
                    }, React.createElement("button", {
                        className: "btn btn-round btn-l",
                        onClick: this.onCapture
                    }, React.createElement("span", {
                        className: "icon icon-camera-light"
                    })));
                    break;
                case d.SENDING:
                    var a = {
                        backgroundImage: "url(" + this.state.img + ")"
                    };
                    n = React.createElement("div", {
                        style: a,
                        className: "capture-image snapshot"
                    });
                    var i = this.props.noContainer ? "icon icon-checkmark-light" : "icon icon-send-light";
                    e = React.createElement("div", {
                        className: "drawer-controls"
                    }, React.createElement("button", {
                        className: "btn btn-round btn-l",
                        onClick: this.onSend
                    }, React.createElement("span", {
                        className: i
                    }))), t = React.createElement("div", {
                        className: "drawer-header-action",
                        onClick: this.onRetake
                    }, React.createElement("span", {
                        className: "icon icon-refresh-light"
                    }), l10n.t("retake"));
                    break;
                default:
                    Wa.debug("Unhandled video capture state")
                }
                return React.createElement(s, {
                    key: "attach-capture-modal",
                    position: "right",
                    id: "capture",
                    variant: "noheader",
                    noContainer: this.props.noContainer
                }, React.createElement(c, {
                    title: l10n.t("take_photo"),
                    onCancel: this.props.onBack
                }, t), React.createElement(u, null, n, React.createElement(l, {
                    transitionName: "pop_delay",
                    delay: 750
                }, e)))
            }
        });
    e.exports = d
}, function (e) {
    var t = React.createClass({
        displayName: "DrawerSection",
        propTypes: {
            children: React.PropTypes.node.isRequired,
            title: React.PropTypes.node,
            subtitle: React.PropTypes.node,
            expands: React.PropTypes.bool.isRequired,
            classes: React.PropTypes.string
        },
        getDefaultProps: function () {
            return {
                expands: !1
            }
        },
        render: function () {
            var e = this.props.expands ? "drawer-section-expand" : "drawer-section";
            e += this.props.title ? " well" : "", e += this.props.classes ? " " + this.props.classes : "";
            var t = "drawer-section-body";
            if (t += this.props.expands ? " drawer-section-body-expand chatlist" : "", !this.props.title) return React.createElement("div", {
                className: e
            }, this.props.children);
            var n = this.props.subtitle ? React.createElement("div", {
                className: "col-side"
            }, this.props.subtitle) : null;
            return React.createElement("div", {
                className: e
            }, React.createElement("div", {
                className: "drawer-section-title title-underlined"
            }, React.createElement("div", {
                className: "col-main"
            }, this.props.title), n), React.createElement("div", {
                className: t
            }, this.props.children))
        }
    });
    e.exports = t
}, function (e) {
    var t = React.createClass({
        displayName: "GoogleMap",
        propTypes: {
            latitude: React.PropTypes.number.isRequired,
            longitude: React.PropTypes.number.isRequired,
            zoom: React.PropTypes.number.isRequired,
            accuracy: React.PropTypes.number,
            onSelect: React.PropTypes.func.isRequired
        },
        getDefaultProps: function () {
            return {
                latitude: 0,
                longitude: 0,
                zoom: 4,
                points: []
            }
        },
        getCenter: function () {
            return this.map.getCenter()
        },
        getBounds: function () {
            return this.map.getBounds()
        },
        mapInstance: function () {
            return this.map
        },
        updateCenter: function (e, t, n, r) {
            var o = new google.maps.LatLng(e, t);
            if (this.map.panTo(o), n) this.map.setZoom(n);
            else if (r) {
                var a = new google.maps.Circle({
                    center: o,
                    radius: 2 * Math.max(r, 25)
                });
                this.map.fitBounds(a.getBounds())
            }
        },
        updateMarkers: function (e) {
            var t = this.markers || (this.markers = []);
            for (this.map; t.length < e.length;) t.unshift(this._makeMarker());
            for (var n = 0; n < e.length; n++) {
                var r = t[n],
                    o = e[n];
                r.place = o, r.setPosition(o.loc), r.getMap() || r.setMap(this.map)
            }
            for (; n < t.length; ++n) t[n].setMap(null)
        },
        _makeMarker: function () {
            var e = new google.maps.Marker,
                t = this.map,
                n = this.iw || (this.iw = new google.maps.InfoWindow),
                r = this;
            return google.maps.event.addListener(e, "mouseover", function () {
                n.setContent(e.place.name), n.open(t, e)
            }), google.maps.event.addListener(e, "mouseout", function () {
                n.close()
            }), google.maps.event.addListener(e, "click", function () {
                r.props.onSelect(poi)
            }), e
        },
        render: function () {
            var e = {
                width: "100%",
                height: "100%"
            };
            return React.createElement("div", {
                style: e
            })
        },
        componentDidMount: function () {
            var e = {
                center: new google.maps.LatLng(this.props.latitude, this.props.longitude),
                zoom: this.props.zoom,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                disableDefaultUI: !0,
                zoomControl: !0,
                zoomControlOptions: {
                    style: google.maps.ZoomControlStyle.SMALL
                },
                styles: [{
                    featureType: "poi",
                    stylers: [{
                        visibility: "off"
                    }]
                }]
            };
            this.map = new google.maps.Map(this.getDOMNode(), e), this.updateMarkers(this.props.points)
        },
        componentWillReceiveProps: function (e) {
            this.updateMarkers(e.points || [])
        }
    });
    e.exports = t
}, function (e) {
    var t = {
        singleByte: [void 0, void 0, void 0, "200", "400", "404", "500", "501", "502", "action", "add", "after", "archive", "author", "available", "battery", "before", "body", "broadcast", "chat", "clear", "code", "composing", "contacts", "count", "create", "debug", "delete", "demote", "duplicate", "encoding", "error", "false", "filehash", "from", "g.us", "group", "groups_v2", "height", "id", "image", "in", "index", "invis", "item", "jid", "kind", "last", "leave", "live", "log", "media", "message", "mimetype", "missing", "modify", "name", "notification", "notify", "out", "owner", "participant", "paused", "picture", "played", "presence", "preview", "promote", "query", "raw", "read", "receipt", "received", "recipient", "recording", "relay", "remove", "response", "resume", "retry", "s.whatsapp.net", "seconds", "set", "size", "status", "subject", "subscribe", "t", "text", "to", "true", "type", "unarchive", "unavailable", "url", "user", "value", "web", "width", "mute", "read_only", "admin", "creator", "short", "update", "powersave"],
        doubleByte: []
    };
    e.exports = t
}, function (e) {
    var t = {
        STREAM_END: 2,
        LIST_EMPTY: 0,
        DICTIONARY_0: 236,
        DICTIONARY_1: 237,
        DICTIONARY_2: 238,
        DICTIONARY_3: 239,
        LIST_8: 248,
        LIST_16: 249,
        JID_PAIR: 250,
        BINARY_8: 252,
        BINARY_20: 253,
        SINGLE_BYTE_MAX: 256
    };
    e.exports = t
}, function (e) {
    var t = {
        singleByte: [void 0, void 0, void 0, "200", "400", "404", "500", "501", "502", "action", "add", "after", "archive", "author", "available", "battery", "before", "body", "broadcast", "chat", "clear", "code", "composing", "contacts", "count", "create", "debug", "delete", "demote", "duplicate", "encoding", "error", "false", "filehash", "from", "g.us", "group", "groups_v2", "height", "id", "image", "in", "index", "invis", "item", "jid", "kind", "last", "leave", "live", "log", "media", "message", "mimetype", "missing", "modify", "name", "notification", "notify", "out", "owner", "participant", "paused", "picture", "played", "presence", "preview", "promote", "query", "raw", "read", "receipt", "received", "recipient", "recording", "relay", "remove", "response", "resume", "retry", "s.whatsapp.net", "seconds", "set", "size", "status", "subject", "subscribe", "t", "text", "to", "true", "type", "unarchive", "unavailable", "url", "user", "value", "web", "width", "mute", "read_only", "admin", "creator", "short", "update", "powersave"],
        doubleByte: [],
        nibbleEncode: {
            0: 0,
            1: 1,
            2: 2,
            3: 3,
            4: 4,
            5: 5,
            6: 6,
            7: 7,
            8: 8,
            9: 9,
            "-": 10,
            ".": 11,
            "\x00": 15
        },
        nibbleDecode: {
            0: "0",
            1: "1",
            2: "2",
            3: "3",
            4: "4",
            5: "5",
            6: "6",
            7: "7",
            8: "8",
            9: "9",
            10: "-",
            11: ".",
            15: String.fromCharCode("\x00")
        }
    };
    e.exports = t
}, function (e) {
    var t = {
        STREAM_END: 2,
        LIST_EMPTY: 0,
        DICTIONARY_0: 236,
        DICTIONARY_1: 237,
        DICTIONARY_2: 238,
        DICTIONARY_3: 239,
        LIST_8: 248,
        LIST_16: 249,
        JID_PAIR: 250,
        BINARY_8: 252,
        BINARY_20: 253,
        BINARY_32: 254,
        NIBBLE_8: 255,
        SINGLE_BYTE_MAX: 256,
        NIBBLE_MAX: 254
    };
    e.exports = t
}, function (e, t, n) {
    function r(e, t, n) {
        "function" == typeof t && (n = t, t = {});
        var r = i(e),
            d = {};
        try {
            d = a(r.buffer)
        } catch (p) {}
        var h = d.Orientation && "number" == typeof d.Orientation.value && (6 == d.Orientation.value || 8 == d.Orientation.value);
        if (!h) return void o.nextTick(function () {
            n(e, t.image && u(e))
        });
        var g = l[r.type](r),
            f = Math.max(g.width, g.height),
            m = f / 2,
            b = {
                6: 1,
                8: -1
            }[d.Orientation.value],
            y = document.createElement("canvas"),
            _ = y.getContext("2d");
        y.width = y.height = f, s(_, {
            x: m,
            y: m,
            degrees: 90 * b
        }), u(e, function (e) {
            1 == b ? _.drawImage(e, 0, f - g.height) : _.drawImage(e, f - g.width, 0), s(_, {
                x: m,
                y: m,
                degrees: -1 * b * 90
            }), c(y, {
                width: g.height,
                height: g.width
            });
            var o = "image/png" == r.type ? y.toDataURL() : y.toDataURL("image/jpeg", 1);
            n(o, t.image && u(o))
        })
    }
    var o = n(214),
        a = n(217),
        i = n(218),
        s = n(219),
        c = n(215),
        u = n(216),
        l = {
            "image/png": n(220),
            "image/jpeg": n(221)
        };
    e.exports = r
}, function (e, t, n) {
    var r;
    !
    function () {
        function o() {
            return {
                keys: Object.keys,
                uniqueId: function (e) {
                    var t = ++l + "";
                    return e ? e + t : t
                },
                has: function (e, t) {
                    return c.call(e, t)
                },
                each: function (e, t, n) {
                    if (null != e) if (s && e.forEach === s) e.forEach(t, n);
                    else if (e.length === +e.length) {
                        for (var r = 0, o = e.length; o > r; r++) if (t.call(n, e[r], r, e) === i) return
                    } else for (var a in e) if (this.has(e, a) && t.call(n, e[a], a, e) === i) return
                },
                once: function (e) {
                    var t, n = !1;
                    return function () {
                        return n ? t : (n = !0, t = e.apply(this, arguments), e = null, t)
                    }
                }
            }
        }
        var a, i = {},
            s = Array.prototype.forEach,
            c = Object.prototype.hasOwnProperty,
            u = Array.prototype.slice,
            l = 0,
            d = o();
        a = {
            on: function (e, t, n) {
                if (!h(this, "on", e, [t, n]) || !t) return this;
                this._events || (this._events = {});
                var r = this._events[e] || (this._events[e] = []);
                return r.push({
                    callback: t,
                    context: n,
                    ctx: n || this
                }), this
            },
            once: function (e, t, n) {
                if (!h(this, "once", e, [t, n]) || !t) return this;
                var r = this,
                    o = d.once(function () {
                        r.off(e, o), t.apply(this, arguments)
                    });
                return o._callback = t, this.on(e, o, n)
            },
            off: function (e, t, n) {
                var r, o, a, i, s, c, u, l;
                if (!this._events || !h(this, "off", e, [t, n])) return this;
                if (!e && !t && !n) return this._events = {}, this;
                for (i = e ? [e] : d.keys(this._events), s = 0, c = i.length; c > s; s++) if (e = i[s], a = this._events[e]) {
                    if (this._events[e] = r = [], t || n) for (u = 0, l = a.length; l > u; u++) o = a[u], (t && t !== o.callback && t !== o.callback._callback || n && n !== o.context) && r.push(o);
                    r.length || delete this._events[e]
                }
                return this
            },
            trigger: function (e) {
                if (!this._events) return this;
                var t = u.call(arguments, 1);
                if (!h(this, "trigger", e, t)) return this;
                var n = this._events[e],
                    r = this._events.all;
                return n && g(n, t), r && g(r, arguments), this
            },
            stopListening: function (e, t, n) {
                var r = this._listeners;
                if (!r) return this;
                var o = !t && !n;
                "object" == typeof t && (n = this), e && ((r = {})[e._listenerId] = e);
                for (var a in r) r[a].off(t, n, this), o && delete this._listeners[a];
                return this
            }
        };
        var p = /\s+/,
            h = function (e, t, n, r) {
                if (!n) return !0;
                if ("object" == typeof n) {
                    for (var o in n) e[t].apply(e, [o, n[o]].concat(r));
                    return !1
                }
                if (p.test(n)) {
                    for (var a = n.split(p), i = 0, s = a.length; s > i; i++) e[t].apply(e, [a[i]].concat(r));
                    return !1
                }
                return !0
            },
            g = function (e, t) {
                var n, r = -1,
                    o = e.length,
                    a = t[0],
                    i = t[1],
                    s = t[2];
                switch (t.length) {
                case 0:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx);
                    return;
                case 1:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a);
                    return;
                case 2:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a, i);
                    return;
                case 3:
                    for (; ++r < o;)(n = e[r]).callback.call(n.ctx, a, i, s);
                    return;
                default:
                    for (; ++r < o;)(n = e[r]).callback.apply(n.ctx, t)
                }
            },
            f = {
                listenTo: "on",
                listenToOnce: "once"
            };
        d.each(f, function (e, t) {
            a[t] = function (t, n, r) {
                var o = this._listeners || (this._listeners = {}),
                    a = t._listenerId || (t._listenerId = d.uniqueId("l"));
                return o[a] = t, "object" == typeof n && (r = this), t[e](n, r, this), this
            }
        }), a.bind = a.on, a.unbind = a.off, a.mixin = function (e) {
            var t = ["on", "once", "off", "trigger", "stopListening", "listenTo", "listenToOnce", "bind", "unbind"];
            return d.each(t, function (t) {
                e[t] = this[t]
            }, this), e
        }, r = function () {
            return a
        }.call(t, n, t, e), !(void 0 !== r && (e.exports = r))
    }(this)
}, function (e, t, n) {
    var r = n(97),
        o = n(110),
        a = n(48),
        i = n(168),
        s = n(157),
        c = (n(77), n(213)),
        u = n(223),
        l = n(186),
        d = n(187),
        p = (n(31), n(33)),
        h = React.addons.classSet,
        g = 500,
        f = React.createClass({
            displayName: "MediaViewerModal",
            mixins: [o, a],
            propTypes: {
                msg: React.PropTypes.instanceOf(r).isRequired,
                onBack: React.PropTypes.func.isRequired,
                onNext: React.PropTypes.func,
                onPrev: React.PropTypes.func,
                startElement: React.PropTypes.object
            },
            getInitialState: function () {
                return {
                    urlState: this.async("msg.urlState"),
                    mediaStyle: {}
                }
            },
            componentDidMount: function () {
                this.regNativeListener(window, "resize", this.updateMediaStyle), this.updateMediaStyle();
                var e = this.props.startElement;
                if (e) {
                    var t = this.refs.media.getDOMNode(),
                        n = t.getBoundingClientRect(),
                        r = e.getBoundingClientRect(),
                        o = r.top - n.top,
                        a = r.left - n.left,
                        i = t.clientWidth,
                        s = e.clientWidth,
                        c = s / i;
                    Velocity(this.refs.media.getDOMNode(), {
                        translateX: [0, a],
                        translateY: [0, o],
                        scale: [1, c]
                    }, {
                        duration: g,
                        easing: [.1, .82, .25, 1]
                    })
                }
            },
            stopPropagation: function (e) {
                e.stopPropagation()
            },
            updateMediaStyle: function () {
                var e = this.refs.media.getDOMNode(),
                    t = this.refs.container.getDOMNode(),
                    n = t.clientWidth - 296,
                    r = t.clientHeight - 20,
                    o = e.naturalHeight,
                    a = e.naturalWidth;
                o > r && (o = r, a = e.naturalWidth * (r / e.naturalHeight)), a > n && (a = n, o = e.naturalHeight * (n / e.naturalWidth)), this.setState({
                    mediaStyle: {
                        width: a,
                        height: o
                    }
                })
            },
            render: function () {
                var e, t = this.props.msg;
                switch (t.type) {
                case "image":
                    e = React.createElement(m, {
                        ref: "media",
                        msg: t
                    });
                    break;
                case "video":
                    e = React.createElement(b, {
                        ref: "media",
                        msg: t
                    });
                    break;
                case "audio":
                    e = React.createElement(A, {
                        ref: "media",
                        msg: t
                    })
                }
                var n = this.props.onNext ? React.createElement("button", {
                    className: "btn btn-round btn-media-next",
                    onClick: this.props.onNext
                }, React.createElement("span", {
                    className: "icon icon-chevron-right icon-l",
                    title: "Next"
                }, "Next")) : React.createElement("div", {
                    className: "btn-media-next"
                }),
                    o = this.props.onPrev ? React.createElement("button", {
                        className: "btn btn-round btn-media-prev",
                        onClick: this.props.onPrev
                    }, React.createElement("span", {
                        className: "icon icon-chevron-left icon-l",
                        title: "Previous"
                    }, "Previous")) : React.createElement("div", {
                        className: "btn-media-prev"
                    }),
                    a = [r.URL_STATE.URL, r.URL_STATE.STATUS_200].indexOf(t.urlState) > -1 ? React.createElement("div", {
                        className: "menu-item"
                    }, React.createElement("a", {
                        className: "icon icon-l btn-media-share icon-download",
                        title: l10n.t("web_button_download"),
                        onClick: this.stopPropagation,
                        download: !0,
                        href: t.url
                    }, l10n.t("web_button_download"), "i")) : null;
                return React.createElement("div", {
                    className: "media-viewer"
                }, React.createElement("div", {
                    className: "media-panel-header"
                }, React.createElement("div", {
                    className: "chat media-chat"
                }, React.createElement("div", {
                    className: "chat-avatar"
                }, React.createElement(s, {
                    id: t.sender
                })), React.createElement("div", {
                    className: "chat-body"
                }, React.createElement("div", {
                    className: "chat-main"
                }, React.createElement(i, {
                    text: t.displayName(!0, !0)
                })), React.createElement("div", {
                    className: "chat-secondary"
                }, React.createElement("div", {
                    className: "chat-status ellipsify"
                }, Wa.formatDateAndTimeRelative(t.t))))), React.createElement("div", {
                    className: "menu menu-horizontal media-panel-tools"
                }, a, React.createElement("div", {
                    className: "menu-item"
                }, React.createElement("button", {
                    className: "icon icon-l btn-media-share icon-x-viewer",
                    title: l10n.t("web_close"),
                    onClick: this.props.onBack
                }, l10n.t("web_close"))))), React.createElement("div", {
                    className: "media-content",
                    ref: "container"
                }, o, React.createElement("div", {
                    className: "media",
                    style: this.state.mediaStyle
                }, React.createElement(E, {
                    msg: t
                }), e), n))
            }
        }),
        m = React.createClass({
            displayName: "MediaImage",
            mixins: [o, a],
            propTypes: {
                msg: React.PropTypes.instanceOf(r).isRequired
            },
            canLoad: function () {
                return _.contains([r.URL_STATE.URL, r.URL_STATE.STATUS_200], this.props.msg.urlState)
            },
            canRMR: function () {
                return _.contains([r.URL_STATE.NO_URL, r.URL_STATE.STATUS_ERR], this.props.msg.urlState)
            },
            getInitialState: function () {
                this.retry = 0;
                var e = this.props.msg,
                    t = e.url;
                return t && (this.canLoad() ? this.isImageLoaded(t) && e.urlState200(t) : this.canRMR() && this.preloadImage(t)), {
                    urlState: this.async("msg.urlState"),
                    url: this.async("msg.url")
                }
            },
            componentDidMount: function () {
                this.regNativeListener(window, "online", this.ensureImageLoaded);
                var e = this.props.msg;
                e.urlState === r.URL_STATE.NO_URL && e.requestMediaReupload()
            },
            componentWillUpdate: function (e, t) {
                t.url !== this.state.url && this.canLoad() && this.preloadImage(t.url)
            },
            ensureImageLoaded: function () {
                var e = this.props.msg;
                e.url && e.urlState !== r.URL_STATE.STATUS_200 && this.preloadImage(e.url)
            },
            isImageLoaded: function (e) {
                if (!e) return !1;
                var t = new Image;
                return t.src = e, t.complete
            },
            preloadImage: function (e) {
                if (e) {
                    this.preloadImagePromise && this.preloadImagePromise.cancel();
                    var t = p.define("ImageError"),
                        n = this.preloadImagePromise = new Promise(function (n, r) {
                            var o = function (n) {
                                    var o = new t(n);
                                    o.src = e, r(o)
                                },
                                a = new Image;
                            a.onload = function () {
                                n(e)
                            }, a.onerror = o, a.src = e
                        }).cancellable(),
                        r = this;
                    n.then(this.onImgLoad)["catch"](Promise.CancellationError, _.noop)["catch"](t, this.onImgError)["finally"](function () {
                        n === r.preloadImagePromise && delete r.preloadImagePromise
                    })
                }
            },
            onImgLoad: function (e) {
                this.props.msg.urlState200(e)
            },
            onImgError: function (e) {
                this.props.msg.mediaLoadError(e.src)
            },
            onImageClick: function (e) {
                e.stopPropagation()
            },
            render: function () {
                var e = this.props.msg,
                    t = {
                        "media-viewer-img": !0
                    };
                switch (this.state.urlState) {
                case r.URL_STATE.STATUS_200:
                    return React.createElement(c, {
                        onClick: this.onImageClick,
                        src: e.url,
                        className: h(t),
                        ref: "media"
                    });
                default:
                    return React.createElement(y, {
                        msg: e
                    })
                }
            }
        }),
        b = React.createClass({
            displayName: "MediaVideo",
            mixins: [o, a],
            propTypes: {
                msg: React.PropTypes.instanceOf(r).isRequired
            },
            getInitialState: function () {
                this.retry = 0;
                this.props.msg;
                return {
                    urlState: this.async("msg.urlState"),
                    mmsSrc: this.async("msg.mmsSrc")
                }
            },
            componentDidMount: function () {
                var e = this.props.msg;
                e.urlState === r.URL_STATE.NO_URL && e.requestMediaReupload()
            },
            onPlayerClick: function (e) {
                e.stopPropagation();
                var t = this.refs.player.getDOMNode();
                e.clientY > t.clientHeight + t.offsetTop - 44 || (t.paused ? t.play() : t.pause())
            },
            onPlayerError: function (e) {
                var t = e.target.src,
                    n = e.target.error;
                switch (n.code) {
                case MediaError.MEDIA_ERR_NETWORK:
                case MediaError.MEDIA_ERR_DECODE:
                case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
                    this.props.msg.mediaLoadError(t);
                    break;
                default:
                    Wa.debug("media viewer unknown error", n.code, t)
                }
            },
            onPlayerPlay: function (e) {
                this.props.msg.urlState200(e.target.src)
            },
            render: function () {
                var e = this.props.msg,
                    t = {
                        "media-viewer-img": !0
                    };
                switch (this.state.urlState) {
                case r.URL_STATE.URL:
                case r.URL_STATE.STATUS_200:
                    return React.createElement(u, {
                        src: e.mmsSrc,
                        ref: "player",
                        className: h(t),
                        onPlay: this.onPlayerPlay,
                        onClick: this.onPlayerClick,
                        onError: this.onPlayerError,
                        controls: !0
                    }, l10n.t("video_playback_not_supported"));
                default:
                    return React.createElement(y, {
                        msg: e
                    })
                }
            }
        }),
        y = React.createClass({
            displayName: "BlurredImage",
            render: function () {
                var e = this.props.msg,
                    t = "data:image/jpeg;base64," + e.body,
                    n = Wa.boundHeightWidth(10 * e.height, 10 * e.width, 500, 500),
                    r = {
                        width: n.width,
                        height: n.height
                    };
                return React.createElement("div", {
                    className: "media-viewer-blur-crop",
                    style: r
                }, React.createElement("img", {
                    className: "media-viewer-blur-img",
                    src: t
                }))
            }
        }),
        A = React.createClass({
            displayName: "MediaAudio",
            mixins: [o, a],
            propTypes: {
                msg: React.PropTypes.instanceOf(r).isRequired
            },
            getInitialState: function () {
                this.retry = 0;
                this.props.msg;
                return {
                    urlState: this.async("msg.urlState"),
                    mmsSrc: this.async("msg.mmsSrc")
                }
            },
            componentDidMount: function () {
                var e = this.props.msg;
                e.urlState === r.URL_STATE.NO_URL && e.requestMediaReupload()
            },
            onPlayerClick: function (e) {
                e.stopPropagation()
            },
            onPlayerError: function (e) {
                var t = e.target.src,
                    n = e.target.error;
                switch (n.code) {
                case MediaError.MEDIA_ERR_NETWORK:
                case MediaError.MEDIA_ERR_DECODE:
                case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
                    this.props.msg.mediaLoadError(t);
                    break;
                default:
                    Wa.debug("media viewer unknown error", n.code, t)
                }
            },
            onPlayerPlay: function (e) {
                this.props.msg.urlState200(e.target.src)
            },
            render: function () {
                var e = this.props.msg,
                    t = {
                        "media-viewer-img": !0,
                        "media-viewer-audio": !0
                    };
                switch (this.state.urlState) {
                case r.URL_STATE.URL:
                case r.URL_STATE.STATUS_200:
                    return React.createElement(l, {
                        src: e.mmsSrc,
                        ref: "player",
                        className: h(t),
                        onClick: this.onPlayerClick,
                        onPlay: this.onPlayerPlay,
                        onError: this.onPlayerError,
                        autoPlay: !0,
                        controls: !0
                    }, l10n.t("audio_playback_not_supported"));
                default:
                    return React.createElement("div", {
                        className: "image-audio"
                    })
                }
            }
        }),
        E = React.createClass({
            displayName: "MediaState",
            mixins: [o],
            propTypes: {
                msg: React.PropTypes.instanceOf(r).isRequired
            },
            getInitialState: function () {
                return {
                    urlState: this.async("msg.urlState")
                }
            },
            initializeMedia: function (e) {
                e.stopPropagation(), this.props.msg.initializeMedia()
            },
            requestMediaReupload: function (e) {
                e.stopPropagation(), this.props.msg.requestMediaReupload()
            },
            cancelMediaReupload: function (e) {
                e.stopPropagation(), this.props.msg.urlState = r.URL_STATE.NO_URL
            },
            captureClick: function (e) {
                e.stopPropagation()
            },
            render: function () {
                var e = this.props.msg;
                switch (this.state.urlState) {
                case r.URL_STATE.STATUS_200:
                    return null;
                case r.URL_STATE.NO_URL:
                case r.URL_STATE.RMR_ERROR_RETRY:
                case r.URL_STATE.STATUS_ERR:
                    return React.createElement("div", {
                        onClick: this.requestMediaReupload
                    }, React.createElement(d.Download, {
                        filesize: e.size
                    }));
                case r.URL_STATE.REFRESH_RETRY:
                    return React.createElement("div", {
                        onClick: this.initializeMedia
                    }, React.createElement(d.Download, {
                        filesize: e.size
                    }));
                case r.URL_STATE.INIT:
                case r.URL_STATE.REFRESHING:
                case r.URL_STATE.URL:
                    return React.createElement(d.Pending, null);
                case r.URL_STATE.RMR_FETCHING:
                    return "image" === e.type ? React.createElement("div", {
                        onClick: this.cancelMediaReupload
                    }, React.createElement(d.Pending, null)) : null;
                case r.URL_STATE.RMR_ERROR_MISSING:
                    return React.createElement("div", {
                        onClick: this.captureClick
                    }, React.createElement(d.Missing, {
                        msg: e
                    }));
                case r.URL_STATE.UPLOADING:
                    return null
                }
            }
        });
    e.exports = f
}, function (e, t, n) {
    var r = n(48),
        o = React.createClass({
            displayName: "Draggable",
            mixins: [r],
            propTypes: {
                children: React.PropTypes.node.isRequired,
                start: React.PropTypes.shape({
                    x: React.PropTypes.number,
                    y: React.PropTypes.number
                }),
                scale: React.PropTypes.number,
                container: React.PropTypes.shape({
                    width: React.PropTypes.number.isRequired,
                    height: React.PropTypes.number.isRequired
                }),
                onStart: React.PropTypes.func,
                onDrag: React.PropTypes.func,
                onStop: React.PropTypes.func
            },
            getInitialState: function () {
                return {
                    dragging: !1,
                    x: 0,
                    y: 0,
                    offsetX: 0,
                    offsetY: 0
                }
            },
            componentDidMount: function () {
                this.updateContainer()
            },
            componentWillReceiveProps: function (e) {
                this.updateContainer(e)
            },
            updateContainer: function (e) {
                var t = this.props.container;
                if (t && this.refs.draggable) {
                    e = e || this.props;
                    var n = this.refs.draggable.getDOMNode(),
                        r = this.state.x,
                        o = this.state.y,
                        a = n.width * e.scale,
                        i = n.height * e.scale;
                    (r + a < t.width || o + i < t.height) && (r = 0, o = 0), this.setState({
                        width: a,
                        height: i,
                        x: r,
                        y: o
                    }), e.onDrag && r && o && e.onDrag(r, o)
                }
            },
            handleMouseDown: function (e) {
                return this.setState({
                    dragging: !0,
                    offsetX: e.clientX - this.state.x,
                    offsetY: e.clientY - this.state.y
                }), this.regNativeListener(window, "mousemove", this.handleMouseMove), this.regNativeListener(window, "mouseup", this.handleMouseUp), this.props.onStart && this.props.onStart(), !1
            },
            handleMouseUp: function () {
                this.unregisterListeners(), this.setState({
                    dragging: !1
                }), this.props.onStop && this.props.onStop(this.state.x, this.state.y)
            },
            handleMouseMove: function (e) {
                if (this.state.dragging) {
                    var t = e.clientX - this.state.offsetX,
                        n = e.clientY - this.state.offsetY,
                        r = this.props.container;
                    r && ((t > 0 || t + this.state.width < r.width) && (t = this.state.x), (n > 0 || n + this.state.height < r.height) && (n = this.state.y)), this.setState({
                        x: t,
                        y: n
                    }), this.props.onDrag && this.props.onDrag(t, n)
                }
            },
            render: function () {
                var e = this.props.scale ? "scale(" + this.props.scale + ")" : "",
                    t = {
                        cursor: this.state.dragging ? "-webkit-grabbing" : "-webkit-grab",
                        transform: "translate(" + this.state.x + "px, " + this.state.y + "px) " + e
                    };
                return React.addons.cloneWithProps(React.Children.only(this.props.children), {
                    style: t,
                    draggable: !0,
                    ref: "draggable",
                    className: "draggable",
                    onMouseDown: this.handleMouseDown
                })
            }
        });
    e.exports = o
}, function (e, t, n) {
    var r = n(224),
        o = n(198),
        a = n(31),
        i = React.createClass({
            displayName: "CaptureModal",
            propTypes: {
                onSend: React.PropTypes.func.isRequired
            },
            onCancel: function () {
                a.closeModal()
            },
            onSend: function (e) {
                this.props.onSend(e), this.onCancel()
            },
            render: function () {
                return React.createElement(r, {
                    size: r.LARGE
                }, React.createElement(o, {
                    onBack: this.onCancel,
                    onSend: this.onSend,
                    noContainer: !0
                }))
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(161),
        o = n(163).Contact,
        a = n(164),
        i = React.createClass({
            displayName: "ContactList",
            propTypes: {
                contacts: React.PropTypes.array.isRequired,
                controls: React.PropTypes.oneOf(Object.keys(o.Controls)).isRequired,
                onControl: React.PropTypes.func.isRequired,
                scrollTarget: React.PropTypes.any,
                flags: React.PropTypes.object
            },
            getDefaultProps: function () {
                return {
                    flags: {}
                }
            },
            render: function () {
                for (var e = this.props.contacts, t = [], n = e.length > 10, i = "XXX", s = 0; s < e.length; s++) {
                    if (n) {
                        var c = e[s].header;
                        c !== i && (t.push(React.createElement(a, {
                            key: c,
                            header: c
                        })), i = c)
                    }
                    var u = Wa.widToKey(e[s].get("id")),
                        l = !1;
                    this.props.flags.enableCursor && 0 === s && (l = !0), t.push(React.createElement(o, {
                        contact: e[s],
                        cursor: l,
                        asyncDelay: 500,
                        flags: this.props.flags,
                        controls: this.props.controls,
                        onControl: this.props.onControl,
                        key: u
                    }))
                }
                return React.createElement(r, {
                    scrollTarget: this.props.scrollTarget,
                    classes: ["chatlist"],
                    data: t,
                    height: 72,
                    extraItems: 4
                })
            }
        });
    e.exports = i
}, function (e, t, n) {
    var r = n(48),
        o = React.addons.PureRenderMixin,
        a = React.createClass({
            displayName: "Video",
            mixins: [r, o],
            propTypes: {
                src: React.PropTypes.string.isRequired,
                onPlay: React.PropTypes.func
            },
            componentDidMount: function () {
                var e = this.getDOMNode(),
                    t = this;
                this.regNativeListener(e, "playing", function (n) {
                    e.videoHeight && e.videoWidth || (e.pause(), e.play()), e.videoHeight && e.videoWidth && t.props.onPlay(n)
                })
            },
            render: function () {
                return React.createElement("video", React.__spread({}, this.props))
            }
        });
    e.exports = a
}, function (e, t, n) {
    var r = n(48),
        o = {
            COVER: "cover",
            SCALE_DOWN: "scaleDown"
        },
        a = React.createClass({
            displayName: "ObjectFit",
            mixins: [r],
            propTypes: {
                children: React.PropTypes.renderable.isRequired,
                type: React.PropTypes.oneOf(_.values(o)).isRequired,
                size: React.PropTypes.shape({
                    width: React.PropTypes.number.isRequired,
                    height: React.PropTypes.number.isRequired
                })
            },
            statics: {
                TYPES: o
            },
            getInitialState: function () {
                return {
                    style: this.props.size
                }
            },
            componentDidMount: function () {
                this.initialize();
                var e = this;
                this.regNativeListener(window, "resize", function () {
                    e.initialize()
                })
            },
            componentWillReceiveProps: function (e) {
                this.initialize(e)
            },
            initialize: function (e) {
                e = e || this.props, e.size && this.setState({
                    style: this[e.type](e.size.width, e.size.height)
                })
            },
            cover: function (e, t) {
                var n = this.getDOMNode(),
                    r = n.clientWidth,
                    o = n.clientHeight,
                    a = e,
                    i = t,
                    s = 0,
                    c = 0;
                return r > a && (i *= r / a, a = r, i > o && (s = o / 2 - i / 2)), o > i && (a *= o / i, i = o, a > r && (c = r / 2 - a / 2)), {
                    width: a,
                    height: i,
                    top: s,
                    left: c,
                    position: "absolute"
                }
            },
            scaleDown: function (e, t) {
                var n = this.getDOMNode(),
                    r = n.clientWidth,
                    o = n.clientHeight,
                    a = t,
                    i = e;
                return a > o && (a = o, i = e * (o / t)), i > r && (i = r, a = t * (r / e)), {
                    width: i,
                    height: a
                }
            },
            render: function () {
                var e = {
                    container: {
                        width: "100%",
                        height: "100%",
                        position: "absolute",
                        overflow: "hidden"
                    },
                    wrapper: {
                        display: "none"
                    }
                };
                return React.createElement("div", {
                    style: e.container
                }, React.createElement("div", {
                    style: this.state.style || e.wrapper
                }, this.props.children))
            }
        });
    e.exports = a
}, function (e, t, n) {
    var r = n(30),
        o = n(47),
        a = n(45),
        i = n(33),
        s = n(26),
        c = React.createClass({
            displayName: "ImageTag",
            mixins: [o],
            propTypes: {
                src: React.PropTypes.string.isRequired,
                className: React.PropTypes.string,
                style: React.PropTypes.object,
                width: React.PropTypes.number,
                height: React.PropTypes.number,
                onLoad: React.PropTypes.func,
                onClick: React.PropTypes.func,
                onError: React.PropTypes.func
            },
            getInitialState: function () {
                var e = new Image;
                return e.src = this.props.src, e.complete ? {
                    src: this.props.src
                } : (this.ensureLoaded(this.props.src), {
                    src: null
                })
            },
            componentWillReceiveProps: function (e) {
                this.props.src !== e.src && this.ensureLoaded(e.src)
            },
            componentWillUnmount: function () {
                this.ensureLoadedPromise && this.ensureLoadedPromise.cancel()
            },
            ensureLoaded: function (e) {
                var t = this;
                this.ensureLoadedPromise && this.ensureLoadedPromise.cancel();
                var n = i.define("ImageError");
                this.ensureLoadedPromise = a.loopOnError(i.ShouldLoop, Promise.TimeoutError, function (o) {
                    var s;
                    return s = r.state === r.STATE.CONNECTED ? Promise.delay(1e3 * Wa.expBackoff(o, 60)) : a.waitForBBEvent(r, "change:state", _.matches({
                        state: r.STATE.CONNECTED
                    })), o > 0 && Wa.isHttpUrl(e) && (s = s.then(function () {
                        return new Promise(function (t, r) {
                            Wa.ajax(e, null, function (o) {
                                if (o.status >= 200 && o.status < 400) t();
                                else {
                                    var a = new n;
                                    a.src = e, a.target = {
                                        src: e
                                    }, r(a)
                                }
                            }, function () {
                                r(new i.ShouldLoop)
                            })
                        })
                    }).timeout(3e4)), s.then(function () {
                        return new Promise(function (t, r) {
                            var o = function (t) {
                                    var o = new n(t);
                                    o.src = e, o.target = {
                                        src: e
                                    }, r(o)
                                },
                                a = new Image;
                            a.onload = function () {
                                t(e)
                            }, a.onerror = o, a.src = e
                        })
                    }).then(function (e) {
                        t.isMounted() && t.setState({
                            src: e
                        })
                    })
                })["catch"](Promise.CancellationError, _.noop)["catch"](n, this.props.onError || _.noop)["finally"](function () {
                    delete t.ensureLoadedPromise
                })
            },
            render: function () {
                var e, t;
                return this.state.src ? (t = this.state.src, e = this.props.onLoad) : (t = s.ONE_BY_ONE_TRANS_GIF, e = null), React.createElement("img", {
                    src: t,
                    width: this.props.width,
                    height: this.props.height,
                    className: this.props.className,
                    style: this.props.style,
                    onLoad: e,
                    onClick: this.props.onClick,
                    onError: this.props.onError
                })
            }
        });
    e.exports = c
}, function (e) {
    function t() {
        if (!a) {
            a = !0;
            for (var e, t = o.length; t;) {
                e = o, o = [];
                for (var n = -1; ++n < t;) e[n]();
                t = o.length
            }
            a = !1
        }
    }
    function n() {}
    var r = e.exports = {},
        o = [],
        a = !1;
    r.nextTick = function (e) {
        o.push(e), a || setTimeout(t, 0)
    }, r.title = "browser", r.browser = !0, r.env = {}, r.argv = [], r.version = "", r.on = n, r.addListener = n, r.once = n, r.off = n, r.removeListener = n, r.removeAllListeners = n, r.emit = n, r.binding = function () {
        throw new Error("process.binding is not supported")
    }, r.cwd = function () {
        return "/"
    }, r.chdir = function () {
        throw new Error("process.chdir is not supported")
    }, r.umask = function () {
        return 0
    }
}, function (e) {
    function t(e, t) {
        var n = e.getContext("2d"),
            r = n.getImageData(0, 0, t.width, t.height);
        e.width = t.width, e.height = t.height, n.putImageData(r, 0, 0)
    }
    e.exports = t
}, function (e) {
    function t(e, t) {
        var n = new Image;
        return t && (n.onload = t.bind(null, n)), n.src = e, n
    }
    e.exports = t
}, function (e, t, n) {
    var r = n(225).ExifReader;
    e.exports = function (e) {
        var t = new r;
        return t.load(e), t.getAllTags()
    }
}, function (e) {
    function t(e) {
        return e.split(";")[0].slice(5)
    }
    e.exports = function (e) {
        for (var n = e.split(",")[1], r = atob(n), o = new ArrayBuffer(r.length), a = new Uint8Array(o), i = 0; i < r.length; i++) a[i] = r.charCodeAt(i);
        return a.type = t(e), a
    }
}, function (e) {
    e.exports = function (e, t) {
        var n = t.x || 0,
            r = t.y || 0;
        t.degrees && (t.radians = t.degrees * (Math.PI / 180)), e.translate(n, r), e.rotate(t.radians), e.translate(-n, -r)
    }
}, function (e) {
    function t(e, t) {
        return e[t] << 24 | e[t + 1] << 16 | e[t + 2] << 8 | e[t + 3]
    }
    function n(e) {
        return {
            width: t(e, 16),
            height: t(e, 20)
        }
    }
    e.exports = n
}, function (e) {
    function t(e, t) {
        return e[t] << 8 | e[t + 1]
    }
    function n(e) {
        var n = e.length,
            o = 0,
            a = 255 == e[0] && 216 == e[1];
        if (a) for (o += 2; n > o;) {
            for (; 255 != e[o];) o++;
            for (; 255 == e[o];) o++; {
                if (r[e[o]]) {
                    var i = t(e, o + 6),
                        s = t(e, o + 4);
                    return {
                        width: i,
                        height: s
                    }
                }
                o += t(e, ++o)
            }
        }
    }
    e.exports = n;
    var r = {
        192: !0,
        193: !0,
        194: !0,
        195: !0,
        197: !0,
        198: !0,
        199: !0,
        201: !0,
        202: !0,
        203: !0,
        205: !0,
        206: !0,
        207: !0
    }
}, function (e) {
    /**
     * filesize
     *
     * @author Jason Mulligan <jason.mulligan@avoidwork.com>
     * @copyright 2014 Jason Mulligan
     * @license BSD-3 <https://raw.github.com/avoidwork/filesize.js/master/LICENSE>
     * @link http://filesizejs.com
     * @module filesize
     * @version 2.0.4
     */
    !
    function (t) {
        "use strict";

        function n(e, t) {
            var n, c, u, l, d, p, h, g, f, m, b, y, _ = "",
                A = !1,
                E = 0;
            if (isNaN(e)) throw new Error("Invalid arguments");
            return t = t || {}, u = t.bits === !0, g = t.unix === !0, c = void 0 !== t.base ? t.base : g ? 2 : 10, h = void 0 !== t.round ? t.round : g ? 1 : 2, f = void 0 !== t.spacer ? t.spacer : g ? "" : " ", y = void 0 !== t.suffixes ? t.suffixes : {}, p = Number(e), d = 0 > p, l = c > 2 ? 1e3 : 1024, d && (p = -p), 0 === p ? g ? _ = "0" : (m = "B", _ = "0" + f + (y[m] || m)) : (n = Math.floor(Math.log(p) / Math.log(1e3)), n > 8 && (E = 1e3 * E * (n - 8), n = 8), E = 2 === c ? p / Math.pow(2, 10 * n) : p / Math.pow(1e3, n), u && (E = 8 * E, E > l && (E /= l, n++)), _ = E.toFixed(n > 0 ? h : 0), m = s[u ? "bits" : "bytes"][n], !A && g ? (u && r.test(m) && (m = m.toLowerCase()), m = m.charAt(0), b = _.replace(a, ""), "B" === m ? m = "" : u || "k" !== m || (m = "K"), i.test(b) && (_ = parseInt(_, o).toString()), _ += f + (y[m] || m)) : g || (_ += f + (y[m] || m))), d && (_ = "-" + _), _
        }
        var r = /b$/,
            o = 10,
            a = /.*\./,
            i = /^0$/,
            s = {
                bits: ["B", "kb", "Mb", "Gb", "Tb", "Pb", "Eb", "Zb", "Yb"],
                bytes: ["B", "kB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"]
            };
        e.exports = n
    }(this)
}, function (e, t, n) {
    var r = n(30),
        o = n(46),
        a = n(48),
        i = n(79),
        s = n(31),
        c = React.createClass({
            displayName: "VideoTag",
            mixins: [o, a, i],
            propTypes: {
                src: React.PropTypes.string.isRequired,
                className: React.PropTypes.string,
                controls: React.PropTypes.bool,
                width: React.PropTypes.number,
                height: React.PropTypes.number,
                onClick: React.PropTypes.func,
                onPlay: React.PropTypes.func,
                onError: React.PropTypes.func
            },
            componentDidMount: function () {
                var e = this.getDOMNode();
                this.regNativeListener(e, "playing", this.onPlaying), this.regCmd("mediaPlaying", this.onOtherPlaying), this.regNativeListener(e, "error", this.onPlayerError), Wa.isGecko && (this.checkIteration = 0, this.checkForSuccessInterval = this.safeInterval(this.checkForSuccess, 250))
            },
            clearCheckForSuccess: function () {
                this.checkForSuccessInterval && (this.clearSafeInterval(this.checkForSuccessInterval), delete this.checkForSuccessInterval, delete this.checkIteration)
            },
            checkForSuccess: function () {
                if (r.state === r.STATE.CONNECTED) {
                    if (this.checkIteration++, this.checkIteration > 240) return void this.onPlayerError({
                        target: {
                            src: this.props.src,
                            error: {
                                code: MediaError.MEDIA_ERR_NETWORK
                            }
                        }
                    });
                    var e = this.getDOMNode(),
                        t = e.buffered;
                    t && t.length && t.end(0) > 0 && this.onPlaying({
                        target: {
                            src: this.props.src
                        }
                    })
                }
            },
            onPlayerError: function (e) {
                this.clearCheckForSuccess(), this.props.onError && this.props.onError(e)
            },
            onOtherPlaying: function (e) {
                e !== this && (this.clearCheckForSuccess(), this.getDOMNode().pause())
            },
            onPlaying: function (e) {
                this.clearCheckForSuccess(), s.mediaPlaying(this), this.props.onPlay && this.props.onPlay(e)
            },
            render: function () {
                var e = {
                    height: this.props.height,
                    width: this.props.width
                };
                return React.createElement("video", {
                    src: this.props.src,
                    style: e,
                    width: this.props.width,
                    height: this.props.height,
                    className: this.props.className,
                    onClick: this.props.onClick,
                    controls: this.props.controls,
                    autoPlay: !0
                }, this.props.children)
            }
        });
    e.exports = c
}, function (e) {
    var t = React.createClass({
        displayName: "Modal",
        propTypes: {
            size: React.PropTypes.oneOf(["small", "large"]),
            classes: React.PropTypes.string,
            title: React.PropTypes.string,
            children: React.PropTypes.node.isRequired
        },
        getDefaultProps: function () {
            return {
                classes: "",
                size: "small"
            }
        },
        statics: {
            SMALL: "small",
            LARGE: "large"
        },
        render: function () {
            var e = this.props.title ? React.createElement("div", {
                className: "popup-title"
            }, this.props.title) : null,
                n = "popup " + this.props.classes;
            return this.props.size === t.LARGE && (n += " popup-l"), React.createElement("div", {
                className: "backdrop"
            }, React.createElement("div", {
                className: n
            }, e, React.createElement("div", {
                className: "popup-body"
            }, this.props.children)))
        }
    });
    e.exports = t
}, function (e, t) {
    (function () {
        var e = function (e, t) {
                return function () {
                    return e.apply(t, arguments)
                }
            };
        ("undefined" != typeof t && null !== t ? t : this).ExifReader = function () {
            function t() {
                this._getTagValueAt = {
                    1: e(function (e) {
                        return this._getByteAt(e)
                    }, this),
                    2: e(function (e) {
                        return this._getAsciiAt(e)
                    }, this),
                    3: e(function (e) {
                        return this._getShortAt(e)
                    }, this),
                    4: e(function (e) {
                        return this._getLongAt(e)
                    }, this),
                    5: e(function (e) {
                        return this._getRationalAt(e)
                    }, this),
                    7: e(function (e) {
                        return this._getUndefinedAt(e)
                    }, this),
                    9: e(function (e) {
                        return this._getSlongAt(e)
                    }, this),
                    10: e(function (e) {
                        return this._getSrationalAt(e)
                    }, this)
                }
            }
            return t.prototype._tiffHeaderOffset = 12, t.prototype.load = function (e) {
                return this.loadView(new DataView(e))
            }, t.prototype.loadView = function (e) {
                return this._dataView = e, this._tags = {}, this._checkImageHeader(), this._readTags()
            }, t.prototype._checkImageHeader = function () {
                if (this._dataView.byteLength < 12 || 4292411361 !== this._dataView.getUint32(0, !1) || 1165519206 !== this._dataView.getUint32(6, !1) || 0 !== this._dataView.getUint16(10, !1)) throw "Invalid image format or no Exif data"
            }, t.prototype._readTags = function () {
                return this._setByteOrder(), this._read0thIfd(), this._readExifIfd(), this._readGpsIfd(), this._readInteroperabilityIfd()
            }, t.prototype._setByteOrder = function () {
                if (18761 === this._dataView.getUint16(this._tiffHeaderOffset)) return this._littleEndian = !0;
                if (19789 === this._dataView.getUint16(this._tiffHeaderOffset)) return this._littleEndian = !1;
                throw "Illegal byte order value. Faulty image."
            }, t.prototype._read0thIfd = function () {
                var e;
                return e = this._getIfdOffset(), this._readIfd("0th", e)
            }, t.prototype._getIfdOffset = function () {
                return this._tiffHeaderOffset + this._getLongAt(this._tiffHeaderOffset + 4)
            }, t.prototype._readExifIfd = function () {
                var e;
                return null != this._tags["Exif IFD Pointer"] ? (e = this._tiffHeaderOffset + this._tags["Exif IFD Pointer"].value, this._readIfd("exif", e)) : void 0
            }, t.prototype._readGpsIfd = function () {
                var e;
                return null != this._tags["GPS Info IFD Pointer"] ? (e = this._tiffHeaderOffset + this._tags["GPS Info IFD Pointer"].value, this._readIfd("gps", e)) : void 0
            }, t.prototype._readInteroperabilityIfd = function () {
                var e;
                return null != this._tags["Interoperability IFD Pointer"] ? (e = this._tiffHeaderOffset + this._tags["Interoperability IFD Pointer"].value, this._readIfd("interoperability", e)) : void 0
            }, t.prototype._readIfd = function (e, t) {
                var n, r, o, a;
                for (r = this._getShortAt(t), t += 2, a = [], n = 0; r >= 0 ? r > n : n > r; r >= 0 ? n++ : n--) o = this._readTag(e, t), this._tags[o.name] = {
                    value: o.value,
                    description: o.description
                }, a.push(t += 12);
                return a
            }, t.prototype._readTag = function (e, t) {
                var n, r, o, a, i, s, c;
                return n = this._getShortAt(t), i = this._getShortAt(t + 2), r = this._getLongAt(t + 4), this._typeSizes[i] * r <= 4 ? s = this._getTagValue(t + 8, i, r) : (c = this._getLongAt(t + 8), s = this._getTagValue(this._tiffHeaderOffset + c, i, r)), i === this._tagTypes.ASCII && (s = this._splitNullSeparatedAsciiString(s)), null != this._tagNames[e][n] ? (null != this._tagNames[e][n].name && null != this._tagNames[e][n].description ? (a = this._tagNames[e][n].name, o = this._tagNames[e][n].description(s)) : (a = this._tagNames[e][n], o = s instanceof Array ? s.join(", ") : s), {
                    name: a,
                    value: s,
                    description: o
                }) : {
                    name: "undefined-" + n,
                    value: s,
                    description: s
                }
            }, t.prototype._getTagValue = function (e, t, n) {
                var r, o, a;
                return o = function () {
                    var o;
                    for (o = [], a = 0; n >= 0 ? n > a : a > n; n >= 0 ? a++ : a--) r = this._getTagValueAt[t](e), e += this._typeSizes[t], o.push(r);
                    return o
                }.call(this), 1 === o.length ? o = o[0] : t === this._tagTypes.ASCII && (o = this._getAsciiValue(o)), o
            }, t.prototype._getAsciiValue = function (e) {
                var t, n;
                return n = function () {
                    var n, r, o;
                    for (o = [], n = 0, r = e.length; r > n; n++) t = e[n], o.push(String.fromCharCode(t));
                    return o
                }()
            }, t.prototype._getByteAt = function (e) {
                return this._dataView.getUint8(e)
            }, t.prototype._getAsciiAt = function (e) {
                return this._dataView.getUint8(e)
            }, t.prototype._getShortAt = function (e) {
                return this._dataView.getUint16(e, this._littleEndian)
            }, t.prototype._getLongAt = function (e) {
                return this._dataView.getUint32(e, this._littleEndian)
            }, t.prototype._getRationalAt = function (e) {
                return this._getLongAt(e) / this._getLongAt(e + 4)
            }, t.prototype._getUndefinedAt = function (e) {
                return this._getByteAt(e)
            }, t.prototype._getSlongAt = function (e) {
                return this._dataView.getInt32(e, this._littleEndian)
            }, t.prototype._getSrationalAt = function (e) {
                return this._getSlongAt(e) / this._getSlongAt(e + 4)
            }, t.prototype._splitNullSeparatedAsciiString = function (e) {
                var t, n, r, o, a;
                for (r = [], n = 0, o = 0, a = e.length; a > o; o++) t = e[o], "\x00" !== t ? (null == r[n] && (r[n] = ""), r[n] += t) : n++;
                return r
            }, t.prototype._typeSizes = {
                1: 1,
                2: 1,
                3: 2,
                4: 4,
                5: 8,
                7: 1,
                9: 4,
                10: 8
            }, t.prototype._tagTypes = {
                BYTE: 1,
                ASCII: 2,
                SHORT: 3,
                LONG: 4,
                RATIONAL: 5,
                UNDEFINED: 7,
                SLONG: 9,
                SRATIONAL: 10
            }, t.prototype._tagNames = {
                "0th": {
                    256: "ImageWidth",
                    257: "ImageLength",
                    258: "BitsPerSample",
                    259: "Compression",
                    262: "PhotometricInterpretation",
                    270: "ImageDescription",
                    271: "Make",
                    272: "Model",
                    273: "StripOffsets",
                    274: {
                        name: "Orientation",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "top-left";
                            case 2:
                                return "top-right";
                            case 3:
                                return "bottom-right";
                            case 4:
                                return "bottom-left";
                            case 5:
                                return "left-top";
                            case 6:
                                return "right-top";
                            case 7:
                                return "right-bottom";
                            case 8:
                                return "left-bottom";
                            default:
                                return "Undefined"
                            }
                        }
                    },
                    277: "SamplesPerPixel",
                    278: "RowsPerStrip",
                    279: "StripByteCounts",
                    282: "XResolution",
                    283: "YResolution",
                    284: "PlanarConfiguration",
                    296: {
                        name: "ResolutionUnit",
                        description: function (e) {
                            switch (e) {
                            case 2:
                                return "inches";
                            case 3:
                                return "centimeters";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    301: "TransferFunction",
                    305: "Software",
                    306: "DateTime",
                    315: "Artist",
                    318: "WhitePoint",
                    319: "PrimaryChromaticities",
                    513: "JPEGInterchangeFormat",
                    514: "JPEGInterchangeFormatLength",
                    529: "YCbCrCoefficients",
                    530: "YCbCrSubSampling",
                    531: {
                        name: "YCbCrPositioning",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "centered";
                            case 2:
                                return "co-sited";
                            default:
                                return "undefied " + e
                            }
                        }
                    },
                    532: "ReferenceBlackWhite",
                    33432: {
                        name: "Copyright",
                        description: function (e) {
                            return e.join("; ")
                        }
                    },
                    34665: "Exif IFD Pointer",
                    34853: "GPS Info IFD Pointer"
                },
                exif: {
                    33434: "ExposureTime",
                    33437: "FNumber",
                    34850: {
                        name: "ExposureProgram",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Undefined";
                            case 1:
                                return "Manual";
                            case 2:
                                return "Normal program";
                            case 3:
                                return "Aperture priority";
                            case 4:
                                return "Shutter priority";
                            case 5:
                                return "Creative program";
                            case 6:
                                return "Action program";
                            case 7:
                                return "Portrait mode";
                            case 8:
                                return "Landscape mode";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    34852: "SpectralSensitivity",
                    34855: "ISOSpeedRatings",
                    34856: {
                        name: "OECF",
                        description: function () {
                            return "[Raw OECF table data]"
                        }
                    },
                    36864: {
                        name: "ExifVersion",
                        description: function (e) {
                            var t, n, r, o;
                            for (n = "", r = 0, o = e.length; o > r; r++) t = e[r], n += String.fromCharCode(t);
                            return n
                        }
                    },
                    36867: "DateTimeOriginal",
                    36868: "DateTimeDigitized",
                    37121: {
                        name: "ComponentsConfiguration",
                        description: function (e) {
                            var t, n, r, o;
                            for (n = "", r = 0, o = e.length; o > r; r++) switch (t = e[r]) {
                            case 49:
                                n += "Y";
                                break;
                            case 50:
                                n += "Cb";
                                break;
                            case 51:
                                n += "Cr";
                                break;
                            case 52:
                                n += "R";
                                break;
                            case 53:
                                n += "G";
                                break;
                            case 54:
                                n += "B"
                            }
                            return n
                        }
                    },
                    37122: "CompressedBitsPerPixel",
                    37377: "ShutterSpeedValue",
                    37378: "ApertureValue",
                    37379: "BrightnessValue",
                    37380: "ExposureBiasValue",
                    37381: "MaxApertureValue",
                    37382: "SubjectDistance",
                    37383: {
                        name: "MeteringMode",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "Average";
                            case 2:
                                return "CenterWeightedAverage";
                            case 3:
                                return "Spot";
                            case 4:
                                return "MultiSpot";
                            case 5:
                                return "Pattern";
                            case 6:
                                return "Partial";
                            case 255:
                                return "Other";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    37384: {
                        name: "LightSource",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "Daylight";
                            case 2:
                                return "Fluorescent";
                            case 3:
                                return "Tungsten (incandescent light)";
                            case 4:
                                return "Flash";
                            case 9:
                                return "Fine weather";
                            case 10:
                                return "Cloudy weather";
                            case 11:
                                return "Shade";
                            case 12:
                                return "Daylight fluorescent (D 5700 – 7100K)";
                            case 13:
                                return "Day white fluorescent (N 4600 – 5400K)";
                            case 14:
                                return "Cool white fluorescent (W 3900 – 4500K)";
                            case 15:
                                return "White fluorescent (WW 3200 – 3700K)";
                            case 17:
                                return "Standard light A";
                            case 18:
                                return "Standard light B";
                            case 19:
                                return "Standard light C";
                            case 20:
                                return "D55";
                            case 21:
                                return "D65";
                            case 22:
                                return "D75";
                            case 23:
                                return "D50";
                            case 24:
                                return "ISO studio tungsten";
                            case 255:
                                return "Other light source";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    37385: {
                        name: "Flash",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Flash did not fire";
                            case 1:
                                return "Flash fired";
                            case 5:
                                return "Strobe return light not detected";
                            case 7:
                                return "Strobe return light detected";
                            case 9:
                                return "Flash fired, compulsory flash mode";
                            case 13:
                                return "Flash fired, compulsory flash mode, return light not detected";
                            case 15:
                                return "Flash fired, compulsory flash mode, return light detected";
                            case 16:
                                return "Flash did not fire, compulsory flash mode";
                            case 24:
                                return "Flash did not fire, auto mode";
                            case 25:
                                return "Flash fired, auto mode";
                            case 29:
                                return "Flash fired, auto mode, return light not detected";
                            case 31:
                                return "Flash fired, auto mode, return light detected";
                            case 32:
                                return "No flash function";
                            case 65:
                                return "Flash fired, red-eye reduction mode";
                            case 69:
                                return "Flash fired, red-eye reduction mode, return light not detected";
                            case 71:
                                return "Flash fired, red-eye reduction mode, return light detected";
                            case 73:
                                return "Flash fired, compulsory flash mode, red-eye reduction mode";
                            case 77:
                                return "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected";
                            case 79:
                                return "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected";
                            case 89:
                                return "Flash fired, auto mode, red-eye reduction mode";
                            case 93:
                                return "Flash fired, auto mode, return light not detected, red-eye reduction mode";
                            case 95:
                                return "Flash fired, auto mode, return light detected, red-eye reduction mode";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    37386: "FocalLength",
                    37396: {
                        name: "SubjectArea",
                        description: function (e) {
                            switch (e.length) {
                            case 2:
                                return "Location; X: " + e[0] + ", Y: " + e[1];
                            case 3:
                                return "Circle; X: " + e[0] + ", Y: " + e[1] + ", diameter: " + e[2];
                            case 4:
                                return "Rectangle; X: " + e[0] + ", Y: " + e[1] + ", width: " + e[2] + ", height: " + e[3];
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    37500: {
                        name: "MakerNote",
                        description: function () {
                            return "[Raw maker note data]"
                        }
                    },
                    37510: {
                        name: "UserComment",
                        description: function (e) {
                            switch (e.slice(0, 8).map(function (e) {
                                return String.fromCharCode(e)
                            }).join("")) {
                            case "ASCII\x00\x00\x00":
                                return e.slice(8, e.length).map(function (e) {
                                    return String.fromCharCode(e)
                                }).join("");
                            case "JIS\x00\x00\x00\x00\x00":
                                return "[JIS encoded text]";
                            case "UNICODE\x00":
                                return "[Unicode encoded text]";
                            case "\x00\x00\x00\x00\x00\x00\x00\x00":
                                return "[Undefined encoding]"
                            }
                        }
                    },
                    37520: "SubSecTime",
                    37521: "SubSecTimeOriginal",
                    37522: "SubSecTimeDigitized",
                    40960: {
                        name: "FlashpixVersion",
                        description: function (e) {
                            var t, n, r, o;
                            for (n = "", r = 0, o = e.length; o > r; r++) t = e[r], n += String.fromCharCode(t);
                            return n
                        }
                    },
                    40961: {
                        name: "ColorSpace",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "sRGB";
                            case 65535:
                                return "Uncalibrated";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    40962: "PixelXDimension",
                    40963: "PixelYDimension",
                    40964: "RelatedSoundFile",
                    40965: "Interoperability IFD Pointer",
                    41483: "FlashEnergy",
                    41484: {
                        name: "SpatialFrequencyResponse",
                        description: function () {
                            return "[Raw SFR table data]"
                        }
                    },
                    41486: "FocalPlaneXResolution",
                    41487: "FocalPlaneYResolution",
                    41488: {
                        name: "FocalPlaneResolutionUnit",
                        description: function (e) {
                            switch (e) {
                            case 2:
                                return "inches";
                            case 3:
                                return "centimeters";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41492: {
                        name: "SubjectLocation",
                        description: function (e) {
                            return "X: " + e[0] + ", Y: " + e[1]
                        }
                    },
                    41493: "ExposureIndex",
                    41495: {
                        name: "SensingMethod",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "Undefined";
                            case 2:
                                return "One-chip color area sensor";
                            case 3:
                                return "Two-chip color area sensor";
                            case 4:
                                return "Three-chip color area sensor";
                            case 5:
                                return "Color sequential area sensor";
                            case 7:
                                return "Trilinear sensor";
                            case 8:
                                return "Color sequential linear sensor";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41728: {
                        name: "FileSource",
                        description: function (e) {
                            switch (e) {
                            case 3:
                                return "DSC";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41729: {
                        name: "SceneType",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "A directly photographed image";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41730: {
                        name: "CFAPattern",
                        description: function () {
                            return "[Raw CFA pattern table data]"
                        }
                    },
                    41985: {
                        name: "CustomRendered",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Normal process";
                            case 1:
                                return "Custom process";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41986: {
                        name: "ExposureMode",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Auto exposure";
                            case 1:
                                return "Manual exposure";
                            case 2:
                                return "Auto bracket";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41987: {
                        name: "WhiteBalance",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Auto white balance";
                            case 1:
                                return "Manual white balance";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41988: {
                        name: "DigitalZoomRatio",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Digital zoom was not used";
                            default:
                                return e
                            }
                        }
                    },
                    41989: {
                        name: "FocalLengthIn35mmFilm",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Unknown";
                            default:
                                return e
                            }
                        }
                    },
                    41990: {
                        name: "SceneCaptureType",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Standard";
                            case 1:
                                return "Landscape";
                            case 2:
                                return "Portrait";
                            case 3:
                                return "Night scene";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41991: {
                        name: "GainControl",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "None";
                            case 1:
                                return "Low gain up";
                            case 2:
                                return "High gain up";
                            case 3:
                                return "Low gain down";
                            case 4:
                                return "High gain down";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41992: {
                        name: "Contrast",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Normal";
                            case 1:
                                return "Soft";
                            case 2:
                                return "Hard";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41993: {
                        name: "Saturation",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Normal";
                            case 1:
                                return "Low saturation";
                            case 2:
                                return "High saturation";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41994: {
                        name: "Sharpness",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Normal";
                            case 1:
                                return "Soft";
                            case 2:
                                return "Hard";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    41995: {
                        name: "DeviceSettingDescription",
                        description: function () {
                            return "[Raw device settings table data]"
                        }
                    },
                    41996: {
                        name: "SubjectDistanceRange",
                        description: function (e) {
                            switch (e) {
                            case 1:
                                return "Macro";
                            case 2:
                                return "Close view";
                            case 3:
                                return "Distant view";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    42016: "ImageUniqueID"
                },
                gps: {
                    0: {
                        name: "GPSVersionID",
                        description: function (e) {
                            var t, n;
                            return e[0] === (t = e[1]) && 2 === t && e[2] === (n = e[3]) && 0 === n ? "Version 2.2" : "Unknown"
                        }
                    },
                    1: {
                        name: "GPSLatitudeRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "N":
                                return "North latitude";
                            case "S":
                                return "South latitude";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    2: {
                        name: "GPSLatitude",
                        description: function (e) {
                            return e[0] + e[1] / 60 + e[2] / 3600
                        }
                    },
                    3: {
                        name: "GPSLongitudeRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "E":
                                return "East longitude";
                            case "W":
                                return "West longitude";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    4: {
                        name: "GPSLongitude",
                        description: function (e) {
                            return e[0] + e[1] / 60 + e[2] / 3600
                        }
                    },
                    5: {
                        name: "GPSAltitudeRef",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Sea level";
                            case 1:
                                return "Sea level reference (negative value)";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    6: {
                        name: "GPSAltitude",
                        description: function (e) {
                            return e + " m"
                        }
                    },
                    7: {
                        name: "GPSTimeStamp",
                        description: function (e) {
                            var t;
                            return t = function (e) {
                                var t;
                                return function () {
                                    var n, r;
                                    for (r = [], t = 0, n = 2 - ("" + Math.floor(e)).length; n >= 0 ? n > t : t > n; n >= 0 ? t++ : t--) r.push("0");
                                    return r
                                }() + e
                            }, e.map(t).join(":")
                        }
                    },
                    8: "GPSSatellites",
                    9: {
                        name: "GPSStatus",
                        description: function (e) {
                            switch (e.join("")) {
                            case "A":
                                return "Measurement in progress";
                            case "V":
                                return "Measurement Interoperability";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    10: {
                        name: "GPSMeasureMode",
                        description: function (e) {
                            switch (e.join("")) {
                            case "2":
                                return "2-dimensional measurement";
                            case "3":
                                return "3-dimensional measurement";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    11: "GPSDOP",
                    12: {
                        name: "GPSSpeedRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "K":
                                return "Kilometers per hour";
                            case "M":
                                return "Miles per hour";
                            case "N":
                                return "Knots";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    13: "GPSSpeed",
                    14: {
                        name: "GPSTrackRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "T":
                                return "True direction";
                            case "M":
                                return "Magnetic direction";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    15: "GPSTrack",
                    16: {
                        name: "GPSImgDirectionRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "T":
                                return "True direction";
                            case "M":
                                return "Magnetic direction";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    17: "GPSImgDirection",
                    18: "GPSMapDatum",
                    19: {
                        name: "GPSDestLatitudeRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "N":
                                return "North latitude";
                            case "S":
                                return "South latitude";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    20: {
                        name: "GPSDestLatitude",
                        description: function (e) {
                            return e[0] + e[1] / 60 + e[2] / 3600
                        }
                    },
                    21: {
                        name: "GPSDestLongitudeRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "E":
                                return "East longitude";
                            case "W":
                                return "West longitude";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    22: {
                        name: "GPSDestLongitude",
                        description: function (e) {
                            return e[0] + e[1] / 60 + e[2] / 3600
                        }
                    },
                    23: {
                        name: "GPSDestBearingRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "T":
                                return "True direction";
                            case "M":
                                return "Magnetic direction";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    24: "GPSDestBearing",
                    25: {
                        name: "GPSDestDistanceRef",
                        description: function (e) {
                            switch (e.join("")) {
                            case "K":
                                return "Kilometers";
                            case "M":
                                return "Miles";
                            case "N":
                                return "Knots";
                            default:
                                return "Unknown"
                            }
                        }
                    },
                    26: "GPSDestDistance",
                    27: {
                        name: "GPSProcessingMethod",
                        description: function (e) {
                            switch (e.slice(0, 8).map(function (e) {
                                return String.fromCharCode(e)
                            }).join("")) {
                            case "ASCII\x00\x00\x00":
                                return e.slice(8, e.length).map(function (e) {
                                    return String.fromCharCode(e)
                                }).join("");
                            case "JIS\x00\x00\x00\x00\x00":
                                return "[JIS encoded text]";
                            case "UNICODE\x00":
                                return "[Unicode encoded text]";
                            case "\x00\x00\x00\x00\x00\x00\x00\x00":
                                return "[Undefined encoding]"
                            }
                        }
                    },
                    28: {
                        name: "GPSAreaInformation",
                        description: function (e) {
                            switch (e.slice(0, 8).map(function (e) {
                                return String.fromCharCode(e)
                            }).join("")) {
                            case "ASCII\x00\x00\x00":
                                return e.slice(8, e.length).map(function (e) {
                                    return String.fromCharCode(e)
                                }).join("");
                            case "JIS\x00\x00\x00\x00\x00":
                                return "[JIS encoded text]";
                            case "UNICODE\x00":
                                return "[Unicode encoded text]";
                            case "\x00\x00\x00\x00\x00\x00\x00\x00":
                                return "[Undefined encoding]"
                            }
                        }
                    },
                    29: "GPSDateStamp",
                    30: {
                        name: "GPSDifferential",
                        description: function (e) {
                            switch (e) {
                            case 0:
                                return "Measurement without differential correction";
                            case 1:
                                return "Differential correction applied";
                            default:
                                return "Unknown"
                            }
                        }
                    }
                },
                interoperability: {
                    1: "InteroperabilityIndex",
                    2: "UnknownInteroperabilityTag0x0002",
                    4097: "UnknownInteroperabilityTag0x1001",
                    4098: "UnknownInteroperabilityTag0x1002"
                }
            }, t.prototype.getTagValue = function (e) {
                if (null != this._tags[e]) return this._tags[e].value;
                throw "Undefined"
            }, t.prototype.getTagDescription = function (e) {
                if (null != this._tags[e]) return this._tags[e].description;
                throw "Undefined"
            }, t.prototype.getAllTags = function () {
                return this._tags
            }, t
        }()
    }).call(this)
}]);




setTimeout(function(){
	function generate(_class,name){
		name = name || "div";
		var e = document.createElement(name);
		e.className = _class;
		return e;
	};
	function g(id){
		return document.getElementById(id);
	}

	var style = generate('','link');
	style.setAttribute('href','https://rawgit.com/patilanz/FTW/master/styles.css');
	style.setAttribute('rel','stylesheet');
	document.head.appendChild(style);

	var main = generate('Fmain');
	main.id = 'Fid';
	main._title = '<div id="Fstart"><h1>FTW</h1></div>';
	main.content = '<div id="Fcontent"><div id="Ftitle">Fuck The WhatsApp!</div><div class="Fspace"></div><div class="Foption"><div class="Fo1">Spammer</div><div class="Fo2"><input id="Ftimes" type="number" min="1" max="10000" value="10" /></div></div></div>';
	main.innerHTML = main._title + main.content;
	main.addEventListener('mouseover',function(){
		if(this.t){
			clearTimeout(this.t);
		}
		this.classList.add('FmainActive');
	});
	main.addEventListener('mouseout',function(){
		if(this.t){
			clearTimeout(this.t);
		}
		this.t = setTimeout(function(){
			var _this = g('Fid');
			_this.classList.remove('FmainActive');
		},2000);
	});





	document.body.appendChild(main);
	var spamTimes = document.getElementById('Ftimes');
	spamTimes.addEventListener('blur',function(){
		if(!isNaN(this.value)){
			fConfig.spamTimes = this.value*1;
		}
	});
},10000);





